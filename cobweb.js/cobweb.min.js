!function(){var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,r){(n||!hasProp(e,r))&&(i&&"string"!=typeof t?(e[r]||(e[r]={}),mixin(e[r],t,n,i)):e[r]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=i,n&&(r.originalError=n),r}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var r,o,s,a,u,l,c,h,d,p,f,g=n&&n.split("/"),m=g,y=C.map,b=y&&y["*"];if(e&&"."===e.charAt(0)&&(n?(m=getOwn(C.pkgs,n)?g=[n]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),o=getOwn(C.pkgs,r=e[0]),e=e.join("/"),o&&e===r+"/"+o.main&&(e=r)):0===e.indexOf("./")&&(e=e.substring(2))),i&&(g||b)&&y){for(a=e.split("/"),u=a.length;u>0;u-=1){if(c=a.slice(0,u).join("/"),g)for(l=g.length;l>0;l-=1)if(s=getOwn(y,g.slice(0,l).join("/")),s&&(s=getOwn(s,c))){h=s,d=u;break}if(h)break;!p&&b&&getOwn(b,c)&&(p=getOwn(b,c),f=u)}!h&&p&&(h=p,d=f),h&&(a.splice(0,d,h),e=a.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===v.contextName?(t.parentNode.removeChild(t),!0):void 0})}function r(e){var t=getOwn(C.paths,e);return t&&isArray(t)&&t.length>1?(i(e),t.shift(),v.require.undef(e),v.require([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function s(e,t,i,r){var s,a,u,l,c=null,h=t?t.name:null,d=e,p=!0,f="";return e||(p=!1,e="_@r"+(V+=1)),l=o(e),c=l[0],e=l[1],c&&(c=n(c,h,r),a=getOwn(O,c)),e&&(c?f=a&&a.normalize?a.normalize(e,function(e){return n(e,h,r)}):n(e,h,r):(f=n(e,h,r),l=o(f),c=l[0],f=l[1],i=!0,s=v.nameToUrl(f))),u=!c||a||i?"":"_unnormalized"+(D+=1),{prefix:c,name:f,parentMap:t,unnormalized:!!u,url:s,originalName:d,isDefine:p,id:(c?c+"!"+f:f)+u}}function a(e){var t=e.id,n=getOwn(S,t);return n||(n=S[t]=new v.Module(e)),n}function u(e,t,n){var i=e.id,r=getOwn(S,i);!hasProp(O,i)||r&&!r.defineEmitComplete?a(e).on(t,n):"defined"===t&&n(O[i])}function l(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(S,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function c(){globalDefQueue.length&&(apsp.apply(F,[F.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function h(e){delete S[e]}function d(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,r){var o=i.id,s=getOwn(S,o);!s||e.depMatched[r]||n[o]||(getOwn(t,o)?(e.defineDep(r,O[o]),e.check()):d(s,t,n))}),n[i]=!0)}function p(){var e,t,n,o,s=1e3*C.waitSeconds,a=s&&v.startTime+s<(new Date).getTime(),u=[],c=[],h=!1,f=!0;if(!b){if(b=!0,eachProp(S,function(n){if(e=n.map,t=e.id,n.enabled&&(e.isDefine||c.push(n),!n.error))if(!n.inited&&a)r(t)?(o=!0,h=!0):(u.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(h=!0,!e.prefix))return f=!1}),a&&u.length)return n=makeError("timeout","Load timeout for modules: "+u,null,u),n.contextName=v.contextName,l(n);f&&each(c,function(e){d(e,{},{})}),a&&!o||!h||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,p()},50)),b=!1}}function f(e){hasProp(O,e[0])||a(s(e[0],null,!0)).init(e[1],e[2])}function g(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,v.onScriptLoad,"load","onreadystatechange"),g(t,v.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function y(){var e;for(c();F.length;){if(e=F.shift(),null===e[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var b,w,v,x,_,C={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},map:{},config:{}},S={},T={},F=[],O={},N={},V=1,D=1;return x={require:function(e){return e.require?e.require:e.require=v.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=O[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return C.config&&getOwn(C.config,e.map.id)||{}},exports:O[e.map.id]}}},w=function(e){this.events=getOwn(T,e.id)||{},this.map=e,this.shim=getOwn(C.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},w.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,v.startTime=(new Date).getTime();var e=this.map;return this.shim?void v.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;N[e]||(N[e]=!0,v.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error)try{r=v.execCb(n,o,i,r)}catch(s){e=s}else r=v.execCb(n,o,i,r);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=[this.map.id],e.requireType="define",l(this.error=e)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(O[n]=r,req.onResourceLoad&&req.onResourceLoad(v,this.map,this.depMaps)),delete S[n],this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=s(e.prefix);this.depMaps.push(i),u(i,"defined",bind(this,function(i){var r,o,c,d=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=v.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(d=i.normalize(d,function(e){return n(e,p,!0)})||""),o=s(e.prefix+"!"+d,this.map.parentMap),u(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),c=getOwn(S,o.id),void(c&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(S,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&h(e.map.id)}),l(e)}),r.fromText=bind(this,function(n,i){var o=e.name,u=s(o),c=useInteractive;i&&(n=i),c&&(useInteractive=!1),a(u),hasProp(C.config,t)&&(C.config[o]=C.config[t]);try{req.exec(n)}catch(h){return l(makeError("fromtexteval","fromText eval for "+t+" failed: "+h,h,[t]))}c&&(useInteractive=!0),this.depMaps.push(u),v.completeLoad(o),f([o],r)}),void i.load(e.name,f,r,C))})),v.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,r;if("string"==typeof e){if(e=s(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(x,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,u(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&u(e,"error",this.errback)}n=e.id,i=S[n],hasProp(x,n)||!i||i.enabled||v.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(S,e.id);t&&!t.enabled&&v.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},v={config:C,contextName:e,registry:S,defined:O,urlFetched:N,defQueue:F,Module:w,makeModuleMap:s,nextTick:req.nextTick,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=C.pkgs,n=C.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?"map"===t?mixin(C[t],e,!0,!0):mixin(C[t],e,!0):C[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=v.makeShimExports(e)),n[t]=e}),C.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),C.pkgs=t),eachProp(S,function(e,t){e.inited||e.map.unnormalized||(e.map=s(t))}),(e.deps||e.callback)&&v.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,i){function r(n,o,u){var c,h,d;return i.enableBuildCallback&&o&&isFunction(o)&&(o.__requireJsBuild=!0),"string"==typeof n?isFunction(o)?l(makeError("requireargs","Invalid require call"),u):t&&hasProp(x,n)?x[n](S[t.id]):req.get?req.get(v,n,t):(h=s(n,t,!1,!0),c=h.id,hasProp(O,c)?O[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(y(),v.nextTick(function(){y(),d=a(s(null,t)),d.skipMap=i.skipMap,d.init(n,o,u,{enabled:!0}),p()}),r)}return i=i||{},mixin(r,{isBrowser:isBrowser,toUrl:function(e){var i,r,o=e.lastIndexOf("."),s=e.split("/")[0],a="."===s||".."===s;return-1!==o&&(!a||o>1)&&(i=e.substring(o,e.length),e=e.substring(0,o)),r=v.nameToUrl(n(e,t&&t.id,!0),i||".fake"),i?r:r.substring(0,r.length-5)},defined:function(e){return hasProp(O,s(e,t,!1,!0).id)},specified:function(e){return e=s(e,t,!1,!0).id,hasProp(O,e)||hasProp(S,e)}}),t||(r.undef=function(e){c();var n=s(e,t,!0),i=getOwn(S,e);delete O[e],delete N[n.url],delete T[e],i&&(i.events.defined&&(T[e]=i.events),h(e))}),r},enable:function(e){var t=getOwn(S,e.id);t&&a(e).enable()},completeLoad:function(e){var t,n,i,o=getOwn(C.shim,e)||{},s=o.exports;for(c();F.length;){if(n=F.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);f(n)}if(i=getOwn(S,e),!t&&!hasProp(O,e)&&i&&!i.inited){if(!(!C.enforceDefine||s&&getGlobal(s)))return r(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t){var n,i,r,o,s,a,u,l,c;if(req.jsExtRegExp.test(e))l=e+(t||"");else{for(n=C.paths,i=C.pkgs,s=e.split("/"),a=s.length;a>0;a-=1){if(u=s.slice(0,a).join("/"),r=getOwn(i,u),c=getOwn(n,u)){isArray(c)&&(c=c[0]),s.splice(0,a,c);break}if(r){o=e===r.name?r.location+"/"+r.main:r.location,s.splice(0,a,o);break}}l=s.join("/"),l+=t||(/\?/.test(l)?"":".js"),l=("/"===l.charAt(0)||l.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+l}return C.urlArgs?l+((-1===l.indexOf("?")?"?":"&")+C.urlArgs):l},load:function(e,t){req.load(v,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);v.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return r(t.id)?void 0:l(makeError("scripterror","Script error",e,[t.id]))}},v.require=v.makeRequire(),v}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.4",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var r,o,s=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=i):e=[]),o&&o.context&&(s=o.context),r=getOwn(contexts,s),r||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){var i,r=e&&e.config||{};return isBrowser?(i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i):void(isWebWorker&&(importScripts(n),e.completeLoad(t)))},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0):void 0}),define=function(e,t,n){var i,r;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")])),(r?r.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){});var jam={packages:[{name:"jquery",location:"jam/jquery",main:"dist/jquery.js"},{name:"jquery-mousewheel",location:"jam/jquery-mousewheel",main:"jquery.mousewheel.js"},{name:"require",location:"jam/require",main:"require.min.js"},{name:"text",location:"jam/text",main:"text.js"}],version:"0.2.17",shim:{}};if("undefined"!=typeof require&&require.config)require.config({packages:[{name:"jquery",location:"jam/jquery",main:"dist/jquery.js"},{name:"jquery-mousewheel",location:"jam/jquery-mousewheel",main:"jquery.mousewheel.js"},{name:"require",location:"jam/require",main:"require.min.js"},{name:"text",location:"jam/text",main:"text.js"}],shim:{}});else var require={packages:[{name:"jquery",location:"jam/jquery",main:"dist/jquery.js"},{name:"jquery-mousewheel",location:"jam/jquery-mousewheel",main:"jquery.mousewheel.js"},{name:"require",location:"jam/require",main:"require.min.js"},{name:"text",location:"jam/text",main:"text.js"}],shim:{}};"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=jam),define("jam/require.config",function(){}),function(e,t){function n(e){var t=e.length,n=oe.type(e);return oe.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e){var t=fe[e]={};return oe.each(e.match(ae)||[],function(e,n){t[n]=!0}),t}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=oe.expando+Math.random()}function o(e,n,i){var r;if(i===t&&1===e.nodeType)if(r="data-"+n.replace(be,"-$1").toLowerCase(),i=e.getAttribute(r),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:ye.test(i)?JSON.parse(i):i}catch(o){}ge.set(e,n,i)}else i=t;return i}function s(){return!0}function a(){return!1}function u(){try{return G.activeElement}catch(e){}}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function c(e,t,n){if(oe.isFunction(t))return oe.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return oe.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Ne.test(t))return oe.filter(t,e,n);t=oe.filter(t,e)}return oe.grep(e,function(e){return te.call(t,e)>=0!==n})}function h(e,t){return oe.nodeName(e,"table")&&oe.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Re.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function f(e,t){for(var n=e.length,i=0;n>i;i++)me.set(e[i],"globalEval",!t||me.get(t[i],"globalEval"))}function g(e,t){var n,i,r,o,s,a,u,l;if(1===t.nodeType){if(me.hasData(e)&&(o=me.access(e),s=oe.extend({},o),l=o.events,me.set(t,s),l)){delete s.handle,s.events={};for(r in l)for(n=0,i=l[r].length;i>n;n++)oe.event.add(t,r,l[r][n])}ge.hasData(e)&&(a=ge.access(e),u=oe.extend({},a),ge.set(t,u))}}function m(e,n){var i=e.getElementsByTagName?e.getElementsByTagName(n||"*"):e.querySelectorAll?e.querySelectorAll(n||"*"):[];return n===t||n&&oe.nodeName(e,n)?oe.merge([e],i):i}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ae.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function b(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,r=Qe.length;r--;)if(t=Qe[r]+n,t in e)return t;return i}function w(e,t){return e=t||e,"none"===oe.css(e,"display")||!oe.contains(e.ownerDocument,e)}function v(t){return e.getComputedStyle(t,null)}function x(e,t){for(var n,i,r,o=[],s=0,a=e.length;a>s;s++)i=e[s],i.style&&(o[s]=me.get(i,"olddisplay"),n=i.style.display,t?(o[s]||"none"!==n||(i.style.display=""),""===i.style.display&&w(i)&&(o[s]=me.access(i,"olddisplay",T(i.nodeName)))):o[s]||(r=w(i),(n&&"none"!==n||!r)&&me.set(i,"olddisplay",r?n:oe.css(i,"display"))));for(s=0;a>s;s++)i=e[s],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[s]||"":"none"));return e}function _(e,t,n){var i=Ge.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function C(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=oe.css(e,n+Ze[o],!0,r)),i?("content"===n&&(s-=oe.css(e,"padding"+Ze[o],!0,r)),"margin"!==n&&(s-=oe.css(e,"border"+Ze[o]+"Width",!0,r))):(s+=oe.css(e,"padding"+Ze[o],!0,r),"padding"!==n&&(s+=oe.css(e,"border"+Ze[o]+"Width",!0,r)));return s}function S(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=v(e),s=oe.support.boxSizing&&"border-box"===oe.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=ze(e,t,o),(0>r||null==r)&&(r=e.style[t]),He.test(r))return r;i=s&&(oe.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+C(e,t,n||(s?"border":"content"),i,o)+"px"}function T(e){var t=G,n=Ye[e];return n||(n=F(e,t),"none"!==n&&n||(Xe=(Xe||oe("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Xe[0].contentWindow||Xe[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=F(e,t),Xe.detach()),Ye[e]=n),n}function F(e,t){var n=oe(t.createElement(e)).appendTo(t.body),i=oe.css(n[0],"display");return n.remove(),i}function O(e,t,n,i){var r;if(oe.isArray(t))oe.each(t,function(t,r){n||et.test(e)?i(e,r):O(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==oe.type(t))i(e,t);else for(r in t)O(e+"["+r+"]",t[r],n,i)}function N(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(ae)||[];if(oe.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function V(e,t,n,i){function r(a){var u;return o[a]=!0,oe.each(e[a]||[],function(e,a){var l=a(t,n,i);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(t.dataTypes.unshift(l),r(l),!1)}),u}var o={},s=e===yt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function D(e,n){var i,r,o=oe.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&oe.extend(!0,e,r),e}function M(e,n,i){for(var r,o,s,a,u=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),r===t&&(r=e.mimeType||n.getResponseHeader("Content-Type"));if(r)for(o in u)if(u[o]&&u[o].test(r)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||e.converters[o+" "+l[0]]){s=o;break}a||(a=o)}s=s||a}return s?(s!==l[0]&&l.unshift(s),i[s]):void 0}function B(e,t,n,i){var r,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[r]:l[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(h){return{state:"parsererror",error:s?h:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}function E(){return setTimeout(function(){Ft=t}),Ft=oe.now()}function I(e,t){oe.each(t,function(t,n){for(var i=(Bt[t]||[]).concat(Bt["*"]),r=0,o=i.length;o>r;r++)if(i[r].call(e,t,n))return})}function A(e,t,n){var i,r,o=0,s=Mt.length,a=oe.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var t=Ft||E(),n=Math.max(0,l.startTime+l.duration-t),i=n/l.duration||0,o=1-i,s=0,u=l.tweens.length;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:oe.extend({},t),opts:oe.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Ft||E(),duration:n.duration,tweens:[],createTween:function(t,n){var i=oe.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var n=0,i=t?l.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(P(c,l.opts.specialEasing);s>o;o++)if(i=Mt[o].call(l,e,c,l.opts))return i;return I(l,c),oe.isFunction(l.opts.start)&&l.opts.start.call(e,l),oe.fx.timer(oe.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function P(e,t){var n,i,r,o,s;for(n in e)if(i=oe.camelCase(n),r=t[i],o=e[n],oe.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),s=oe.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function L(e,n,i){var r,o,s,a,u,l,c,h,d,p=this,f=e.style,g={},m=[],y=e.nodeType&&w(e);i.queue||(h=oe._queueHooks(e,"fx"),null==h.unqueued&&(h.unqueued=0,d=h.empty.fire,h.empty.fire=function(){h.unqueued||d()}),h.unqueued++,p.always(function(){p.always(function(){h.unqueued--,oe.queue(e,"fx").length||h.empty.fire()})})),1===e.nodeType&&("height"in n||"width"in n)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===oe.css(e,"display")&&"none"===oe.css(e,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",p.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),u=me.get(e,"fxshow");for(r in n)if(s=n[r],Nt.exec(s)){if(delete n[r],l=l||"toggle"===s,s===(y?"hide":"show")){if("show"!==s||u===t||u[r]===t)continue;y=!0}m.push(r)}if(a=m.length){u=me.get(e,"fxshow")||me.access(e,"fxshow",{}),"hidden"in u&&(y=u.hidden),l&&(u.hidden=!y),y?oe(e).show():p.done(function(){oe(e).hide()}),p.done(function(){var t;me.remove(e,"fxshow");for(t in g)oe.style(e,t,g[t])});for(r=0;a>r;r++)o=m[r],c=p.createTween(o,y?u[o]:0),g[o]=u[o]||oe.style(e,o),o in u||(u[o]=c.start,y&&(c.end=c.start,c.start="width"===o||"height"===o?1:0))}}function R(e,t,n,i,r){return new R.prototype.init(e,t,n,i,r)}function k(e,t){var n,i={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)n=Ze[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function j(e){return oe.isWindow(e)?e:9===e.nodeType&&e.defaultView}var z,X,U=typeof t,q=e.location,G=e.document,H=G.documentElement,W=e.jQuery,Y=e.$,$={},K=[],Z="2.0.0",Q=K.concat,J=K.push,ee=K.slice,te=K.indexOf,ne=$.toString,ie=$.hasOwnProperty,re=Z.trim,oe=function(e,t){return new oe.fn.init(e,t,z)},se=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ae=/\S+/g,ue=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,le=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ce=/^-ms-/,he=/-([\da-z])/gi,de=function(e,t){return t.toUpperCase()},pe=function(){G.removeEventListener("DOMContentLoaded",pe,!1),e.removeEventListener("load",pe,!1),oe.ready()};oe.fn=oe.prototype={jquery:Z,constructor:oe,init:function(e,n,i){var r,o;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ue.exec(e),!r||!r[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(r[1]){if(n=n instanceof oe?n[0]:n,oe.merge(this,oe.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:G,!0)),le.test(r[1])&&oe.isPlainObject(n))for(r in n)oe.isFunction(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}return o=G.getElementById(r[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=G,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):oe.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),oe.makeArray(e,this))},selector:"",length:0,toArray:function(){return ee.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=oe.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return oe.each(this,e,t)},ready:function(e){return oe.ready.promise().done(e),this},slice:function(){return this.pushStack(ee.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(oe.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:[].sort,splice:[].splice},oe.fn.init.prototype=oe.fn,oe.extend=oe.fn.extend=function(){var e,n,i,r,o,s,a=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},u=2),"object"==typeof a||oe.isFunction(a)||(a={}),l===u&&(a=this,--u);l>u;u++)if(null!=(e=arguments[u]))for(n in e)i=a[n],r=e[n],a!==r&&(c&&r&&(oe.isPlainObject(r)||(o=oe.isArray(r)))?(o?(o=!1,s=i&&oe.isArray(i)?i:[]):s=i&&oe.isPlainObject(i)?i:{},a[n]=oe.extend(c,s,r)):r!==t&&(a[n]=r));return a},oe.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===oe&&(e.$=Y),t&&e.jQuery===oe&&(e.jQuery=W),oe},isReady:!1,readyWait:1,holdReady:function(e){e?oe.readyWait++:oe.ready(!0)},ready:function(e){(e===!0?--oe.readyWait:oe.isReady)||(oe.isReady=!0,e!==!0&&--oe.readyWait>0||(X.resolveWith(G,[oe]),oe.fn.trigger&&oe(G).trigger("ready").off("ready")))},isFunction:function(e){return"function"===oe.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?$[ne.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==oe.type(e)||e.nodeType||oe.isWindow(e))return!1;try{if(e.constructor&&!ie.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||G;var i=le.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=oe.buildFragment([e],t,r),r&&oe(r).remove(),oe.merge([],i.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var n,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,n=i.parseFromString(e,"text/xml")}catch(r){n=t}return(!n||n.getElementsByTagName("parsererror").length)&&oe.error("Invalid XML: "+e),n},noop:function(){},globalEval:function(e){var t,n=eval;e=oe.trim(e),e&&(1===e.indexOf("use strict")?(t=G.createElement("script"),t.text=e,G.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(ce,"ms-").replace(he,de)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,s=e.length,a=n(e);if(i){if(a)for(;s>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(a)for(;s>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":re.call(e)},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?oe.merge(i,"string"==typeof e?[e]:e):J.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:te.call(t,e,n)},merge:function(e,n){var i=n.length,r=e.length,o=0;if("number"==typeof i)for(;i>o;o++)e[r++]=n[o];else for(;n[o]!==t;)e[r++]=n[o++];return e.length=r,e},grep:function(e,t,n){var i,r=[],o=0,s=e.length;for(n=!!n;s>o;o++)i=!!t(e[o],o),n!==i&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,s=e.length,a=n(e),u=[];if(a)for(;s>o;o++)r=t(e[o],o,i),null!=r&&(u[u.length]=r);else for(o in e)r=t(e[o],o,i),null!=r&&(u[u.length]=r);return Q.apply([],u)},guid:1,proxy:function(e,n){var i,r,o;return"string"==typeof n&&(i=e[n],n=e,e=i),oe.isFunction(e)?(r=ee.call(arguments,2),o=function(){return e.apply(n||this,r.concat(ee.call(arguments)))},o.guid=e.guid=e.guid||oe.guid++,o):t},access:function(e,n,i,r,o,s,a){var u=0,l=e.length,c=null==i;if("object"===oe.type(i)){o=!0;for(u in i)oe.access(e,n,u,i[u],!0,s,a)}else if(r!==t&&(o=!0,oe.isFunction(r)||(a=!0),c&&(a?(n.call(e,r),n=null):(c=n,n=function(e,t,n){return c.call(oe(e),n)})),n))for(;l>u;u++)n(e[u],i,a?r:r.call(e[u],u,n(e[u],i)));return o?e:c?n.call(e):l?n(e[0],i):s;
},now:Date.now,swap:function(e,t,n,i){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=s[o];return r}}),oe.ready.promise=function(t){return X||(X=oe.Deferred(),"complete"===G.readyState?setTimeout(oe.ready):(G.addEventListener("DOMContentLoaded",pe,!1),e.addEventListener("load",pe,!1))),X.promise(t)},oe.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()}),z=oe(G),function(e,t){function n(e){return we.test(e+"")}function i(){var e,t=[];return e=function(n,i){return t.push(n+=" ")>F.cacheLength&&delete e[t.shift()],e[n]=i}}function r(e){return e[j]=!0,e}function o(e){var t=E.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t,n,i){var r,o,s,a,u,l,c,h,d,g;if((t?t.ownerDocument||t:z)!==E&&B(t),t=t||E,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(A&&!i){if(r=ve.exec(e))if(s=r[1]){if(9===a){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&k(t,o)&&o.id===s)return n.push(o),n}else{if(r[2])return te.apply(n,t.getElementsByTagName(e)),n;if((s=r[3])&&X.getElementsByClassName&&t.getElementsByClassName)return te.apply(n,t.getElementsByClassName(s)),n}if(X.qsa&&(!P||!P.test(e))){if(h=c=j,d=t,g=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(l=p(e),(c=t.getAttribute("id"))?h=c.replace(Ce,"\\$&"):t.setAttribute("id",h),h="[id='"+h+"'] ",u=l.length;u--;)l[u]=h+f(l[u]);d=fe.test(e)&&t.parentNode||t,g=l.join(",")}if(g)try{return te.apply(n,d.querySelectorAll(g)),n}catch(m){}finally{c||t.removeAttribute("id")}}}return _(e.replace(he,"$1"),t,n,i)}function a(e,t){var n=t&&e,i=n&&(~t.sourceIndex||Z)-(~e.sourceIndex||Z);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function u(e,n,i){var r;return i?t:(r=e.getAttributeNode(n))&&r.specified?r.value:e[n]===!0?n.toLowerCase():null}function l(e,n,i){var r;return i?t:r=e.getAttribute(n,"type"===n.toLowerCase()?1:2)}function c(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function h(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function d(e){return r(function(t){return t=+t,r(function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function p(e,t){var n,i,r,o,a,u,l,c=H[e+" "];if(c)return t?0:c.slice(0);for(a=e,u=[],l=F.preFilter;a;){(!n||(i=de.exec(a)))&&(i&&(a=a.slice(i[0].length)||a),u.push(r=[])),n=!1,(i=pe.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(he," ")}),a=a.slice(n.length));for(o in F.filter)!(i=be[o].exec(a))||l[o]&&!(i=l[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?s.error(e):H(e,u).slice(0)}function f(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function g(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=q++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,s){var a,u,l,c=U+" "+o;if(s){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,s))return!0}else for(;t=t[i];)if(1===t.nodeType||r)if(l=t[j]||(t[j]={}),(u=l[i])&&u[0]===c){if((a=u[1])===!0||a===T)return a===!0}else if(u=l[i]=[c],u[1]=e(t,n,s)||T,u[1]===!0)return!0}}function m(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function y(e,t,n,i,r){for(var o,s=[],a=0,u=e.length,l=null!=t;u>a;a++)(o=e[a])&&(!n||n(o,i,r))&&(s.push(o),l&&t.push(a));return s}function b(e,t,n,i,o,s){return i&&!i[j]&&(i=b(i)),o&&!o[j]&&(o=b(o,s)),r(function(r,s,a,u){var l,c,h,d=[],p=[],f=s.length,g=r||x(t||"*",a.nodeType?[a]:a,[]),m=!e||!r&&t?g:y(g,d,e,a,u),b=n?o||(r?e:f||i)?[]:s:m;if(n&&n(m,b,a,u),i)for(l=y(b,p),i(l,[],a,u),c=l.length;c--;)(h=l[c])&&(b[p[c]]=!(m[p[c]]=h));if(r){if(o||e){if(o){for(l=[],c=b.length;c--;)(h=b[c])&&l.push(m[c]=h);o(null,b=[],l,u)}for(c=b.length;c--;)(h=b[c])&&(l=o?ie.call(r,h):d[c])>-1&&(r[l]=!(s[l]=h))}}else b=y(b===s?b.splice(f,b.length):b),o?o(null,s,b,u):te.apply(s,b)})}function w(e){for(var t,n,i,r=e.length,o=F.relative[e[0].type],s=o||F.relative[" "],a=o?1:0,u=g(function(e){return e===t},s,!0),l=g(function(e){return ie.call(t,e)>-1},s,!0),c=[function(e,n,i){return!o&&(i||n!==D)||((t=n).nodeType?u(e,n,i):l(e,n,i))}];r>a;a++)if(n=F.relative[e[a].type])c=[g(m(c),n)];else{if(n=F.filter[e[a].type].apply(null,e[a].matches),n[j]){for(i=++a;r>i&&!F.relative[e[i].type];i++);return b(a>1&&m(c),a>1&&f(e.slice(0,a-1)).replace(he,"$1"),n,i>a&&w(e.slice(a,i)),r>i&&w(e=e.slice(i)),r>i&&f(e))}c.push(n)}return m(c)}function v(e,t){var n=0,i=t.length>0,o=e.length>0,a=function(r,a,u,l,c){var h,d,p,f=[],g=0,m="0",b=r&&[],w=null!=c,v=D,x=r||o&&F.find.TAG("*",c&&a.parentNode||a),_=U+=null==v?1:Math.random()||.1;for(w&&(D=a!==E&&a,T=n);null!=(h=x[m]);m++){if(o&&h){for(d=0;p=e[d++];)if(p(h,a,u)){l.push(h);break}w&&(U=_,T=++n)}i&&((h=!p&&h)&&g--,r&&b.push(h))}if(g+=m,i&&m!==g){for(d=0;p=t[d++];)p(b,f,a,u);if(r){if(g>0)for(;m--;)b[m]||f[m]||(f[m]=J.call(l));f=y(f)}te.apply(l,f),w&&!r&&f.length>0&&g+t.length>1&&s.uniqueSort(l)}return w&&(U=_,D=v),b};return i?r(a):a}function x(e,t,n){for(var i=0,r=t.length;r>i;i++)s(e,t[i],n);return n}function _(e,t,n,i){var r,o,s,a,u,l=p(e);if(!i&&1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&A&&F.relative[o[1].type]){if(t=(F.find.ID(s.matches[0].replace(Se,Te),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}for(r=be.needsContext.test(e)?0:o.length;r--&&(s=o[r],!F.relative[a=s.type]);)if((u=F.find[a])&&(i=u(s.matches[0].replace(Se,Te),fe.test(o[0].type)&&t.parentNode||t))){if(o.splice(r,1),e=i.length&&f(o),!e)return te.apply(n,i),n;break}}return V(e,l)(i,t,!A,n,fe.test(e)),n}function C(){}var S,T,F,O,N,V,D,M,B,E,I,A,P,L,R,k,j="sizzle"+-new Date,z=e.document,X={},U=0,q=0,G=i(),H=i(),W=i(),Y=!1,$=function(){return 0},K=typeof t,Z=1<<31,Q=[],J=Q.pop,ee=Q.push,te=Q.push,ne=Q.slice,ie=Q.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},re="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",se="[\\x20\\t\\r\\n\\f]",ae="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ue=ae.replace("w","w#"),le="\\["+se+"*("+ae+")"+se+"*(?:([*^$|!~]?=)"+se+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ue+")|)|)"+se+"*\\]",ce=":("+ae+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+le.replace(3,8)+")*)|.*)\\)|)",he=new RegExp("^"+se+"+|((?:^|[^\\\\])(?:\\\\.)*)"+se+"+$","g"),de=new RegExp("^"+se+"*,"+se+"*"),pe=new RegExp("^"+se+"*([>+~]|"+se+")"+se+"*"),fe=new RegExp(se+"*[+~]"),ge=new RegExp("="+se+"*([^\\]'\"]*)"+se+"*\\]","g"),me=new RegExp(ce),ye=new RegExp("^"+ue+"$"),be={ID:new RegExp("^#("+ae+")"),CLASS:new RegExp("^\\.("+ae+")"),TAG:new RegExp("^("+ae.replace("w","w*")+")"),ATTR:new RegExp("^"+le),PSEUDO:new RegExp("^"+ce),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+se+"*(even|odd|(([+-]|)(\\d*)n|)"+se+"*(?:([+-]|)"+se+"*(\\d+)|))"+se+"*\\)|)","i"),"boolean":new RegExp("^(?:"+re+")$","i"),needsContext:new RegExp("^"+se+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+se+"*((?:-\\d)?\\d*)"+se+"*\\)|)(?=[^-]|$)","i")},we=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,xe=/^(?:input|select|textarea|button)$/i,_e=/^h\d$/i,Ce=/'|\\/g,Se=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Te=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{te.apply(Q=ne.call(z.childNodes),z.childNodes),Q[z.childNodes.length].nodeType}catch(Fe){te={apply:Q.length?function(e,t){ee.apply(e,ne.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}N=s.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},B=s.setDocument=function(e){var i=e?e.ownerDocument||e:z;return i!==E&&9===i.nodeType&&i.documentElement?(E=i,I=i.documentElement,A=!N(i),X.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),X.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),X.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),X.sortDetached=o(function(e){return 1&e.compareDocumentPosition(E.createElement("div"))}),X.getById=o(function(e){return I.appendChild(e).id=j,!i.getElementsByName||!i.getElementsByName(j).length}),X.getById?(F.find.ID=function(e,t){if(typeof t.getElementById!==K&&A){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},F.filter.ID=function(e){var t=e.replace(Se,Te);return function(e){return e.getAttribute("id")===t}}):(F.find.ID=function(e,n){if(typeof n.getElementById!==K&&A){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==K&&i.getAttributeNode("id").value===e?[i]:t:[]}},F.filter.ID=function(e){var t=e.replace(Se,Te);return function(e){var n=typeof e.getAttributeNode!==K&&e.getAttributeNode("id");return n&&n.value===t}}),F.find.TAG=X.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==K?t.getElementsByTagName(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},F.find.CLASS=X.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==K&&A?t.getElementsByClassName(e):void 0},L=[],P=[],(X.qsa=n(i.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||P.push("\\["+se+"*(?:value|"+re+")"),e.querySelectorAll(":checked").length||P.push(":checked")}),o(function(e){var t=E.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&P.push("[*^$]="+se+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||P.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),P.push(",.*:")})),(X.matchesSelector=n(R=I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&o(function(e){X.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),L.push("!=",ce)}),P=P.length&&new RegExp(P.join("|")),L=L.length&&new RegExp(L.join("|")),k=n(I.contains)||I.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=I.compareDocumentPosition?function(e,t){if(e===t)return Y=!0,0;var n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return n?1&n||!X.sortDetached&&t.compareDocumentPosition(e)===n?e===i||k(z,e)?-1:t===i||k(z,t)?1:M?ie.call(M,e)-ie.call(M,t):0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var n,r=0,o=e.parentNode,s=t.parentNode,u=[e],l=[t];if(e===t)return Y=!0,0;if(!o||!s)return e===i?-1:t===i?1:o?-1:s?1:M?ie.call(M,e)-ie.call(M,t):0;if(o===s)return a(e,t);for(n=e;n=n.parentNode;)u.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;u[r]===l[r];)r++;return r?a(u[r],l[r]):u[r]===z?-1:l[r]===z?1:0},E):E},s.matches=function(e,t){return s(e,null,null,t)},s.matchesSelector=function(e,t){if((e.ownerDocument||e)!==E&&B(e),t=t.replace(ge,"='$1']"),X.matchesSelector&&A&&(!L||!L.test(t))&&(!P||!P.test(t)))try{var n=R.call(e,t);if(n||X.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return s(t,E,null,[e]).length>0},s.contains=function(e,t){return(e.ownerDocument||e)!==E&&B(e),k(e,t)},s.attr=function(e,n){(e.ownerDocument||e)!==E&&B(e);var i=F.attrHandle[n.toLowerCase()],r=i&&i(e,n,!A);return r===t?X.attributes||!A?e.getAttribute(n):(r=e.getAttributeNode(n))&&r.specified?r.value:null:r},s.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},s.uniqueSort=function(e){var t,n=[],i=0,r=0;if(Y=!X.detectDuplicates,M=!X.sortStable&&e.slice(0),e.sort($),Y){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},O=s.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=O(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i];i++)n+=O(t);return n},F=s.selectors={cacheLength:50,createPseudo:r,match:be,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Se,Te),e[3]=(e[4]||e[5]||"").replace(Se,Te),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||s.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&s.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return be.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&me.test(n)&&(t=p(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Se,Te).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=G[e+" "];return t||(t=new RegExp("(^|"+se+")"+e+"("+se+"|$)"))&&G(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==K&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var r=s.attr(i,e);return null==r?"!="===t:t?(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r+" ").indexOf(n)>-1:"|="===t?r===n||r.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,u){var l,c,h,d,p,f,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),b=!u&&!a;if(m){if(o){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&b){for(c=m[j]||(m[j]={}),l=c[e]||[],p=l[0]===U&&l[1],d=l[0]===U&&l[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===t){c[e]=[U,p,d];break}}else if(b&&(l=(t[j]||(t[j]={}))[e])&&l[0]===U)d=l[1];else for(;(h=++p&&h&&h[g]||(d=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++d||(b&&((h[j]||(h[j]={}))[e]=[U,d]),h!==t)););return d-=r,d===i||d%i===0&&d/i>=0}}},PSEUDO:function(e,t){var n,i=F.pseudos[e]||F.setFilters[e.toLowerCase()]||s.error("unsupported pseudo: "+e);return i[j]?i(t):i.length>1?(n=[e,e,"",t],F.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,n){for(var r,o=i(e,t),s=o.length;s--;)r=ie.call(e,o[s]),e[r]=!(n[r]=o[s])}):function(e){return i(e,0,n)}):i}},pseudos:{not:r(function(e){var t=[],n=[],i=V(e.replace(he,"$1"));return i[j]?r(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),!n.pop()}}),has:r(function(e){return function(t){return s(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||O(t)).indexOf(e)>-1}}),lang:r(function(e){return ye.test(e||"")||s.error("unsupported lang: "+e),e=e.replace(Se,Te).toLowerCase(),function(t){var n;do if(n=A?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===I},focus:function(e){return e===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!F.pseudos.empty(e)},header:function(e){return _e.test(e.nodeName)},input:function(e){return xe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:d(function(){return[0]}),last:d(function(e,t){return[t-1]}),eq:d(function(e,t,n){return[0>n?n+t:n]}),even:d(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:d(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:d(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:d(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}};for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})F.pseudos[S]=c(S);for(S in{submit:!0,reset:!0})F.pseudos[S]=h(S);V=s.compile=function(e,t){var n,i=[],r=[],o=W[e+" "];if(!o){for(t||(t=p(e)),n=t.length;n--;)o=w(t[n]),o[j]?i.push(o):r.push(o);o=W(e,v(r,i))}return o},F.pseudos.nth=F.pseudos.eq,C.prototype=F.filters=F.pseudos,F.setFilters=new C,X.sortStable=j.split("").sort($).join("")===j,B(),[0,0].sort($),X.detectDuplicates=Y,o(function(e){if(e.innerHTML="<a href='#'></a>","#"!==e.firstChild.getAttribute("href"))for(var t="type|href|height|width".split("|"),n=t.length;n--;)F.attrHandle[t[n]]=l}),o(function(e){if(null!=e.getAttribute("disabled"))for(var t=re.split("|"),n=t.length;n--;)F.attrHandle[t[n]]=u}),oe.find=s,oe.expr=s.selectors,oe.expr[":"]=oe.expr.pseudos,oe.unique=s.uniqueSort,oe.text=s.getText,oe.isXMLDoc=s.isXML,oe.contains=s.contains}(e);var fe={};oe.Callbacks=function(e){e="string"==typeof e?fe[e]||i(e):oe.extend({},e);var n,r,o,s,a,u,l=[],c=!e.once&&[],h=function(t){for(n=e.memory&&t,r=!0,u=s||0,s=0,a=l.length,o=!0;l&&a>u;u++)if(l[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}o=!1,l&&(c?c.length&&h(c.shift()):n?l=[]:d.disable())},d={add:function(){if(l){var t=l.length;!function i(t){oe.each(t,function(t,n){var r=oe.type(n);"function"===r?e.unique&&d.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),o?a=l.length:n&&(s=t,h(n))}return this},remove:function(){return l&&oe.each(arguments,function(e,t){for(var n;(n=oe.inArray(t,l,n))>-1;)l.splice(n,1),o&&(a>=n&&a--,u>=n&&u--)}),this},has:function(e){return e?oe.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=c=n=t,this},disabled:function(){return!l},lock:function(){return c=t,n||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!l||r&&!c||(o?c.push(t):h(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d},oe.extend({Deferred:function(e){var t=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return oe.Deferred(function(n){oe.each(t,function(t,o){var s=o[0],a=oe.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&oe.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?oe.extend(e,i):i}},r={};return i.pipe=i.then,oe.each(t,function(e,o){var s=o[2],a=o[3];i[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=s.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=ee.call(arguments),s=o.length,a=1!==s||e&&oe.isFunction(e.promise)?s:0,u=1===a?e:oe.Deferred(),l=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?ee.call(arguments):r,i===t?u.notifyWith(n,i):--a||u.resolveWith(n,i)}};if(s>1)for(t=new Array(s),n=new Array(s),i=new Array(s);s>r;r++)o[r]&&oe.isFunction(o[r].promise)?o[r].promise().done(l(r,i,o)).fail(u.reject).progress(l(r,n,t)):--a;return a||u.resolveWith(i,o),u.promise()}}),oe.support=function(t){var n=G.createElement("input"),i=G.createDocumentFragment(),r=G.createElement("div"),o=G.createElement("select"),s=o.appendChild(G.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=s.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!s.disabled,n=G.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),i.appendChild(n),t.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===r.style.backgroundClip,oe(function(){var n,i,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",s=G.getElementsByTagName("body")[0];s&&(n=G.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(n).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",oe.swap(s,null!=s.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===r.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(r,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(r,null)||{width:"4px"}).width,i=r.appendChild(G.createElement("div")),i.style.cssText=r.style.cssText=o,i.style.marginRight=i.style.width="0",r.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),s.removeChild(n))}),t):t}({});var ge,me,ye=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,be=/([A-Z])/g;r.uid=1,r.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=r.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,oe.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(oe.isEmptyObject(o))this.cache[r]=t;else for(i in t)o[i]=t[i]},get:function(e,n){var i=this.cache[this.key(e)];return n===t?i:i[n]},access:function(e,n,i){return n===t||n&&"string"==typeof n&&i===t?this.get(e,n):(this.set(e,n,i),i!==t?i:n)},remove:function(e,n){var i,r,o=this.key(e),s=this.cache[o];if(n===t)this.cache[o]={};else{oe.isArray(n)?r=n.concat(n.map(oe.camelCase)):n in s?r=[n]:(r=oe.camelCase(n),r=r in s?[r]:r.match(ae)||[]),i=r.length;for(;i--;)delete s[r[i]]}},hasData:function(e){return!oe.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){delete this.cache[this.key(e)]}},ge=new r,me=new r,oe.extend({acceptData:r.accepts,hasData:function(e){return ge.hasData(e)||me.hasData(e)},data:function(e,t,n){return ge.access(e,t,n)},removeData:function(e,t){ge.remove(e,t)},_data:function(e,t,n){return me.access(e,t,n)},_removeData:function(e,t){me.remove(e,t)}}),oe.fn.extend({data:function(e,n){var i,r,s=this[0],a=0,u=null;if(e===t){if(this.length&&(u=ge.get(s),1===s.nodeType&&!me.get(s,"hasDataAttrs"))){for(i=s.attributes;a<i.length;a++)r=i[a].name,0===r.indexOf("data-")&&(r=oe.camelCase(r.substring(5)),o(s,r,u[r]));me.set(s,"hasDataAttrs",!0)}return u}return"object"==typeof e?this.each(function(){ge.set(this,e)}):oe.access(this,function(n){var i,r=oe.camelCase(e);if(s&&n===t){if(i=ge.get(s,e),i!==t)return i;if(i=ge.get(s,r),i!==t)return i;if(i=o(s,r,t),i!==t)return i}else this.each(function(){var i=ge.get(this,r);ge.set(this,r,n),-1!==e.indexOf("-")&&i!==t&&ge.set(this,e,n)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ge.remove(this,e)})}}),oe.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=me.get(e,t),n&&(!i||oe.isArray(n)?i=me.access(e,t,oe.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=oe.queue(e,t),i=n.length,r=n.shift(),o=oe._queueHooks(e,t),s=function(){oe.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),o.cur=r,r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return me.get(e,n)||me.access(e,n,{empty:oe.Callbacks("once memory").add(function(){me.remove(e,[t+"queue",n])})})}}),oe.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?oe.queue(this[0],e):n===t?this:this.each(function(){var t=oe.queue(this,e,n);oe._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&oe.dequeue(this,e)})},dequeue:function(e){return this.each(function(){oe.dequeue(this,e)})},delay:function(e,t){return e=oe.fx?oe.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,r=1,o=oe.Deferred(),s=this,a=this.length,u=function(){--r||o.resolveWith(s,[s])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";a--;)i=me.get(s[a],e+"queueHooks"),i&&i.empty&&(r++,i.empty.add(u));return u(),o.promise(n)}});var we,ve,xe=/[\t\r\n]/g,_e=/\r/g,Ce=/^(?:input|select|textarea|button)$/i;oe.fn.extend({attr:function(e,t){return oe.access(this,oe.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){oe.removeAttr(this,e)})},prop:function(e,t){return oe.access(this,oe.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[oe.propFix[e]||e]})},addClass:function(e){var t,n,i,r,o,s=0,a=this.length,u="string"==typeof e&&e;if(oe.isFunction(e))return this.each(function(t){oe(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(ae)||[];a>s;s++)if(n=this[s],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(xe," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");n.className=oe.trim(i)}return this},removeClass:function(e){var t,n,i,r,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(oe.isFunction(e))return this.each(function(t){oe(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(ae)||[];a>s;s++)if(n=this[s],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(xe," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");n.className=e?oe.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return oe.isFunction(e)?this.each(function(n){oe(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var r,o=0,s=oe(this),a=t,u=e.match(ae)||[];r=u[o++];)a=i?a:!s.hasClass(r),s[a?"addClass":"removeClass"](r);else(n===U||"boolean"===n)&&(this.className&&me.set(this,"__className__",this.className),this.className=this.className||e===!1?"":me.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(xe," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,r,o=this[0];{if(arguments.length)return r=oe.isFunction(e),this.each(function(i){var o,s=oe(this);1===this.nodeType&&(o=r?e.call(this,i,s.val()):e,null==o?o="":"number"==typeof o?o+="":oe.isArray(o)&&(o=oe.map(o,function(e){return null==e?"":e+""})),n=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=oe.valHooks[o.type]||oe.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==t?i:(i=o.value,"string"==typeof i?i.replace(_e,""):null==i?"":i)}}}),oe.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,s=o?null:[],a=o?r+1:i.length,u=0>r?a:o?r:0;a>u;u++)if(n=i[u],(n.selected||u===r)&&(oe.support.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!oe.nodeName(n.parentNode,"optgroup"))){if(t=oe(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,o=oe.makeArray(t),s=r.length;s--;)i=r[s],(i.selected=oe.inArray(oe(i).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,i){var r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===U?oe.prop(e,n,i):(1===s&&oe.isXMLDoc(e)||(n=n.toLowerCase(),r=oe.attrHooks[n]||(oe.expr.match["boolean"].test(n)?ve:we)),i===t?r&&"get"in r&&null!==(o=r.get(e,n))?o:(o=oe.find.attr(e,n),null==o?t:o):null!==i?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:(e.setAttribute(n,i+""),i):void oe.removeAttr(e,n))},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(ae);if(o&&1===e.nodeType)for(;n=o[r++];)i=oe.propFix[n]||n,oe.expr.match["boolean"].test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!oe.support.radioValue&&"radio"===t&&oe.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,i){var r,o,s,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return s=1!==a||!oe.isXMLDoc(e),s&&(n=oe.propFix[n]||n,o=oe.propHooks[n]),i!==t?o&&"set"in o&&(r=o.set(e,i,n))!==t?r:e[n]=i:o&&"get"in o&&null!==(r=o.get(e,n))?r:e[n]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Ce.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),ve={set:function(e,t,n){return t===!1?oe.removeAttr(e,n):e.setAttribute(n,n),n}},oe.each(oe.expr.match["boolean"].source.match(/\w+/g),function(e,n){var i=oe.expr.attrHandle[n]||oe.find.attr;oe.expr.attrHandle[n]=function(e,n,r){var o=oe.expr.attrHandle[n],s=r?t:(oe.expr.attrHandle[n]=t)!=i(e,n,r)?n.toLowerCase():null;return oe.expr.attrHandle[n]=o,s}}),oe.support.optSelected||(oe.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),oe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){oe.propFix[this.toLowerCase()]=this}),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(e,t){return oe.isArray(t)?e.checked=oe.inArray(oe(e).val(),t)>=0:void 0}},oe.support.checkOn||(oe.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Se=/^key/,Te=/^(?:mouse|contextmenu)|click/,Fe=/^(?:focusinfocus|focusoutblur)$/,Oe=/^([^.]*)(?:\.(.+)|)$/;oe.event={global:{},add:function(e,n,i,r,o){var s,a,u,l,c,h,d,p,f,g,m,y=me.get(e);if(y){for(i.handler&&(s=i,i=s.handler,o=s.selector),i.guid||(i.guid=oe.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof oe===U||e&&oe.event.triggered===e.type?t:oe.event.dispatch.apply(a.elem,arguments)},a.elem=e),n=(n||"").match(ae)||[""],c=n.length;c--;)u=Oe.exec(n[c])||[],f=m=u[1],g=(u[2]||"").split(".").sort(),f&&(d=oe.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=oe.event.special[f]||{},h=oe.extend({type:f,origType:m,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&oe.expr.match.needsContext.test(o),
namespace:g.join(".")},s),(p=l[f])||(p=l[f]=[],p.delegateCount=0,d.setup&&d.setup.call(e,r,g,a)!==!1||e.addEventListener&&e.addEventListener(f,a,!1)),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),o?p.splice(p.delegateCount++,0,h):p.push(h),oe.event.global[f]=!0);e=null}},remove:function(e,t,n,i,r){var o,s,a,u,l,c,h,d,p,f,g,m=me.hasData(e)&&me.get(e);if(m&&(u=m.events)){for(t=(t||"").match(ae)||[""],l=t.length;l--;)if(a=Oe.exec(t[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=oe.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)c=d[o],!r&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(e,c));s&&!d.length&&(h.teardown&&h.teardown.call(e,f,m.handle)!==!1||oe.removeEvent(e,p,m.handle),delete u[p])}else for(p in u)oe.event.remove(e,p+t[l],n,i,!0);oe.isEmptyObject(u)&&(delete m.handle,me.remove(e,"events"))}},trigger:function(n,i,r,o){var s,a,u,l,c,h,d,p=[r||G],f=ie.call(n,"type")?n.type:n,g=ie.call(n,"namespace")?n.namespace.split("."):[];if(a=u=r=r||G,3!==r.nodeType&&8!==r.nodeType&&!Fe.test(f+oe.event.triggered)&&(f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),c=f.indexOf(":")<0&&"on"+f,n=n[oe.expando]?n:new oe.Event(f,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=r),i=null==i?[n]:oe.makeArray(i,[n]),d=oe.event.special[f]||{},o||!d.trigger||d.trigger.apply(r,i)!==!1)){if(!o&&!d.noBubble&&!oe.isWindow(r)){for(l=d.delegateType||f,Fe.test(l+f)||(a=a.parentNode);a;a=a.parentNode)p.push(a),u=a;u===(r.ownerDocument||G)&&p.push(u.defaultView||u.parentWindow||e)}for(s=0;(a=p[s++])&&!n.isPropagationStopped();)n.type=s>1?l:d.bindType||f,h=(me.get(a,"events")||{})[n.type]&&me.get(a,"handle"),h&&h.apply(a,i),h=c&&a[c],h&&oe.acceptData(a)&&h.apply&&h.apply(a,i)===!1&&n.preventDefault();return n.type=f,o||n.isDefaultPrevented()||d._default&&d._default.apply(p.pop(),i)!==!1||!oe.acceptData(r)||c&&oe.isFunction(r[f])&&!oe.isWindow(r)&&(u=r[c],u&&(r[c]=null),oe.event.triggered=f,r[f](),oe.event.triggered=t,u&&(r[c]=u)),n.result}},dispatch:function(e){e=oe.event.fix(e);var n,i,r,o,s,a=[],u=ee.call(arguments),l=(me.get(this,"events")||{})[e.type]||[],c=oe.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(a=oe.event.handlers.call(this,e,l),n=0;(o=a[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((oe.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,r,o,s,a=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(r=[],i=0;u>i;i++)s=n[i],o=s.selector+" ",r[o]===t&&(r[o]=s.needsContext?oe(o,this).index(l)>=0:oe.find(o,this,null,[l]).length),r[o]&&r.push(s);r.length&&a.push({elem:l,handlers:r})}return u<n.length&&a.push({elem:this,handlers:n.slice(u)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,r,o,s=n.button;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||G,r=i.documentElement,o=i.body,e.pageX=n.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[oe.expando])return e;var t,n,i,r=e.type,o=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=Te.test(r)?this.mouseHooks:Se.test(r)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,e=new oe.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return 3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&oe.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return oe.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=oe.extend(new oe.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?oe.event.trigger(r,null,t):oe.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},oe.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},oe.Event=function(e,t){return this instanceof oe.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?s:a):this.type=e,t&&oe.extend(this,t),this.timeStamp=e&&e.timeStamp||oe.now(),void(this[oe.expando]=!0)):new oe.Event(e,t)},oe.Event.prototype={isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=s,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=s,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){oe.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!oe.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),oe.support.focusinBubbles||oe.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){oe.event.simulate(t,e.target,oe.event.fix(e),!0)};oe.event.special[t]={setup:function(){0===n++&&G.addEventListener(e,i,!0)},teardown:function(){0===--n&&G.removeEventListener(e,i,!0)}}}),oe.fn.extend({on:function(e,n,i,r,o){var s,u;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(u in e)this.on(u,n,i,e[u],o);return this}if(null==i&&null==r?(r=n,i=n=t):null==r&&("string"==typeof n?(r=i,i=t):(r=i,i=n,n=t)),r===!1)r=a;else if(!r)return this;return 1===o&&(s=r,r=function(e){return oe().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=oe.guid++)),this.each(function(){oe.event.add(this,e,r,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,oe(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=a),this.each(function(){oe.event.remove(this,e,i,n)})},trigger:function(e,t){return this.each(function(){oe.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?oe.event.trigger(e,t,n,!0):void 0}});var Ne=/^.[^:#\[\.,]*$/,Ve=oe.expr.match.needsContext,De={children:!0,contents:!0,next:!0,prev:!0};oe.fn.extend({find:function(e){var t,n,i,r=this.length;if("string"!=typeof e)return t=this,this.pushStack(oe(e).filter(function(){for(i=0;r>i;i++)if(oe.contains(t[i],this))return!0}));for(n=[],i=0;r>i;i++)oe.find(e,this[i],n);return n=this.pushStack(r>1?oe.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t=oe(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(oe.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(c(this,e||[],!0))},filter:function(e){return this.pushStack(c(this,e||[],!1))},is:function(e){return!!e&&("string"==typeof e?Ve.test(e)?oe(e,this.context).index(this[0])>=0:oe.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,i=0,r=this.length,o=[],s=Ve.test(e)||"string"!=typeof e?oe(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&oe.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?oe.unique(o):o)},index:function(e){return e?"string"==typeof e?te.call(oe(e),this[0]):te.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?oe(e,t):oe.makeArray(e&&e.nodeType?[e]:e),i=oe.merge(this.get(),n);return this.pushStack(oe.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),oe.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return oe.dir(e,"parentNode")},parentsUntil:function(e,t,n){return oe.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return oe.dir(e,"nextSibling")},prevAll:function(e){return oe.dir(e,"previousSibling")},nextUntil:function(e,t,n){return oe.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return oe.dir(e,"previousSibling",n)},siblings:function(e){return oe.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return oe.sibling(e.firstChild)},contents:function(e){return oe.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:oe.merge([],e.childNodes)}},function(e,t){oe.fn[e]=function(n,i){var r=oe.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=oe.filter(i,r)),this.length>1&&(De[e]||oe.unique(r),"p"===e[0]&&r.reverse()),this.pushStack(r)}}),oe.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?oe.find.matchesSelector(i,e)?[i]:[]:oe.find.matches(e,oe.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,i){for(var r=[],o=i!==t;(e=e[n])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&oe(e).is(i))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Be=/<([\w:]+)/,Ee=/<|&#?\w+;/,Ie=/<(?:script|style|link)/i,Ae=/^(?:checkbox|radio)$/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Le=/^$|\/(?:java|ecma)script/i,Re=/^true\/(.*)/,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.col=je.thead,je.th=je.td,oe.fn.extend({text:function(e){return oe.access(this,function(e){return e===t?oe.text(this):this.empty().append((this[0]&&this[0].ownerDocument||G).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?oe.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||oe.cleanData(m(n)),n.parentNode&&(t&&oe.contains(n.ownerDocument,n)&&f(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(oe.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return oe.clone(this,e,t)})},html:function(e){return oe.access(this,function(e){var n=this[0]||{},i=0,r=this.length;if(e===t&&1===n.nodeType)return n.innerHTML;if("string"==typeof e&&!Ie.test(e)&&!je[(Be.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Me,"<$1></$2>");try{for(;r>i;i++)n=this[i]||{},1===n.nodeType&&(oe.cleanData(m(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=oe.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var i=e[t++],r=e[t++];r&&(oe(this).remove(),r.insertBefore(n,i))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=Q.apply([],e);var i,r,o,s,a,u,l=0,c=this.length,h=this,f=c-1,g=e[0],y=oe.isFunction(g);if(y||!(1>=c||"string"!=typeof g||oe.support.checkClone)&&Pe.test(g))return this.each(function(i){var r=h.eq(i);y&&(e[0]=g.call(this,i,r.html())),r.domManip(e,t,n)});if(c&&(i=oe.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=i.firstChild,1===i.childNodes.length&&(i=r),r)){for(o=oe.map(m(i,"script"),d),s=o.length;c>l;l++)a=i,l!==f&&(a=oe.clone(a,!0,!0),s&&oe.merge(o,m(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,oe.map(o,p),l=0;s>l;l++)a=o[l],Le.test(a.type||"")&&!me.access(a,"globalEval")&&oe.contains(u,a)&&(a.src?oe._evalUrl(a.src):oe.globalEval(a.textContent.replace(ke,"")))}return this}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){oe.fn[e]=function(e){for(var n,i=[],r=oe(e),o=r.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),oe(r[s])[t](n),J.apply(i,n.get());return this.pushStack(i)}}),oe.extend({clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),u=oe.contains(e.ownerDocument,e);if(!(oe.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||oe.isXMLDoc(e)))for(s=m(a),o=m(e),i=0,r=o.length;r>i;i++)y(o[i],s[i]);if(t)if(n)for(o=o||m(e),s=s||m(a),i=0,r=o.length;r>i;i++)g(o[i],s[i]);else g(e,a);return s=m(a,"script"),s.length>0&&f(s,!u&&m(e,"script")),a},buildFragment:function(e,t,n,i){for(var r,o,s,a,u,l,c=0,h=e.length,d=t.createDocumentFragment(),p=[];h>c;c++)if(r=e[c],r||0===r)if("object"===oe.type(r))oe.merge(p,r.nodeType?[r]:r);else if(Ee.test(r)){for(o=o||d.appendChild(t.createElement("div")),s=(Be.exec(r)||["",""])[1].toLowerCase(),a=je[s]||je._default,o.innerHTML=a[1]+r.replace(Me,"<$1></$2>")+a[2],l=a[0];l--;)o=o.firstChild;oe.merge(p,o.childNodes),o=d.firstChild,o.textContent=""}else p.push(t.createTextNode(r));for(d.textContent="",c=0;r=p[c++];)if((!i||-1===oe.inArray(r,i))&&(u=oe.contains(r.ownerDocument,r),o=m(d.appendChild(r),"script"),u&&f(o),n))for(l=0;r=o[l++];)Le.test(r.type||"")&&n.push(r);return d},cleanData:function(e){for(var t,n,i,r=e.length,o=0,s=oe.event.special;r>o;o++){if(n=e[o],oe.acceptData(n)&&(t=me.access(n)))for(i in t.events)s[i]?oe.event.remove(n,i):oe.removeEvent(n,i,t.handle);ge.discard(n),me.discard(n)}},_evalUrl:function(e){return oe.ajax({url:e,type:"GET",dataType:"text",async:!1,global:!1,success:oe.globalEval})}}),oe.fn.extend({wrapAll:function(e){var t;return oe.isFunction(e)?this.each(function(t){oe(this).wrapAll(e.call(this,t))}):(this[0]&&(t=oe(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return oe.isFunction(e)?this.each(function(t){oe(this).wrapInner(e.call(this,t))}):this.each(function(){var t=oe(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=oe.isFunction(e);return this.each(function(n){oe(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}});var ze,Xe,Ue=/^(none|table(?!-c[ea]).+)/,qe=/^margin/,Ge=new RegExp("^("+se+")(.*)$","i"),He=new RegExp("^("+se+")(?!px)[a-z%]+$","i"),We=new RegExp("^([+-])=("+se+")","i"),Ye={BODY:"block"},$e={position:"absolute",visibility:"hidden",display:"block"},Ke={letterSpacing:0,fontWeight:400},Ze=["Top","Right","Bottom","Left"],Qe=["Webkit","O","Moz","ms"];oe.fn.extend({css:function(e,n){return oe.access(this,function(e,n,i){var r,o,s={},a=0;if(oe.isArray(n)){for(r=v(e),o=n.length;o>a;a++)s[n[a]]=oe.css(e,n[a],!1,r);return s}return i!==t?oe.style(e,n,i):oe.css(e,n)},e,n,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:w(this))?oe(this).show():oe(this).hide()})}}),oe.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,n,i,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,s,a,u=oe.camelCase(n),l=e.style;return n=oe.cssProps[u]||(oe.cssProps[u]=b(l,u)),a=oe.cssHooks[n]||oe.cssHooks[u],i===t?a&&"get"in a&&(o=a.get(e,!1,r))!==t?o:l[n]:(s=typeof i,"string"===s&&(o=We.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(oe.css(e,n)),s="number"),null==i||"number"===s&&isNaN(i)||("number"!==s||oe.cssNumber[u]||(i+="px"),oe.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(l[n]="inherit"),a&&"set"in a&&(i=a.set(e,i,r))===t||(l[n]=i)),void 0)}},css:function(e,n,i,r){var o,s,a,u=oe.camelCase(n);return n=oe.cssProps[u]||(oe.cssProps[u]=b(e.style,u)),a=oe.cssHooks[n]||oe.cssHooks[u],a&&"get"in a&&(o=a.get(e,!0,i)),o===t&&(o=ze(e,n,r)),"normal"===o&&n in Ke&&(o=Ke[n]),""===i||i?(s=parseFloat(o),i===!0||oe.isNumeric(s)?s||0:o):o}}),ze=function(e,n,i){var r,o,s,a=i||v(e),u=a?a.getPropertyValue(n)||a[n]:t,l=e.style;return a&&(""!==u||oe.contains(e.ownerDocument,e)||(u=oe.style(e,n)),He.test(u)&&qe.test(n)&&(r=l.width,o=l.minWidth,s=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=a.width,l.width=r,l.minWidth=o,l.maxWidth=s)),u},oe.each(["height","width"],function(e,t){oe.cssHooks[t]={get:function(e,n,i){return n?0===e.offsetWidth&&Ue.test(oe.css(e,"display"))?oe.swap(e,$e,function(){return S(e,t,i)}):S(e,t,i):void 0},set:function(e,n,i){var r=i&&v(e);return _(e,n,i?C(e,t,i,oe.support.boxSizing&&"border-box"===oe.css(e,"boxSizing",!1,r),r):0)}}}),oe(function(){oe.support.reliableMarginRight||(oe.cssHooks.marginRight={get:function(e,t){return t?oe.swap(e,{display:"inline-block"},ze,[e,"marginRight"]):void 0}}),!oe.support.pixelPosition&&oe.fn.position&&oe.each(["top","left"],function(e,t){oe.cssHooks[t]={get:function(e,n){return n?(n=ze(e,t),He.test(n)?oe(e).position()[t]+"px":n):void 0}}})}),oe.expr&&oe.expr.filters&&(oe.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},oe.expr.filters.visible=function(e){return!oe.expr.filters.hidden(e)}),oe.each({margin:"",padding:"",border:"Width"},function(e,t){oe.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+Ze[i]+t]=o[i]||o[i-2]||o[0];return r}},qe.test(e)||(oe.cssHooks[e+t].set=_)});var Je=/%20/g,et=/\[\]$/,tt=/\r?\n/g,nt=/^(?:submit|button|image|reset|file)$/i,it=/^(?:input|select|textarea|keygen)/i;oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=oe.prop(this,"elements");return e?oe.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!oe(this).is(":disabled")&&it.test(this.nodeName)&&!nt.test(e)&&(this.checked||!Ae.test(e))}).map(function(e,t){var n=oe(this).val();return null==n?null:oe.isArray(n)?oe.map(n,function(e){return{name:t.name,value:e.replace(tt,"\r\n")}}):{name:t.name,value:n.replace(tt,"\r\n")}}).get()}}),oe.param=function(e,n){var i,r=[],o=function(e,t){t=oe.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(e)||e.jquery&&!oe.isPlainObject(e))oe.each(e,function(){o(this.name,this.value)});else for(i in e)O(i,e[i],n,o);return r.join("&").replace(Je,"+")},oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){oe.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),oe.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var rt,ot,st=oe.now(),at=/\?/,ut=/#.*$/,lt=/([?&])_=[^&]*/,ct=/^(.*?):[ \t]*([^\r\n]*)$/gm,ht=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,dt=/^(?:GET|HEAD)$/,pt=/^\/\//,ft=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,gt=oe.fn.load,mt={},yt={},bt="*/".concat("*");try{ot=q.href}catch(wt){ot=G.createElement("a"),ot.href="",ot=ot.href}rt=ft.exec(ot.toLowerCase())||[],oe.fn.load=function(e,n,i){if("string"!=typeof e&&gt)return gt.apply(this,arguments);var r,o,s,a=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),oe.isFunction(n)?(i=n,n=t):n&&"object"==typeof n&&(o="POST"),a.length>0&&oe.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,a.html(r?oe("<div>").append(oe.parseHTML(e)).find(r):e)}).complete(i&&function(e,t){a.each(i,s||[e.responseText,t,e])}),this},oe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){oe.fn[t]=function(e){return this.on(t,e)}}),oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ot,type:"GET",isLocal:ht.test(rt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":bt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?D(D(e,oe.ajaxSettings),t):D(oe.ajaxSettings,e)},ajaxPrefilter:N(mt),ajaxTransport:N(yt),ajax:function(e,n){function i(e,n,i,a){var l,h,b,w,x,C=n;2!==v&&(v=2,u&&clearTimeout(u),r=t,s=a||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(w=M(d,_,i)),w=B(d,w,_,l),l?(d.ifModified&&(x=_.getResponseHeader("Last-Modified"),x&&(oe.lastModified[o]=x),x=_.getResponseHeader("etag"),x&&(oe.etag[o]=x)),204===e?C="nocontent":304===e?C="notmodified":(C=w.state,h=w.data,b=w.error,l=!b)):(b=C,(e||!C)&&(C="error",0>e&&(e=0))),_.status=e,_.statusText=(n||C)+"",l?g.resolveWith(p,[h,C,_]):g.rejectWith(p,[_,C,b]),_.statusCode(y),y=t,c&&f.trigger(l?"ajaxSuccess":"ajaxError",[_,d,l?h:b]),m.fireWith(p,[_,C]),c&&(f.trigger("ajaxComplete",[_,d]),--oe.active||oe.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,o,s,a,u,l,c,h,d=oe.ajaxSetup({},n),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?oe(p):oe.event,g=oe.Deferred(),m=oe.Callbacks("once memory"),y=d.statusCode||{},b={},w={},v=0,x="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!a)for(a={};t=ct.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=w[n]=w[n]||e,b[e]=t),this},overrideMimeType:function(e){return v||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)y[t]=[y[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||x;return r&&r.abort(t),i(0,t),this}};if(g.promise(_).complete=m.add,_.success=_.done,_.error=_.fail,d.url=((e||d.url||ot)+"").replace(ut,"").replace(pt,rt[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=oe.trim(d.dataType||"*").toLowerCase().match(ae)||[""],null==d.crossDomain&&(l=ft.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===rt[1]&&l[2]===rt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(rt[3]||("http:"===rt[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=oe.param(d.data,d.traditional)),V(mt,d,n,_),2===v)return _;c=d.global,c&&0===oe.active++&&oe.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!dt.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(at.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=lt.test(o)?o.replace(lt,"$1_="+st++):o+(at.test(o)?"&":"?")+"_="+st++)),d.ifModified&&(oe.lastModified[o]&&_.setRequestHeader("If-Modified-Since",oe.lastModified[o]),oe.etag[o]&&_.setRequestHeader("If-None-Match",oe.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&_.setRequestHeader("Content-Type",d.contentType),_.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+bt+"; q=0.01":""):d.accepts["*"]);for(h in d.headers)_.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(d.beforeSend.call(p,_,d)===!1||2===v))return _.abort();x="abort";for(h in{success:1,error:1,complete:1})_[h](d[h]);if(r=V(yt,d,n,_)){_.readyState=1,c&&f.trigger("ajaxSend",[_,d]),d.async&&d.timeout>0&&(u=setTimeout(function(){_.abort("timeout")},d.timeout));try{v=1,r.send(b,i)}catch(C){if(!(2>v))throw C;i(-1,C)}}else i(-1,"No Transport");return _},getJSON:function(e,t,n){return oe.get(e,t,n,"json")},getScript:function(e,n){return oe.get(e,t,n,"script")}}),oe.each(["get","post"],function(e,n){oe[n]=function(e,i,r,o){return oe.isFunction(i)&&(o=o||r,r=i,i=t),oe.ajax({url:e,type:n,dataType:o,data:i,success:r})}}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return oe.globalEval(e),e}}}),oe.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),oe.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,r){t=oe("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),G.head.appendChild(t[0])},abort:function(){n&&n()}}}});var vt=[],xt=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=vt.pop()||oe.expando+"_"+st++;return this[e]=!0,e}}),oe.ajaxPrefilter("json jsonp",function(n,i,r){var o,s,a,u=n.jsonp!==!1&&(xt.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&xt.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=oe.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(xt,"$1"+o):n.jsonp!==!1&&(n.url+=(at.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return a||oe.error(o+" was not called"),a[0]},n.dataTypes[0]="json",s=e[o],e[o]=function(){a=arguments},r.always(function(){e[o]=s,n[o]&&(n.jsonpCallback=i.jsonpCallback,vt.push(o)),a&&oe.isFunction(s)&&s(a[0]),a=s=t}),"script"):void 0}),oe.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var _t=oe.ajaxSettings.xhr(),Ct={0:200,1223:204},St=0,Tt={};e.ActiveXObject&&oe(e).on("unload",function(){for(var e in Tt)Tt[e]();Tt=t}),oe.support.cors=!!_t&&"withCredentials"in _t,oe.support.ajax=_t=!!_t,oe.ajaxTransport(function(e){var n;return oe.support.cors||_t&&!e.crossDomain?{send:function(i,r){var o,s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)a.setRequestHeader(o,i[o]);n=function(e){return function(){n&&(delete Tt[s],n=a.onload=a.onerror=null,"abort"===e?a.abort():"error"===e?r(a.status||404,a.statusText):r(Ct[a.status]||a.status,a.statusText,"string"==typeof a.responseText?{text:a.responseText}:t,a.getAllResponseHeaders()))}},a.onload=n(),a.onerror=n("error"),n=Tt[s=St++]=n("abort"),a.send(e.hasContent&&e.data||null)},abort:function(){n&&n()}}:void 0});var Ft,Ot,Nt=/^(?:toggle|show|hide)$/,Vt=new RegExp("^(?:([+-])=|)("+se+")([a-z%]*)$","i"),Dt=/queueHooks$/,Mt=[L],Bt={"*":[function(e,t){var n,i,r=this.createTween(e,t),o=Vt.exec(t),s=r.cur(),a=+s||0,u=1,l=20;if(o){if(n=+o[2],i=o[3]||(oe.cssNumber[e]?"":"px"),"px"!==i&&a){a=oe.css(r.elem,e,!0)||n||1;do u=u||".5",a/=u,oe.style(r.elem,e,a+i);while(u!==(u=r.cur()/s)&&1!==u&&--l)}r.unit=i,r.start=a,r.end=o[1]?a+(o[1]+1)*n:n}return r}]};oe.Animation=oe.extend(A,{tweener:function(e,t){oe.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;r>i;i++)n=e[i],Bt[n]=Bt[n]||[],Bt[n].unshift(t)},prefilter:function(e,t){t?Mt.unshift(e):Mt.push(e)}}),oe.Tween=R,R.prototype={constructor:R,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(oe.cssNumber[n]?"":"px")},cur:function(){var e=R.propHooks[this.prop];return e&&e.get?e.get(this):R.propHooks._default.get(this)},run:function(e){var t,n=R.propHooks[this.prop];return this.options.duration?this.pos=t=oe.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):R.propHooks._default.set(this),this}},R.prototype.init.prototype=R.prototype,R.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=oe.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){oe.fx.step[e.prop]?oe.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[oe.cssProps[e.prop]]||oe.cssHooks[e.prop])?oe.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},oe.each(["toggle","show","hide"],function(e,t){var n=oe.fn[t];oe.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(k(t,!0),e,i,r)}}),oe.fn.extend({fadeTo:function(e,t,n,i){return this.filter(w).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=oe.isEmptyObject(e),o=oe.speed(t,n,i),s=function(){var t=A(this,oe.extend({},e),o);s.finish=function(){t.stop(!0)},(r||me.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,n,i){var r=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=oe.timers,s=me.get(this);if(n)s[n]&&s[n].stop&&r(s[n]);else for(n in s)s[n]&&s[n].stop&&Dt.test(n)&&r(s[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(i),t=!1,o.splice(n,1));(t||!i)&&oe.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=me.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=oe.timers,s=i?i.length:0;for(n.finish=!0,oe.queue(this,e,[]),r&&r.cur&&r.cur.finish&&r.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),
o.splice(t,1));for(t=0;s>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),oe.each({slideDown:k("show"),slideUp:k("hide"),slideToggle:k("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){oe.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),oe.speed=function(e,t,n){var i=e&&"object"==typeof e?oe.extend({},e):{complete:n||!n&&t||oe.isFunction(e)&&e,duration:e,easing:n&&t||t&&!oe.isFunction(t)&&t};return i.duration=oe.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in oe.fx.speeds?oe.fx.speeds[i.duration]:oe.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){oe.isFunction(i.old)&&i.old.call(this),i.queue&&oe.dequeue(this,i.queue)},i},oe.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},oe.timers=[],oe.fx=R.prototype.init,oe.fx.tick=function(){var e,n=oe.timers,i=0;for(Ft=oe.now();i<n.length;i++)e=n[i],e()||n[i]!==e||n.splice(i--,1);n.length||oe.fx.stop(),Ft=t},oe.fx.timer=function(e){e()&&oe.timers.push(e)&&oe.fx.start()},oe.fx.interval=13,oe.fx.start=function(){Ot||(Ot=setInterval(oe.fx.tick,oe.fx.interval))},oe.fx.stop=function(){clearInterval(Ot),Ot=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fx.step={},oe.expr&&oe.expr.filters&&(oe.expr.filters.animated=function(e){return oe.grep(oe.timers,function(t){return e===t.elem}).length}),oe.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){oe.offset.setOffset(this,e,t)});var n,i,r=this[0],o={top:0,left:0},s=r&&r.ownerDocument;if(s)return n=s.documentElement,oe.contains(n,r)?(typeof r.getBoundingClientRect!==U&&(o=r.getBoundingClientRect()),i=j(s),{top:o.top+i.pageYOffset-n.clientTop,left:o.left+i.pageXOffset-n.clientLeft}):o},oe.offset={setOffset:function(e,t,n){var i,r,o,s,a,u,l,c=oe.css(e,"position"),h=oe(e),d={};"static"===c&&(e.style.position="relative"),a=h.offset(),o=oe.css(e,"top"),u=oe.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(i=h.position(),s=i.top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(u)||0),oe.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},oe.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===oe.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),oe.nodeName(e[0],"html")||(i=e.offset()),i.top+=oe.css(e[0],"borderTopWidth",!0),i.left+=oe.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-oe.css(n,"marginTop",!0),left:t.left-i.left-oe.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||H;e&&!oe.nodeName(e,"html")&&"static"===oe.css(e,"position");)e=e.offsetParent;return e||H})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,i){var r="pageYOffset"===i;oe.fn[n]=function(o){return oe.access(this,function(n,o,s){var a=j(n);return s===t?a?a[i]:n[o]:void(a?a.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):n[o]=s)},n,o,arguments.length,null)}}),oe.each({Height:"height",Width:"width"},function(e,n){oe.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,r){oe.fn[r]=function(r,o){var s=arguments.length&&(i||"boolean"!=typeof r),a=i||(r===!0||o===!0?"margin":"border");return oe.access(this,function(n,i,r){var o;return oe.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):r===t?oe.css(n,i,a):oe.style(n,i,r,a)},n,s?r:t,s,null)}})}),oe.fn.size=function(){return this.length},oe.fn.andSelf=oe.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=oe:"function"==typeof define&&define.amd&&define("jquery",[],function(){return oe}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=oe)}(window),define("jquery/dist/jquery",function(){}),define("cobweb/Error",["jquery"],function(e){function t(n,i){e(function(){var r=e("X3D");r.each(function(){t.fallback(e(this))});for(var o=0;o<i.length;++o){var s=i[o];"function"==typeof s&&s(r,n)}})}function n(e){e.children().addClass("cobweb-fallback")}return t.fallback=n,t}),define("cobweb/Basic/X3DFieldDefinition",[],function(){function e(e,t,n,i){this.accessType=e,this.dataType=n.getType(),this.name=t,this.value=n,this.userDefined=i}return e.prototype.constructor=e,e}),define("cobweb/Basic/FieldDefinitionArray",["jquery"],function(e){function t(e){return this.array=e,new Proxy(this,n)}var n={get:function(e,t){return t in e?e[t]:e.array[t]},set:function(e,t,n){return!1}};return e.extend(t.prototype,{constructor:t,getValue:function(){return this.array}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.array.length},enumerable:!1,configurable:!1}),t}),define("cobweb/Base/X3DObject",[],function(){function e(){return this.id_}function t(){}var n=0;return t.prototype={constructor:t,id_:0,name_:"",tainted_:!1,interests_:{},getId:function(){return this.getId=e,this.id_=++n},setName:function(e){this.name_=e},getName:function(){return this.name_},setTainted:function(e){this.tainted_=e},getTainted:function(){return this.tainted_},addInterest:function(e,t){this.hasOwnProperty("interests_")||(this.interests_={});var n=Array.prototype.slice.call(arguments,0);n[1]=this,this.interests_[e.getId()+t]=Function.prototype.bind.apply(e[t],n)},removeInterest:function(e,t){delete this.interests_[e.getId()+t]},getInterests:function(){return this.interests_},processInterests:function(){var e=this.interests_;for(var t in e)e[t]()}},t}),define("cobweb/Base/X3DChildObject",["jquery","cobweb/Base/X3DObject"],function(e,t){function n(){t.call(this),this.parents_={}}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n,addParent:function(e){this.parents_[e.getId()]=e},removeParent:function(e){delete this.parents_[e.getId()]},getParents:function(){return this.parents_}}),n}),define("cobweb/Bits/X3DConstants",[],function(){var e=0,t=0,n=0,i={NOT_STARTED_STATE:e++,IN_PROGRESS_STATE:e++,COMPLETE_STATE:e++,FAILED_STATE:e++,initializeOnly:parseInt("001",2),inputOnly:parseInt("010",2),outputOnly:parseInt("100",2),inputOutput:parseInt("111",2),SFBool:t++,SFColor:t++,SFColorRGBA:t++,SFDouble:t++,SFFloat:t++,SFImage:t++,SFInt32:t++,SFMatrix3d:t++,SFMatrix3f:t++,SFMatrix4d:t++,SFMatrix4f:t++,SFNode:t++,SFRotation:t++,SFString:t++,SFTime:t++,SFVec2d:t++,SFVec2f:t++,SFVec3d:t++,SFVec3f:t++,SFVec4d:t++,SFVec4f:t++,VrmlMatrix:t++,MFBool:t++,MFColor:t++,MFColorRGBA:t++,MFDouble:t++,MFFloat:t++,MFImage:t++,MFInt32:t++,MFMatrix3d:t++,MFMatrix3f:t++,MFMatrix4d:t++,MFMatrix4f:t++,MFNode:t++,MFRotation:t++,MFString:t++,MFTime:t++,MFVec2d:t++,MFVec2f:t++,MFVec3d:t++,MFVec3f:t++,MFVec4d:t++,MFVec4f:t++,Anchor:n++,Appearance:n++,Arc2D:n++,ArcClose2D:n++,AudioClip:n++,Background:n++,BallJoint:n++,Billboard:n++,BooleanFilter:n++,BooleanSequencer:n++,BooleanToggle:n++,BooleanTrigger:n++,BoundedPhysicsModel:n++,Box:n++,CADAssembly:n++,CADFace:n++,CADLayer:n++,CADPart:n++,Circle2D:n++,ClipPlane:n++,CollidableOffset:n++,CollidableShape:n++,Collision:n++,CollisionCollection:n++,CollisionSensor:n++,CollisionSpace:n++,Color:n++,ColorChaser:n++,ColorDamper:n++,ColorInterpolator:n++,ColorRGBA:n++,ComposedCubeMapTexture:n++,ComposedShader:n++,ComposedTexture3D:n++,Cone:n++,ConeEmitter:n++,Contact:n++,Contour2D:n++,ContourPolyline2D:n++,Coordinate:n++,CoordinateChaser:n++,CoordinateDamper:n++,CoordinateDouble:n++,CoordinateInterpolator:n++,CoordinateInterpolator2D:n++,Cylinder:n++,CylinderSensor:n++,DISEntityManager:n++,DISEntityTypeMapping:n++,DirectionalLight:n++,Disk2D:n++,DoubleAxisHingeJoint:n++,EaseInEaseOut:n++,ElevationGrid:n++,EspduTransform:n++,ExplosionEmitter:n++,Extrusion:n++,FillProperties:n++,FloatVertexAttribute:n++,Fog:n++,FogCoordinate:n++,FontStyle:n++,ForcePhysicsModel:n++,GeneratedCubeMapTexture:n++,GeoCoordinate:n++,GeoElevationGrid:n++,GeoLOD:n++,GeoLocation:n++,GeoMetadata:n++,GeoOrigin:n++,GeoPositionInterpolator:n++,GeoProximitySensor:n++,GeoTouchSensor:n++,GeoTransform:n++,GeoViewpoint:n++,Group:n++,HAnimDisplacer:n++,HAnimHumanoid:n++,HAnimJoint:n++,HAnimSegment:n++,HAnimSite:n++,ImageCubeMapTexture:n++,ImageTexture:n++,ImageTexture3D:n++,IndexedFaceSet:n++,IndexedLineSet:n++,IndexedQuadSet:n++,IndexedTriangleFanSet:n++,IndexedTriangleSet:n++,IndexedTriangleStripSet:n++,Inline:n++,IntegerSequencer:n++,IntegerTrigger:n++,KeySensor:n++,LOD:n++,Layer:n++,LayerSet:n++,Layout:n++,LayoutGroup:n++,LayoutLayer:n++,LinePickSensor:n++,LineProperties:n++,LineSet:n++,LoadSensor:n++,LocalFog:n++,Material:n++,Matrix3VertexAttribute:n++,Matrix4VertexAttribute:n++,MetadataBoolean:n++,MetadataDouble:n++,MetadataFloat:n++,MetadataInteger:n++,MetadataSet:n++,MetadataString:n++,MotorJoint:n++,MovieTexture:n++,MultiTexture:n++,MultiTextureCoordinate:n++,MultiTextureTransform:n++,NavigationInfo:n++,Normal:n++,NormalInterpolator:n++,NurbsCurve:n++,NurbsCurve2D:n++,NurbsOrientationInterpolator:n++,NurbsPatchSurface:n++,NurbsPositionInterpolator:n++,NurbsSet:n++,NurbsSurfaceInterpolator:n++,NurbsSweptSurface:n++,NurbsSwungSurface:n++,NurbsTextureCoordinate:n++,NurbsTrimmedSurface:n++,OrientationChaser:n++,OrientationDamper:n++,OrientationInterpolator:n++,OrthoViewpoint:n++,PackagedShader:n++,ParticleSystem:n++,PickableGroup:n++,PixelTexture:n++,PixelTexture3D:n++,PlaneSensor:n++,PointEmitter:n++,PointLight:n++,PointPickSensor:n++,PointSet:n++,Polyline2D:n++,PolylineEmitter:n++,Polypoint2D:n++,PositionChaser:n++,PositionChaser2D:n++,PositionDamper:n++,PositionDamper2D:n++,PositionInterpolator:n++,PositionInterpolator2D:n++,PrimitivePickSensor:n++,ProgramShader:n++,ProximitySensor:n++,QuadSet:n++,ReceiverPdu:n++,Rectangle2D:n++,RigidBody:n++,RigidBodyCollection:n++,ScalarChaser:n++,ScalarDamper:n++,ScalarInterpolator:n++,ScreenFontStyle:n++,ScreenGroup:n++,Script:n++,ShaderPart:n++,ShaderProgram:n++,Shape:n++,SignalPdu:n++,SingleAxisHingeJoint:n++,SliderJoint:n++,Sound:n++,Sphere:n++,SphereSensor:n++,SplinePositionInterpolator:n++,SplinePositionInterpolator2D:n++,SplineScalarInterpolator:n++,SpotLight:n++,SquadOrientationInterpolator:n++,StaticGroup:n++,StringSensor:n++,SurfaceEmitter:n++,Switch:n++,TexCoordChaser2D:n++,TexCoordDamper2D:n++,Text:n++,TextureBackground:n++,TextureCoordinate:n++,TextureCoordinate3D:n++,TextureCoordinate4D:n++,TextureCoordinateGenerator:n++,TextureProperties:n++,TextureTransform:n++,TextureTransform3D:n++,TextureTransformMatrix3D:n++,TimeSensor:n++,TimeTrigger:n++,TouchGroup:n++,TouchSensor:n++,Transform:n++,TransformSensor:n++,TransmitterPdu:n++,TriangleFanSet:n++,TriangleSet:n++,TriangleSet2D:n++,TriangleStripSet:n++,TwoSidedMaterial:n++,UniversalJoint:n++,Viewpoint:n++,ViewpointGroup:n++,Viewport:n++,VisibilitySensor:n++,VolumeEmitter:n++,VolumePickSensor:n++,WindPhysicsModel:n++,WorldInfo:n++,X3DBaseNode:n++,X3DAppearanceChildNode:n++,X3DAppearanceNode:n++,X3DBackgroundNode:n++,X3DBindableNode:n++,X3DBoundedObject:n++,X3DChaserNode:n++,X3DChildNode:n++,X3DColorNode:n++,X3DComposedGeometryNode:n++,X3DCoordinateNode:n++,X3DDamperNode:n++,X3DDragSensorNode:n++,X3DEnvironmentTextureNode:n++,X3DEnvironmentalSensorNode:n++,X3DFogObject:n++,X3DFollowerNode:n++,X3DFontStyleNode:n++,X3DGeometricPropertyNode:n++,X3DGeometryNode:n++,X3DGeospatialObject:n++,X3DGroupingNode:n++,X3DInfoNode:n++,X3DInterpolatorNode:n++,X3DKeyDeviceSensorNode:n++,X3DLayerNode:n++,X3DLayoutNode:n++,X3DLightNode:n++,X3DLineGeometryNode:n++,X3DMaterialNode:n++,X3DMetadataObject:n++,X3DNBodyCollidableNode:n++,X3DNBodyCollisionSpaceNode:n++,X3DNetworkSensorNode:n++,X3DNode:n++,X3DNormalNode:n++,X3DNurbsControlCurveNode:n++,X3DNurbsSurfaceGeometryNode:n++,X3DParametricGeometryNode:n++,X3DParticleEmitterNode:n++,X3DParticlePhysicsModelNode:n++,X3DPickSensorNode:n++,X3DPickableObject:n++,X3DPointingDeviceSensorNode:n++,X3DProductStructureChildNode:n++,X3DProgrammableShaderObject:n++,X3DPrototypeInstance:n++,X3DRigidJointNode:n++,X3DScriptNode:n++,X3DSensorNode:n++,X3DSequencerNode:n++,X3DShaderNode:n++,X3DShapeNode:n++,X3DSoundNode:n++,X3DSoundSourceNode:n++,X3DTexture2DNode:n++,X3DTexture3DNode:n++,X3DTextureCoordinateNode:n++,X3DTextureNode:n++,X3DTextureTransformNode:n++,X3DTimeDependentNode:n++,X3DTouchSensorNode:n++,X3DTransformMatrix4DNode:n++,X3DTransformNode:n++,X3DTriggerNode:n++,X3DUrlObject:n++,X3DVertexAttributeNode:n++,X3DViewpointNode:n++,X3DViewportNode:n++,X3DProtoDeclarationNode:n++,X3DProtoDeclaration:n++,X3DExternProtoDeclaration:n++};return Object.preventExtensions(i),Object.freeze(i),Object.seal(i),i}),define("cobweb/Base/Events",["jquery"],function(e){var t={stack:[],create:function(e){if(this.stack.length){var t=this.stack.pop();return t.field=e,t}return{field:e,sources:{}}},copy:function(t){if(this.stack.length){var n=this.stack.pop();return n.field=t.field,e.extend(n.sources,t.sources),n}return{field:t.field,sources:e.extend({},t.sources)}},push:function(e){var t=e.sources;for(var n in t)delete e.sources[n];this.stack.push(e)}};return t}),define("cobweb/Basic/X3DField",["jquery","cobweb/Base/X3DChildObject","cobweb/Bits/X3DConstants","cobweb/Base/Events"],function(e,t,n,i){function r(e){return t.call(this),this.value_=e,this}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,references_:{},fieldInterests_:{},fieldCallbacks_:{},accessType_:n.initializeOnly,set_:null,uniformLocation_:null,clone:function(){return this.copy()},equals:function(e){return this.getValue()==e.valueOf()},setValue:function(e){this.set(e instanceof this.constructor?e.getValue():e),this.addEvent()},set:function(e){this.value_=e},getValue:function(){return this.value_},setAccessType:function(e){this.accessType_=e},getAccessType:function(){return this.accessType_},isInitializable:function(){return this.getAccessType()&n.initializeOnly},isInput:function(){return this.getAccessType()&n.inputOnly},isOutput:function(){return this.getAccessType()&n.outputOnly},isReadable:function(){return this.getAccessType()!==n.inputOnly},isWritable:function(){return this.getAccessType()!==n.initializeOnly},setSet:function(e){return this.set_=e},getSet:function(){return this.set_},hasReferences:function(){return this.hasOwnProperty("references_")?!e.isEmptyObject(this.references_):!1},isReference:function(e){return e===this.getAccessType()||e===n.inputOutput},addReference:function(e){var t=this.getReferences();if(!t[e.getId()])switch(t[e.getId()]=e,this.getAccessType()&e.getAccessType()){case n.initializeOnly:return void this.set(e.getValue());case n.inputOnly:return void e.addFieldInterest(this);case n.outputOnly:return void this.addFieldInterest(e);case n.inputOutput:return e.addFieldInterest(this),this.addFieldInterest(e),void this.set(e.getValue())}},getReferences:function(){return this.hasOwnProperty("references_")||(this.references_={}),this.references_},updateReferences:function(){if(this.hasOwnProperty("references_"))for(var e in this.references_){var t=this.references_[e];switch(this.getAccessType()&t.getAccessType()){case n.inputOnly:case n.outputOnly:continue;case n.initializeOnly:case n.inputOutput:this.set(t.getValue());continue}}},addFieldInterest:function(e){this.hasOwnProperty("fieldInterests_")||(this.fieldInterests_={}),this.fieldInterests_[e.getId()]=e},removeFieldInterest:function(e){delete this.fieldInterests_[e.getId()]},addFieldCallback:function(e,t){this.hasOwnProperty("fieldCallbacks_")||(this.fieldCallbacks_={}),this.fieldCallbacks_[e]=t},removeFieldCallback:function(e){delete this.fieldCallbacks_[e]},addEvent:function(){var e=this.getParents();for(var t in e)e[t].addEvent(this)},addEventObject:function(e,t){var n=this.getParents();for(var i in n)n[i].addEventObject(this,t)},processEvent:function(e){if(!e.sources.hasOwnProperty(this.getId())){e.sources[this.getId()]=!0,this.setTainted(!1),this.setSet(!0),e.field!==this&&this.set(e.field.getValue()),this.processInterests();var t=this.fieldInterests_,n=!0;for(var r in t)n?(n=!1,t[r].addEventObject(this,e)):t[r].addEventObject(this,i.copy(e));n&&i.push(e);var o=this.fieldCallbacks_;for(var r in o)o[r](this.valueOf())}},valueOf:function(){return this}}),r}),define("cobweb/InputOutput/Generator",["jquery"],function(e){return{indent:"",indentChar:"  ",Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)}}}),define("cobweb/Basic/X3DArrayField",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants","cobweb/InputOutput/Generator"],function(e,t,n,i){function r(e){t.call(this,[]),e[0]instanceof Array&&(e=e[0]);for(var n=0,i=e.length;i>n;++n)this.push(e[n]);return new Proxy(this,o)}var o={get:function(e,t){try{if(t in e)return e[t];var n=e.getValue(),i=parseInt(t);return i>=n.length&&e.resize(i+1),n[i].valueOf()}catch(r){console.log(e,t,r)}},set:function(e,t,n){try{if(t in e)return e[t]=n,!0;var i=e.getValue(),r=parseInt(t);return r>=i.length&&e.resize(r+1),i[r].setValue(n),!0}catch(o){return console.log(e,t,o),!1}},has:function(e,t){return t in e.getValue()},enumerate:function(e){return Object.keys(e.getValue())[Symbol.iterator]()}};return r.prototype=e.extend(new t([]),{constructor:r,copy:function(){for(var e=new this.constructor,t=this.getValue(),n=0,i=t.length;i>n;++n)e.push(t[n]);return e},setValue:function(e){this.set(e instanceof r?e.getValue():e),this.addEvent()},set:function(e){this.resize(e.length,void 0,!0);for(var n=this.getValue(),i=0,r=e.length;r>i;++i)n[i].set(e[i]instanceof t?e[i].getValue():e[i])},unshift:function(e){var t=this.getValue(),n=new this.ValueType;return n.setValue(e),n.addParent(this),this.addEvent(),t.unshift(n)},shift:function(){var e=this.getValue();if(e.length){var t=e.shift();return t.removeParent(this),this.addEvent(),t.valueOf()}},push:function(e){var t=this.getValue(),n=new this.ValueType;return n.setValue(e),n.addParent(this),this.addEvent(),t.push(n)},pop:function(){var e=this.getValue();if(e.length){var t=e.pop();return t.removeParent(this),this.addEvent(),t.valueOf()}},insert:function(e,t,n,i){for(var r=[e,0],o=n;i>o;++o){var s=new this.ValueType;s.setValue(t[o]),s.addParent(this),r.push(s)}Array.prototype.splice.apply(this.getValue(),r),this.addEvent()},erase:function(e,t){for(var n=this.getValue().splice(e,t-e),i=0,r=n.length;r>i;++i)n[i].removeParent(this);this.addEvent()},resize:function(e,t,n){var i=this.getValue();if(e<i.length){for(var r=e,o=i.length;o>r;++r)i[r].removeParent(this);i.length=e,n||this.addEvent()}else if(e>i.length){for(var r=i.length;e>r;++r){var s=new this.ValueType;void 0!==t&&s.setValue(t),s.addParent(this),i.push(s)}n||this.addEvent()}},toString:function(){var e=this.getValue(),t="";switch(e.length){case 0:t+="[ ]";break;case 1:t+=e[0].toString();break;default:t+="[\n",i.IncIndent();for(var n=0,r=e.length-1;r>n;++n)t+=i.Indent(),t+=e[n].toString(),t+=",\n";t+=i.Indent(),t+=e[r].toString(),t+="\n",i.DecIndent(),t+=i.Indent(),t+="]"}return t}}),Object.defineProperty(r.prototype,"length",{get:function(){return this.getValue().length},set:function(e){this.resize(e)},enumerable:!1,configurable:!1}),r}),define("cobweb/Fields/SFBool",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,Boolean(e)):t.call(Object.create(i.prototype),Boolean(e))}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},set:function(e){t.prototype.set.call(this,Boolean(e))},valueOf:function(){return this.getValue()},getTypeName:function(){return"SFBool"},getType:function(){return n.SFBool},valueOf:t.prototype.getValue,toString:function(){return this.getValue()?"TRUE":"FALSE"}}),i}),define("standard/Math/Algorithm",[],function(){var e={signum:function(e){return(e>0)-(0>e)},radians:function(e){return e*(Math.PI/180)},degrees:function(e){return e*(180/Math.PI)},clamp:function(e,t,n){return t>e?t:e>n?n:e},interval:function(e,t,n){return e>=n?(e-t)%(n-t)+t:t>e?(e-n)%(n-t)+n:e},lerp:function(e,t,n){return e+n*(t-e)},slerp:function(e,t,n){var i=e.dot(t);if(-1>=i)throw new Error("slerp is not possible: vectors are inverse collinear.");if(i>=1)return e;0>i&&(i=-i,t.negate());var r=Math.acos(i),o=Math.sin(r),s=Math.sin((1-n)*r),a=Math.sin(n*r);return e.multiply(s).add(t.multiply(a)).divide(o)},isPowerOfTwo:function(e){return 0===(e-1&e)},nextPowerOfTwo:function(e){--e;for(var t=1;!(32&t);t<<=1)e|=e>>t;return++e},less:function(e,t){return t>e},greater:function(e,t){return e>t},lowerBound:function(e,t,n,i,r){for(var o=0,s=0,a=n-t;a>0;)s=a>>>1,o=t+s,r(e[o],i)?(t=++o,a-=s+1):a=s;return t},upperBound:function(e,t,n,i,r){for(var o=0,s=0,a=n-t;a>0;)s=a>>>1,o=t+s,r(i,e[o])?a=s:(t=++o,a-=s+1);return t},set_difference:function(e,t,n){for(var i in e)i in t||(n[i]=e[i]);return n}};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("standard/Math/Numbers/Color3",["jquery","standard/Math/Algorithm"],function(e,t){function n(e,t,n){arguments.length?(this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)):(this.r_=0,this.g_=0,this.b_=0)}var i=t.clamp;e.extend(n,{HSV:function(e,t,i){var r=new n;return r.setHSV(e,t,i),r}}),n.prototype={constructor:n,length:3,copy:function(){var e=Object.create(n.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_},set:function(e,t,n){this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)},equals:function(e){return this.r_===vector.r_&&this.g_===vector.g_&&this.b_===vector.b_},getHSV:function(e){var t,n,i,r=Math.min(this.r_,this.g_,this.b_),o=Math.max(this.r_,this.g_,this.b_);i=o;var s=o-r;return 0!==o&&0!==s?(n=s/o,t=this.r_===o?(this.g_-this.b_)/s:this.g_===o?2+(this.b_-this.r_)/s:4+(this.r_-this.g_)/s,t*=Math.PI/3,0>t&&(t+=2*Math.PI)):n=t=0,e[0]=t,e[1]=n,e[2]=i,e},setHSV:function(e,n,r){if(n=i(n,0,1),r=i(r,0,1),0===n)this.r_=this.g_=this.b_=r;else{var o=t.degrees(t.interval(e,0,2*Math.PI))/60,s=Math.floor(o),a=o-s,u=r*(1-n),l=r*(1-n*a),c=r*(1-n*(1-a));switch(s%6){case 0:this.r_=r,this.g_=c,this.b_=u;break;case 1:this.r_=l,this.g_=r,this.b_=u;break;case 2:this.r_=u,this.g_=r,this.b_=c;break;case 3:this.r_=u,this.g_=l,this.b_=r;break;case 4:this.r_=c,this.g_=u,this.b_=r;break;default:this.r_=r,this.g_=u,this.b_=l}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_}};var r={get:function(){return this.r_},set:function(e){this.r_=i(e,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.g_},set:function(e){this.g_=i(e,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(e){this.b_=i(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(n.prototype,"r",r),Object.defineProperty(n.prototype,"g",o),Object.defineProperty(n.prototype,"b",s),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,Object.defineProperty(n.prototype,"0",r),Object.defineProperty(n.prototype,"1",o),Object.defineProperty(n.prototype,"2",s),e.extend(n,{HSV:function(e,t,i){var r=new n(0,0,0);return r.setHSV(e,t,i),r},lerp:function(e,n,i,r){var o=Math.abs(n[0]-e[0]);if(o<=Math.PI)return r[0]=t.lerp(e[0],n[0],i),r[1]=t.lerp(e[1],n[1],i),r[2]=t.lerp(e[2],n[2],i),r;var s=2*Math.PI,a=(s-o)*i,u=e[0]<n[0]?e[0]-a:e[0]+a;return 0>u?u+=s:u>s&&(u-=s),r[0]=u,r[1]=t.lerp(e[1],n[1],i),r[2]=t.lerp(e[2],n[2],i),r}}),n}),define("cobweb/Fields/SFColor",["jquery","standard/Math/Numbers/Color3","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,i,o){return this instanceof r?arguments.length?arguments[0]instanceof t?n.call(this,arguments[0]):n.call(this,new t(+e,+i,+o)):n.call(this,new t):r.apply(Object.create(r.prototype),arguments)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return i.SFColor},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(e,t,n){this.getValue().setHSV(e,t,n),this.addEvent()},toString:function(){return this.getValue().toString()}}),Object.defineProperty(r.prototype,"r",{get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"0",{get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"g",{get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"b",{get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!1,configurable:!1}),r}),define("standard/Math/Numbers/Color4",["jquery","standard/Math/Algorithm"],function(e,t){function n(e,t,n,r){arguments.length?(this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1),this.a_=i(r,0,1)):(this.r_=0,this.g_=0,this.b_=0,this.a_=0)}var i=t.clamp;e.extend(n,{HSVA:function(e,t,n,i){var r=new Color3(0,0,0,i);return r.setHSV(e,t,n),r}}),n.prototype={constructor:n,length:4,copy:function(){var e=Object.create(n.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e.a_=this.a_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_,this.a_=e.a_},set:function(e,t,n,r){this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1),this.a_=i(r,0,1)},equals:function(e){return this.r_===e.r_&&this.g_===e.g_&&this.b_===e.b_&&this.a_===e.a_},getHSV:function(e){var t,n,i,r=Math.min(this.r_,this.g_,this.b_),o=Math.max(this.r_,this.g_,this.b_);i=o;var s=o-r;return 0!==o&&0!==s?(n=s/o,t=this.r===o?(this.g_-this.b_)/s:this.g_==o?2+(this.b_-this.r_)/s:4+(this.r_-this.g_)/s,t*=Math.PI/3,0>t&&(t+=2*Math.PI)):n=t=0,e[0]=t,e[1]=n,e[2]=i,e},setHSV:function(e,n,r){if(n=i(n,0,1),r=i(r,0,1),0===n)this.r_=this.g_=this.b_=r;else{var o=t.degrees(t.interval(e,0,2*Math.PI))/60,s=Math.floor(o),a=o-s,u=r*(1-n),l=r*(1-n*a),c=r*(1-n*(1-a));switch(s%6){case 0:this.r_=r,this.g_=c,this.b_=u;break;case 1:this.r_=l,this.g_=r,this.b_=u;break;case 2:this.r_=u,this.g_=r,this.b_=c;break;case 3:this.r_=u,this.g_=l,this.b_=r;break;case 4:this.r_=c,this.g_=u,this.b_=r;break;default:this.r_=r,this.g_=u,this.b_=l}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_+" "+this.a_}};var r={get:function(){return this.r_},set:function(e){this.r_=i(e,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.g_},set:function(e){this.g_=i(e,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(e){this.b_=i(e,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this.a_},set:function(e){this.a_=i(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(n.prototype,"r",r),Object.defineProperty(n.prototype,"g",o),Object.defineProperty(n.prototype,"b",s),Object.defineProperty(n.prototype,"a",a),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,Object.defineProperty(n.prototype,"0",r),Object.defineProperty(n.prototype,"1",o),Object.defineProperty(n.prototype,"2",s),Object.defineProperty(n.prototype,"3",a),n.HSVA=function(e,t,i,r){var o=new n(0,0,0,r);return o.setHSV(e,t,i),o},n}),define("cobweb/Fields/SFColorRGBA",["jquery","standard/Math/Numbers/Color4","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,i,o,s){return this instanceof r?arguments.length?arguments[0]instanceof t?n.call(this,arguments[0]):n.call(this,new t(+e,+i,+o,+s)):n.call(this,new t):r.apply(Object.create(r.prototype),arguments)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return i.SFColorRGBA},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(e,t,n){this.getValue().setHSV(e,t,n),this.addEvent()},toString:function(){return this.getValue().toString()}}),Object.defineProperty(r.prototype,"r",{get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"0",{get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"g",{get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"b",{get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"a",{get:function(){return this.getValue().a},set:function(e){this.getValue().a=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"3",{get:function(){return this.getValue().a},set:function(e){this.getValue().a=e,this.addEvent()},enumerable:!1,configurable:!1}),r}),define("cobweb/Fields/SFDouble",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,arguments.length?+e:0):t.call(Object.create(i.prototype),arguments.length?+e:0)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return n.SFDouble},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toString:function(){return String(this.getValue())}}),i}),define("cobweb/Fields/SFFloat",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,arguments.length?+e:0):t.call(Object.create(i.prototype),arguments.length?+e:0)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return n.SFFloat},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toString:function(){return String(this.getValue())}}),i}),define("cobweb/Fields/SFInt32",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,~~e):t.call(Object.create(i.prototype),~~e)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return n.SFInt32},set:function(e){t.prototype.set.call(this,~~e)},valueOf:t.prototype.getValue,toString:function(){return String(this.getValue())}}),i}),define("standard/Math/Numbers/Vector2",["jquery","standard/Math/Algorithm"],function(e,t){function n(e,t){this.x=e,this.y=t}return n.prototype={constructor:n,length:2,copy:function(){var e=Object.create(n.prototype);return e.x=this.x,e.y=this.y,e},assign:function(e){return this.x=e.x,this.y=e.y,this},set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return this.x===e.x&&this.y===e.y},negate:function(){return this.x=-this.x,
this.y=-this.y,this},add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this},multiply:function(e){return this.x*=e,this.y*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this},divide:function(e){return this.x/=e,this.y/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return e&&(e=1/e,this.x*=e,this.y*=e),this},dot:function(e){return this.x*e.x+this.y*e.y},norm:function(){return this.x*this.x+this.y*this.y},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lerp:function(e,n){return this.x=t.lerp(this.x,e.x,n),this.y=t.lerp(this.y,e.y,n),this},min:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y)}return this},max:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y)}return this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),e.extend(n,{Zero:new n(0,0),One:new n(1,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t},add:function(e,t){var n=Object.create(this.prototype);return n.x=e.x+t.x,n.y=e.y+t.y,n},subtract:function(e,t){var n=Object.create(this.prototype);return n.x=e.x-t.x,n.y=e.y-t.y,n},multiply:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t,n.y=e.y*t,n},multVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t.x,n.y=e.y*t.y,n},divide:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t,n.y=e.y/t,n},divVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t.x,n.y=e.y/t.y,n},normalize:function(e){var t=Object.create(this.prototype),n=e.x,i=e.y,r=Math.sqrt(n*n+i*i);return r?(r=1/r,t.x=n*r,t.y=i*r):(t.x=0,t.y=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,r){return new n(t.lerp(e.x,i.x,r),t.lerp(e.y,i.y,r))},min:function(e,t){for(var i=e.x,r=e.y,o=1,s=arguments.length;s>o;++o){var a=arguments[o];i=Math.min(i,a.x),r=Math.min(r,a.y)}return new n(i,r)},max:function(e,t){for(var i=e.x,r=e.y,o=1,s=arguments.length;s>o;++o){var a=arguments[o];i=Math.max(i,a.x),r=Math.max(r,a.y)}return new n(i,r)}}),n}),define("cobweb/Fields/SFVec2",["jquery","standard/Math/Numbers/Vector2","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e){return e.length?e[0]instanceof t?n.call(this,e[0]):n.call(this,new t(+e[0],+e[1])):n.call(this,new t(0,0))}function o(e,t){return this instanceof o?r.call(this,arguments):r.call(Object.create(o.prototype),arguments)}function s(e,t){return this instanceof s?r.call(this,arguments):r.call(Object.create(s.prototype),arguments)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},negate:function(){return new this.constructor(t.negate(this.getValue().copy()))},add:function(e){return new this.constructor(t.add(this.getValue(),e.getValue()))},subtract:function(e){return new this.constructor(t.subtract(this.getValue(),e.getValue()))},multiply:function(e){return new this.constructor(t.multiply(this.getValue(),e))},divide:function(e){return new this.constructor(t.divide(this.getValue(),e))},dot:function(e){return this.getValue().dot(e.getValue())},normalize:function(e){return new this.constructor(t.normalize(this.getValue()))},length:function(){return this.getValue().abs()},toString:function(){return this.getValue().toString()}}),Object.defineProperty(r.prototype,"x",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"0",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!1,configurable:!1}),o.prototype=e.extend(Object.create(r.prototype),{constructor:o,getTypeName:function(){return"SFVec2d"},getType:function(){return i.SFVec2d}}),s.prototype=e.extend(Object.create(r.prototype),{constructor:s,getTypeName:function(){return"SFVec2f"},getType:function(){return i.SFVec2f}}),{SFVec2d:o,SFVec2f:s}}),define("standard/Math/Numbers/Vector3",["jquery","standard/Math/Algorithm"],function(e,t){function n(e,t,n){this.x=e,this.y=t,this.z=n}n.prototype={constructor:n,length:3,copy:function(){var e=Object.create(n.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},cross:function(e){var t=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-t*e.z,this.z=t*e.y-n*e.x,this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lerp:function(e,n){return this.x=t.lerp(this.x,e.x,n),this.y=t.lerp(this.y,e.y,n),this.z=t.lerp(this.z,e.z,n),this},slerp:function(e,n){return t.slerp(this,i.assign(e),n)},min:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z)}return this},max:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z)}return this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),e.extend(n,{Zero:new n(0,0,0),One:new n(1,1,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},add:function(e,t){var n=Object.create(this.prototype);return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},subtract:function(e,t){var n=Object.create(this.prototype);return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},multiply:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},multVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},divide:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},divVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n},cross:function(e,t){var n=Object.create(this.prototype);return n.x=e.y*t.z-e.z*t.y,n.y=e.z*t.x-e.x*t.z,n.z=e.x*t.y-e.y*t.x,n},normalize:function(e){var t=Object.create(this.prototype),n=e.x,i=e.y,r=e.z,o=Math.sqrt(n*n+i*i+r*r);return o?(o=1/o,t.x=n*o,t.y=i*o,t.z=r*o):(t.x=0,t.y=0,t.z=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,r){return new n(t.lerp(e.x,i.x,r),t.lerp(e.y,i.y,r),t.lerp(e.z,i.z,r))},slerp:function(e,n,r){return t.slerp(e.copy(),i.assign(n),r)},min:function(e,t){for(var i=e.x,r=e.y,o=e.z,s=1,a=arguments.length;a>s;++s){var u=arguments[s];i=Math.min(i,u.x),r=Math.min(r,u.y),o=Math.min(o,u.z)}return new n(i,r,o)},max:function(e,t){for(var i=e.x,r=e.y,o=e.z,s=1,a=arguments.length;a>s;++s){var u=arguments[s];i=Math.max(i,u.x),r=Math.max(r,u.y),o=Math.max(o,u.z)}return new n(i,r,o)}});var i=new n(0,0,0);return n}),define("standard/Math/Numbers/Matrix2",["jquery","standard/Math/Algorithm"],function(e,t){function n(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return n.prototype={constructor:n,order:2,length:4,copy:function(){var e=Object.create(n.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e},assign:function(e){this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3]},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]},set1:function(e,t,n){this[e*this.order+t]=n},get1:function(e,t){return this[e*this.order+t]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(n.prototype,"x",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"origin",{get:function(){return nthis[2]},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"submatrix",{get:function(){return this.value[0]},enumerable:!1,configurable:!1}),e.extend(n,{Identity:new n}),n}),define("standard/Math/Algorithms/eigendecomposition",[],function(){return function(e){var t,n,i,r,o,s,a,u,l,c,h,d,p,f=e.order,g=new Array(f),m=new Array(f),y=new Array(f),b=new Array(f),w=new Array(f),v=e.length;for(d=0;f>d;++d)for(m[d]=new Array(f),y[d]=new Array(f),b[d]=g[d]=e.get1(d,d),w[d]=0,p=0;f>p;++p)m[d][p]=d===p?1:0,y[d][p]=e.get1(p,d);for(d=0;50>d;++d){for(t=0,c=0;f-1>c;++c)for(h=c+1;f>h;++h)t+=Math.abs(y[c][h]);if(0===t)break;for(l=3>d?.2*t/v:0,c=0;f-1>c;++c)for(h=c+1;f>h;++h)if(u=100*Math.abs(y[c][h]),d>3&&Math.abs(g[c])+u===Math.abs(g[c])&&Math.abs(g[h])+u===Math.abs(g[h]))y[c][h]=0;else if(Math.abs(y[c][h])>l){for(a=g[h]-g[c],Math.abs(a)+u===Math.abs(a)?o=y[c][h]/a:(n=.5*a/y[c][h],o=1/(Math.abs(n)+Math.sqrt(1+n*n)),0>n&&(o=-o)),i=1/Math.sqrt(1+o*o),r=o*i,s=r/(1+i),a=o*y[c][h],w[c]-=a,w[h]+=a,g[c]-=a,g[h]+=a,y[c][h]=0,p=0;c>p;++p)u=y[p][c],a=y[p][h],y[p][c]=u-r*(a+u*s),y[p][h]=a+r*(u-a*s);for(p=c+1;h>p;++p)u=y[c][p],a=y[p][h],y[c][p]=u-r*(a+u*s),y[p][h]=a+r*(u-a*s);for(p=h+1;f>p;++p)u=y[c][p],a=y[h][p],y[c][p]=u-r*(a+u*s),y[h][p]=a+r*(u-a*s);for(p=0;f>p;++p)u=m[p][c],a=m[p][h],m[p][c]=u-r*(a+u*s),m[p][h]=a+r*(u-a*s)}for(c=0;f>c;++c)g[c]=b[c]+=w[c],w[c]=0}return{values:g,vectors:m}}}),define("standard/Math/Numbers/Matrix3",["jquery","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],function(e,t,n,i,r){function o(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}var s=new t(0,0),a=new n(0,0,0),u=new t(0,0),l=new n(0,0,0),c=new t(0,0);return o.prototype={constructor:o,order:3,length:9,copy:function(){var e=Object.create(o.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(e,t,n){return this[e*this.order+t]=n,this},get1:function(e,t){return this[e*this.order+t]},set:function(e,i,r,o,s){switch(arguments.length){case 0:this.identity();break;case 1:null===e&&(e=t.Zero),this.identity(),this.translate(e);break;case 2:null===e&&(e=t.Zero),null===i&&(i=n.Zero),this.identity(),this.translate(e),0!==i[2]&&this.rotate(i[2]);break;case 3:null===e&&(e=t.Zero),null===i&&(i=n.Zero),null===r&&(r=t.One),this.identity(),this.translate(e),0!==i[2]&&this.rotate(i[2]),r.equals(t.One)||this.scale(r);break;case 4:if(null===e&&(e=t.Zero),null===i&&(i=n.Zero),null===r&&(r=t.One),null===o&&(o=n.Zero),this.identity(),this.translate(e),0!==i[2]&&this.rotate(i[2]),!r.equals(t.One)){var a=0!==o[2];a?(this.rotate(o[2]),this.scale(r),this.rotate(-o[2])):this.scale(r)}break;case 5:null===e&&(e=t.Zero),null===i&&(i=n.Zero),null===r&&(r=t.One),null===o&&(o=n.Zero),null===s&&(s=t.Zero),this.identity(),this.translate(e);var u=!s.equals(t.Zero);u&&this.translate(s),0!==i[2]&&this.rotate(i[2]),r.equals(t.One)||(0!==o[2]?(this.rotate(o[2]),this.scale(r),this.rotate(-o[2])):this.scale(r)),u&&this.translate(t.negate(s));break;case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this},get:function(e,t,n,i,r){null===e&&(e=s),null===t&&(t=a),null===n&&(n=u),null===i&&(i=l),null===r&&(r=c)},determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){var e=this[0],t=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8];return e*(r*u-o*a)-t*(i*u-o*s)+n*(i*a-r*s)},transpose:function(){var e;return e=this[1],this[1]=this[3],this[3]=e,e=this[2],this[2]=this[6],this[6]=e,e=this[5],this[5]=this[7],this[7]=e,this},inverse:function(){var e=this[0],t=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=e*r,c=e*a,h=i*t,d=i*a,p=s*t,f=s*r,g=l*u-c*o-h*u+d*n+p*o-f*n;if(0===g)throw new Error("Matrix3 .inverse: determinant is 0.");g=1/g;var m=(r*u-a*o)*g,y=-(t*u-a*n)*g,b=(t*o-r*n)*g,w=-(i*u-s*o)*g,v=(e*u-s*n)*g,x=-(e*o-i*n)*g;return this[0]=m,this[1]=y,this[2]=b,this[3]=w,this[4]=v,this[5]=x,this[6]=(d-f)*g,this[7]=-(c-p)*g,this[8]=(l-h)*g,this},multLeft:function(e){var t=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],y=e[7],b=e[8];return this[0]=t*c+r*h+a*d,this[1]=n*c+o*h+u*d,this[2]=i*c+s*h+l*d,this[3]=t*p+r*f+a*g,this[4]=n*p+o*f+u*g,this[5]=i*p+s*f+l*g,this[6]=t*m+r*y+a*b,this[7]=n*m+o*y+u*b,this[8]=i*m+s*y+l*b,this},multRight:function(e){var t=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],y=e[7],b=e[8];return this[0]=t*c+n*p+i*m,this[1]=t*h+n*f+i*y,this[2]=t*d+n*g+i*b,this[3]=r*c+o*p+s*m,this[4]=r*h+o*f+s*y,this[5]=r*d+o*g+s*b,this[6]=a*c+u*p+l*m,this[7]=a*h+u*f+l*y,this[8]=a*d+u*g+l*b,this},multVecMatrix:function(e){if(2===e.length){var t=e.x,n=e.y,i=t*this[2]+n*this[5]+this[8];return e.x=(t*this[0]+n*this[3]+this[6])/i,e.y=(t*this[1]+n*this[4]+this[7])/i,e}var t=e.x,n=e.y,r=e.z;return e.x=t*this[0]+n*this[3]+r*this[6],e.y=t*this[1]+n*this[4]+r*this[7],e.z=t*this[2]+n*this[5]+r*this[8],e},multMatrixVec:function(e){if(2===e.length){var t=e.x,n=e.y,i=t*this[6]+n*this[7]+this[8];return e.x=(t*this[0]+n*this[1]+this[2])/i,e.y=(t*this[3]+n*this[4]+this[5])/i,e}var t=e.x,n=e.y,r=e.z;return e.x=t*this[0]+n*this[1]+r*this[2],e.y=t*this[3]+n*this[4]+r*this[5],e.z=t*this[6]+n*this[7]+r*this[8],e},multDirMatrix:function(e){var t=e.x,n=e.y;return e.x=t*this[0]+n*this[3],e.y=t*this[1]+n*this[4],e},multMatrixDir:function(e){var t=e.x,n=e.y;return e.x=t*this[0]+n*this[1],e.y=t*this[3]+n*this[4],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},translate:function(e){var t=e.x,n=e.y;this[6]+=this[0]*t+this[3]*n,this[7]+=this[1]*t+this[4]*n},rotate:function(e){this.multLeft(o.Rotation(e))},scale:function(e){var t=e.x,n=e.y;this[0]*=t,this[3]*=n,this[1]*=t,this[4]*=n},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(o.prototype,"x",{get:function(){return new t(this[0],this[1])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){return new t(this[3],this[4])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"origin",{get:function(){return new t(this[6],this[7])},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"submatrix",{get:function(){var e=Object.create(i.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[3],e[3]=this[4],e},enumerable:!1,configurable:!1}),e.extend(o,{Identity:new o,Rotation:function(e){var t=Math.sin(e),n=Math.cos(e);return new o(n,t,0,-t,n,0,0,0,1)},Matrix2:function(e){return new o(e[0],e[1],0,e[2],e[3],0,0,0,1)},transpose:function(e){var t=Object.create(this.prototype);return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},inverse:function(e){var t=Object.create(this.prototype),n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=n*s,d=n*l,p=o*i,f=o*l,g=u*i,m=u*s,y=h*c-d*a-p*c+f*r+g*a-m*r;if(0===y)throw new Error("Matrix3 .inverse: determinant is 0.");y=1/y;var b=(s*c-l*a)*y,w=-(i*c-l*r)*y,v=(i*a-s*r)*y,x=-(o*c-u*a)*y,_=(n*c-u*r)*y,C=-(n*a-o*r)*y;return t[0]=b,t[1]=w,t[2]=v,t[3]=x,t[4]=_,t[5]=C,t[6]=(f-m)*y,t[7]=-(d-g)*y,t[8]=(h-p)*y,t},multLeft:function(e,t){var n=Object.create(this.prototype),i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=t[0],p=t[1],f=t[2],g=t[3],m=t[4],y=t[5],b=t[6],w=t[7],v=t[8];return n[0]=i*d+s*p+l*f,n[1]=r*d+a*p+c*f,n[2]=o*d+u*p+h*f,n[3]=i*g+s*m+l*y,n[4]=r*g+a*m+c*y,n[5]=o*g+u*m+h*y,n[6]=i*b+s*w+l*v,n[7]=r*b+a*w+c*v,n[8]=o*b+u*w+h*v,n},multRight:function(e,t){var n=Object.create(this.prototype),i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=t[0],p=t[1],f=t[2],g=t[3],m=t[4],y=t[5],b=t[6],w=t[7],v=t[8];return n[0]=i*d+r*g+o*b,n[1]=i*p+r*m+o*w,n[2]=i*f+r*y+o*v,n[3]=s*d+a*g+u*b,n[4]=s*p+a*m+u*w,n[5]=s*f+a*y+u*v,n[6]=l*d+c*g+h*b,n[7]=l*p+c*m+h*w,n[8]=l*f+c*y+h*v,n}}),o}),define("cobweb/Fields/SFMatrix3",["jquery","cobweb/Basic/X3DField","cobweb/Fields/SFVec2","cobweb/Bits/X3DConstants","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){return e.length?e[0]instanceof r?t.call(this,e[0]):t.call(this,new r(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5],+e[6],+e[7],+e[8])):t.call(this,new r)}function u(e){Object.defineProperty(a.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=t,this.addEvent()},enumerable:!1,configurable:!1})}function l(e,t,n,i,r,o,s,u,c){return this instanceof l?a.call(this,arguments):a.call(Object.create(l.prototype),arguments)}function c(e,t,n,i,r,o,s,u,l){return this instanceof c?a.call(this,arguments):a.call(Object.create(c.prototype),arguments)}var h=n.SFVec2d,d=n.SFVec2f;a.prototype=e.extend(Object.create(t.prototype),{constructor:a,copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},setTransform:function(e,t,n,i,r){e=e?e.getValue():o.Zero,t=t?t.getValue():s.Zero,n=n?n.getValue():o.One,i=i?i.getValue():s.Zero,r=r?r.getValue():o.Zero,this.getValue().set(e,t,n,i,r)},getTransform:function(e,t,n,i,r){e=e?e.getValue():null,t=t?t.getValue():null,n=n?n.getValue():null,i=i?i.getValue():null,r=r?r.getValue():null,this.getValue().get(e,t,n,i,r)},transpose:function(){return new this.constructor(r.transpose(this.getValue()))},inverse:function(){return new this.constructor(r.inverse(this.getValue()))},multLeft:function(e){return new this.constructor(r.multLeft(this.getValue(),e.getValue()))},multRight:function(e){return new this.constructor(r.multRight(this.getValue(),e.getValue()))},multVecMatrix:function(e){return new this.Vector2(this.getValue().multVecMatrix(e.getValue().copy()))},multMatrixVec:function(e){return new this.Vector2(this.getValue().multMatrixVec(e.getValue().copy()))},multDirMatrix:function(e){return new this.Vector2(this.getValue().multDirMatrix(e.getValue().copy()))},multMatrixDir:function(e){return new this.Vector2(this.getValue().multMatrixDir(e.getValue().copy()))},toString:function(){return this.getValue().toString()}});for(var p=0;p<r.prototype.length;++p)u(p);return l.prototype=e.extend(Object.create(a.prototype),{constructor:l,Vector2:h,getTypeName:function(){return"SFMatrix3d"},getType:function(){return i.SFMatrix3d}}),c.prototype=e.extend(Object.create(a.prototype),{constructor:c,Vector2:d,getTypeName:function(){return"SFMatrix3f"},getType:function(){return i.SFMatrix3f}}),{SFMatrix3d:l,SFMatrix3f:c}}),define("cobweb/Fields/SFVec3",["jquery","standard/Math/Numbers/Vector3","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e){return e.length?e[0]instanceof t?n.call(this,e[0]):n.call(this,new t(+e[0],+e[1],+e[2])):n.call(this,new t(0,0,0))}function o(e,t,n){return this instanceof o?r.call(this,arguments):r.call(Object.create(o.prototype),arguments)}function s(e,t,n){return this instanceof s?r.call(this,arguments):r.call(Object.create(s.prototype),arguments)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},negate:function(){return new this.constructor(t.negate(this.getValue().copy()))},add:function(e){return new this.constructor(t.add(this.getValue(),e.getValue()))},subtract:function(e){return new this.constructor(t.subtract(this.getValue(),e.getValue()))},multiply:function(e){return new this.constructor(t.multiply(this.getValue(),e))},divide:function(e){return new this.constructor(t.divide(this.getValue(),e))},cross:function(e){return new this.constructor(t.cross(this.getValue(),e.getValue()))},dot:function(e){return this.getValue().dot(e.getValue())},normalize:function(e){return new this.constructor(t.normalize(this.getValue()))},length:function(){return this.getValue().abs()},toString:function(){return this.getValue().toString()}}),Object.defineProperty(r.prototype,"x",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"0",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"z",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!1,configurable:!1}),o.prototype=e.extend(Object.create(r.prototype),{constructor:o,getTypeName:function(){return"SFVec3d"},getType:function(){return i.SFVec3d}}),s.prototype=e.extend(Object.create(r.prototype),{constructor:s,getTypeName:function(){return"SFVec3f"},getType:function(){return i.SFVec3f}}),{SFVec3d:o,SFVec3f:s}}),define("standard/Math/Numbers/Vector4",["jquery","standard/Math/Algorithm"],function(e,t){function n(e,t,n,i){this.x=e,this.y=t,this.z=n,this.w=i}return n.prototype={constructor:n,length:4,copy:function(){var e=Object.create(n.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lerp:function(e,n){return this.x=t.lerp(this.x,e.x,n),this.y=t.lerp(this.y,e.y,n),this.z=t.lerp(this.z,e.z,n),this.w=t.lerp(this.w,e.w,n),this},min:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w)}return this},max:function(e){for(var t=0,n=arguments.length;n>t;++t){var e=arguments[t];this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w)}return this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),e.extend(n,{Zero:new n(0,0,0,0),One:new n(1,1,1,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},add:function(e,t){var n=Object.create(this.prototype);return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},subtract:function(e,t){var n=Object.create(this.prototype);return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},multiply:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},multVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},divide:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},divVec:function(e,t){var n=Object.create(this.prototype);return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n},normalize:function(e){var t=Object.create(this.prototype),n=e.x,i=e.y,r=e.z,o=e.w,s=Math.sqrt(n*n+i*i+r*r+o*o);return s?(s=1/s,t.x=n*s,t.y=i*s,t.z=r*s,t.w=o*s):(t.x=0,t.y=0,t.z=0,t.w=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,r){return new n(t.lerp(e.x,i.x,r),t.lerp(e.y,i.y,r),t.lerp(e.z,i.z,r),t.lerp(e.w,i.w,r))},min:function(e,t){for(var i=e.x,r=e.y,o=e.z,s=e.w,a=1,u=arguments.length;u>a;++a){var l=arguments[a];i=Math.min(i,l.x),r=Math.min(r,l.y),o=Math.min(o,l.z),s=Math.min(s,l.w)}return new n(i,r,o,s)},max:function(e,t){for(var i=e.x,r=e.y,o=e.z,s=e.w,a=1,u=arguments.length;u>a;++a){var l=arguments[a];i=Math.max(i,l.x),r=Math.max(r,l.y),o=Math.max(o,l.z),s=Math.max(s,l.w)}return new n(i,r,o,s)}}),n}),define("standard/Math/Numbers/Quaternion",["jquery","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,n,i){function r(e,t,n,i){this.x=e,this.y=t,this.z=n,this.w=i}var o=new n(0,0,0);r.prototype={constructor:r,length:4,copy:function(){var e=Object.create(r.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multLeft:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=e.w;return this.x=r*o+t*u+n*a-i*s,this.y=r*s+n*u+i*o-t*a,this.z=r*a+i*u+t*s-n*o,this.w=r*u-t*o-n*s-i*a,this},multRight:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=e.w;return this.x=u*t+o*r+s*i-a*n,this.y=u*n+s*r+a*t-o*i,this.z=u*i+a*r+o*n-s*t,this.w=u*r-o*t-s*n-a*i,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},multVecQuat:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=r*r-t*t-n*n-i*i,l=2*(o*t+s*n+a*i),c=2*r;return e.x=u*o+l*t+c*(n*a-i*s),e.y=u*s+l*n+c*(i*o-t*a),e.z=u*a+l*i+c*(t*s-n*o),e},multQuatVec:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=r*r-t*t-n*n-i*i,l=2*(o*t+s*n+a*i),c=2*r;return e.x=u*o+l*t-c*(n*a-i*s),e.y=u*s+l*n-c*(i*o-t*a),e.z=u*a+l*i-c*(t*s-n*o),e},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},pow:function(t){if(t instanceof r)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));var n=this.abs(),i=Math.acos(this.w/n),o=this.imag.abs(),s=Math.pow(n,t),a=t*i,u=s/o*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=s*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));var e=this.abs(),t=this.imag.normalize().multiply(Math.acos(this.w/e)),n=Math.log(e);return this.x=t.x,this.y=t.y,this.z=t.z,this.w=n,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));var e=this.imag,t=e.abs(),n=Math.exp(this.w),i=n*Math.cos(t),r=e.multiply(n*Math.sin(t)/t);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=i,this},slerp:function(e,t){return i.slerp(this,s.assign(e),t)},squad:function(e,t,n,r){return i.slerp(i.slerp(this,s.assign(n),r),i.slerp(a.assign(e),u.assign(t),r),2*r*(1-r))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(r.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){
return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"imag",{get:function(){return o.set(this.x,this.y,this.z)},enumerable:!1,configurable:!1}),t.extend(r,{Matrix3:function(e){var t,n=Object.create(this.prototype);t=e[0]>e[4]?e[0]>e[8]?0:2:e[4]>e[8]?1:2;var i=e[0]+e[4]+e[8];if(i>e[3*t+t]){n[3]=Math.sqrt(i+1)/2;var r=4*n[3];n[0]=(e[5]-e[7])/r,n[1]=(e[6]-e[2])/r,n[2]=(e[1]-e[3])/r}else{var o=(t+1)%3,s=(t+2)%3;n[t]=Math.sqrt(e[3*t+t]-e[3*o+o]-e[3*s+s]+1)/2;var r=4*n[t];n[o]=(e[3*t+o]+e[3*o+t])/r,n[s]=(e[3*t+s]+e[3*s+t])/r,n[3]=(e[3*o+s]-e[3*s+o])/r}return n},negate:function(e){var t=Object.create(this.prototype);return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t},inverse:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},add:function(e,t){var n=Object.create(this.prototype);return n.x=t.x+t.x,n.y=t.y+t.y,n.z=t.z+t.z,n.w=t.w+t.w,n},subtract:function(e,t){var n=Object.create(this.prototype);return n.x=t.x-t.x,n.y=t.y-t.y,n.z=t.z-t.z,n.w=t.w-t.w,n},multiply:function(e,t){var n=Object.create(this.prototype);return n.x=t.x*t,n.y=t.y*t,n.z=t.z*t,n.w=t.w*t,n},multLeft:function(e,t){var n=Object.create(this.prototype),i=e.x,r=e.y,o=e.z,s=e.w,a=t.x,u=t.y,l=t.z,c=t.w;return n.x=s*a+i*c+r*l-o*u,n.y=s*u+r*c+o*a-i*l,n.z=s*l+o*c+i*u-r*a,n.w=s*c-i*a-r*u-o*l,n},multRight:function(e,t){var n=Object.create(this.prototype),i=e.x,r=e.y,o=e.z,s=e.w,a=t.x,u=t.y,l=t.z,c=t.w;return n.x=c*i+a*s+u*o-l*r,n.y=c*r+u*s+l*i-a*o,n.z=c*o+l*s+a*r-u*i,n.w=c*s-a*i-u*r-l*o,n},divide:function(e,t){var n=Object.create(this.prototype);return n.x=t.x/t,n.y=t.y/t,n.z=t.z/t,n.w=t.w/t,n},normalize:function(e){var t=Object.create(this.prototype),n=e.x,i=e.y,r=e.z,o=e.w,s=Math.sqrt(n*n+i*i+r*r+o*o);return s?(s=1/s,t.x=n*s,t.y=i*s,t.z=r*s,t.w=o*s):(t.x=0,t.y=0,t.z=0,t.w=0),t},slerp:function(e,t,n){return i.slerp(e.copy(),a.assign(t),n)},squad:function(e,t,n,r,o){return i.slerp(i.slerp(e.copy(),s.assign(r),o),i.slerp(a.assign(t),u.assign(n),o),2*o*(1-o))},spline:function(e,t,n){return l.assign(e),c.assign(t),h.assign(n),l.dot(c)<0&&l.negate(),h.dot(c)<0&&h.negate(),d.assign(c).inverse(),c.multRight(s.assign(d).multRight(l).log().add(a.assign(d).multRight(h).log()).divide(-4).exp()).normalize().copy()}});var s=new r(0,0,0,1),a=new r(0,0,0,1),u=new r(0,0,0,1),l=new r(0,0,0,1),c=new r(0,0,0,1),h=new r(0,0,0,1),d=new r(0,0,0,1);return r}),define("standard/Math/Numbers/Rotation4",["jquery","standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],function(e,t,n,i,r){function o(e,i,r,o){switch(arguments.length){case 0:return void(this.value=new t(0,0,0,1));case 1:return void(this.value=arguments[0]);case 2:var s=arguments[0],a=arguments[1];return this.value=new t(0,0,0,1),a instanceof n?this.setFromToVec(s,a):void this.set(s.x,s.y,s.z,a);case 4:return this.value=new t(0,0,0,1),void this.set(e,i,r,o)}}var s=new n(1,0,0),a=new n(0,1,0),u=new n(0,0,1),l=new n(0,0,0),c=new n(0,0,0),h=new n(0,0,0),d=new n(0,0,0),p=new i(0,0,1,0),f=new i(0,0,0,0);o.prototype={constructor:o,length:4,copy:function(){var e=Object.create(o.prototype);return e.value=this.value.copy(),e},assign:function(e){return this.value.assign(e.value),this},set:function(e,t,n,i){var o=Math.sqrt(e*e+t*t+n*n);if(0===o)return this.value.set(0,0,0,1),this;var s=r.interval(i/2,0,Math.PI),o=Math.sin(s)/o;return this.value.set(e*o,t*o,n*o,Math.cos(s)),this},get:function(){var e=this.value;if(Math.abs(e.w)>=1)return p;var t=e.imag.normalize();return f.set(t.x,t.y,t.z,2*Math.acos(e.w))},setAxisAngle:function(e,t){this.set(e.x,e.y,e.z,t)},setFromToVec:function(e,t){l.assign(e).normalize(),c.assign(t).normalize();var n=r.clamp(l.dot(c),-1,1),i=h.assign(l).cross(c).normalize(),o=i.abs();return 0===o?n>0?this.value.set(0,0,0,1):(d.assign(l).cross(s),0===d.norm()&&d.assign(l).cross(a),d.normalize(),this.value.set(d.x,d.y,d.z,0)):(i.multiply(Math.sqrt(Math.abs(1-n)/2)),this.value.set(i.x,i.y,i.z,Math.sqrt((1+n)/2))),this},setAxis:function(e){this.set(e.x,e.y,e.z,this.angle)},getAxis:function(){return Math.abs(this.value.w)>=1?u:this.value.imag.normalize()},equals:function(e){return this.value.equals(e.value)},inverse:function(){return this.value.inverse(),this},multLeft:function(e){return this.value.multLeft(e.value).normalize(),this},multRight:function(e){return this.value.multRight(e.value).normalize(),this},multVecRot:function(e){return this.value.multVecQuat(e)},multRotVec:function(e){return this.value.multQuatVec(e)},slerp:function(e,t){return this.value.slerp(e.value,t),this},squad:function(e,t,n,i){return this.value.squad(e.value,t.value,n.value,i),this},toString:function(){var e=this.get();return e.x+" "+e.y+" "+e.z+" "+e.w}};var g={get:function(){return this.getAxis().x},set:function(e){var t=this.get();this.set(e,t[1],t[2],t[3])},enumerable:!0,configurable:!1},m={get:function(){return this.getAxis().y},set:function(e){var t=this.get();this.set(t[0],e,t[2],t[3])},enumerable:!0,configurable:!1},y={get:function(){return this.getAxis().z},set:function(e){var t=this.get();this.set(t[0],t[1],e,t[3])},enumerable:!0,configurable:!1},b={get:function(){return Math.abs(this.value.w)>=1?0:2*Math.acos(this.value.w)},set:function(e){var t=this.getAxis();this.set(t.x,t.y,t.z,e)},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",g),Object.defineProperty(o.prototype,"y",m),Object.defineProperty(o.prototype,"z",y),Object.defineProperty(o.prototype,"angle",b),g.enumerable=!1,m.enumerable=!1,y.enumerable=!1,b.enumerable=!1,Object.defineProperty(o.prototype,"0",g),Object.defineProperty(o.prototype,"1",m),Object.defineProperty(o.prototype,"2",y),Object.defineProperty(o.prototype,"3",b),e.extend(o,{Identity:new o,Matrix3:function(e){var n=Object.create(this.prototype);return n.value=t.Matrix3(e),n},inverse:function(e){var n=Object.create(this.prototype);return n.value=t.inverse(e.value),n},multRight:function(e,n){var i=Object.create(this.prototype);return i.value=t.multRight(e.value,n.value),i},slerp:function(e,n,i){var r=Object.create(this.prototype);return r.value=t.slerp(e.value,n.value,i),r},squad:function(e,n,i,r,o){var s=Object.create(this.prototype);return s.value=t.squad(e.value,n,i,r.value,o),s},bezier:function(e,n,i,r,o){var s=Object.create(this.prototype);return s.value=t.bezier(e.value,n,i,r.value,o),s},spline:function(e,n,i){var r=Object.create(this.prototype);return r.value=t.spline(e.value,n.value,i.value),r}}),o}),define("standard/Math/Numbers/Matrix4",["jquery","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],function(e,t,n,i,r,o){function s(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}var a=new t(0,0,0),u=new i,l=new t(0,0,0),c=new i,h=new t(0,0,0),d=new r,p=new r,f=new r;return s.prototype={constructor:s,order:4,length:16,copy:function(){var e=Object.create(s.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e[9]=this[9],e[10]=this[10],e[11]=this[11],e[12]=this[12],e[13]=this[13],e[14]=this[14],e[15]=this[15],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]&&this[9]===e[9]&&this[10]===e[10]&&this[11]===e[11]&&this[12]===e[12]&&this[13]===e[13]&&this[14]===e[14]&&this[15]===e[15]},set1:function(e,t,n){return this[e*this.order+t]=n,this},get1:function(e,t){return this[e*this.order+t]},set:function(e,n,r,o,s){switch(arguments.length){case 0:this.identity();break;case 1:null===e&&(e=t.Zero),this.identity(),this.translate(e);break;case 2:null===e&&(e=t.Zero),null===n&&(n=i.Identity),this.identity(),this.translate(e),n.equals(i.Identity)||this.rotate(n);break;case 3:null===e&&(e=t.Zero),null===n&&(n=i.Identity),null===r&&(r=t.One),this.identity(),this.translate(e),n.equals(i.Identity)||this.rotate(n),r.equals(t.One)||this.scale(r);break;case 4:if(null===e&&(e=t.Zero),null===n&&(n=i.Identity),null===r&&(r=t.One),null===o&&(o=i.Identity),this.identity(),this.translate(e),n.equals(i.Identity)||this.rotate(n),!r.equals(t.One)){var a=!o.equals(i.Identity);a?(this.rotate(o),this.scale(r),this.rotate(i.inverse(o))):this.scale(r)}break;case 5:null===e&&(e=t.Zero),null===n&&(n=i.Identity),null===r&&(r=t.One),null===o&&(o=i.Identity),null===s&&(s=t.Zero),this.identity(),this.translate(e);var u=!s.equals(t.Zero);u&&this.translate(s),n.equals(i.Identity)||this.rotate(n),r.equals(t.One)||(o.equals(i.Identity)?this.scale(r):(this.rotate(o),this.scale(r),this.rotate(i.inverse(o)))),u&&this.translate(t.negate(s));break;case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this},get:function(e,n,r,o,f){switch(null===e&&(e=a),null===n&&(n=u),null===r&&(r=l),null===o&&(o=c),null===f&&(f=h),arguments.length){case 1:e.set(this[12],this[13],this[14]);break;case 2:this.factor(e,d,l,p),n.assign(i.Matrix3(d));break;case 3:this.factor(e,d,r,p),n.assign(i.Matrix3(d));break;case 4:this.factor(e,d,r,p),n.assign(i.Matrix3(d)),o.assign(i.Matrix3(p));break;case 5:var g=new s;g.set(t.negate(f)),g.multLeft(this),g.translate(f),g.get(e,n,r,o)}},setRotation:function(e){return this.setQuaternion(e.value)},setQuaternion:function(e){var t=e.x,n=e.y,i=e.z,r=e.w,o=n*n,s=i*i,a=t*n,u=i*r,l=i*t,c=n*r,h=t*t,d=n*i,p=t*r;return this[0]=1-2*(o+s),this[1]=2*(a+u),this[2]=2*(l-c),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(s+h),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+c),this[9]=2*(d-p),this[10]=1-2*(o+h),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(e,t,n,i){e.set(this[12],this[13],this[14]);var s=this.submatrix,a=s.determinant(),u=0>a?-1:1;if(u*a===0)return!1;var l=r.transpose(s).multLeft(s),c=o(l);return i.set(c.vectors[0][0],c.vectors[0][1],c.vectors[0][2],c.vectors[1][0],c.vectors[1][1],c.vectors[1][2],c.vectors[2][0],c.vectors[2][1],c.vectors[2][2]),n.x=u*Math.sqrt(c.values[0]),n.y=u*Math.sqrt(c.values[1]),n.z=u*Math.sqrt(c.values[2]),f[0]=1/n.x,f[4]=1/n.y,f[8]=1/n.z,t.assign(r.multRight(i,f).transpose().multLeft(i).multRight(s)),i.transpose(),!0},determinant3:function(){var e=this[0],t=this[1],n=this[2],i=this[4],r=this[5],o=this[6],s=this[8],a=this[9],u=this[10];return e*(r*u-o*a)-t*(i*u-o*s)+n*(i*a-r*s)},determinant:function(){var e=this[0],t=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,y=f*h,b=s*g,w=f*a,v=s*h,x=c*a,_=n*g,C=f*i,S=n*h,T=c*i,F=n*a,O=s*i,N=m*o+w*l+v*p-y*o-b*l-x*p,V=y*t+_*l+T*p-m*t-C*l-S*p,D=b*t+C*o+F*p-w*t-_*o-O*p,M=x*t+S*o+O*l-v*t-T*o-F*l;return e*N+r*V+u*D+d*M},transpose:function(){var e;return e=this[1],this[1]=this[4],this[1]=e,e=this[2],this[2]=this[8],this[2]=e,e=this[3],this[3]=this[12],this[3]=e,e=this[6],this[6]=this[9],this[6]=e,e=this[7],this[7]=this[13],this[7]=e,e=this[11],this[11]=this[14],this[11]=e,this},inverse:function(){var e=this[0],t=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,y=f*h,b=s*g,w=f*a,v=s*h,x=c*a,_=n*g,C=f*i,S=n*h,T=c*i,F=n*a,O=s*i,N=u*p,V=d*l,D=r*p,M=d*o,B=r*l,E=u*o,I=e*p,A=d*t,P=e*l,L=u*t,R=e*o,k=r*t,j=m*o+w*l+v*p-(y*o+b*l+x*p),z=y*t+_*l+T*p-(m*t+C*l+S*p),X=b*t+C*o+F*p-(w*t+_*o+O*p),U=x*t+S*o+O*l-(v*t+T*o+F*l),q=e*j+r*z+u*X+d*U;if(0===q)throw new Error("Matrix4 .inverse: determinant is 0.");return q=1/q,this[0]=q*j,this[1]=q*z,this[2]=q*X,this[3]=q*U,this[4]=q*(y*r+b*u+x*d-m*r-w*u-v*d),this[5]=q*(m*e+C*u+S*d-y*e-_*u-T*d),this[6]=q*(w*e+_*r+O*d-b*e-C*r-F*d),this[7]=q*(v*e+T*r+F*u-x*e-S*r-O*u),this[8]=q*(N*a+M*h+B*g-V*a-D*h-E*g),this[9]=q*(V*i+I*h+L*g-N*i-A*h-P*g),this[10]=q*(D*i+A*a+R*g-M*i-I*a-k*g),this[11]=q*(E*i+P*a+k*h-B*i-L*a-R*h),this[12]=q*(D*c+E*f+V*s-B*f-N*s-M*c),this[13]=q*(P*f+N*n+A*c-I*c-L*f-V*n),this[14]=q*(I*s+k*f+M*n-R*f-D*n-A*s),this[15]=q*(R*c+B*n+L*s-P*s-k*c-E*n),this},multLeft:function(e){var t=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],y=e[0],b=e[1],w=e[2],v=e[3],x=e[4],_=e[5],C=e[6],S=e[7],T=e[8],F=e[9],O=e[10],N=e[11],V=e[12],D=e[13],M=e[14],B=e[15];return this[0]=t*y+o*b+l*w+p*v,this[1]=n*y+s*b+c*w+f*v,this[2]=i*y+a*b+h*w+g*v,this[3]=r*y+u*b+d*w+m*v,this[4]=t*x+o*_+l*C+p*S,this[5]=n*x+s*_+c*C+f*S,this[6]=i*x+a*_+h*C+g*S,this[7]=r*x+u*_+d*C+m*S,this[8]=t*T+o*F+l*O+p*N,this[9]=n*T+s*F+c*O+f*N,this[10]=i*T+a*F+h*O+g*N,this[11]=r*T+u*F+d*O+m*N,this[12]=t*V+o*D+l*M+p*B,this[13]=n*V+s*D+c*M+f*B,this[14]=i*V+a*D+h*M+g*B,this[15]=r*V+u*D+d*M+m*B,this},multRight:function(e){var t=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],y=e[0],b=e[1],w=e[2],v=e[3],x=e[4],_=e[5],C=e[6],S=e[7],T=e[8],F=e[9],O=e[10],N=e[11],V=e[12],D=e[13],M=e[14],B=e[15];return this[0]=t*y+n*x+i*T+r*V,this[1]=t*b+n*_+i*F+r*D,this[2]=t*w+n*C+i*O+r*M,this[3]=t*v+n*S+i*N+r*B,this[4]=o*y+s*x+a*T+u*V,this[5]=o*b+s*_+a*F+u*D,this[6]=o*w+s*C+a*O+u*M,this[7]=o*v+s*S+a*N+u*B,this[8]=l*y+c*x+h*T+d*V,this[9]=l*b+c*_+h*F+d*D,this[10]=l*w+c*C+h*O+d*M,this[11]=l*v+c*S+h*N+d*B,this[12]=p*y+f*x+g*T+m*V,this[13]=p*b+f*_+g*F+m*D,this[14]=p*w+f*C+g*O+m*M,this[15]=p*v+f*S+g*N+m*B,this},multVecMatrix:function(e){if(3===e.length){var t=e.x,n=e.y,i=e.z,r=1/(t*this[3]+n*this[7]+i*this[11]+this[15]);return e.x=(t*this[0]+n*this[4]+i*this[8]+this[12])*r,e.y=(t*this[1]+n*this[5]+i*this[9]+this[13])*r,e.z=(t*this[2]+n*this[6]+i*this[10]+this[14])*r,e}var t=e.x,n=e.y,i=e.z,r=e.w;return e.x=t*this[0]+n*this[4]+i*this[8]+r*this[12],e.y=t*this[1]+n*this[5]+i*this[9]+r*this[13],e.z=t*this[2]+n*this[6]+i*this[10]+r*this[14],e.w=t*this[3]+n*this[7]+i*this[11]+r*this[15],e},multMatrixVec:function(e){if(3===e.length){var t=e.x,n=e.y,i=e.z,r=1/(t*this[12]+n*this[13]+i*this[14]+this[15]);return e.x=(t*this[0]+n*this[1]+i*this[2]+this[3])*r,e.y=(t*this[4]+n*this[5]+i*this[6]+this[7])*r,e.z=(t*this[8]+n*this[9]+i*this[10]+this[11])*r,e}var t=e.x,n=e.y,i=e.z,r=e.w;return e.x=t*this[0]+n*this[1]+i*this[2]+r*this[3],e.y=t*this[4]+n*this[5]+i*this[6]+r*this[7],e.z=t*this[8]+n*this[9]+i*this[10]+r*this[11],e.w=t*this[12]+n*this[13]+i*this[14]+r*this[15],e},multDirMatrix:function(e){var t=e.x,n=e.y,i=e.z;return e.x=t*this[0]+n*this[4]+i*this[8],e.y=t*this[1]+n*this[5]+i*this[9],e.z=t*this[2]+n*this[6]+i*this[10],e},multMatrixDir:function(e){var t=e.x,n=e.y,i=e.z;return e.x=t*this[0]+n*this[1]+i*this[2],e.y=t*this[4]+n*this[5]+i*this[6],e.z=t*this[8]+n*this[9]+i*this[10],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(e){var t=e.x,n=e.y,i=e.z;this[12]+=this[0]*t+this[4]*n+this[8]*i,this[13]+=this[1]*t+this[5]*n+this[9]*i,this[14]+=this[2]*t+this[6]*n+this[10]*i},rotate:function(e){this.multLeft(s.Quaternion(e.value))},scale:function(e){var t=e.x,n=e.y,i=e.z;this[0]*=t,this[4]*=n,this[8]*=i,this[1]*=t,this[5]*=n,this[9]*=i,this[2]*=t,this[6]*=n,this[10]*=i},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(s.prototype,"x",{get:function(){return new t(this[0],this[1],this[2])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"y",{get:function(){return new t(this[4],this[5],this[6])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"z",{get:function(){return new t(this[8],this[9],this[10])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"origin",{get:function(){return new t(this[12],this[13],this[14])},enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"submatrix",{get:function(){var e=Object.create(r.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[4],e[4]=this[5],e[5]=this[6],e[6]=this[8],e[7]=this[9],e[8]=this[10],e},enumerable:!1,configurable:!1}),e.extend(s,{Identity:new s,Rotation:function(e){return Object.create(this.prototype).setQuaternion(e.value)},Quaternion:function(e){return Object.create(this.prototype).setQuaternion(e)},Matrix3:function(e){return new s(e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1)},transpose:function(e){var t=Object.create(this.prototype);return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},inverse:function(e){var t=Object.create(this.prototype),n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],y=e[15],b=d*y,w=m*p,v=u*y,x=m*l,_=u*p,C=d*l,S=r*y,T=m*o,F=r*p,O=d*o,N=r*l,V=u*o,D=c*g,M=f*h,B=s*g,E=f*a,I=s*h,A=c*a,P=n*g,L=f*i,R=n*h,k=c*i,j=n*a,z=s*i,X=b*a+x*h+_*g-(w*a+v*h+C*g),U=w*i+S*h+O*g-(b*i+T*h+F*g),q=v*i+T*a+N*g-(x*i+S*a+V*g),G=C*i+F*a+V*h-(_*i+O*a+N*h),H=n*X+s*U+c*q+f*G;if(0==H)throw new Error("Matrix4 .inverse: determinant is 0.");return H=1/H,t[0]=H*X,t[1]=H*U,t[2]=H*q,t[3]=H*G,t[4]=H*(w*s+v*c+C*f-b*s-x*c-_*f),t[5]=H*(b*n+T*c+F*f-w*n-S*c-O*f),t[6]=H*(x*n+S*s+V*f-v*n-T*s-N*f),t[7]=H*(_*n+O*s+N*c-C*n-F*s-V*c),t[8]=H*(D*l+E*p+I*y-M*l-B*p-A*y),t[9]=H*(M*o+P*p+k*y-D*o-L*p-R*y),t[10]=H*(B*o+L*l+j*y-E*o-P*l-z*y),t[11]=H*(A*o+R*l+z*p-I*o-k*l-j*p),t[12]=H*(B*d+A*m+M*u-I*m-D*u-E*d),t[13]=H*(R*m+D*r+L*d-P*d-k*m-M*r),t[14]=H*(P*u+z*m+E*r-j*m-B*r-L*u),t[15]=H*(j*d+I*r+k*u-R*u-z*d-A*r),t},multLeft:function(e,t){var n=Object.create(this.prototype),i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],y=e[14],b=e[15],w=t[0],v=t[1],x=t[2],_=t[3],C=t[4],S=t[5],T=t[6],F=t[7],O=t[8],N=t[9],V=t[10],D=t[11],M=t[12],B=t[13],E=t[14],I=t[15];return n[0]=i*w+a*v+h*x+g*_,n[1]=r*w+u*v+d*x+m*_,n[2]=o*w+l*v+p*x+y*_,n[3]=s*w+c*v+f*x+b*_,n[4]=i*C+a*S+h*T+g*F,n[5]=r*C+u*S+d*T+m*F,n[6]=o*C+l*S+p*T+y*F,n[7]=s*C+c*S+f*T+b*F,n[8]=i*O+a*N+h*V+g*D,n[9]=r*O+u*N+d*V+m*D,n[10]=o*O+l*N+p*V+y*D,n[11]=s*O+c*N+f*V+b*D,n[12]=i*M+a*B+h*E+g*I,n[13]=r*M+u*B+d*E+m*I,n[14]=o*M+l*B+p*E+y*I,n[15]=s*M+c*B+f*E+b*I,n},multRight:function(e,t){var n=Object.create(this.prototype),i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],y=e[14],b=e[15],w=t[0],v=t[1],x=t[2],_=t[3],C=t[4],S=t[5],T=t[6],F=t[7],O=t[8],N=t[9],V=t[10],D=t[11],M=t[12],B=t[13],E=t[14],I=t[15];return n[0]=i*w+r*C+o*O+s*M,n[1]=i*v+r*S+o*N+s*B,n[2]=i*x+r*T+o*V+s*E,n[3]=i*_+r*F+o*D+s*I,n[4]=a*w+u*C+l*O+c*M,n[5]=a*v+u*S+l*N+c*B,n[6]=a*x+u*T+l*V+c*E,n[7]=a*_+u*F+l*D+c*I,n[8]=h*w+d*C+p*O+f*M,n[9]=h*v+d*S+p*N+f*B,n[10]=h*x+d*T+p*V+f*E,n[11]=h*_+d*F+p*D+f*I,n[12]=g*w+m*C+y*O+b*M,n[13]=g*v+m*S+y*N+b*B,n[14]=g*x+m*T+y*V+b*E,n[15]=g*_+m*F+y*D+b*I,n}}),s}),define("cobweb/Fields/SFMatrix4",["jquery","cobweb/Basic/X3DField","cobweb/Fields/SFVec3","cobweb/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,n,i,r,o,s){function a(e){return e.length?e[0]instanceof r?t.call(this,e[0]):t.call(this,new r(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5],+e[6],+e[7],+e[8],+e[9],+e[10],+e[11],+e[12],+e[13],+e[14],+e[15])):t.call(this,new r)}function u(e){Object.defineProperty(a.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=t,this.addEvent()},enumerable:!1,configurable:!1})}function l(e,t,n,i,r,o,s,u,c,h,d,p,f,g,m,y){return this instanceof l?a.call(this,arguments):a.call(Object.create(l.prototype),arguments)}function c(e,t,n,i,r,o,s,u,l,h,d,p,f,g,m,y){return this instanceof c?a.call(this,arguments):a.call(Object.create(c.prototype),arguments)}function h(e,t,n,i,r,o,s,u,l,c,d,p,f,g,m,y){return this instanceof h&&a.call(this,arguments),a.call(Object.create(h.prototype),arguments)}var d=n.SFVec3d,p=n.SFVec3f;a.prototype=e.extend(Object.create(t.prototype),{constructor:a,copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},set:function(e){this.getValue().assign(e)},setTransform:function(e,t,n,i,r){e=e?e.getValue():null,t=t?t.getValue():null,n=n?n.getValue():null,i=i?i.getValue():null,r=r?r.getValue():null,this.getValue().set(e,t,n,i,r)},getTransform:function(e,t,n,i,r){e=e?e.getValue():null,t=t?t.getValue():null,n=n?n.getValue():null,i=i?i.getValue():null,r=r?r.getValue():null,this.getValue().get(e,t,n,i,r)},transpose:function(){return new this.constructor(r.transpose(this.getValue()))},inverse:function(){return new this.constructor(r.inverse(this.getValue()))},multLeft:function(e){return new this.constructor(r.multLeft(this.getValue(),e.getValue()))},multRight:function(e){return new this.constructor(r.multRight(this.getValue(),e.getValue()))},multVecMatrix:function(e){return new this.Vector3(this.getValue().multVecMatrix(e.getValue().copy()))},multMatrixVec:function(e){return new this.Vector3(this.getValue().multMatrixVec(e.getValue().copy()))},multDirMatrix:function(e){return new this.Vector3(this.getValue().multDirMatrix(e.getValue().copy()))},multMatrixDir:function(e){return new this.Vector3(this.getValue().multMatrixDir(e.getValue().copy()))},toString:function(){return this.getValue().toString()}});for(var f=0;f<r.prototype.length;++f)u(f);return l.prototype=e.extend(Object.create(a.prototype),{constructor:l,Vector3:d,getTypeName:function(){return"SFMatrix4d"},getType:function(){return i.SFMatrix4d}}),c.prototype=e.extend(Object.create(a.prototype),{constructor:c,Vector3:p,getTypeName:function(){return"SFMatrix4f"},getType:function(){return i.SFMatrix4f}}),h.prototype=e.extend(Object.create(a.prototype),{constructor:h,Vector3:p,getTypeName:function(){return"VrmlMatrix"},getType:function(){return i.VrmlMatrix}}),{SFMatrix4d:l,SFMatrix4f:c,VrmlMatrix:h}}),define("cobweb/Fields/SFNode",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?(t.call(this,e?e:null),new Proxy(this,r)):i.call(Object.create(i.prototype),e)}var r={get:function(e,t){if(t in e)return e[t];try{var i=e.getValue().getField(t),r=i.getAccessType();if(r!==n.inputOnly)return i.valueOf();return}catch(o){return}},set:function(e,t,i){if(t in e)return e[t]=i,!0;try{var r=e.getValue().getField(t),o=r.getAccessType();return o&n.inputOnly&&r.setValue(i),!0}catch(s){return!1}}};return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,clone:function(){return new i(this.getValue())},copy:function(e){var t=this.getValue();return t?new i(t.copy(e)):new i},getTypeName:function(){return"SFNode"},getType:function(){return n.SFNode},set:function(e){t.prototype.set.call(this,e?e:null)},getNodeTypeName:function(){return this.getValue().getTypeName()},getNodeName:function(){return this.getValue().getName()},getFieldDefinitions:function(){return this.getValue().getFieldDefinitions()},valueOf:function(){return this.getValue()?this:null},toString:function(){var e=this.getValue();return e?e.toString():"NULL"},toVRMLString:function(){var e=this.getValue();return e?e.toVRMLString():"NULL"},toXMLString:function(){var e=this.getValue();return e?e.toXMLString():"<!-- NULL -->"}}),i}),define("cobweb/Fields/SFRotation",["jquery","cobweb/Fields/SFVec3","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,n,i,r){function o(e,t,i,a){if(this instanceof o)switch(arguments.length){case 1:return n.call(this,arguments[0]);case 2:return arguments[1]instanceof s?n.call(this,new r(arguments[0].getValue(),arguments[1].getValue())):n.call(this,new r(arguments[0].getValue(),+arguments[1]));case 4:return n.call(this,new r(+e,+t,+i,+a));default:return n.call(this,new r)}return o.apply(Object.create(o.prototype),arguments)}var s=t.SFVec3f;return o.prototype=e.extend(Object.create(n.prototype),{constructor:o,copy:function(){return new o(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},getTypeName:function(){return"SFRotation"},getType:function(){return i.SFRotation},set:function(e){this.getValue().assign(e)},setAxis:function(e){this.getValue().setAxis(e.getValue()),this.addEvent()},getAxis:function(){return new s(this.getValue().getAxis().copy())},inverse:function(){return new o(r.inverse(this.getValue()))},multiply:function(e){return new o(r.multRight(this.getValue(),e.getValue()))},multVec:function(e){return new s(this.getValue().multVecRot(e.getValue().copy()))},slerp:function(e,t){return new o(r.slerp(this.getValue(),e.getValue(),t))},toString:function(){return this.getValue().toString()}}),Object.defineProperty(o.prototype,"x",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"0",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"1",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"z",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"2",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"angle",{get:function(){return this.getValue().angle},set:function(e){this.getValue().angle=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"3",{get:function(){return this.getValue().angle},set:function(e){this.getValue().angle=e,this.addEvent()},enumerable:!1,configurable:!1}),o}),define("cobweb/Fields/SFString",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,arguments.length?String(e):""):t.call(Object.create(i.prototype),arguments.length?String(e):"")}var r=/\\([\\"])/g,o=/([\\"])/g;return e.extend(i,{unescape:function(e){return e.replace(r,"$1")},escape:function(e){return e.replace(o,"\\$1")}}),i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return n.SFString},set:function(e){t.prototype.set.call(this,String(e))},valueOf:t.prototype.getValue,toString:function(){return'"'+i.escape(this.getValue())+'"'}}),Object.defineProperty(i.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),i}),define("cobweb/Fields/SFTime",["jquery","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e){return this instanceof i?t.call(this,arguments.length?+e:0):t.call(Object.create(i.prototype),arguments.length?+e:0)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return n.SFTime},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toString:function(){return String(this.getValue())}}),i}),define("cobweb/Fields/SFVec4",["jquery","standard/Math/Numbers/Vector4","cobweb/Basic/X3DField","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e){return e.length?e[0]instanceof t?n.call(this,e[0]):n.call(this,new t(+e[0],+e[1],+e[2],+e[3])):n.call(this,new t(0,0,0,0))}function o(e,t,n,i){return this instanceof o?r.call(this,arguments):r.call(Object.create(o.prototype),arguments)}function s(e,t,n,i){return this instanceof s?r.call(this,arguments):r.call(Object.create(s.prototype),arguments)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},negate:function(){return new this.constructor(t.negate(this.getValue().copy()))},add:function(e){return new this.constructor(t.add(this.getValue(),e.getValue()))},subtract:function(e){return new this.constructor(t.subtract(this.getValue(),e.getValue()))},multiply:function(e){return new this.constructor(t.multiply(this.getValue(),e))},divide:function(e){return new this.constructor(t.divide(this.getValue(),e))},dot:function(e){return this.getValue().dot(e.getValue())},normalize:function(e){return new this.constructor(t.normalize(this.getValue()))},length:function(){return this.getValue().abs()},toString:function(){return this.getValue().toString()}}),Object.defineProperty(r.prototype,"x",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"0",{get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"1",{get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"z",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"2",{get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"w",{get:function(){return this.getValue().w},set:function(e){this.getValue().w=e,this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"3",{get:function(){return this.getValue().w},set:function(e){this.getValue().w=e,this.addEvent()},enumerable:!1,configurable:!1}),o.prototype=e.extend(Object.create(r.prototype),{constructor:o,getTypeName:function(){return"SFVec4d"},getType:function(){return i.SFVec4d}}),s.prototype=e.extend(Object.create(r.prototype),{constructor:s,getTypeName:function(){return"SFVec4f"},getType:function(){return i.SFVec4f}}),{SFVec4d:o,SFVec4f:s}}),define("cobweb/Fields/ArrayFields",["jquery","cobweb/Fields/SFBool","cobweb/Fields/SFColor","cobweb/Fields/SFColorRGBA","cobweb/Fields/SFDouble","cobweb/Fields/SFFloat","cobweb/Fields/SFImage","cobweb/Fields/SFInt32","cobweb/Fields/SFMatrix3","cobweb/Fields/SFMatrix4","cobweb/Fields/SFNode","cobweb/Fields/SFRotation","cobweb/Fields/SFString","cobweb/Fields/SFTime","cobweb/Fields/SFVec2","cobweb/Fields/SFVec3","cobweb/Fields/SFVec4","cobweb/Basic/X3DArrayField","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y,b){
function w(e){return this instanceof w?y.call(this,arguments):y.call(Object.create(w.prototype),arguments)}function v(e){return this instanceof v?y.call(this,arguments):y.call(Object.create(v.prototype),arguments)}function x(e){return this instanceof x?y.call(this,arguments):y.call(Object.create(x.prototype),arguments)}function _(e){return this instanceof _?y.call(this,arguments):y.call(Object.create(_.prototype),arguments)}function C(e){return this instanceof C?y.call(this,arguments):y.call(Object.create(C.prototype),arguments)}function S(e){return this instanceof S?y.call(this,arguments):y.call(Object.create(S.prototype),arguments)}function T(e){return this instanceof T?y.call(this,arguments):y.call(Object.create(T.prototype),arguments)}function F(e){return this instanceof F?y.call(this,arguments):y.call(Object.create(F.prototype),arguments)}function O(e){return this instanceof O?y.call(this,arguments):y.call(Object.create(O.prototype),arguments)}function N(e){return this instanceof N?y.call(this,arguments):y.call(Object.create(N.prototype),arguments)}function V(e){return this instanceof V?y.call(this,arguments):y.call(Object.create(V.prototype),arguments)}function D(e){return this instanceof D?y.call(this,arguments):y.call(Object.create(D.prototype),arguments)}function M(e){return this instanceof M?y.call(this,arguments):y.call(Object.create(M.prototype),arguments)}function B(e){return this instanceof B?y.call(this,arguments):y.call(Object.create(B.prototype),arguments)}function E(e){return this instanceof E?y.call(this,arguments):y.call(Object.create(E.prototype),arguments)}function I(e){return this instanceof I?y.call(this,arguments):y.call(Object.create(I.prototype),arguments)}function A(e){return this instanceof A?y.call(this,arguments):y.call(Object.create(A.prototype),arguments)}function P(e){return this instanceof P?y.call(this,arguments):y.call(Object.create(P.prototype),arguments)}function L(e){return this instanceof L?y.call(this,arguments):y.call(Object.create(L.prototype),arguments)}function R(e){return this instanceof R?y.call(this,arguments):y.call(Object.create(R.prototype),arguments)}function k(e){return this instanceof k?y.call(this,arguments):y.call(Object.create(k.prototype),arguments)}var j=u.SFMatrix3d,z=u.SFMatrix3f,X=l.SFMatrix4d,U=l.SFMatrix4f,q=f.SFVec2d,G=f.SFVec2f,H=g.SFVec3d,W=g.SFVec3f,Y=m.SFVec4d,$=m.SFVec4f;w.prototype=e.extend(Object.create(y.prototype),{constructor:w,ValueType:t,getTypeName:function(){return"MFBool"},getType:function(){return b.MFBool}}),v.prototype=e.extend(Object.create(y.prototype),{constructor:v,ValueType:n,getTypeName:function(){return"MFColor"},getType:function(){return b.MFColor}}),x.prototype=e.extend(Object.create(y.prototype),{constructor:x,ValueType:i,getTypeName:function(){return"MFColorRGBA"},getType:function(){return b.MFColorRGBA}}),_.prototype=e.extend(Object.create(y.prototype),{constructor:_,ValueType:r,getTypeName:function(){return"MFDouble"},getType:function(){return b.MFDouble}}),C.prototype=e.extend(Object.create(y.prototype),{constructor:C,ValueType:o,getTypeName:function(){return"MFFloat"},getType:function(){return b.MFFloat}}),S.prototype=e.extend(Object.create(y.prototype),{constructor:S,ValueType:s,getTypeName:function(){return"MFImage"},getType:function(){return b.MFImage}}),T.prototype=e.extend(Object.create(y.prototype),{constructor:T,ValueType:a,getTypeName:function(){return"MFInt32"},getType:function(){return b.MFInt32}}),F.prototype=e.extend(Object.create(y.prototype),{constructor:F,ValueType:j,getTypeName:function(){return"MFMatrix3d"},getType:function(){return b.MFMatrix3d}}),O.prototype=e.extend(Object.create(y.prototype),{constructor:O,ValueType:z,getTypeName:function(){return"MFMatrix3f"},getType:function(){return b.MFMatrix3f}}),N.prototype=e.extend(Object.create(y.prototype),{constructor:N,ValueType:X,getTypeName:function(){return"MFMatrix4d"},getType:function(){return b.MFMatrix4d}}),V.prototype=e.extend(Object.create(y.prototype),{constructor:V,ValueType:U,getTypeName:function(){return"MFMatrix4f"},getType:function(){return b.MFMatrix4f}}),D.prototype=e.extend(Object.create(y.prototype),{constructor:D,ValueType:c,getTypeName:function(){return"MFNode"},getType:function(){return b.MFNode},clone:function(){var e=new D;return e.setValue(this),e},copy:function(e){for(var t=new D,n=this.getValue(),i=t.getValue(),r=0,o=n.length;o>r;++r){var s=n[r].copy(e);s.addParent(t),i.push(s)}return t}}),M.prototype=e.extend(Object.create(y.prototype),{constructor:M,ValueType:h,getTypeName:function(){return"MFRotation"},getType:function(){return b.MFRotation}}),B.prototype=e.extend(Object.create(y.prototype),{constructor:B,ValueType:d,getTypeName:function(){return"MFString"},getType:function(){return b.MFString}}),E.prototype=e.extend(Object.create(y.prototype),{constructor:E,ValueType:p,getTypeName:function(){return"MFTime"},getType:function(){return b.MFTime}}),I.prototype=e.extend(Object.create(y.prototype),{constructor:I,ValueType:q,getTypeName:function(){return"MFVec2d"},getType:function(){return b.MFVec2d}}),A.prototype=e.extend(Object.create(y.prototype),{constructor:A,ValueType:G,getTypeName:function(){return"MFVec2f"},getType:function(){return b.MFVec2f}}),P.prototype=e.extend(Object.create(y.prototype),{constructor:P,ValueType:H,getTypeName:function(){return"MFVec3d"},getType:function(){return b.MFVec3d}}),L.prototype=e.extend(Object.create(y.prototype),{constructor:L,ValueType:W,getTypeName:function(){return"MFVec3f"},getType:function(){return b.MFVec3f}}),R.prototype=e.extend(Object.create(y.prototype),{constructor:R,ValueType:Y,getTypeName:function(){return"MFVec4d"},getType:function(){return b.MFVec4d}}),k.prototype=e.extend(Object.create(y.prototype),{constructor:k,ValueType:$,getTypeName:function(){return"MFVec4f"},getType:function(){return b.MFVec4f}});var K={MFBool:w,MFColor:v,MFColorRGBA:x,MFDouble:_,MFFloat:C,MFImage:S,MFInt32:T,MFMatrix3d:F,MFMatrix3f:O,MFMatrix4d:N,MFMatrix4f:V,MFNode:D,MFRotation:M,MFString:B,MFTime:E,MFVec2d:I,MFVec2f:A,MFVec3d:P,MFVec3f:L,MFVec4d:R,MFVec4f:k};return Object.preventExtensions(K),Object.freeze(K),Object.seal(K),K}),define("cobweb/Fields/SFImage",["jquery","cobweb/Basic/X3DField","cobweb/Fields/ArrayFields","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,t,n,i){this.width=e,this.height=t,this.comp=n,this.array=new s,this.array.setValue(i),this.array.length=e*t}function o(e,n,i,a){return this instanceof o?(4===arguments.length?t.call(this,new r(+e,+n,+i,a)):t.call(this,new r(0,0,0,new s)),this.getValue().getArray().addParent(this),this.addInterest(this,"set_size__"),this):o.apply(Object.create(o.prototype),arguments)}var s=n.MFInt32;return r.prototype={constructor:r,copy:function(){return new r(this.width,this.height,this.comp,this.array)},equals:function(e){return this.width===e.width&&this.height===e.height&&this.comp===e.comp&&this.array.equals(e.array)},assign:function(e){this.width=e.width,this.height=e.height,this.comp=e.comp,this.array.set(e.array.getValue())},set:function(e,t,n,i){this.width=e,this.height=t,this.comp=n,this.array.set(i)},setWidth:function(e){this.width=e,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(e){this.height=e,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(e){this.comp=e},getComp:function(){return this.comp},setArray:function(e){this.array.setValue(e),this.array.length=this.width*this.height},getArray:function(){return this.array}},o.prototype=e.extend(Object.create(t.prototype),{constructor:o,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new o(this.getValue())},equals:function(e){return this.getValue().equals(e.getValue())},set:function(e){this.getValue().assign(e)},getTypeName:function(){return"SFImage"},getType:function(){return i.SFImage},toString:function(){return this.width+" "+this.height+" "+this.comp}}),Object.defineProperty(o.prototype,"width",{get:function(){return this.getValue().getWidth()},set:function(e){this.getValue().setWidth(e),this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"x",{get:function(){return this.getValue().getWidth()},set:function(e){this.getValue().setWidth(e),this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"height",{get:function(){return this.getValue().getHeight()},set:function(e){this.getValue().setHeight(e),this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){return this.getValue().getHeight()},set:function(e){this.getValue().setHeight(e),this.addEvent()},enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"comp",{get:function(){return this.getValue().getComp()},set:function(e){this.getValue().setComp(e),this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(o.prototype,"array",{get:function(){return this.getValue().getArray()},set:function(e){this.getValue().setArray(e),this.addEvent()},enumerable:!0,configurable:!1}),o}),define("cobweb/Fields",["jquery","cobweb/Fields/SFBool","cobweb/Fields/SFColor","cobweb/Fields/SFColorRGBA","cobweb/Fields/SFDouble","cobweb/Fields/SFFloat","cobweb/Fields/SFImage","cobweb/Fields/SFInt32","cobweb/Fields/SFMatrix3","cobweb/Fields/SFMatrix4","cobweb/Fields/SFNode","cobweb/Fields/SFRotation","cobweb/Fields/SFString","cobweb/Fields/SFTime","cobweb/Fields/SFVec2","cobweb/Fields/SFVec3","cobweb/Fields/SFVec4","cobweb/Fields/ArrayFields"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y){var b=e.extend({SFBool:t,SFColor:n,SFColorRGBA:i,SFDouble:r,SFFloat:o,SFImage:s,SFInt32:a,SFMatrix3d:u.SFMatrix3d,SFMatrix3f:u.SFMatrix3f,SFMatrix4d:l.SFMatrix4d,SFMatrix4f:l.SFMatrix4f,SFNode:c,SFRotation:h,SFString:d,SFTime:p,SFVec2d:f.SFVec2d,SFVec2f:f.SFVec2f,SFVec3d:g.SFVec3d,SFVec3f:g.SFVec3f,SFVec4d:m.SFVec4d,SFVec4f:m.SFVec4f,VrmlMatrix:l.VrmlMatrix},y);return Object.preventExtensions(b),Object.freeze(b),Object.seal(b),b}),define("cobweb/Base/X3DEventObject",["jquery","cobweb/Base/X3DChildObject","cobweb/Base/Events"],function(e,t,n){function i(e){t.call(this),this.browser=e}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,getBrowser:function(){return this.browser},getExtendedEventHandling:function(){return!0},addEvent:function(e){e.getTainted()||(e.setTainted(!0),this.addEventObject(e,n.create(e)))},addEventObject:function(e,t){this.getBrowser().addBrowserEvent(),this.getBrowser().addTaintedField(e,t),this.getTainted()||(e.isInput()||this.getExtendedEventHandling()&&!e.isOutput())&&(this.setTainted(!0),this.getBrowser().addTaintedNode(this))},addNodeEvent:function(){this.getTainted()||(this.setTainted(!0),this.getBrowser().addTaintedNode(this),this.getBrowser().addBrowserEvent())},processEvents:function(){this.setTainted(!1),this.processInterests()}}),i}),define("cobweb/Basic/X3DBaseNode",["jquery","cobweb/Base/X3DEventObject","cobweb/Base/Events","cobweb/Basic/X3DFieldDefinition","cobweb/Fields","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e,n){if(!this.hasOwnProperty("executionContext")){t.call(this,e),this.executionContext=n,this.type=[o.X3DBaseNode],this.fields={},this.preDefinedFields={},this.userDefinedFields={},this.addChildren("isLive",new r.SFBool(!0));for(var i=this.fieldDefinitions,s=0,a=i.length;a>s;++s)this.addField(i[s])}}return s.prototype=e.extend(Object.create(t.prototype),{constructor:s,fieldDefinitions:[],$initialized:!1,create:function(e){return new this.constructor(e)},getScene:function(){for(var e=this.executionContext;!e.isRootContext();)e=e.getExecutionContext();return e},getExecutionContext:function(){return this.executionContext},addType:function(e){this.type.push(e)},getType:function(){return this.type},getInnerNode:function(){return this},isInitialized:function(){return this.$initialized},isLive:function(){return this.isLive_},setup:function(){if(!this.$initialized){this.$initialized=!0;for(var e=this.fieldDefinitions,t=0,n=e.length;n>t;++t){var i=this.fields[e[t].name];i.updateReferences(),i.setTainted(!1)}this.initialize()}},initialize:function(){},eventsProcessed:function(){},copy:function(e){var t=this.getName();if(t.length)try{return e.getNamedNode(t).getValue()}catch(n){}var i=this.create(e);t.length&&e.updateNamedNode(t,i);for(var r=0,s=i.fieldDefinitions.length;s>r;++r)try{var a=i.fieldDefinitions[r],u=this.preDefinedFields[a.name],l=i.getField(a.name);if(l.setSet(u.getSet()),u.hasReferences())for(var c in u.getReferences()){var h=u.getReferences()[c];try{l.addReference(e.getField(h.getName()))}catch(n){console.log(n.message)}}else u.getAccessType()&o.initializeOnly&&l.set(u.copy(e).getValue())}catch(n){console.log(n.message)}for(var t in this.userDefinedFields){var u=this.userDefinedFields[t],l=u.copy(e);if(i.addUserDefinedField(u.getAccessType(),u.getName(),l),l.setSet(u.getSet()),u.hasReferences())for(var c in u.getReferences()){var h=u.getReferences()[c];try{l.addReference(e.getField(h.getName()))}catch(n){console.log("No reference '"+h.getName()+"' inside execution context "+e.getTypeName()+" '"+e.getName()+"'.")}}}return e.addUninitializedNode(i),i},addChildren:function(e,t){for(var n=0;n<arguments.length;n+=2)this.addChild(arguments[n+0],arguments[n+1])},addChild:function(e,t){t.addParent(this),t.setName(e),Object.defineProperty(this,e+"_",{get:function(){return this}.bind(t),set:t.setValue.bind(t),enumerable:!0,configurable:!1})},addField:function(e){var t=e.accessType,n=e.name,i=e.value.clone();i.setTainted(!0),i.addParent(this),i.setName(n),i.setAccessType(t),this.addAlias(n,i,e.userDefined)},addAlias:function(e,t,n){this.fields[e]=t,this.preDefinedFields[e]=t,t.getAccessType()===o.inputOutput&&(this.fields["set_"+e]=t,this.fields[e+"_changed"]=t),n||Object.defineProperty(this,e+"_",{get:function(){return this}.bind(t),set:t.setValue.bind(t),enumerable:!0,configurable:!1})},removeField:function(e){this.fields[e];delete this.fields[e],delete this.userDefinedFields[e];for(var t=this.fieldDefinitions.getValue(),n=0;n<t.length;++n)if(t[n].name===e){t.splice(n,1);break}},getField:function(e){var t=this.fields[e];if(t)return t;throw new Error("Unkown field '"+e+"' in node class "+this.getTypeName()+".")},getFieldDefinitions:function(){return this.fieldDefinitions},hasUserDefinedFields:function(){return!1},addUserDefinedField:function(e,t,n){this.fields[t]&&this.removeField(t),n.setTainted(!0),n.addParent(this),n.setName(t),n.setAccessType(e),this.fieldDefinitions.getValue().push(new i(e,t,n,!0)),this.fields[t]=n,this.userDefinedFields[t]=n,n.getAccessType()===o.inputOutput&&(this.fields["set_"+t]=n,this.fields[t+"_changed"]=n)},getUserDefinedFields:function(){return this.userDefinedFields},getCDATA:function(){return null},traverse:function(){},beginUpdate:function(){this.isLive().getValue()||(this.isLive().setValue(!0),this.isLive().processEvent(n.create(this.isLive())))},endUpdate:function(){this.isLive().getValue()&&(this.isLive().setValue(!1),this.isLive().processEvent(n.create(this.isLive())))},toString:function(){return this.getTypeName()+" { }"}}),s}),define("cobweb/Browser/Core/PrimitiveQuality",[],function(){var e=0,t={LOW:e++,MEDIUM:e++,HIGH:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("cobweb/Browser/Core/TextureQuality",[],function(){var e=0,t={LOW:e++,MEDIUM:e++,HIGH:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("lib/dataStorage",[],function(){function e(){return new Proxy(this,t)}var t={get:function(e,t){if(t in e)return e[t];if(void 0!==localStorage[t])return JSON.parse(localStorage[t])},set:function(e,t,n){return void 0===n?localStorage.removeItem(t):localStorage[t]=JSON.stringify(n),!0}};return e.prototype={constructor:e,clear:function(){return localStorage.clear()}},new e}),define("cobweb/Browser/Core/BrowserOptions",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Basic/X3DBaseNode","cobweb/Bits/X3DConstants","cobweb/Browser/Core/PrimitiveQuality","cobweb/Browser/Core/TextureQuality","lib/dataStorage"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addAlias("AntiAliased",this.Antialiased_),this.primitiveQuality=s.MEDIUM,this.textureQuality=a.MEDIUM}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"SplashScreen",new t.SFBool(!0)),new n(o.inputOutput,"Dashboard",new t.SFBool(!0)),new n(o.inputOutput,"Rubberband",new t.SFBool(!0)),new n(o.inputOutput,"EnableInlineViewpoints",new t.SFBool(!0)),new n(o.inputOutput,"Antialiased",new t.SFBool(!0)),new n(o.inputOutput,"TextureQuality",new t.SFString("MEDIUM")),new n(o.inputOutput,"PrimitiveQuality",new t.SFString("MEDIUM")),new n(o.inputOutput,"QualityWhenMoving",new t.SFString("MEDIUM")),new n(o.inputOutput,"Shading",new t.SFString("GOURAUD")),new n(o.inputOutput,"MotionBlur",new t.SFBool),new n(o.inputOutput,"Gravity",new t.SFFloat(9.80665))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"browserOptions"},initialize:function(){r.prototype.initialize.call(this),this.Rubberband_.addInterest(this,"set_rubberband__"),this.PrimitiveQuality_.addInterest(this,"set_primitiveQuality__"),this.TextureQuality_.addInterest(this,"set_textureQuality__"),this.Shading_.addInterest(this,"set_shading__"),this.getBrowser().shutdown().addInterest(this,"configure"),this.configure()},configure:function(){for(var e=this.getFieldDefinitions(),t=0;t<e.length;++t){var n=e[t],i=this.getField(n.name);void 0===u["BrowserOptions."+n.name]&&(i.equals(n.value)||i.setValue(n.value))}var r=u["BrowserOptions.Rubberband"],o=u["BrowserOptions.PrimitiveQuality"],s=u["BrowserOptions.TextureQuality"];void 0!==r&&r!==this.Rubberband_.getValue()&&(this.Rubberband_=r),void 0!==o&&o!==this.PrimitiveQuality_.getValue()&&(this.PrimitiveQuality_=o),void 0!==s&&s!==this.TextureQuality_.getValue()&&(this.TextureQuality_=s)},getPrimitiveQuality:function(){return this.primitiveQuality},getTextureQuality:function(){return this.textureQuality},getShading:function(){return this.Shading_.getValue()},set_rubberband__:function(e){u["BrowserOptions.Rubberband"]=e.getValue()},set_primitiveQuality__:function(e){u["BrowserOptions.PrimitiveQuality"]=e.getValue();var t=this.getBrowser().getArc2DOptions(),n=this.getBrowser().getArcClose2DOptions(),i=this.getBrowser().getCircle2DOptions(),r=this.getBrowser().getDisk2DOptions(),o=this.getBrowser().getConeOptions(),a=this.getBrowser().getCylinderOptions(),l=this.getBrowser().getSphereOptions();switch(e.getValue()){case"LOW":this.primitiveQuality=s.LOW,t.minAngle_=Math.PI/10,n.minAngle_=Math.PI/10,i.segments_=20,r.segments_=20,o.vDimension_=16,a.vDimension_=16,l.uDimension_=24,l.vDimension_=12;break;case"HIGH":this.primitiveQuality=s.HIGH,t.minAngle_=Math.PI/40,n.minAngle_=Math.PI/40,i.segments_=80,r.segments_=80,o.vDimension_=32,a.vDimension_=32,l.uDimension_=40,l.vDimension_=20;break;default:this.primitiveQuality=s.MEDIUM,t.minAngle_=Math.PI/20,n.minAngle_=Math.PI/20,i.segments_=40,r.segments_=40,o.vDimension_=20,a.vDimension_=20,l.uDimension_=32,l.vDimension_=16}},set_textureQuality__:function(e){u["BrowserOptions.TextureQuality"]=e.getValue();var t=this.getBrowser().getDefaultTextureProperties();switch(e.getValue()){case"LOW":this.textureQuality=a.LOW,t.magnificationFilter_="AVG_PIXEL",t.minificationFilter_="AVG_PIXEL",t.textureCompression_="FASTEST",t.generateMipMaps_=!0;break;case"HIGH":this.textureQuality=a.HIGH,t.magnificationFilter_="NICEST",t.minificationFilter_="NICEST",t.textureCompression_="NICEST",t.generateMipMaps_=!0;break;default:this.textureQuality=a.MEDIUM,t.magnificationFilter_="NICEST",t.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",t.textureCompression_="NICEST",t.generateMipMaps_=!0}},set_shading__:function(e){this.getBrowser().setShading(e.getValue())}}),l}),define("cobweb/Browser/Core/RenderingProperties",["jquery","cobweb/Basic/X3DBaseNode"],function(e,t){function n(e){t.call(this,e.getBrowser(),e)}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n,getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"renderingProperties"}}),n}),define("cobweb/Browser/Core/Notification",["jquery","cobweb/Fields/SFString","cobweb/Basic/X3DBaseNode"],function(e,t,n){function i(e){n.call(this,e.getBrowser(),e)}return e.fn.textWidth=function(){var t=e(this).html(),n="<span>"+t+"</span>";e(this).html(n);var i=e(this).find("span:first").width();return e(this).html(t),i},i.prototype=e.extend(Object.create(n.prototype),{constructor:i,initialize:function(){n.prototype.initialize.call(this),this.addChildren("string",new t),this.element=e("<div/>").addClass("cobweb-notification").appendTo(this.getBrowser().getElement().find(".cobweb-surface")).animate({width:0}),this.string_.addInterest(this,"set_string__")},set_string__:function(){0!==this.string_.length&&(this.element.text(this.string_.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth(this.string_.getValue())}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),i}),define("text/text",["module"],function(e){var t,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,a=s&&location.protocol&&location.protocol.replace(/\:/,""),u=s&&location.hostname,l=s&&(location.port||void 0),c=[],h=e.config&&e.config()||{};return t={version:"2.0.2+",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(o);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(r){}if(e){i=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),i=e.substring(0,n),r=e.substring(n+1,e.length);return n=r.indexOf("!"),-1!==n&&(t=r.substring(n+1,r.length),t="strip"===t,r=r.substring(0,n)),{moduleName:i,ext:r,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,s,a,u=t.xdRegExp.exec(e);return u?(o=u[2],s=u[3],s=s.split(":"),a=s[1],s=s[0],!(o&&o!==n||s&&s.toLowerCase()!==i.toLowerCase()||(a||s)&&a!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,h.isBuild&&(c[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();h.isBuild=r.isBuild;var o=t.parseName(e),c=o.moduleName+"."+o.ext,d=n.toUrl(c),p=h.useXhr||t.useXhr;!s||p(d,a,u,l)?t.get(d,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([c],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,n,i,r){if(c.hasOwnProperty(n)){var o=t.jsEscape(c[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var s=t.parseName(n),a=s.moduleName+"."+s.ext,u=i.toUrl(s.moduleName+"."+s.ext)+".js";t.load(a,i,function(n){var i=function(e){return r(u,e)};i.asModule=function(e,t){return r.asModule(e,u,t)},t.write(e,a,i,o)},o)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),t.get=function(e,t){var i=n.readFileSync(e,"utf8");0===i.indexOf("\ufeff")&&(i=i.substring(1)),t(i)}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,n,i){var r=t.createXhr();r.open("GET",e,!0),h.onXhr&&h.onXhr(r,e),r.onreadystatechange=function(t){var o,s;4===r.readyState&&(o=r.status,o>399&&600>o?(s=new Error(e+" HTTP status: "+o),s.xhr=r,i(s)):n(r.responseText))},r.send(null)}:("rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),u="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);u=String(n.toString())}finally{a.close()}t(u)}),t}),define("text",["text/text"],function(e){return e}),define("text!locale/de.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: Cobweb\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../cobweb\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "BpS"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\nmsgid "Browser"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routen"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "Zeigegert"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Kamera"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Kollision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Anzeige"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formen"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Sensoren"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "Cobweb X3D Browser"\nmsgstr ""\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Verfgbare Betrachter"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualitt der Grundobjekte"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Hoch"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "hoch"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Mittel"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "mittel"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Niedrig"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "niedrig"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Textur Qualitt"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "an"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "aus"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About Cobweb"\nmsgstr "ber Cobweb"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Lade %d Datei"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Lade %d Dateien"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\n#~ msgid "Look At"\n#~ msgstr "Auf Objekte zielen"\n'}),define("text!locale/fr.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: Cobweb\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../cobweb\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Moins de proprits"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Plus de proprits"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Frquence"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "fps"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Vlocit"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\n#, fuzzy\nmsgid "Browser"\nmsgstr "Cobweb X3D Navigateur"\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routes"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "Pointeur"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Camra"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Collision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Visualisation"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formes"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Senseurs"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "Cobweb X3D Browser"\nmsgstr "Cobweb X3D Navigateur"\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualit des objets simples"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Haut"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "haut"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Moyenne"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "moyenne"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Faible"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "faible"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Qualit des textures"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Prsenter le bande lastique"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Bande lastique"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "marche"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "arrt"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur ractiv"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein cran"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Plein cran"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About Cobweb"\nmsgstr " propos de Cobweb"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de prs"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Tlcharger %d fichier"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Tlcharger %d fichiers"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Tlchargement fini"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers ayant chou."\n\n#~ msgid "Look At"\n#~ msgstr "Regarder un objet de prs"\n';
}),define("lib/gettext",["text!locale/de.po","text!locale/fr.po"],function(e,t){function n(e,t){for(var n=null,i=[];n=e.exec(t);)i.push(n);return i}function i(){for(var e=0;e<navigator.languages;++e){var t=navigator.languages[e].split("-")[0];if(s[t])return t}return(navigator.language||navigator.userLanguage).split("-")[0]}function r(e){if(s[e])for(var t=n(a,s[e]),i=s[e]={},r=0,o=t.length;o>r;++r)t[r][2].length&&(i[t[r][1]]=t[r][2])}function o(e){var t=s[u];if(void 0===t)return e;var n=t[e];return void 0===n?e:n}var s={en:"C",de:e,fr:t},a=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,u=i();return r(u),o}),define("cobweb/Browser/Core/BrowserTimings",["jquery","cobweb/Fields/SFBool","cobweb/Basic/X3DBaseNode","lib/dataStorage","lib/gettext"],function(e,t,n,i,r){function o(e){return Math.floor(100*e)/100}function s(e){n.call(this,e.getBrowser(),e),this.addChildren("enabled",new t)}return s.prototype=e.extend(Object.create(n.prototype),{constructor:s,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"browserTimings"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.type=i["BrowserTimings.type"]||"LESS",this.startTime=0,this.frames=0,this.element=e("<div>").addClass("cobweb-browser-timing").appendTo(this.getBrowser().getElement().find(".cobweb-surface")),this.table=e("<table>").appendTo(this.element),this.header=e("<thead>").append(e("<tr>").append(e("<th colspan=2>"))).appendTo(this.table),this.body=e("<tbody>").appendTo(this.table),this.footer=e("<tfoot>").append(e("<tr>").append(e("<td colspan=2>"))).appendTo(this.table),this.button=e("<button>").click(this.set_type__.bind(this)).appendTo(this.footer.find("td")),this.rows=[],this.set_button__(),i["BrowserTimings.enabled"]&&(this.enabled_=!0)},set_enabled__:function(e){i["BrowserTimings.enabled"]=e.getValue(),e.getValue()?(this.element.fadeIn(),this.getBrowser().prepareEvents().addInterest(this,"update"),this.update()):(this.element.fadeOut(),this.getBrowser().prepareEvents().removeInterest(this,"update"))},set_type__:function(){"MORE"===this.type?this.type="LESS":this.type="MORE",i["BrowserTimings.type"]=this.type,this.set_button__(),this.build()},set_button__:function(){"MORE"===this.type?this.button.text(r("Less Properties")):this.button.text(r("More Properties"))},update:function(){var e=this.getBrowser().getCurrentTime();e-this.startTime>1?(this.build(),this.frames=0,this.startTime=e):++this.frames},build:function(){var t=this.getBrowser(),n=t.getCurrentTime(),i=navigator.language||navigator.userLanguage,s=this.localeOptions,a=this.rows,u=0;if(a[u++]=e("<tr>").append(e("<td>").text(r("Frame rate")+":")).append(e("<td>").text(o(this.frames/(n-this.startTime)).toLocaleString(i,s)+" "+r("fps"))),a[u++]=e("<tr>").append(e("<td>").text(r("Speed")+":")).append(e("<td>").text(o(t.currentSpeed).toLocaleString(i,s)+" "+r("m/s"))),"MORE"===this.type){for(var l=t.systemTime,c=m&&t.getCollisionCount()?m.collisionTime:0,h=t.collisionTime+c,d=t.browserTime-(t.cameraTime+t.collisionTime+t.displayTime+c),p=Object.keys(t.prepareEvents().getInterests()).length-1,f=Object.keys(t.sensors().getInterests()).length,g=t.getWorld().getLayerSet().getLayers(),m=t.getActiveLayer(),y=0,b=0,w=0;w<g.length;++w){var v=g[w];y+=v.numOpaqueShapes,b+=v.numTransparentShapes}a[1].addClass("cobweb-more"),a[u++]=e("<tr>").append(e("<td>").text(r("Browser")+":")).append(e("<td>").text(o(l).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("X3D")+":")).append(e("<td>").text(o(t.browserTime).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Routing")+":")).append(e("<td>").text(o(d).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Picking")+":")).append(e("<td>").text(o(t.pickingTime).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Camera")+":")).append(e("<td>").text(o(t.cameraTime).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Collision")+":")).append(e("<td>").text(o(h).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Display")+":")).append(e("<td>").text(o(t.displayTime).toLocaleString(i,s)+" "+r("ms"))),a[u++]=e("<tr>").append(e("<td>").text(r("Shapes")+":")).append(e("<td>").text(y+" + "+b)),a[u++]=e("<tr>").append(e("<td>").text(r("Sensors")+":")).append(e("<td>").text(p+f))}a.length=u,this.header.find("th").text(r("Browser Timings")),this.body.empty(),this.body.append(a)}}),s}),function(e){"function"==typeof define&&define.amd?define("lib/jquery-contextMenu/dist/jquery.contextMenu",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){for(var t,n=e.split(/\s+/),i=[],r=0;t=n[r];r++)t=t.charAt(0).toUpperCase(),i.push(t);return i}function n(t){return t.id&&e('label[for="'+t.id+'"]').val()||t.name}function i(t,r,o){return o||(o=0),r.each(function(){var r,s,a=e(this),u=this,l=this.nodeName.toLowerCase();switch("label"===l&&a.find("input, textarea, select").length&&(r=a.text(),a=a.children().first(),u=a.get(0),l=u.nodeName.toLowerCase()),l){case"menu":s={name:a.attr("label"),items:{}},o=i(s.items,a.children(),o);break;case"a":case"button":s={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){return function(){a.click()}}()};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":s={name:a.attr("label"),disabled:!!a.attr("disabled"),icon:a.attr("icon"),callback:function(){return function(){a.click()}}()};break;case"checkbox":s={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:s=void 0}break;case"hr":s="-------";break;case"input":switch(a.attr("type")){case"text":s={type:"text",name:r||n(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":s={type:"checkbox",name:r||n(u),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",name:r||n(u),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:s=void 0}break;case"select":s={type:"select",name:r||n(u),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each(function(){s.options[this.value]=e(this).text()});break;case"textarea":s={type:"textarea",name:r||n(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:s={type:"html",html:a.clone(!0)}}s&&(o++,t["key"+o]=s)}),o}e.support.htmlMenuitem="HTMLMenuItemElement"in window,e.support.htmlCommand="HTMLCommandElement"in window,e.support.eventSelectstart="onselectstart"in document.documentElement,e.ui&&e.widget||(e.cleanData=function(t){return function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)try{i=e._data(r,"events"),i&&i.remove&&e(r).triggerHandler("remove")}catch(s){}t(n)}}(e.cleanData));var r=null,o=!1,s=e(window),a=0,u={},l={},c={},h={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,classNames:{hover:"hover",disabled:"disabled",visible:"visible",notSelectable:"not-selectable",icon:"icon",iconEdit:"icon-edit",iconCut:"icon-cut",iconCopy:"icon-copy",iconPaste:"icon-paste",iconDelete:"icon-delete",iconAdd:"icon-add",iconQuit:"icon-quit"},determinePosition:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var n=this.offset();n.top+=this.outerHeight(),n.left+=this.outerWidth()/2-t.outerWidth()/2,t.css(n)}},position:function(e,t,n){var i;if(!t&&!n)return void e.determinePosition.call(this,e.$menu);i="maintain"===t&&"maintain"===n?e.$menu.position():{top:n,left:t};var r=s.scrollTop()+s.height(),o=s.scrollLeft()+s.width(),a=e.$menu.outerHeight(),u=e.$menu.outerWidth();i.top+a>r&&(i.top-=a),i.top<0&&(i.top=0),i.left+u>o&&(i.left-=u),e.$menu.css(i)},positionSubmenu:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var n={top:0,left:this.outerWidth()};t.css(n)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:e.noop,hide:e.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},p=function(e){for(var t=0,n=e;;)if(t=Math.max(t,parseInt(n.css("z-index"),10)||0),n=n.parent(),!n||!n.length||"html body".indexOf(n.prop("nodeName").toLowerCase())>-1)break;return t},f={abortevent:function(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function(t){var n=e(this);if("right"===t.data.trigger&&(t.preventDefault(),t.stopImmediatePropagation()),!("right"!==t.data.trigger&&"demand"!==t.data.trigger&&t.originalEvent||n.hasClass("context-menu-active")||n.hasClass("context-menu-disabled"))){if(r=n,t.data.build){var i=t.data.build(r,t);if(i===!1)return;if(t.data=e.extend(!0,{},h,t.data,i||{}),!t.data.items||e.isEmptyObject(t.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");t.data.$trigger=r,g.create(t.data)}var o=!1;for(var s in t.data.items)if(t.data.items.hasOwnProperty(s)){var a;a=e.isFunction(t.data.items[s].visible)?t.data.items[s].visible.call(e(t.currentTarget),s,t.data):"undefined"!=typeof s.visible?t.data.items[s].visible===!0:!0,a&&(o=!0)}o&&g.show.call(n,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var n=e(this);r&&r.length&&!r.is(n)&&r.data("contextMenu").$menu.trigger("contextmenu:hide"),2===t.button&&(r=n.data("contextMenuActive",!0))},mouseup:function(t){var n=e(this);n.data("contextMenuActive")&&r&&r.length&&r.is(n)&&!n.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),r=n,n.trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))),n.removeData("contextMenuActive")},mouseenter:function(t){var n=e(this),i=e(t.relatedTarget),o=e(document);i.is(".context-menu-list")||i.closest(".context-menu-list").length||r&&r.length||(d.pageX=t.pageX,d.pageY=t.pageY,d.data=t.data,o.on("mousemove.contextMenuShow",f.mousemove),d.timer=setTimeout(function(){d.timer=null,o.off("mousemove.contextMenuShow"),r=n,n.trigger(e.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},t.data.delay))},mousemove:function(e){d.pageX=e.pageX,d.pageY=e.pageY},mouseleave:function(t){var n=e(t.relatedTarget);if(!n.is(".context-menu-list")&&!n.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(t){}d.timer=null}},layerClick:function(t){var n,i,r=e(this),o=r.data("contextMenuRoot"),a=t.button,u=t.pageX,l=t.pageY;t.preventDefault(),t.stopImmediatePropagation(),setTimeout(function(){var r,c="left"===o.trigger&&0===a||"right"===o.trigger&&2===a;if(document.elementFromPoint&&(o.$layer.hide(),n=document.elementFromPoint(u-s.scrollLeft(),l-s.scrollTop()),o.$layer.show()),o.reposition&&c)if(document.elementFromPoint){if(o.$trigger.is(n)||o.$trigger.has(n).length)return void o.position.call(o.$trigger,o,u,l)}else if(i=o.$trigger.offset(),r=e(window),i.top+=r.scrollTop(),i.top<=t.pageY&&(i.left+=r.scrollLeft(),i.left<=t.pageX&&(i.bottom=i.top+o.$trigger.outerHeight(),i.bottom>=t.pageY&&(i.right=i.left+o.$trigger.outerWidth(),i.right>=t.pageX))))return void o.position.call(o.$trigger,o,u,l);n&&c&&o.$trigger.one("contextmenu:hidden",function(){e(n).contextMenu({x:u,y:l})}),o.$menu.trigger("contextmenu:hide")},50)},keyStop:function(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function(e){var t={};switch(r&&(t=r.data("contextMenu")||{}),e.keyCode){case 9:case 38:if(f.keyStop(e,t),t.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("prevcommand");if(38===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void t.$menu.trigger("prevcommand");case 40:if(f.keyStop(e,t),!t.isInput)return void t.$menu.trigger("nextcommand");if(9===e.keyCode)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("nextcommand");if(40===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;if(!t.$selected.parent().hasClass("context-menu-root")){var n=t.$selected.parent().parent();return t.$selected.trigger("contextmenu:blur"),void(t.$selected=n)}break;case 39:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;var i=t.$selected.data("contextMenu")||{};if(i.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,i.$selected=null,void i.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(."+t.classNames.disabled+", ."+t.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(f.keyStop(e,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void e.preventDefault();break}return void("undefined"!=typeof t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(e,t);case 27:return f.keyStop(e,t),void t.$menu.trigger("contextmenu:hide");default:var o=String.fromCharCode(e.keyCode).toUpperCase();if(t.accesskeys&&t.accesskeys[o])return void t.accesskeys[o].$node.trigger(t.accesskeys[o].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),"undefined"!=typeof t.$selected&&t.$selected.trigger(e)},prevItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},i=e(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),s=n.$selected&&n.$selected.prev().length?n.$selected.prev():o.last(),a=s;s.hasClass(i.classNames.disabled)||s.hasClass(i.classNames.notSelectable);)if(s=s.prev().length?s.prev():o.last(),s.is(a))return;n.$selected&&f.itemMouseleave.call(n.$selected.get(0),t),f.itemMouseenter.call(s.get(0),t);var u=s.find("input, textarea, select");u.length&&u.focus()},nextItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},i=e(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),s=n.$selected&&n.$selected.next().length?n.$selected.next():o.first(),a=s;s.hasClass(i.classNames.disabled)||s.hasClass(i.classNames.notSelectable);)if(s=s.next().length?s.next():o.first(),s.is(a))return;n.$selected&&f.itemMouseleave.call(n.$selected.get(0),t),f.itemMouseenter.call(s.get(0),t);var u=s.find("input, textarea, select");u.length&&u.focus()},focusInput:function(){var t=e(this).closest(".context-menu-item"),n=t.data(),i=n.contextMenu,r=n.contextMenuRoot;r.$selected=i.$selected=t,r.isInput=i.isInput=!0},blurInput:function(){var t=e(this).closest(".context-menu-item"),n=t.data(),i=n.contextMenu,r=n.contextMenuRoot;r.isInput=i.isInput=!1},menuMouseenter:function(){var t=e(this).data().contextMenuRoot;t.hovering=!0},menuMouseleave:function(t){var n=e(this).data().contextMenuRoot;n.$layer&&n.$layer.is(t.relatedTarget)&&(n.hovering=!1)},itemMouseenter:function(t){var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;return o.hovering=!0,t&&o.$layer&&o.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(r.$menu?r:o).$menu.children(".hover").trigger("contextmenu:blur"),n.hasClass(o.classNames.disabled)||n.hasClass(o.classNames.notSelectable)?void(r.$selected=null):void n.trigger("contextmenu:focus")},itemMouseleave:function(t){var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;return o!==r&&o.$layer&&o.$layer.is(t.relatedTarget)?("undefined"!=typeof o.$selected&&o.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node)):void n.trigger("contextmenu:blur")},itemClick:function(t){var n,i=e(this),r=i.data(),o=r.contextMenu,s=r.contextMenuRoot,a=r.contextMenuKey;if(o.items[a]&&!i.is("."+s.classNames.disabled+", .context-menu-submenu, .context-menu-separator, ."+s.classNames.notSelectable)){if(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(s.callbacks[a])&&Object.prototype.hasOwnProperty.call(s.callbacks,a))n=s.callbacks[a];else{if(!e.isFunction(s.callback))return;n=s.callback}n.call(s.$trigger,a,s)!==!1?s.$menu.trigger("contextmenu:hide"):s.$menu.parent().length&&g.update.call(s.$trigger,s)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(t,n){var i=e(this).data("contextMenuRoot");g.hide.call(i.$trigger,i,n&&n.force)},focusItem:function(t){t.stopPropagation();var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;n.addClass([o.classNames.hover,o.classNames.visible].join(" ")).siblings().removeClass(o.classNames.visible).filter(o.classNames.hover).trigger("contextmenu:blur"),r.$selected=o.$selected=n,r.$node&&o.positionSubmenu.call(r.$node,r.$menu)},blurItem:function(t){t.stopPropagation();var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;r.autoHide&&n.removeClass(o.classNames.visible),n.removeClass(o.classNames.hover),r.$selected=null}},g={show:function(t,n,i){var o=e(this),s={};return e("#context-menu-layer").trigger("mousedown"),t.$trigger=o,t.events.show.call(o,t)===!1?void(r=null):(g.update.call(o,t),t.position.call(o,t,n,i),t.zIndex&&(s.zIndex=p(o)+t.zIndex),g.layer.call(t.$menu,t,s.zIndex),t.$menu.find("ul").css("zIndex",s.zIndex+1),t.$menu.css(s)[t.animation.show](t.animation.duration,function(){o.trigger("contextmenu:visible")}),o.data("contextMenu",t).addClass("context-menu-active"),e(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),void(t.autoHide&&e(document).on("mousemove.contextMenuAutoHide",function(e){var n=o.offset();n.right=n.left+o.outerWidth(),n.bottom=n.top+o.outerHeight(),!t.$layer||t.hovering||e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom||t.$menu.trigger("contextmenu:hide")})))},hide:function(t,n){var i=e(this);if(t||(t=i.data("contextMenu")||{}),n||!t.events||t.events.hide.call(i,t)!==!1){if(i.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout(function(e){return function(){e.remove()}}(t.$layer),10);try{delete t.$layer}catch(o){t.$layer=null}}r=null,t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur"),t.$selected=null,e(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),e.each(t,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:t[e]=void 0;try{delete t[e]}catch(n){}return!0}})),setTimeout(function(){i.trigger("contextmenu:hidden")},10)})}},create:function(n,i){void 0===i&&(i=n),n.$menu=e('<ul class="context-menu-list"></ul>').addClass(n.className||"").data({contextMenu:n,contextMenuRoot:i}),e.each(["callbacks","commands","inputs"],function(e,t){n[t]={},i[t]||(i[t]={})}),i.accesskeys||(i.accesskeys={}),e.each(n.items,function(r,o){var s=e('<li class="context-menu-item"></li>').addClass(o.className||""),a=null,u=null;if(s.on("click",e.noop),"string"==typeof o&&(o={type:"cm_seperator"}),o.$node=s.data({contextMenu:n,contextMenuRoot:i,contextMenuKey:r}),"undefined"!=typeof o.accesskey)for(var l,h=t(o.accesskey),d=0;l=h[d];d++)if(!i.accesskeys[l]){i.accesskeys[l]=o,o._name=o.name.replace(new RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if(o.type&&c[o.type])c[o.type].call(s,o,n,i),e.each([n,i],function(t,n){n.commands[r]=o,e.isFunction(o.callback)&&(n.callbacks[r]=o.callback)});else{switch("cm_seperator"===o.type?s.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===o.type?s.addClass("context-menu-html "+n.classNames.notSelectable):o.type?(a=e("<label></label>").appendTo(s),e("<span></span>").html(o._name||o.name).appendTo(a),s.addClass("context-menu-input"),n.hasTypes=!0,e.each([n,i],function(e,t){t.commands[r]=o,t.inputs[r]=o})):o.items&&(o.type="sub"),o.type){case"seperator":break;case"text":u=e('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+r).val(o.value||"").appendTo(a);break;case"textarea":u=e('<textarea name=""></textarea>').attr("name","context-menu-input-"+r).val(o.value||"").appendTo(a),o.height&&u.height(o.height);break;case"checkbox":u=e('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+r).val(o.value||"").prop("checked",!!o.selected).prependTo(a);break;case"radio":u=e('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+o.radio).val(o.value||"").prop("checked",!!o.selected).prependTo(a);break;case"select":u=e('<select name="">').attr("name","context-menu-input-"+r).appendTo(a),o.options&&(e.each(o.options,function(t,n){e("<option></option>").val(t).text(n).appendTo(u)}),u.val(o.selected));break;case"sub":e("<span></span>").html(o._name||o.name).appendTo(s),o.appendTo=o.$node,g.create(o,i),s.data("contextMenu",o).addClass("context-menu-submenu"),o.callback=null;break;case"html":e(o.html).appendTo(s);break;default:e.each([n,i],function(t,n){n.commands[r]=o,e.isFunction(o.callback)&&(n.callbacks[r]=o.callback)}),e("<span></span>").html(o._name||o.name||"").appendTo(s)}o.type&&"sub"!==o.type&&"html"!==o.type&&"cm_seperator"!==o.type&&(u.on("focus",f.focusInput).on("blur",f.blurInput),o.events&&u.on(o.events,n)),o.icon&&(e.isFunction(o.icon)?o._icon=o.icon.call(this,s,r,o):o._icon=n.classNames.icon+" "+n.classNames.icon+"-"+o.icon,s.addClass(o._icon))}o.$input=u,o.$label=a,s.appendTo(n.$menu),!n.hasTypes&&e.support.eventSelectstart&&s.on("selectstart.disableTextSelect",f.abortevent)}),n.$node||n.$menu.css("display","none").addClass("context-menu-root"),n.$menu.appendTo(n.appendTo||document.body)},resize:function(t,n){t.css({position:"absolute",display:"block"}),t.data("width",Math.ceil(t.width())),t.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),t.find("> li > ul").each(function(){g.resize(e(this),!0)}),n||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return e(this).data("width")})},update:function(t,n){var i=this;void 0===n&&(n=t,g.resize(t.$menu)),t.$menu.children().each(function(){var r,o=e(this),s=o.data("contextMenuKey"),a=t.items[s],u=e.isFunction(a.disabled)&&a.disabled.call(i,s,n)||a.disabled===!0;if(r=e.isFunction(a.visible)?a.visible.call(i,s,n):"undefined"!=typeof a.visible?a.visible===!0:!0,o[r?"show":"hide"](),o[u?"addClass":"removeClass"](n.classNames.disabled),e.isFunction(a.icon)&&(o.removeClass(a._icon),a._icon=a.icon.call(this,i,s,a),o.addClass(a._icon)),a.type)switch(o.find("input, select, textarea").prop("disabled",u),a.type){case"text":case"textarea":a.$input.val(a.value||"");break;case"checkbox":case"radio":a.$input.val(a.value||"").prop("checked",!!a.selected);break;case"select":a.$input.val(a.selected||"")}a.$menu&&g.update.call(i,a,n)})},layer:function(t,n){var i=t.$layer=e('<div id="context-menu-layer" style="position:fixed; z-index:'+n+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:s.height(),width:s.width(),display:"block"}).data("contextMenuRoot",t).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&i.css({position:"absolute",height:e(document).height()}),i}};e.fn.contextMenu=function(t){var n=this,i=t;if(this.length>0)if(void 0===t)this.first().trigger("contextmenu");else if(void 0!==t.x&&void 0!==t.y)this.first().trigger(e.Event("contextmenu",{pageX:t.x,pageY:t.y}));else if("hide"===t){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===t?e.contextMenu("destroy",{context:this}):e.isPlainObject(t)?(t.context=this,e.contextMenu("create",t)):t?this.removeClass("context-menu-disabled"):t||this.addClass("context-menu-disabled");else e.each(l,function(){this.selector===n.selector&&(i.data=this,e.extend(i.data,{trigger:"demand"}))}),f.contextmenu.call(i.target,i);return this},e.contextMenu=function(t,n){"string"!=typeof t&&(n=t,t="create"),"string"==typeof n?n={selector:n}:void 0===n&&(n={});var i=e.extend(!0,{},h,n||{}),r=e(document),s=r,c=!1;switch(i.context&&i.context.length?(s=e(i.context).first(),i.context=s.get(0),c=i.context!==document):i.context=document,t){case"create":if(!i.selector)throw new Error("No selector specified");if(i.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+i.selector+'" as it contains a reserved className');if(!i.build&&(!i.items||e.isEmptyObject(i.items)))throw new Error("No Items specified");switch(a++,i.ns=".contextMenu"+a,c||(u[i.selector]=i.ns),l[i.ns]=i,i.trigger||(i.trigger="right"),o||(r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on({"mouseup.contextMenu":f.itemClick,"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave},".context-menu-item"),o=!0),s.on("contextmenu"+i.ns,i.selector,i,f.contextmenu),c&&s.on("remove"+i.ns,function(){e(this).contextMenu("destroy")}),i.trigger){case"hover":s.on("mouseenter"+i.ns,i.selector,i,f.mouseenter).on("mouseleave"+i.ns,i.selector,i,f.mouseleave);break;case"left":s.on("click"+i.ns,i.selector,i,f.click)}i.build||g.create(i);break;case"destroy":var d;if(c){var p=i.context;e.each(l,function(t,n){if(n.context!==p)return!0;d=e(".context-menu-list").filter(":visible"),d.length&&d.data().contextMenuRoot.$trigger.is(e(n.context).find(n.selector))&&d.trigger("contextmenu:hide",{force:!0});try{l[n.ns].$menu&&l[n.ns].$menu.remove(),delete l[n.ns]}catch(i){l[n.ns]=null}return e(n.context).off(n.ns),!0})}else if(i.selector){if(u[i.selector]){d=e(".context-menu-list").filter(":visible"),d.length&&d.data().contextMenuRoot.$trigger.is(i.selector)&&d.trigger("contextmenu:hide",{force:!0});try{l[u[i.selector]].$menu&&l[u[i.selector]].$menu.remove(),delete l[u[i.selector]]}catch(m){l[u[i.selector]]=null}r.off(u[i.selector])}}else r.off(".contextMenu .contextMenuAutoHide"),e.each(l,function(t,n){e(n.context).off(n.ns)}),u={},l={},a=0,o=!1,e("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!e.support.htmlCommand&&!e.support.htmlMenuitem||"boolean"==typeof n&&n)&&e('menu[type="context"]').each(function(){this.id&&e.contextMenu({selector:"[contextmenu="+this.id+"]",items:e.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+t+'"')}return this},e.contextMenu.setInputValues=function(t,n){void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=n[e]||"";break;case"checkbox":t.selected=n[e]?!0:!1;break;case"radio":t.selected=(n[t.radio]||"")===t.value;break;case"select":t.selected=n[e]||""}})},e.contextMenu.getInputValues=function(t,n){return void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":n[e]=t.$input.val();break;case"checkbox":n[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(n[t.radio]=t.value)}}),n},e.contextMenu.fromMenu=function(t){var n=e(t),r={};return i(r,n.children()),r},e.contextMenu.defaults=h,e.contextMenu.types=c,e.contextMenu.handle=f,e.contextMenu.op=g,e.contextMenu.menus=l}),define("lib/jquery.fullscreen-min",["jquery"],function(e){function t(e){var t,n;return this.length?(t=this[0],t.ownerDocument?n=t.ownerDocument:(n=t,t=n.documentElement),null==e?n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen?(e=!!(n.fullscreenElement||n.msFullscreenElement||n.webkitIsFullScreen||n.mozFullScreen),e?n.fullscreenElement||n.webkitFullscreenElement||n.webkitCurrentFullScreenElement||n.msFullscreenElement||n.mozFullScreenElement||e:e):null:(e?(e=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen)&&e.call(t):(e=n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen)&&e.call(n),this)):this}e.fn.fullScreen=t,e.fn.toggleFullScreen=function(){return t.call(this,!t.call(this))};var n,i,r;n=document,n.webkitCancelFullScreen?(i="webkitfullscreenchange",r="webkitfullscreenerror"):n.msExitFullscreen?(i="MSFullscreenChange",r="MSFullscreenError"):n.mozCancelFullScreen?(i="mozfullscreenchange",r="mozfullscreenerror"):(i="fullscreenchange",r="fullscreenerror"),e(document).bind(i,function(){e(document).trigger(new e.Event("fullscreenchange"))}),e(document).bind(r,function(){e(document).trigger(new e.Event("fullscreenerror"))})}),define("cobweb/Browser/Core/ContextMenu",["jquery","cobweb/Basic/X3DBaseNode","lib/gettext","lib/jquery-contextMenu/dist/jquery.contextMenu","lib/jquery.fullscreen-min"],function(e,t,n){function i(i){t.call(this,i.getBrowser(),i),e("head").append('<style>.cobweb-menu-title:before { content: "'+n("Cobweb X3D Browser")+'" }</style>')}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"contextMenu"},initialize:function(){t.prototype.initialize.call(this),e.contextMenu({selector:".cobweb-surface",build:this.build.bind(this)})},build:function(t,i){var r=this.getBrowser().getActiveLayer(),o=r?r.getViewpoint():null,s=this.getBrowser().viewer_.getValue(),a=this.getBrowser().getElement().fullScreen(),u={className:"cobweb-menu cobweb-menu-title",items:{separator0:"--------",viewpoints:{name:n("Viewpoints"),className:"context-menu-icon cobweb-icon-viewpoint",items:this.getViewpoints(),callback:function(t){t&&(e(".context-menu-list").fadeOut(500),this.getBrowser().bindViewpoint(t),this.getBrowser().getCanvas().focus())}.bind(this,o)},separator1:"--------",viewer:{name:n(this.getViewerName(s)),className:"context-menu-icon cobweb-icon-"+s.toLowerCase()+"-viewer",callback:function(t){e(".context-menu-list").fadeOut(500),this.getBrowser().viewer_=t,this.getBrowser().getNotification().string_=n(this.getViewerName(t)),this.getBrowser().getCanvas().focus()}.bind(this,s)},"available-viewer":{name:n("Available Viewers"),items:this.getAvailableViewers()},separator2:"--------","primitive-quality":{name:n("Primitive Quality"),className:"context-menu-icon cobweb-icon-primitive-quality",items:{high:{name:n("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","HIGH"),this.getBrowser().getNotification().string_=n("Primitive Quality")+": "+n("high")}.bind(this)}},medium:{name:n("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","MEDIUM"),
this.getBrowser().getNotification().string_=n("Primitive Quality")+": "+n("medium")}.bind(this)}},low:{name:n("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){this.getBrowser().setBrowserOption("PrimitiveQuality","LOW"),this.getBrowser().getNotification().string_=n("Primitive Quality")+": "+n("low")}.bind(this)}}}},"texture-quality":{name:n("Texture Quality"),className:"context-menu-icon cobweb-icon-texture-quality",items:{high:{name:n("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","HIGH"),this.getBrowser().getNotification().string_=n("Texture Quality")+": "+n("high")}.bind(this)}},medium:{name:n("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","MEDIUM"),this.getBrowser().getNotification().string_=n("Texture Quality")+": "+n("medium")}.bind(this)}},low:{name:n("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){this.getBrowser().setBrowserOption("TextureQuality","LOW"),this.getBrowser().getNotification().string_=n("Texture Quality")+": "+n("low")}.bind(this)}}}},"display-rubberband":{name:n("Display Rubberband"),type:"checkbox",selected:this.getBrowser().getBrowserOption("Rubberband"),events:{click:function(){var e=!this.getBrowser().getBrowserOption("Rubberband");this.getBrowser().setBrowserOption("Rubberband",e),e?this.getBrowser().getNotification().string_=n("Rubberband")+": "+n("on"):this.getBrowser().getNotification().string_=n("Rubberband")+": "+n("off")}.bind(this)}},"browser-timings":{name:n("Browser Timings"),type:"checkbox",selected:this.getBrowser().getBrowserTimings().enabled_.getValue(),events:{click:function(){this.getBrowser().getBrowserTimings().enabled_=!this.getBrowser().getBrowserTimings().enabled_.getValue(),this.getBrowser().getCanvas().focus()}.bind(this)}},"mute-browser":{name:n("Mute Browser"),type:"checkbox",selected:this.getBrowser().mute_.getValue(),events:{click:function(){var e=!this.getBrowser().mute_.getValue();this.getBrowser().mute_=e,this.getBrowser().getNotification().string_=n(e?"Browser muted":"Browser unmuted")}.bind(this)}},fullscreen:{name:n(a?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(a?"cobweb-icon-leave-fullscreen":"cobweb-icon-fullscreen"),callback:function(){this.getBrowser().getElement().toggleFullScreen()}.bind(this)},separator3:"--------",about:{name:n("About Cobweb"),className:"context-menu-icon cobweb-icon-help-about",callback:function(){window.open("http://titania.create3000.de/cobweb")}}}};return e.isEmptyObject(u.items.viewpoints.items)&&(delete u.items.separator0,delete u.items.viewpoints),u},getViewpoints:function(){var t=this.getBrowser().getActiveLayer();if(!t)return{};for(var n=t.getViewpoints().get(),i=t.getViewpoint(),r={},o=0;o<n.length;++o){var s=n[o],a=s.description_.getValue();if(""!==a){var u={name:a,callback:function(t){e(".context-menu-list").fadeOut(500),this.getBrowser().bindViewpoint(t),this.getBrowser().getCanvas().focus()}.bind(this,s)};s===i&&(u.className="context-menu-selected"),r["Viewpoint"+s.getId()]=u}}return r},getAvailableViewers:function(){for(var t=this.getBrowser().viewer_.getValue(),i=this.getBrowser().availableViewers_,r={},o=0;o<i.length;++o){var s=i[o];r[s]={name:n(this.getViewerName(s)),className:"context-menu-icon cobweb-icon-"+s.toLowerCase()+"-viewer",callback:function(t){e(".context-menu-list").fadeOut(500),this.getBrowser().viewer_=t,this.getBrowser().getNotification().string_=n(this.getViewerName(t)),this.getBrowser().getCanvas().focus()}.bind(this,s)},s===t&&(r[s].className+=" context-menu-selected")}return r},getViewerName:function(e){switch(e){case"EXAMINE":return n("Examine Viewer");case"WALK":return n("Walk Viewer");case"FLY":return n("Fly Viewer");case"PLANE":return n("Plane Viewer");case"LOOKAT":return n("Look At Viewer");case"NONE":return n("None Viewer")}}}),i}),define("cobweb/Browser/Core/X3DCoreContext",["cobweb/Browser/Core/BrowserOptions","cobweb/Browser/Core/RenderingProperties","cobweb/Browser/Core/Notification","cobweb/Browser/Core/BrowserTimings","cobweb/Browser/Core/ContextMenu"],function(e,t,n,i,r){function o(e){var t=e.getContext("webgl")||e.getContext("experimental-webgl");if(t)return t;throw new Error("Couldn't create WebGL context.")}function s(s){this.element=s;var a=$("<div/>").addClass("cobweb-browser").prependTo(this.element),u=$("<div/>").addClass("cobweb-loading").appendTo(a),l=$("<div/>").addClass("cobweb-spinner").appendTo(u),c=$("<div/>").addClass("cobweb-surface").appendTo(a);$("<div/>").addClass("cobweb-spinner-one").appendTo(l),$("<div/>").addClass("cobweb-spinner-two").appendTo(l),$("<div/>").addClass("cobweb-spinner-three").appendTo(l),$("<div/>").addClass("cobweb-spinner-text").text("Lade 0 Dateien").appendTo(l),this.loading=u,this.canvas=$("<canvas/>").prependTo(c),this.context=o(this.canvas[0]),this.browserOptions=new e(this),this.renderingProperties=new t(this),this.notification=new n(this),this.browserTimings=new i(this),this.contextMenu=new r(this)}return s.prototype={initialize:function(){this.browserOptions.setup(),this.renderingProperties.setup(),this.notification.setup(),this.browserTimings.setup(),this.contextMenu.setup()},isStrict:function(){return!1},getElement:function(){return this.element},getLoadingElement:function(){return this.loading},getCanvas:function(){return this.canvas},getContext:function(){return this.context},getBrowserOptions:function(){return this.browserOptions},getRenderingProperties:function(){return this.renderingProperties},getNotification:function(){return this.notification},getBrowserTimings:function(){return this.browserTimings}},s}),define("cobweb/Routing/X3DRoutingContext",[],function(){function e(){this.taintedFields=[],this.taintedFieldsTemp=[],this.taintedNodes=[],this.taintedNodesTemp=[]}return e.prototype={constructor:e,initialize:function(){},addTaintedField:function(e,t){this.taintedFields.push(e,t)},addTaintedNode:function(e){this.taintedNodes.push(e)},processEvents:function(){do{do{var e=this.taintedFields;this.taintedFields=this.taintedFieldsTemp,this.taintedFields.length=0;for(var t=0,n=e.length;n>t;t+=2)e[t].processEvent(e[t+1]);this.taintedFieldsTemp=e}while(this.taintedFields.length);do{var i=this.taintedNodes;this.taintedNodes=this.taintedNodesTemp,this.taintedNodes.length=0;for(var t=0,n=i.length;n>t;++t)i[t].processEvents();this.taintedNodesTemp=i}while(!this.taintedFields.length&&this.taintedNodes.length)}while(this.taintedFields.length)}},e}),define("cobweb/Browser/Scripting/X3DScriptingContext",[],function(){function e(){this.scripts=[this]}return e.prototype={initialize:function(){},isExternal:function(){return 1===this.scripts.length},getScriptStack:function(){return this.scripts}},e}),define("cobweb/Bits/TraverseType",[],function(){var e=0,t={POINTER:e++,CAMERA:e++,COLLISION:e++,DISPLAY:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("cobweb/Components/Core/X3DNode",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,n){t.call(this,e,n),this.addType(i.X3DNode)}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,getCurrentLayer:function(){return this.getBrowser().getLayers()[0]},getCurrentViewport:function(){return this.getBrowser().getLayers()[0].getViewport()},getCurrentNavigationInfo:function(){return this.getBrowser().getLayers()[0].getNavigationInfo()},getCurrentViewpoint:function(){return this.getBrowser().getLayers()[0].getViewpoint()},getModelViewMatrix:function(e,t){return t.assign(this.getBrowser().getModelViewMatrix().get()),e===n.CAMERA&&t.multRight(this.getCurrentViewpoint().getInverseCameraSpaceMatrix()),t}}),r}),define("cobweb/Components/Core/X3DChildNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,r){this.getExecutionContext()||(n.call(this,e,r),this.addType(i.X3DChildNode),this.addChildren("isCameraObject",new t.SFBool))}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,setCameraObject:function(e){e!==this.isCameraObject_.getValue()&&(this.isCameraObject_=e)},getCameraObject:function(){return this.isCameraObject_.getValue()}}),r}),define("cobweb/Components/Core/X3DSensorNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DSensorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Networking/X3DNetworkSensorNode",["jquery","cobweb/Components/Core/X3DSensorNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DNetworkSensorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Bits/X3DCast",[],function(){return function(e,t){try{if(t&&(t.getValue&&(t=t.getValue()),t&&(t=t.getInnerNode(),-1!==t.getType().indexOf(e))))return t}catch(n){}return null}}),define("cobweb/Components/Networking/LoadSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Networking/X3DNetworkSensorNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"timeOut",new t.SFTime),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"isLoaded",new t.SFBool),new n(s.outputOnly,"progress",new t.SFFloat),new n(s.outputOnly,"loadTime",new t.SFTime),new n(s.inputOutput,"watchList",new t.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.timeOut_.addInterest(this,"set_timeOut__"),this.watchList_.addInterest(this,"set_watchList__"),this.watchList_.addEvent()},set_enabled__:function(){this.enabled_.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this.isActive_.getValue()&&(this.clearTimeout(),this.aborted=!1,this.timeOut_.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this.timeOut_.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(e,t){switch(t.checkLoadState()){case s.NOT_STARTED_STATE:break;case s.IN_PROGRESS_STATE:case s.COMPLETE_STATE:case s.FAILED_STATE:this.count()}},count:function(){for(var e=0,t=0,n=this.urlObjects,i=0,r=n.length;r>i;++i){var o=n[i];e+=o.checkLoadState()==s.COMPLETE_STATE,t+=o.checkLoadState()==s.FAILED_STATE}var a=e/n.length;if(this.aborted||t||e==n.length){var u=e==n.length;this.clearTimeout(),this.isActive_=!1,this.isLoaded_=u,this.progress_=a,u&&(this.loadTime_=this.getBrowser().getCurrentTime())}else this.isActive_.getValue()?this.progress_=a:(this.isActive_=!0,this.progress_=a,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this.enabled_.getValue()&&this.count()},reset:function(){if(this.remove(),this.enabled_.getValue()){for(var e=this.watchList_.getValue(),t=this.urlObjects,n=0,i=e.length;i>n;++n){var r=o(s.X3DUrlObject,e[n]);r&&(t.push(r),r.loadState_.addInterest(this,"set_loadState__",r))}this.count()}},remove:function(){this.clearTimeout();for(var e=this.urlObjects,t=0,n=e.length;n>t;++t)e[t].loadState_.removeInterest(this,"set_loadState__");e.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),a}),define("cobweb/Browser/Networking/urls",[],function(){return{provider:"http://titania.create3000.de/cobweb",fallback:"https://crossorigin.me/",fallbackRx:new RegExp("^https://crossorigin.me/")}}),define("standard/Networking/URI",["jquery"],function(e){function t(e,t){switch(arguments.length){case 2:this.value=e.split(t),this.value.separator=t,this.value.leadingSeparator=!1,this.value.trailingSeparator=!1,this.value.length&&""===this.value[0]&&(this.value.shift(),this.value.leadingSeparator=!0),this.value.length&&""===this.value[this.value.length-1]&&(this.value.pop(),this.value.trailingSeparator=!0);break;case 4:this.value=arguments[0],this.value.separator=arguments[1],this.value.leadingSeparator=arguments[2],this.value.trailingSeparator=arguments[3]}}function n(e,t){var n=s.exec(t);if(n){e.scheme=n[1]||"",e.slashs=n[2]||"",e.authority=n[3]||"",e.path=n[4]||"",e.query=n[5]||"",e.fragment=n[6]||"";var n=a.exec(e.authority);n&&(e.host=n[1]||"",e.port=n[2]?parseInt(n[2]):0,e.authority=e.host,e.port&&(e.authority+=":"+e.port)),e.absolute=Boolean(e.slashs.length)||"/"===e.path[0],e.local=/^(?:file|data)$/.test(e.scheme)||!e.scheme&&!e.authority}e.string=t}function i(e){return new t(e,"/").removeDotSegments().toString()}function r(e){switch(this.value={local:!0,absolute:!0,scheme:"",slashs:"",authority:"",host:"",port:0,path:"",query:"",fragment:"",string:""},arguments.length){case 0:break;case 1:n(this.value,e);break;case 10:this.value.local=arguments[0],this.value.absolute=arguments[1],this.value.scheme=arguments[2],this.value.slashs=arguments[3],this.value.authority=arguments[4],this.value.host=arguments[5],this.value.port=arguments[6],this.value.path=arguments[7],this.value.query=arguments[8],this.value.fragment=arguments[9],this.value.string=this.toString()}}t.prototype={copy:function(){return new t(this.value.slice(0,this.value.length),this.value.separator,this.value.leadingSeparator,this.value.trailingSeparator)},get origin(){return new t([],this.value.separator,!0,!1)},get base(){return this.value.trailingSeparator?this.copy():this.parent},get parent(){switch(this.value.length){case 0:case 1:return this.value.leadingSeparator?this.origin:new t([".."],this.value.separator,!1,!1);default:return new t(this.value.slice(0,this.value.length-1),this.value.separator,this.value.leadingSeparator,!0)}},getRelativePath:function(e){var n,i,r=new t([],"/",!1,!1),o=this.removeDotSegments().base,s=e.removeDotSegments();for(n=0;n<o.value.length&&n<s.value.length&&o.value[n]===s.value[n];++n);for(i=n;i<o.value.length;++i)r.value.push("..");for(i=n;i<s.value.length;++i)r.value.push(s.value[i]);return r},removeDotSegments:function(){var e=new t([],this.value.separator,this.value.leadingSeparator,this.value.trailingSeparator);if(this.value.length){for(var n=0;n<this.value.length;++n){var i=this.value[n];"."===i?e.value.trailingSeparator=!0:".."===i?(e.value.trailingSeparator=!0,e.value.length&&e.value.pop()):(e.value.trailingSeparator=!1,e.value.push(i))}e.value.trailingSeparator|=this.value.trailingSeparator}return e},toString:function(){var e="";return this.value.leadingSeparator&&(e+=this.value.separator),e+=this.value.join(this.value.separator),this.value.trailingSeparator&&(e+=this.value.separator),e}};var o={ftp:21,http:80,https:443,ftps:990},s=/^(?:([^:\/?#]*?):)?(?:(\/\/)([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,a=/^(.*?)(?:\:([^:]*))?$/;return r.prototype={copy:function(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,this.value.query,this.value.fragment)},get length(){return this.value.string.length},isRelative:function(){return!this.value.absolute()},isAbsolute:function(){return!this.value.absolute},isLocal:function(){return this.value.local},isNetwork:function(){return!this.value.local},isDirectory:function(){return this.value.path.length&&"/"===this.value.path[this.value.path.length-1]},isFile:function(){return!this.isDirectory()},get hierarchy(){var e="";return e+=this.value.slashs,e+=this.value.authority,e+=this.value.path},get authority(){return this.value.authority},get scheme(){return this.value.scheme},get host(){return this.value.host},get port(){return this.value.port},get wellKnownPort(){var e=o[this.value.scheme];return void 0!==e?e:0},get path(){return this.value.path},set query(e){this.value.query=e},get query(){return this.value.query},set fragment(e){this.value.fragment=e},get fragment(){return this.value.fragment},get location(){return this.toString()},get origin(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.local?"/":"","","")},get base(){return this.isDirectory()?new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,"",""):this.parent},get parent(){var e;if(this.isDirectory()){if(1==this.value.path.length)return"/";e=this.value.path.substr(0,this.value.path.length-1)}else e=this.path;var t=e.lastIndexOf("/");return e=-1==t?"":e.substring(0,e.lastIndexOf("/")+1),new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,e,"","")},get filename(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,this.value.path,"","")},get basename(){return this.value.path?this.value.path.substr(this.value.path.lastIndexOf("/")+1):""},get prefix(){if(this.value.path.length&&this.isFile()){var e=this.basename,t=this.suffix;return e.substr(0,e.length-t.length)}return this.basename},get suffix(){var e=this.value.path.lastIndexOf("."),t=this.value.path.lastIndexOf("/");return e>t?this.value.path.substr(e):""},transform:function(e){var t=!1,n=!1,o="",s="",a="",u="",l=0,c="",h="",d="";if(e.scheme.length)t=e.isLocal(),n=e.isAbsolute(),o=e.scheme,s=e.value.slashs,a=e.authority,u=e.host,l=e.port,c=e.path,h=e.query;else{if(e.authority.length)t=e.isLocal(),n=e.isAbsolute(),a=e.authority,u=e.host,l=e.port,c=e.path,h=e.query;else{if(0===e.path.length){var c=this.value.path;h=e.query.length?e.query:this.value.query}else{if("/"===e.path[0])c=e.path;else{var p=this.base;0===p.path.length?c="/":c+=p.path,c+=e.path}h=e.query}t=this.isLocal(),n=this.isAbsolute()||e.isAbsolute(),a=this.value.authority,u=this.value.host,l=this.value.port}o=this.value.scheme,s=this.value.slashs}return d=e.fragment,new r(t,n,o,s,a,u,l,i(c),h,d)},removeDotSegments:function(){return new r(this.value.local,this.value.absolute,this.value.scheme,this.value.slashs,this.value.authority,this.value.host,this.value.port,i(this.value.path),this.value.query,this.value.fragment)},getRelativePath:function(e){if(this.value.scheme!==e.scheme)return e;if(this.value.authority!==e.authority)return e;var n=new t(this.value.path,"/"),i=new t(e.path,"/");return new r(!0,!1,"","","","",0,n.getRelativePath(i).toString(),e.query,e.fragment)},escape:function(){return new r(escape(this.location))},unescape:function(){return new r(unescape(this.location))},toString:function(){var e=this.value.scheme;return this.value.scheme.length&&(e+=":"),e+=this.hierarchy,this.value.query.length&&(e+="?"+this.value.query),this.value.fragment.length&&(e+="#"+this.value.fragment),e}},r}),function(e){function t(){var e=arguments[0],n=t.cache;return n[e]&&n.hasOwnProperty(e)||(n[e]=t.parse(e)),t.format.call(null,n[e],arguments)}function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,t){return Array(t+1).join(e)}var r={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};t.format=function(e,o){var s,a,u,l,c,h,d,p=1,f=e.length,g="",m=[],y=!0,b="";for(a=0;f>a;a++)if(g=n(e[a]),"string"===g)m[m.length]=e[a];else if("array"===g){if(l=e[a],l[2])for(s=o[p],u=0;u<l[2].length;u++){if(!s.hasOwnProperty(l[2][u]))throw new Error(t("[sprintf] property '%s' does not exist",l[2][u]));s=s[l[2][u]]}else s=l[1]?o[l[1]]:o[p++];if("function"==n(s)&&(s=s()),r.not_string.test(l[8])&&r.not_json.test(l[8])&&"number"!=n(s)&&isNaN(s))throw new TypeError(t("[sprintf] expecting number but found %s",n(s)));switch(r.number.test(l[8])&&(y=s>=0),l[8]){case"b":s=s.toString(2);break;case"c":s=String.fromCharCode(s);break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,l[6]?parseInt(l[6]):0);break;case"e":s=l[7]?s.toExponential(l[7]):s.toExponential();break;case"f":s=l[7]?parseFloat(s).toFixed(l[7]):parseFloat(s);break;case"g":s=l[7]?parseFloat(s).toPrecision(l[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=String(s))&&l[7]?s.substring(0,l[7]):s;break;case"u":s>>>=0;break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}r.json.test(l[8])?m[m.length]=s:(!r.number.test(l[8])||y&&!l[3]?b="":(b=y?"+":"-",s=s.toString().replace(r.sign,"")),h=l[4]?"0"===l[4]?"0":l[4].charAt(1):" ",d=l[6]-(b+s).length,c=l[6]&&d>0?i(h,d):"",m[m.length]=l[5]?b+s+c:"0"===h?b+c+s:c+b+s)}return m.join("")},t.cache={},t.parse=function(e){for(var t=e,n=[],i=[],o=0;t;){if(null!==(n=r.text.exec(t)))i[i.length]=n[0];else if(null!==(n=r.modulo.exec(t)))i[i.length]="%";else{if(null===(n=r.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){o|=1;var s=[],a=n[2],u=[];if(null===(u=r.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(s[s.length]=u[1];""!==(a=a.substring(u[0].length));)if(null!==(u=r.key_access.exec(a)))s[s.length]=u[1];else{if(null===(u=r.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");s[s.length]=u[1]}n[2]=s}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=n}t=t.substring(n[0].length)}return i};var o=function(e,n,i){return i=(n||[]).slice(0),i.splice(0,0,e),t.apply(null,i)};"undefined"!=typeof exports?(exports.sprintf=t,exports.vsprintf=o):(e.sprintf=t,e.vsprintf=o,"function"==typeof define&&define.amd&&define("lib/sprintf.js/src/sprintf",[],function(){return{sprintf:t,vsprintf:o}}))}("undefined"==typeof window?this:window),define("cobweb/Browser/Networking/X3DNetworkingContext",["cobweb/Fields","cobweb/Components/Networking/LoadSensor","cobweb/Browser/Networking/urls","standard/Networking/URI","lib/sprintf.js/src/sprintf","lib/gettext"],function(e,t,n,i,r,o){function s(){this.cache="false"!=this.getElement()[0].getAttribute("cache"),this.addChildren("loadCount",new e.SFInt32),this.loadSensor=new t(this),this.loadingObjects={},this.location=new i(this.getElement()[0].baseURI),this.defaultScene=this.createScene(),this.privateScene=this.createScene(),this.browserLoading=!1}var a=0;return s.prototype={initialize:function(){this.loadSensor.setup(),this.defaultScene.setup(),this.defaultScene.beginUpdate(),this.privateScene.setup(),this.privateScene.beginUpdate()},getProviderUrl:function(){return n.provider},doCaching:function(){return this.cache},getLocation:function(){return this.location},getDefaultScene:function(){return this.defaultScene},getPrivateScene:function(){return this.privateScene},getLoadSensor:function(){return this.loadSensor},setBrowserLoading:function(e){this.browserLoading=e,e?(this.resetLoadCount(),this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getLoadingElement().stop(!0,!0).animate({delay:1},1).fadeIn(0)):(this.getLoadingElement().stop(!0,!0).fadeOut(2e3),this.getCanvas().stop(!0,!0).fadeIn(2e3))},addLoadCount:function(){var e=a++;return this.loadingObjects[e]=!0,this.setLoadCount(this.loadCount_=this.loadCount_.getValue()+1),this.setCursor("DEFAULT"),e},removeLoadCount:function(e){this.loadingObjects.hasOwnProperty(e)&&(delete this.loadingObjects[e],this.setLoadCount(this.loadCount_=this.loadCount_.getValue()-1))},setLoadCount:function(e){if(e)var t=r.sprintf(o(1==e?"Loading %d file":"Loading %d files"),e);else{var t=o("Loading done");this.setCursor("DEFAULT")}this.browserLoading||(this.getNotification().string_=t),this.getLoadingElement().find(".cobweb-spinner-text").text(t)},resetLoadCount:function(){this.loadCount_=0,this.loadingObjects={}}},s}),define("cobweb/Browser/Shaders/X3DShadersContext",[],function(){function e(){this.shaders={}}return e.prototype={initialize:function(){},getShadingLanguageVersion:function(){return this.getContext().getParameter(this.getContext().SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_ATTRIBS)},addShader:function(e){this.shaders[e.getId()]=e,e.setShading(this.getBrowserOptions().getShading())},removeShader:function(e){delete this.shaders[e.getId()]},getShaders:function(){return this.shaders}},e}),define("cobweb/Components/Shape/X3DAppearanceNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,t){n.call(this,e,t),this.addType(i.X3DAppearanceNode)}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,initialize:function(){n.prototype.initialize.call(this),this.addChildren("transparent",new t.SFBool)}}),r}),define("cobweb/Components/Shape/Appearance",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shape/X3DAppearanceNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.Appearance),this.linePropertiesNode=null,this.materialNode=null,this.textureNode=null,this.textureTransformNode=null,this.shaderNodes=[],this.shaderNode=null}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"fillProperties",new t.SFNode),new n(s.inputOutput,"lineProperties",new t.SFNode),new n(s.inputOutput,"material",new t.SFNode),new n(s.inputOutput,"texture",new t.SFNode),new n(s.inputOutput,"textureTransform",new t.SFNode),new n(s.inputOutput,"shaders",new t.MFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){r.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.lineProperties_.addInterest(this,"set_lineProperties__"),this.material_.addInterest(this,"set_material__"),this.texture_.addInterest(this,"set_texture__"),this.textureTransform_.addInterest(this,"set_textureTransform__"),this.shaders_.addInterest(this,"set_shaders__"),this.set_lineProperties__(),this.set_material__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__()},getLineProperties:function(){return this.linePropertiesNode},getMaterial:function(){return this.materialNode},getTexture:function(){return this.textureNode},getTextureTransform:function(){return this.textureTransformNode},set_lineProperties__:function(){this.linePropertiesNode=o(s.LineProperties,this.lineProperties_)},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.shaderNode&&this.getBrowser().addShader(this.shaderNode):this.shaderNode&&this.getBrowser().removeShader(this.shaderNode)},set_material__:function(){this.materialNode&&this.materialNode.transparent_.removeInterest(this,"set_transparent__"),this.materialNode=o(s.X3DMaterialNode,this.material_),this.materialNode&&this.materialNode.transparent_.addInterest(this,"set_transparent__"),this.set_transparent__()},set_texture__:function(){this.textureNode&&this.textureNode.transparent_.removeInterest(this,"set_transparent__"),this.textureNode=o(s.X3DTextureNode,this.texture_),this.textureNode&&this.textureNode.transparent_.addInterest(this,"set_transparent__"),this.set_transparent__()},set_textureTransform__:function(){this.textureTransformNode=o(s.X3DTextureTransformNode,this.textureTransform_),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform())},set_shaders__:function(){for(var e=this.shaders_.getValue(),t=this.shaderNodes,n=0,i=t.length;i>n;++n)t[n].isValid_.removeInterest(this,"set_shader__");t.length=0;for(var n=0,i=e.length;i>n;++n){var r=o(s.X3DShaderNode,e[n]);r&&(t.push(r),r.isValid_.addInterest(this,"set_shader__"))}this.set_shader__()},set_shader__:function(){var e=this.shaderNodes;this.shaderNode&&this.getBrowser().removeShader(this.shaderNode),this.shaderNode=null;for(var t=0,n=e.length;n>t;++t)if(e[t].isValid_.getValue()){this.shaderNode=e[t];break}this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()&&this.shaderNode&&this.getBrowser().addShader(this.shaderNode),this.set_transparent__()},set_transparent__:function(){this.transparent_=this.materialNode&&this.materialNode.transparent_.getValue()||this.textureNode&&this.textureNode.transparent_.getValue()},traverse:function(){var e=this.getBrowser();e.setAppearance(this),e.setShader(this.shaderNode||e.getDefaultShader())}}),a}),define("cobweb/Browser/Shape/X3DShapeContext",["cobweb/Components/Shape/Appearance"],function(e){function t(){this.defaultAppearance=new e(this),this.appearance=null,this.lineProperties=null}return t.prototype={initialize:function(){this.defaultAppearance.setup()},getDefaultAppearance:function(){return this.defaultAppearance},setAppearance:function(e){this.appearance=e},getAppearance:function(){return this.appearance},setLineProperties:function(e){this.lineProperties=e},getLineProperties:function(){return this.lineProperties}},t}),define("cobweb/Components/Shape/X3DAppearanceChildNode",["jquery","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DAppearanceChildNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Shaders/X3DShaderNode",["jquery","cobweb/Components/Shape/X3DAppearanceChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DShaderNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,pointsValue:!1,geometryTypeValue:3,custom:!0,shading:"GOURAUD",setCustom:function(e){this.custom=e},getCustom:function(){return this.custom},setGeometryType:function(e){this.geometryTypeValue=e,this.use(),this.getBrowser().getContext().uniform1i(this.geometryType,e)},getGeometryType:function(){return this.geometryTypeValue},setShading:function(e){var t=this.getBrowser().getContext();switch(this.shading=e,e){case"POINTSET":this.primitiveMode=t.POINTS,this.wireframe=!0;break;case"WIREFRAME":this.primitiveMode=t.LINE_LOOP,this.wireframe=!0;break;case"PHONG":this.primitiveMode=t.TRIANGLES,this.wireframe=!1;break;default:this.primitiveMode=t.TRIANGLES,this.wireframe=!1}},getShading:function(){return this.shading}}),i}),define("cobweb/Components/Shaders/X3DProgrammableShaderObject",["jquery","cobweb/Fields","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,t){this.addType(i.X3DProgrammableShaderObject)}var o=t.SFNode();return r.prototype={constructor:r,initialize:function(){this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__")},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.addShaderFields():this.removeShaderFields();
},hasUserDefinedFields:function(){return!0},addShaderFields:function(){if(this.isValid_.getValue()){var e=this.getBrowser().getContext(),t=this.getProgram(),n=this.getUserDefinedFields();this.use();for(var r in n){var o=n[r],s=e.getUniformLocation(t,r);if(s){switch(o.uniformLocation_=s,o.addInterest(this,"set_field__"),o.getType()){case i.SFImage:s.array=new Int32Array(3+o.array.length);break;case i.MFBool:case i.MFInt32:s.array=new Int32Array(this.getLocationLength(e,t,o));break;case i.MFFloat:case i.MFDouble:case i.MFTime:s.array=new Float32Array(this.getLocationLength(e,t,o));break;case i.MFImage:s.array=new Int32Array(this.getImagesLength(o));break;case i.MFMatrix3d:case i.MFMatrix3f:s.array=new Float32Array(9*this.getLocationLength(e,t,o));break;case i.MFMatrix4d:case i.MFMatrix4f:s.array=new Float32Array(16*this.getLocationLength(e,t,o));break;case i.MFNode:for(var a=o.uniformLocation_=[],u=0;;++u){var s=e.getUniformLocation(t,r+"["+u+"]");if(!s)break;a[u]=s}break;case i.MFVec2d:case i.MFVec2f:s.array=new Float32Array(2*this.getLocationLength(e,t,o));break;case i.MFVec3d:case i.MFVec3f:case i.MFColor:s.array=new Float32Array(3*this.getLocationLength(e,t,o));break;case i.MFVec4d:case i.MFVec4f:case i.MFColorRGBA:case i.MFRotation:s.array=new Float32Array(4*this.getLocationLength(e,t,o))}this.set_field__(o)}}}},removeShaderFields:function(){if(this.isValid_.getValue()){var e=this.getBrowser().getContext(),t=this.getProgram(),n=this.getUserDefinedFields();this.use();for(var r in n){var o=n[r];switch(o.removeInterest(this,"set_field__"),o.getType()){case i.SFNode:this.removeNode(e,t,o.uniformLocation_);break;case i.MFNode:for(var r=o.getName(),s=0;;++s){var a=e.getUniformLocation(t,r+"["+s+"]");if(!a)break;this.removeNode(e,t,a)}break;default:continue}break}}},set_field__:function(e){var t=this.getBrowser().getContext(),n=this.getProgram();switch(this.use(),e.getType()){case i.SFBool:case i.SFInt32:return void t.uniform1i(e.uniformLocation_,e.getValue());case i.SFColor:var r=e.getValue();return void t.uniform3f(e.uniformLocation_,r.r,r.g,r.b);case i.SFColorRGBA:var r=e.getValue();return void t.uniform4f(e.uniformLocation_,r.r,r.g,r.b,r.a);case i.SFDouble:case i.SFFloat:case i.SFTime:return void t.uniform1f(e.uniformLocation_,e.getValue());case i.SFImage:var s=e.uniformLocation_,a=s.array,u=e.array.getValue(),l=3+u.length;l!==a.length&&(a=s.array=new Int32Array(l)),a[0]=e.width,a[1]=e.height,a[2]=e.comp;for(var c=3,h=0,l=u.length;l>h;++h)a[c++]=u[h].getValue();return void t.uniform1iv(s,a);case i.SFMatrix3d:case i.SFMatrix3f:return this.matrix3f.set(e.getValue()),void t.uniformMatrix3fv(e.uniformLocation_,!1,this.matrix3f);case i.SFMatrix4d:case i.SFMatrix4f:return this.matrix4f.set(e.getValue()),void t.uniformMatrix4fv(e.uniformLocation_,!1,this.matrix4f);case i.SFNode:var s=e.uniformLocation_;return void this.setNode(t,n,s,e);case i.SFRotation:var d=e.getValue().quat;return void t.uniform4f(e.uniformLocation_,d.x,d.y,d.z,d.w);case i.SFString:return;case i.SFVec2d:case i.SFVec2f:var r=e.getValue();return void t.uniform2f(e.uniformLocation_,r.x,r.y);case i.SFVec3d:case i.SFVec3f:var r=e.getValue();return void t.uniform3f(e.uniformLocation_,r.x,r.y,r.z);case i.SFVec4d:case i.SFVec4f:var r=e.getValue();return void t.uniform4f(e.uniformLocation_,r.x,r.y,r.z,r.w);case i.MFBool:case i.MFInt32:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,l=r.length;l>p;++p)a[p]=r[p].getValue();for(var l=a.length;l>p;++p)a[p]=0;return void t.uniform1iv(e.uniformLocation_,a);case i.MFColor:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var g=r[p].getValue();a[f++]=g.r,a[f++]=g.g,a[f++]=g.b}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform3fv(e.uniformLocation_,a);case i.MFColorRGBA:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var g=r[p].getValue();a[f++]=g.r,a[f++]=g.g,a[f++]=g.b,a[f++]=g.a}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform4fv(e.uniformLocation_,a);case i.MFDouble:case i.MFFloat:case i.MFTime:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,l=r.length;l>p;++p)a[p]=r[p].getValue();for(var l=a.length;l>p;++p)a[p]=0;return void t.uniform1fv(e.uniformLocation_,a);case i.MFImage:var r=e.getValue(),s=e.uniformLocation_,a=s.array,l=this.getImagesLength(e);l!==a.length&&(a=s.array=new Int32Array(l));for(var p=0,c=0,l=r.length;l>p;++p){var r=e[p],u=r.array;a[c++]=r.width,a[c++]=r.height,a[c++]=r.comp;for(var h=0,l=u.length;l>h;++h)a[c++]=u[h].getValue()}return void t.uniform1iv(s,a);case i.MFMatrix3d:case i.MFMatrix3f:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var m=r[p].getValue();a[f++]=m[0],a[f++]=m[1],a[f++]=m[2],a[f++]=m[3],a[f++]=m[4],a[f++]=m[5],a[f++]=m[6],a[f++]=m[7],a[f++]=m[8]}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniformMatrix3fv(e.uniformLocation_,a);case i.MFMatrix4d:case i.MFMatrix4f:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var m=r[p].getValue();a[f++]=m[0],a[f++]=m[1],a[f++]=m[2],a[f++]=m[3],a[f++]=m[4],a[f++]=m[5],a[f++]=m[6],a[f++]=m[7],a[f++]=m[8],a[f++]=m[9],a[f++]=m[10],a[f++]=m[11],a[f++]=m[12],a[f++]=m[13],a[f++]=m[14],a[f++]=m[15]}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniformMatrix4fv(e.uniformLocation_,a);case i.MFNode:for(var r=e.getValue(),y=e.uniformLocation_,p=0,l=r.length;l>p;++p)this.setNode(t,n,y[p],r[p]);for(var l=y.length;l>p;++p)this.setNode(t,n,y[p],o);return;case i.MFRotation:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var d=r[p].getValue().quat;a[f++]=d.x,a[f++]=d.y,a[f++]=d.z,a[f++]=d.w}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform4fv(e.uniformLocation_,a);case i.MFString:return;case i.MFVec2d:case i.MFVec2f:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var b=r[p].getValue();a[f++]=b.x,a[f++]=b.y}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform2fv(e.uniformLocation_,a);case i.MFVec3d:case i.MFVec3f:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var b=r[p].getValue();a[f++]=b.x,a[f++]=b.y,a[f++]=b.z}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform3fv(e.uniformLocation_,a);case i.MFVec4d:case i.MFVec4f:for(var r=e.getValue(),a=e.uniformLocation_.array,p=0,f=0,l=r.length;l>p;++p){var b=r[p].getValue();a[f++]=b.x,a[f++]=b.y,a[f++]=b.z,a[f++]=b.w}for(var l=a.length;l>f;++f)a[f]=0;return void t.uniform4fv(e.uniformLocation_,a)}},setNode:function(e,t,r,o){if(r){var s=e.getUniform(t,r);if(!s){if(!this.getBrowser().getCombinedTextureUnits().length)return void console.warn("Not enough combined texture units for uniform variable '",o.getName(),"' available.");s=this.getBrowser().getCombinedTextureUnits().pop(),e.uniform1i(r,s)}e.activeTexture(e.TEXTURE0+s);var a=n(i.X3DTextureNode,o);a?e.bindTexture(a.getTarget(),a.getTexture()):e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}},removeNode:function(e,t,n){if(n){var i=e.getUniform(t,n);i&&this.getBrowser().getCombinedTextureUnits().push(i),e.uniform1i(n,0),e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}},getImagesLength:function(e){for(var t=e.getValue(),n=3*t.length,i=0,r=t.length;r>i;++i)n+=t[i].array.length;return n},getLocationLength:function(e,t,n){for(var i=n.getName(),r=0;;++r){var o=e.getUniformLocation(t,i+"["+r+"]");if(!o)break}return r}},r}),define("cobweb/Components/Shaders/ComposedShader",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shaders/X3DShaderNode","cobweb/Components/Shaders/X3DProgrammableShaderObject","cobweb/Components/Networking/LoadSensor","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(e,t,n,i,r,o,s,a,u,l){function c(e){this.fieldDefinitions=new i(g.slice(0)),r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(u.ComposedShader),this.loadSensor=new s(e),this.clipPlane=[],this.lightType=[],this.lightOn=[],this.lightColor=[],this.lightIntensity=[],this.lightAmbientIntensity=[],this.lightAttenuation=[],this.lightLocation=[],this.lightDirection=[],this.lightBeamWidth=[],this.lightCutOffAngle=[],this.lightRadius=[]}var h=6,d=8,p=1,f=null,g=[new n(u.inputOutput,"metadata",new t.SFNode),new n(u.inputOnly,"activate",new t.SFBool),new n(u.outputOnly,"isSelected",new t.SFBool),new n(u.outputOnly,"isValid",new t.SFBool),new n(u.initializeOnly,"language",new t.SFString),new n(u.inputOutput,"parts",new t.MFNode)];return c.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:c,wireframe:!1,normalMatrixArray:new Float32Array(9),maxClipPlanes:h,noClipPlane:new Float32Array(4),fogNode:null,maxLights:d,numGlobalLights:0,textureTypeArray:new Int32Array(p),getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.primitiveMode=e.TRIANGLES,this.activate_.addInterest(this,"set_activate__"),this.parts_.addFieldInterest(this.loadSensor.watchList_),this.loadSensor.isLoaded_.addInterest(this,"set_loaded__"),this.loadSensor.watchList_=this.parts_,this.loadSensor.setup()},getProgram:function(){return this.program},set_activate__:function(){this.activate_.getValue()&&this.set_loaded__()},set_loaded__:function(){if(this.loadSensor.isLoaded_.getValue()){var e=this.getBrowser().getContext(),t=e.createProgram(),n=this.parts_.getValue(),i=0;this.isValid_.getValue()&&this.removeShaderFields(),this.program=t;for(var r=0,o=n.length;o>r;++r){var s=a(u.ShaderPart,n[r]);s&&(i+=s.isValid(),e.attachShader(t,s.getShader()))}i&&(this.bindAttribLocations(e,t),e.linkProgram(t),i=i&&e.getProgramParameter(t,e.LINK_STATUS)),i!=this.isValid_.getValue()&&(this.isValid_=i),i?(this.getDefaultUniforms(),this.addShaderFields()):console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"'.")}else this.isValid_.getValue()&&(this.isValid_=!1)},bindAttribLocations:function(e,t){e.bindAttribLocation(t,3,"x3d_Color"),e.bindAttribLocation(t,2,"x3d_TexCoord"),e.bindAttribLocation(t,1,"x3d_Normal"),e.bindAttribLocation(t,0,"x3d_Vertex")},getDefaultUniforms:function(){var e=this.getBrowser().getContext(),t=this.program;f=this,e.useProgram(t),this.geometryType=e.getUniformLocation(t,"x3d_GeometryType");for(var n=0;n<this.maxClipPlanes;++n)this.clipPlane[n]=e.getUniformLocation(t,"x3d_ClipPlane["+n+"]");this.fogType=e.getUniformLocation(t,"x3d_FogType"),this.fogColor=e.getUniformLocation(t,"x3d_FogColor"),this.fogVisibilityRange=e.getUniformLocation(t,"x3d_FogVisibilityRange"),this.linewidthScaleFactor=e.getUniformLocation(t,"x3d_LinewidthScaleFactor"),this.lighting=e.getUniformLocation(t,"x3d_Lighting"),this.colorMaterial=e.getUniformLocation(t,"x3d_ColorMaterial");for(var n=0;n<this.maxLights;++n)this.lightType[n]=e.getUniformLocation(t,"x3d_LightType["+n+"]"),this.lightColor[n]=e.getUniformLocation(t,"x3d_LightColor["+n+"]"),this.lightAmbientIntensity[n]=e.getUniformLocation(t,"x3d_LightAmbientIntensity["+n+"]"),this.lightIntensity[n]=e.getUniformLocation(t,"x3d_LightIntensity["+n+"]"),this.lightAttenuation[n]=e.getUniformLocation(t,"x3d_LightAttenuation["+n+"]"),this.lightLocation[n]=e.getUniformLocation(t,"x3d_LightLocation["+n+"]"),this.lightDirection[n]=e.getUniformLocation(t,"x3d_LightDirection["+n+"]"),this.lightBeamWidth[n]=e.getUniformLocation(t,"x3d_LightBeamWidth["+n+"]"),this.lightCutOffAngle[n]=e.getUniformLocation(t,"x3d_LightCutOffAngle["+n+"]"),this.lightRadius[n]=e.getUniformLocation(t,"x3d_LightRadius["+n+"]");this.separateBackColor=e.getUniformLocation(t,"x3d_SeparateBackColor"),this.ambientIntensity=e.getUniformLocation(t,"x3d_AmbientIntensity"),this.diffuseColor=e.getUniformLocation(t,"x3d_DiffuseColor"),this.specularColor=e.getUniformLocation(t,"x3d_SpecularColor"),this.emissiveColor=e.getUniformLocation(t,"x3d_EmissiveColor"),this.shininess=e.getUniformLocation(t,"x3d_Shininess"),this.transparency=e.getUniformLocation(t,"x3d_Transparency"),this.backAmbientIntensity=e.getUniformLocation(t,"x3d_BackAmbientIntensity"),this.backDiffuseColor=e.getUniformLocation(t,"x3d_BackDiffuseColor"),this.backSpecularColor=e.getUniformLocation(t,"x3d_BackSpecularColor"),this.backEmissiveColor=e.getUniformLocation(t,"x3d_BackEmissiveColor"),this.backShininess=e.getUniformLocation(t,"x3d_BackShininess"),this.backTransparency=e.getUniformLocation(t,"x3d_BackTransparency"),this.textureType=e.getUniformLocation(t,"x3d_TextureType"),this.texture=e.getUniformLocation(t,"x3d_Texture"),this.cubeMapTexture=e.getUniformLocation(t,"x3d_CubeMapTexture"),this.textureMatrix=e.getUniformLocation(t,"x3d_TextureMatrix"),this.normalMatrix=e.getUniformLocation(t,"x3d_NormalMatrix"),this.projectionMatrix=e.getUniformLocation(t,"x3d_ProjectionMatrix"),this.modelViewMatrix=e.getUniformLocation(t,"x3d_ModelViewMatrix"),this.color=e.getAttribLocation(t,"x3d_Color"),this.texCoord=e.getAttribLocation(t,"x3d_TexCoord"),this.normal=e.getAttribLocation(t,"x3d_Normal"),this.vertex=e.getAttribLocation(t,"x3d_Vertex"),e.uniform1i(this.geometryType,this.getGeometryType()),e.uniform1f(this.linewidthScaleFactor,1),e.uniform1iv(this.textureType,new Int32Array([0])),e.uniform1iv(this.texture,new Int32Array([0])),e.uniform1iv(this.cubeMapTexture,new Int32Array([1]))},setGlobalUniforms:function(){var e=this.getBrowser(),t=e.getContext(),n=e.getGlobalLights();f=this,t.useProgram(this.program),t.uniformMatrix4fv(this.projectionMatrix,!1,e.getProjectionMatrixArray()),this.numGlobalLights=Math.min(this.maxLights,n.length);for(var i=0,r=this.numGlobalLights;r>i;++i)n[i].use(t,this,i)},setLocalUniforms:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getAppearance(),r=i.getLineProperties(),o=i.getMaterial(),s=i.getTexture(),a=e.modelViewMatrix,u=e.clipPlanes;if(this!==f&&(f=this,n.useProgram(this.program),t.setLineProperties(void 0)),u.length){for(var c=0,h=Math.min(this.maxClipPlanes,u.length);h>c;++c)u[c].use(n,this,c);c<this.maxClipPlanes&&n.uniform4fv(this.clipPlane[c],this.noClipPlane)}else n.uniform4fv(this.clipPlane[0],this.noClipPlane);if(e.fogNode!==this.fogNode&&(this.fogNode=e.fogNode,e.fogNode.use(n,this)),r!==t.getLineProperties())if(t.setLineProperties(r),r&&r.applied_.getValue()){var d=r.getLinewidthScaleFactor();n.lineWidth(d),n.uniform1f(this.linewidthScaleFactor,d)}else n.lineWidth(1),n.uniform1f(this.linewidthScaleFactor,1);if(n.uniform1i(this.colorMaterial,e.colorMaterial),o){for(var p=e.localLights,g=Math.min(this.maxLights,this.numGlobalLights+p.length),c=this.numGlobalLights,m=0;g>c;++c,++m)p[m].use(n,this,c);c<this.maxLights&&n.uniform1i(this.lightType[c],0),n.uniform1i(this.lighting,!0),n.uniform1f(this.ambientIntensity,o.ambientIntensity),n.uniform3fv(this.diffuseColor,o.diffuseColor),n.uniform3fv(this.specularColor,o.specularColor),n.uniform3fv(this.emissiveColor,o.emissiveColor),n.uniform1f(this.shininess,o.shininess),n.uniform1f(this.transparency,o.transparency),o.getSeparateBackColor()?(n.uniform1i(this.separateBackColor,!0),n.uniform1f(this.backAmbientIntensity,o.backAmbientIntensity),n.uniform3fv(this.backDiffuseColor,o.backDiffuseColor),n.uniform3fv(this.backSpecularColor,o.backSpecularColor),n.uniform3fv(this.backEmissiveColor,o.backEmissiveColor),n.uniform1f(this.backShininess,o.backShininess),n.uniform1f(this.backTransparency,o.backTransparency)):n.uniform1i(this.separateBackColor,!1);var y=this.normalMatrixArray;y[0]=a[0],y[1]=a[4],y[2]=a[8],y[3]=a[1],y[4]=a[5],y[5]=a[9],y[6]=a[2],y[7]=a[6],y[8]=a[10],l.prototype.inverse.call(y),n.uniformMatrix3fv(this.normalMatrix,!1,y)}else if(n.uniform1i(this.lighting,!1),this.getCustom()){var y=this.normalMatrixArray;y[0]=a[0],y[1]=a[4],y[2]=a[8],y[3]=a[1],y[4]=a[5],y[5]=a[9],y[6]=a[2],y[7]=a[6],y[8]=a[10],l.prototype.inverse.call(y),n.uniformMatrix3fv(this.normalMatrix,!1,y)}s?(s.traverse(n,this,0),i.getTextureTransform().traverse(),n.uniformMatrix4fv(this.textureMatrix,!1,t.getTextureTransform()[0].getMatrixArray())):(this.textureTypeArray[0]=0,n.uniform1iv(this.textureType,this.textureTypeArray),this.getCustom()&&(i.getTextureTransform().traverse(),n.uniformMatrix4fv(this.textureMatrix,!1,t.getTextureTransform()[0].getMatrixArray()))),n.uniformMatrix4fv(this.modelViewMatrix,!1,a)},use:function(){this!==f&&(f=this,this.getBrowser().getContext().useProgram(this.program))}}),c}),define("cobweb/Components/Networking/X3DUrlObject",["jquery","cobweb/Fields","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){this.addType(n.X3DUrlObject),this.addChildren("loadState",new t.SFInt32(n.NOT_STARTED_STATE))}return i.prototype={constructor:i,initialize:function(){},setLoadState:function(e,t){this.hasOwnProperty("loadId")&&(this.getBrowser().removeLoadCount(this.loadId),delete this.loadId),t!==!1&&e===n.IN_PROGRESS_STATE&&(this.loadId=this.getBrowser().addLoadCount()),this.loadState_=e},checkLoadState:function(){return this.loadState_.getValue()}},i}),define("cobweb/Configuration/X3DInfoArray",["jquery"],function(e){function t(){return this.array=[],this.index={},new Proxy(this,n)}var n={get:function(e,t){return t in e?e[t]:t in e.array?e.array[t]:e.index[t]},set:function(e,t,n){return!1},has:function(e,t){return t in e.array||t in e.index},enumerate:function(e){return Object.keys(e.array)[Symbol.iterator]()}};return e.extend(t.prototype,{constructor:t,add:function(e,t){this.array.push(t),this.index[e]=t},get:function(e){return this.index[e]}}),t}),define("cobweb/Configuration/ComponentInfoArray",["jquery","cobweb/Configuration/X3DInfoArray"],function(e,t){function n(e){var n=t.call(this);if(e)for(var i=0,r=e.length;r>i;++i)this.add(e[i].name,e[i]);return n}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n}),n}),define("cobweb/Prototype/ExternProtoDeclarationArray",["jquery","cobweb/Configuration/X3DInfoArray"],function(e,t){function n(e){return t.call(this)}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n}),n}),define("cobweb/Prototype/ProtoDeclarationArray",["jquery","cobweb/Configuration/X3DInfoArray"],function(e,t){function n(e){return t.call(this)}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n}),n}),define("cobweb/Routing/RouteArray",["jquery"],function(e){function t(){return this.array=[],new Proxy(this,n)}var n={get:function(e,t){return t in e?e[t]:e.array[t]},set:function(e,t,n){return!1}};return e.extend(t.prototype,{constructor:t,getValue:function(){return this.array}}),t}),define("cobweb/Routing/X3DRoute",["jquery","cobweb/Basic/X3DBaseNode"],function(e,t){function n(e,t,n,i){this.sourceNode_=e,this.sourceField_=t,this.destinationNode_=n,this.destinationField_=i,t.addFieldInterest(i)}return n.prototype={disconnect:function(){this.sourceField_.removeFieldInterest(this.destinationField_)},toString:function(){return Object.prototype.toString(this)}},Object.defineProperty(n.prototype,"sourceNode",{get:function(){return this.sourceNode_},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"sourceField",{get:function(){return this.sourceField_.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"destinationNode",{get:function(){return this.destinationNode_},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"destinationField",{get:function(){return this.destinationField_.getName()},enumerable:!0,configurable:!1}),n}),define("cobweb/Execution/X3DExecutionContext",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Basic/X3DBaseNode","cobweb/Configuration/ComponentInfoArray","cobweb/Prototype/ExternProtoDeclarationArray","cobweb/Prototype/ProtoDeclarationArray","cobweb/Routing/RouteArray","cobweb/Routing/X3DRoute","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Networking/URI"],function(e,t,n,i,r,o,s,a,u,l,c,h,d){function p(e,n){r.call(this,e,n),this.addChildren("rootNodes",new t.MFNode,"loadCount",new t.SFInt32),this.specificationVersion="3.3",this.encoding="SCRIPTED",this.profile=null,this.components=new o,this.url=new d(window.location),this.uninitializedNodes=[],this.namedNodes={},this.protos=new a,this.externprotos=new s,this.routes=new u,this.routeIndex={},this.endUpdate()}return p.prototype=e.extend(Object.create(r.prototype),{constructor:p,setup:function(){r.prototype.setup.call(this);for(var e=this.uninitializedNodes,t=0,n=e.length;n>t;++t)e[t].setup();e.length=0},isRootContext:function(){return!1},getWorldURL:function(){return this.getURL().location},setURL:function(e){this.url=e},getURL:function(){return this.url},setProfile:function(e){this.profile=e},addComponent:function(e){this.components.add(e.name,e)},createNode:function(e,n){var i=this.getBrowser().supportedNodes[e];if(!i)throw new Error("Unknown node type '"+e+"'.");var r=new i(this);return n===!1?r:(r.setup(),new t.SFNode(r))},createProto:function(e,t){for(var n=this;;){var i=n.protos[e];if(i)return i.createInstance(this,t);var r=n.externprotos[e];if(r)return r.createInstance(this,t);if(n.isRootContext())break;n=n.getExecutionContext()}throw new Error("Unknown proto or externproto type '"+e+"'.")},addUninitializedNode:function(e){this.uninitializedNodes.push(e)},addNamedNode:function(e,t){if(void 0!==this.namedNodes[e])throw new Error("Couldn't add named node: node name '"+e+"' is already in use.");this.updateNamedNode(e,t)},updateNamedNode:function(e,n){if(e=String(e),n instanceof r&&(n=new t.SFNode(n)),!(n instanceof t.SFNode))throw new Error("Couldn't update named node: node must be of type SFNode.");if(!n.getValue())throw new Error("Couldn't update named node: node IS NULL.");if(n.getValue().getExecutionContext()!==this)throw new Error("Couldn't update named node: the node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(n.getValue().getName()),this.removeNamedNode(e),n.getValue().setName(e),this.namedNodes[e]=new t.SFNode(n.getValue())},removeNamedNode:function(e){delete this.namedNodes[e]},getNamedNode:function(e){var t=this.namedNodes[e];if(void 0!==t)return t;throw new Error("Named node '"+e+"' not found.")},getLocalNode:function(e){try{return this.getNamedNode(e)}catch(t){try{return this.getImportedNode(e)}catch(t){throw new Error("Unknown named or imported node '"+e+"'.")}}},getImportedNode:function(e){throw new Error("Imported node '"+e+"' not found.")},setRootNodes:function(){},getRootNodes:function(){return this.rootNodes_},addRoute:function(e,t,n,i){try{if(!e.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!n.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");var r=e.getValue().getField(t),o=n.getValue().getField(i);if(!r.isOutput())throw new Error("Bad ROUTE specification: Field named '"+r.getName()+"' in node named '"+e.getNodeName()+"' of type "+e.getNodeTypeName()+" is not an output field.");if(!o.isInput())throw new Error("Bad ROUTE specification: Field named '"+o.getName()+"' in node named '"+n.getName()+"' of type "+n.getNodeTypeName()+" is not an input field.");var s=r.getId()+"."+o.getId(),a=new l(e,r,n,o);return this.routes.getValue().push(a),this.routeIndex[s]=a,a}catch(u){throw new Error("Bad ROUTE specification: "+u.message)}},deleteRoute:function(e){try{var t=e.sourceField_,n=e.destinationField_,i=t.getId()+"."+n.getId(),r=this.routes.getValue().indexOf(e);e.disconnect(),-1!==r&&this.routes.getValue().splice(r,1),delete this.routeIndex[i]}catch(o){console.log(o)}},getRoute:function(e,t,n,i){if(!e.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!n.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");var r=e.getValue().getField(t),o=n.getValue().getField(i),s=r.getId()+"."+o.getId();return this.routeIndex[s]},changeViewpoint:function(e){try{var t=this.getNamedNode(e),n=c(h.X3DViewpointNode,t);if(!n)throw 1;n.isBound_.getValue()?n.transitionStart(null,n):n.set_bind_=!0}catch(i){if(this.isRootContext())throw new Error("Viewpoint named '"+e+"' not found.");this.getExecutionContext().changeViewpoint(e)}},addLoadCount:function(e){this.loadCount_=this.loadCount_.getValue()+1},removeLoadCount:function(e){this.loadCount_=this.loadCount_.getValue()-1},requestAsyncLoadOfExternProtos:function(){this.loadCount_.setTainted(!1),this.loadCount_.addEvent();for(var e=0,t=this.externprotos.length;t>e;++e){var n=this.externprotos[e];0!==n.getInstances().length&&n.requestAsyncLoad()}for(var e=0,t=this.protos.length;t>e;++e){var i=this.protos[e];i.requestAsyncLoadOfExternProtos()}}}),Object.defineProperty(p.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(e){this.setRootNodes(e)},enumerable:!0,configurable:!1}),p}),define("cobweb/Components/Core/X3DPrototypeInstance",["jquery","cobweb/Basic/FieldDefinitionArray","cobweb/Fields","cobweb/Components/Core/X3DNode","cobweb/Execution/X3DExecutionContext","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e,s){this.protoNode=s,this.fieldDefinitions=new t(s.getFieldDefinitions().getValue().slice(0)),this.addChildren("isLiveX3DPrototypeInstance",new n.SFBool(!0)),i.call(this,e.getBrowser(),e),r.call(this,e.getBrowser(),e),this.addType(o.X3DPrototypeInstance),this.getRootNodes().setAccessType(o.initializeOnly),s.addInstance(this),s.isExternProto()?s.checkLoadState()===o.COMPLETE_STATE&&this.construct():this.construct()}return s.prototype=e.extend(Object.create(r.prototype),i.prototype,{constructor:s,create:function(e){return new s(e,this.protoNode)},getTypeName:function(){return this.protoNode.getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},construct:function(){var e=this.protoNode.getProtoDeclaration();if(e){if(this.metadata_=e.metadata_,this.protoNode.isExternProto())for(var t=e.getFieldDefinitions(),n=0,i=t.length;i>n;++n)try{var r=t[n],s=e.getField(r.name),a=this.getField(r.name);if(a.getAccessType()!==s.getAccessType())continue;if(a.getType()!==s.getType())continue;if(!(a.getAccessType()&o.initializeOnly))continue;if(a.getSet())continue;if(a.hasReferences())continue;a.set(s.getValue())}catch(u){this.addField(r)}this.setURL(e.getURL()),this.importExternProtos(e),this.importProtos(e),this.copyRootNodes(e)}},setup:function(){i.prototype.setup.call(this),r.prototype.setup.call(this)},initialize:function(){try{if(this.protoNode.isExternProto()&&this.construct(),this.protoNode.checkLoadState()===o.COMPLETE_STATE){var e=this.protoNode.getProtoDeclaration();e&&this.copyRoutes(e)}this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.set_live__(),r.prototype.initialize.call(this),i.prototype.initialize.call(this)}catch(t){console.log(t)}},getExtendedEventHandling:function(){return!1},isLive:function(){return this.isLiveX3DPrototypeInstance_},getInnerNode:function(){var e=this.getRootNodes();if(e.length){var t=e[0];if(t)return t.getValue().getInnerNode()}throw new Error("Root node not available.")},set_live__:function(){var e=this.getExecutionContext().isLive().getValue()&&i.prototype.isLive.call(this).getValue();e?this.beginUpdate():this.endUpdate()},importExternProtos:function(e){for(var t=e.externprotos,n=0,i=t.length;i>n;++n)this.externprotos.add(t[n].getName(),t[n])},importProtos:function(e){for(var t=e.protos,n=0,i=t.length;i>n;++n)this.protos.add(t[n].getName(),t[n])},copyRootNodes:function(e){for(var t=e.getRootNodes().getValue(),n=this.getRootNodes().getValue(),i=0,r=t.length;r>i;++i){var o=t[i].copy(this);o.addParent(this.getRootNodes()),n.push(o)}},copyRoutes:function(e){for(var t=e.routes,n=0,i=t.length;i>n;++n)try{var r=t[n];this.addRoute(this.getNamedNode(r.sourceNode.getNodeName()),r.sourceField,this.getNamedNode(r.destinationNode.getNodeName()),r.destinationField)}catch(o){console.log(o.message)}}}),s}),define("cobweb/Prototype/X3DProtoDeclarationNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DPrototypeInstance","cobweb/Bits/X3DConstants"],function(e,t,n,i,r){function o(e,t){n.call(this,e,t),this.addType(r.X3DProtoDeclarationNode),this.instances={}}return o.prototype=e.extend(Object.create(n.prototype),{constructor:o,hasUserDefinedFields:function(){return!0},createInstance:function(e,n){var r=new i(e?e:this.getExecutionContext(),this);return n===!1?r:(r.setup(),new t.SFNode(r))},addInstance:function(e){this.instances[e.getId()]=e},removeInstance:function(e){delete this.instances[e.getId()]},getInstances:function(){return this.instances}}),o}),define("cobweb/Prototype/X3DExternProtoDeclaration",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Networking/X3DUrlObject","cobweb/Prototype/X3DProtoDeclarationNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){this.fieldDefinitions=new i(u.slice(0)),o.call(this,e.getBrowser(),e),r.call(this,e.getBrowser(),e),this.addType(s.X3DExternProtoDeclaration),this.addChildren("url",new t.MFString),this.callbacks=[]}var u=[new n(s.inputOutput,"metadata",new t.SFNode)];return a.prototype=e.extend(Object.create(o.prototype),r.prototype,{constructor:a,getTypeName:function(){return"EXTERNPROTO"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"externprotos"},initialize:function(){o.prototype.initialize.call(this),r.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__")},set_live__:function(){if(this.checkLoadState()===s.COMPLETE_STATE){var e=this.getExecutionContext().isLive_.getValue()&&this.isLive_.getValue();e?this.scene.beginUpdate():this.scene.endUpdate()}},isExternProto:function(){return!0},setProtoDeclaration:function(e){this.proto=e},getProtoDeclaration:function(){return this.proto},requestAsyncLoad:function(){if(this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE){this.setLoadState(s.IN_PROGRESS_STATE),this.getScene().addLoadCount(this);var e=require("cobweb/InputOutput/Loader");new e(this).createX3DFromURL(this.url_,this.setSceneAsync.bind(this))}},setSceneAsync:function(e){this.getScene().removeLoadCount(this),e?this.setScene(e):(this.setLoadState(s.FAILED_STATE),this.scene=this.getBrowser().getPrivateScene(),this.setProtoDeclaration(null))},setScene:function(e){this.scene=e;try{this.setLoadState(s.COMPLETE_STATE),this.scene.isLive_=this.getExecutionContext().isLive_.getValue()&&this.isLive_.getValue(),this.scene.setup();var t=this.scene.getURL().fragment||0;this.setProtoDeclaration(this.scene.protos[t])}catch(n){console.log(n),this.setLoadState(s.FAILED_STATE),this.scene=this.getBrowser().getPrivateScene(),this.setProtoDeclaration(null)}}}),a}),define("cobweb/Prototype/X3DProtoDeclaration",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Execution/X3DExecutionContext","cobweb/Prototype/X3DProtoDeclarationNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){this.fieldDefinitions=new i(u.slice(0)),o.call(this,e.getBrowser(),e),r.call(this,e.getBrowser(),e),this.addType(s.X3DProtoDeclaration),this.addChildren("loadState",new t.SFInt32(s.NOT_STARTED_STATE))}var u=[new n(s.inputOutput,"metadata",new t.SFNode)];return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,getTypeName:function(){return"PROTO"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"protos"},initialize:function(){o.prototype.initialize.call(this),this.loadState_=s.COMPLETE_STATE},isExternProto:function(){return!1},getURL:function(){return this.getExecutionContext().getURL()},getProtoDeclaration:function(){
return this},checkLoadState:function(){return this.loadState_.getValue()}}),a}),define("cobweb/Parser/Parser",["jquery","cobweb/Fields","cobweb/Prototype/X3DExternProtoDeclaration","cobweb/Prototype/X3DProtoDeclaration","cobweb/Bits/X3DConstants"],function(e,t,n,i,r){function o(e){switch(e){case r.inializeOnly:return"initializeOnly";case r.inputOnly:return"inputOnly";case r.outputOnly:return"outputOnly";case r.inputOutput:return"inputOutput"}}function s(e){return this.lastIndex=e.lastIndex,e.result=this.exec(e.input),e.result?(e.lastIndex=this.lastIndex,!0):!1}function a(e,t,n){this.scene=e,this.isXML=n,this.executionContexts=[],this.setInput(t)}var u={Whitespaces:new RegExp("^([\\x20\\n,\\t\\r]+)","y"),Comment:new RegExp("^#(.*?)(?=[\\n\\r])","y"),Header:new RegExp("^#(VRML|X3D) V(.*?) (utf8)(?: (.*?))?[\\n\\r]"),COMPONENT:new RegExp("^COMPONENT","y"),DEF:new RegExp("^DEF","y"),EXTERNPROTO:new RegExp("^EXTERNPROTO","y"),FALSE:new RegExp("^FALSE","y"),"false":new RegExp("^false","y"),IS:new RegExp("^IS","y"),META:new RegExp("^META","y"),NULL:new RegExp("^NULL","y"),TRUE:new RegExp("^TRUE","y"),"true":new RegExp("^true","y"),PROFILE:new RegExp("^PROFILE","y"),PROTO:new RegExp("^PROTO","y"),ROUTE:new RegExp("^ROUTE","y"),TO:new RegExp("^TO","y"),UNIT:new RegExp("^UNIT","y"),USE:new RegExp("^USE","y"),OpenBrace:new RegExp("^\\{","y"),CloseBrace:new RegExp("^\\}","y"),OpenBracket:new RegExp("^\\[","y"),CloseBracket:new RegExp("^\\]","y"),Period:new RegExp("^\\.","y"),Colon:new RegExp("^\\:","y"),Id:new RegExp("^([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]*)","y"),ComponentNameId:new RegExp("^([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]*)","y"),initializeOnly:new RegExp("^initializeOnly","y"),inputOnly:new RegExp("^inputOnly","y"),outputOnly:new RegExp("^outputOnly","y"),inputOutput:new RegExp("^inputOutput","y"),field:new RegExp("^field","y"),eventIn:new RegExp("^eventIn","y"),eventOut:new RegExp("^eventOut","y"),exposedField:new RegExp("^exposedField","y"),FieldType:new RegExp("^(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)","y"),int32:new RegExp("^((?:0[xX][\\da-fA-F]+)|(?:[+-]?\\d+))","y"),"double":new RegExp("^([+-]?(?:(?:(?:\\d*\\.\\d+)|(?:\\d+(?:\\.)?))(?:[eE][+-]?\\d+)?))","y"),string:new RegExp('^"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"y"),Inf:new RegExp("^[+]?inf","yi"),NegativeInf:new RegExp("^-inf","yi"),NaN:new RegExp("^[+-]?nan","yi"),Break:new RegExp("\\r?\\n","g")};for(var l in u)u[l].parse=s;return Object.preventExtensions(u),Object.freeze(u),Object.seal(u),a.prototype={accessTypes:{field:r.initializeOnly,eventIn:r.inputOnly,eventOut:r.outputOnly,exposedField:r.inputOutput,initializeOnly:r.initializeOnly,inputOnly:r.inputOnly,outputOnly:r.outputOnly,inputOutput:r.inputOutput},SFBool:new t.SFBool,SFColor:new t.SFColor,SFColorRGBA:new t.SFColorRGBA,SFDouble:new t.SFDouble,SFFloat:new t.SFFloat,SFImage:new t.SFImage,SFInt32:new t.SFInt32,SFMatrix3f:new t.SFMatrix3f,SFMatrix3d:new t.SFMatrix3d,SFMatrix4f:new t.SFMatrix4f,SFMatrix4d:new t.SFMatrix4d,SFNode:new t.SFNode,SFRotation:new t.SFRotation,SFString:new t.SFString,SFTime:new t.SFTime,SFVec2d:new t.SFVec2d,SFVec2f:new t.SFVec2f,SFVec3d:new t.SFVec3d,SFVec3f:new t.SFVec3f,SFVec4d:new t.SFVec4d,SFVec4f:new t.SFVec4f,MFBool:new t.MFBool,MFColor:new t.MFColor,MFColorRGBA:new t.MFColorRGBA,MFDouble:new t.MFDouble,MFFloat:new t.MFFloat,MFImage:new t.MFImage,MFInt32:new t.MFInt32,MFMatrix3d:new t.MFMatrix3d,MFMatrix3f:new t.MFMatrix3f,MFMatrix4d:new t.MFMatrix4d,MFMatrix4f:new t.MFMatrix4f,MFNode:new t.MFNode,MFRotation:new t.MFRotation,MFString:new t.MFString,MFTime:new t.MFTime,MFVec2d:new t.MFVec2d,MFVec2f:new t.MFVec2f,MFVec3d:new t.MFVec3d,MFVec3f:new t.MFVec3f,MFVec4d:new t.MFVec4d,MFVec4f:new t.MFVec4f,setInput:function(e){this.input=e,this.lineNumber=1,this.lastIndex=0},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts[this.executionContexts.length-1]},pushExecutionContext:function(e){return this.executionContexts.push(e)},popExecutionContext:function(){this.executionContexts.pop()},isInsideProtoDefinition:function(){return this.executionContexts.length>1},addRootNode:function(e){this.getExecutionContext().rootNodes.push(e)},exception:function(e){if(this.getBrowser().isStrict())throw new Error(e);this.getBrowser().println(e)},parseIntoScene:function(){try{return void this.x3dScene()}catch(e){throw new Error(this.getError(e))}},getError:function(e){var t=e.message,n=this.getLine(),i=this.getLastLine(),r=this.getLastLine(),o=i.length-n.length+1;i.length>80&&(i=i.substr(o-40,80),r="",o=40);var s="\n********************************************************************************\nParser error at line "+this.lineNumber+":"+o+"\nin '"+this.scene.getURL()+"'\n\n"+r+"\n"+i+"\n"+Array(o).join(" ")+"^\n"+t+"\n********************************************************************************\n";return s},getLine:function(){for(var e=this.input,t=this.lastIndex,n="";t<e.length&&"\n"!==e[t]&&"\r"!==e[t];)n+=e[t++];return this.lastIndex=t,n},getLastLine:function(){var e=this.input,t=this.lastIndex,n="";for(t<e.length&&("\n"!==e[t]||"\r"!==e[t])&&--t;t>=0&&"\n"!==e[t]&&"\r"!==e[t];)n=e[t--]+n;return this.lastIndex=t,n},comments:function(){for(;this.comment(););},comment:function(){return this.whitespaces()?!0:u.Comment.parse(this)},whitespaces:function(){return u.Whitespaces.parse(this)?(this.xml||this.lines(this.result[1]),!0):!1},lines:function(e){var t=e.match(u.Break);t&&(this.lineNumber+=t.length)},x3dScene:function(){if(this.pushExecutionContext(this.scene),this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements(),this.statements(),this.popExecutionContext(this.scene),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){var e=u.Header.exec(this.input);return e?(this.scene.specificationVersion=e[2],this.scene.encoding="VRML",!0):!1},profileStatement:function(){if(this.comments(),u.PROFILE.parse(this)){if(this.profileNameId()){var e=this.getBrowser().getProfile(this.result[1]);return void this.scene.setProfile(e)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var e=this.componentStatement();e;)this.scene.addComponent(e),e=this.componentStatement()},componentStatement:function(){if(this.comments(),u.COMPONENT.parse(this)){if(this.componentNameId()){var e=this.result[1];if(this.comments(),u.Colon.parse(this)){if(this.componentSupportLevel()){var t=this.value;return this.getBrowser().getComponent(e,t)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),u.UNIT.parse(this)){if(this.categoryNameId()){var e=this.result[1];if(this.unitNameId()){var t=this.result[1];if(this.unitConversionFactor()){var n=this.value;try{return this.scene.updateUnit(e,t,n),!0}catch(i){console.log(i.message)}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identificator.")}throw new Error("Expected category name identificator after UNIT statement.")}return!1},unitConversionFactor:function(){return this["double"]()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),u.META.parse(this)){if(this.metakey()){var e=this.value;if(this.metavalue()){var t=this.value;return this.scene.setMetaData(e,t),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){return!1},importStatement:function(){return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var e=this.nodeStatement();return e!==!1?(this.addRootNode(e),!0):!1},nodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(u.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]);throw new Error("No name given after USE.")}return u.NULL.parse(this)?null:this.node("")},protoStatement:function(){return this.proto()?!0:this.externproto()?!0:!1},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),u.PROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.interfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.comments(),u.OpenBrace.parse(this)){for(var n=new i(this.getExecutionContext()),r=0,o=t.length;o>r;++r){var s=t[r];n.addUserDefinedField(s.getAccessType(),s.getName(),s)}if(this.pushExecutionContext(n),this.protoBody(),this.popExecutionContext(),this.comments(),u.CloseBrace.parse(this))return n.setName(e),n.setup(),this.getExecutionContext().protos.add(e,n),!0;throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var e=this.rootNodeStatement();e!==!1&&this.addRootNode(e),this.statements()},rootNodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId()){var e=this.result[0],t=this.node(e);if(t!==!1)return t;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var t=this.node("");return t!==!1?t:!1},interfaceDeclarations:function(){for(var e=[],t=this.interfaceDeclaration();t;)e.push(t),t=this.interfaceDeclaration();return e},restrictedInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.inputOnly),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.outputOnly),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],n=new this[e].constructor;if(this.fieldValue(n))return n.setAccessType(r.initializeOnly),n.setName(t),n;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){var e=this.restrictedInterfaceDeclaration();if(e)return e;if(this.comments(),u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var n=this.result[1],e=new this[t].constructor;if(this.fieldValue(e))return e.setAccessType(r.inputOutput),e.setName(n),e;throw new Error("Couldn't read value for field '"+n+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),u.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.externInterfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var i=new n(this.getExecutionContext()),r=0,o=t.length;o>r;++r){var s=t[r];i.addUserDefinedField(s.getAccessType(),s.getName(),s)}return i.setName(e),i.url_=this.MFString,i.setup(),this.getExecutionContext().externprotos.add(e,i),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+e+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var e=[],t=this.externInterfaceDeclaration();t;)e.push(t),t=this.externInterfaceDeclaration();return e},externInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.inputOnly),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.outputOnly),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.initializeOnly),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOutputId()){var t=this.result[1],n=new this[e].constructor;return n.setAccessType(r.inputOutput),n.setName(t),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(e){return this.mfstringValue(e)},routeStatement:function(){if(this.comments(),u.ROUTE.parse(this)){if(this.nodeNameId()){var e=this.result[1],t=this.getExecutionContext().getLocalNode(e);if(this.comments(),u.Period.parse(this)){if(this.outputOnlyId()){var n=this.result[1];if(this.comments(),u.TO.parse(this)){if(this.nodeNameId()){var i=this.result[1],r=this.getExecutionContext().getLocalNode(i);if(this.comments(),u.Period.parse(this)){if(this.inputOnlyId())try{var o=this.result[1];return this.getExecutionContext().addRoute(t,n,r,o),!0}catch(s){return this.exception(s.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(e){if(this.nodeTypeId()){var t=this.result[1];try{var n=this.getExecutionContext().createNode(t,!1)}catch(i){try{var n=this.getExecutionContext().createProto(t,!1)}catch(r){throw new Error(i.message+"\n"+r.message)}}if(e.length&&this.getExecutionContext().updateNamedNode(e,n),this.comments(),u.OpenBrace.parse(this)){if(n.hasUserDefinedFields()?this.scriptBody(n):this.nodeBody(n),this.comments(),u.CloseBrace.parse(this))return this.getExecutionContext().addUninitializedNode(n),n;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(e){for(;this.scriptBodyElement(e););},scriptBodyElement:function(e){var t=this.lastIndex,n=this.lineNumber;if(this.Id()){var i=this.accessTypes[this.result[1]];if(i&&this.fieldType()){var s=this.result[1];if(this.Id()){var a=this.result[1];if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var l=this.result[1];try{var c=this.getExecutionContext().getField(l)}catch(h){return this.exception("No such event or field '"+l+"' inside PROTO "+this.getExecutionContext().getName()+" interface declaration."),!0}var d=this[s];if(d.getType()===c.getType()){if(c.isReference(i)){try{var p=e.getField(a);if(c.getType()===p.getType())if(i===p.getAccessType());else{if(p.getAccessType()!==r.inputOutput)return this.exception("Field '"+a+"' must have access type "+o(p.getAccessType())+"."),!0;i!==p.getAccessType()&&(p=this.createUserDefinedField(e,i,a,d))}else p=this.createUserDefinedField(e,i,a,d)}catch(h){var p=this.createUserDefinedField(e,i,a,d)}return p.addReference(c),!0}throw new Error("Field '"+a+"' and '"+c.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+a+"' and '"+c.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}this.lastIndex=t,this.lineNumber=n;var p=this.interfaceDeclaration();if(p){try{if(p.getAccessType()===r.inputOutput){var f=e.getField(p.getName());if(f.getAccessType()===r.inputOutput&&p.getType()===f.getType())return f.set(p.getValue()),f.setSet(!0),!0}}catch(h){}return e.addUserDefinedField(p.getAccessType(),p.getName(),p),!0}return this.nodeBodyElement(e)},createUserDefinedField:function(e,t,n,i){var r=new i.constructor;return e.addUserDefinedField(t,n,r),r},nodeBody:function(e){for(;this.nodeBodyElement(e););},nodeBodyElement:function(e){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var t=this.result[1];try{var n=e.getField(t)}catch(i){throw new Error("Unknown field '"+t+"' in class '"+e.getTypeName()+"'.")}if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var r=this.result[1];try{var s=this.getExecutionContext().getField(r)}catch(i){return this.exception("No such event or field '"+r+"' inside PROTO "+this.getExecutionContext().getName()),!0}if(n.getType()===s.getType()){if(s.isReference(n.getAccessType()))return n.addReference(s),!0;throw new Error("Field '"+n.getName()+"' and '"+s.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+n.getName()+"' and '"+s.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(n.isInitializable()){if(this.fieldValue(n))return!0;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Couldn't assign value to "+o(n.getAccessType())+" field '"+t+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),u.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),u.Id.parse(this)},fieldType:function(){return this.comments(),u.FieldType.parse(this)},fieldValue:function(e){return e.setSet(!0),this.fieldTypes[e.getType()].call(this,e)},"double":function(){return this.comments(),u["double"].parse(this)?(this.value=parseFloat(this.result[1]),!0):u.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):u.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):u.NaN.parse(this)?(this.value=Number.NaN,!0):!1},int32:function(){return this.comments(),u.int32.parse(this)?(this.value=parseInt(this.result[1]),!0):!1},string:function(){return this.comments(),u.string.parse(this)?(this.value=t.SFString.unescape(this.result[1]),this.isXML||this.lines(this.value),!0):!1},sfboolValue:function(e){if(this.comments(),this.isXML){if(u["true"].parse(this))return e.set(!0),!0;if(u["false"].parse(this))return e.set(!1),!0}return u.TRUE.parse(this)?(e.set(!0),!0):u.FALSE.parse(this)?(e.set(!1),!0):!1},mfboolValue:function(e){if(e.length=0,this.sfboolValue(this.SFBool))return e.push(this.SFBool),!0;if(u.OpenBracket.parse(this)){if(this.sfboolValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFBool;this.sfboolValue(i);)i.addParent(e),n.push(i),i=new t.SFBool},sfcolorValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;return e.getValue().set(t,n,i),!0}}}return!1},mfcolorValue:function(e){if(e.length=0,this.sfcolorValue(this.SFColor))return e.push(this.SFColor),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFColor;this.sfcolorValue(i);)i.addParent(e),n.push(i),i=new t.SFColor},sfcolorrgbaValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;if(this["double"]()){var r=this.value;return e.getValue().set(t,n,i,r),!0}}}}return!1},mfcolorrgbaValue:function(e){if(e.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return e.push(this.SFColorRGBA),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFColorRGBA;this.sfcolorrgbaValue(i);)i.addParent(e),n.push(i),i=new t.SFColorRGBA},sfdoubleValue:function(e){return this["double"]()?(e.set(this.value),!0):!1},mfdoubleValue:function(e){if(e.length=0,this.sfdoubleValue(this.SFDouble))return e.push(this.SFDouble),!0;if(u.OpenBracket.parse(this)){if(this.sfdoubleValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFDouble;this.sfdoubleValue(i);)i.addParent(e),n.push(i),i=new t.SFDouble},sffloatValue:function(e){return this.sfdoubleValue(e)},mffloatValue:function(e){if(e.length=0,this.sffloatValue(this.SFFloat))return e.push(this.SFFloat),!0;if(u.OpenBracket.parse(this)){if(this.sffloatValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFFloat;this.sffloatValue(i);)i.addParent(e),n.push(i),i=new t.SFFloat},sfimageValue:function(e){if(this.int32()){var t=this.value;if(this.int32()){var n=this.value;if(this.int32()){for(var i=this.value,r=[],o=t*n,s=0;o>s;++s){if(!this.int32())return!1;r.push(this.value)}return e.getValue().set(t,n,i,r),!0}}}return!1},mfimageValue:function(e){if(e.length=0,this.sfimageValue(this.SFImage))return e.push(this.SFImage),!0;if(u.OpenBracket.parse(this)){if(this.sfimageValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFImage;this.sfimageValue(i);)i.addParent(e),n.push(i),i=new t.SFImage},sfint32Value:function(e){return this.int32()?(e.set(this.value),!0):!1},mfint32Value:function(e){if(e.length=0,this.sfint32Value(this.SFInt32))return e.push(this.SFInt32),!0;if(u.OpenBracket.parse(this)){if(this.sfint32Values(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFInt32;this.sfint32Value(i);)i.addParent(e),n.push(i),i=new t.SFInt32},sfmatrix3dValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;if(this["double"]()){var r=this.value;if(this["double"]()){var o=this.value;if(this["double"]()){var s=this.value;if(this["double"]()){var a=this.value;if(this["double"]()){var u=this.value;if(this["double"]()){var l=this.value;return e.getValue().set(t,n,i,r,o,s,a,u,l),!0}}}}}}}}}return!1},mfmatrix3dValue:function(e){if(e.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return e.push(this.SFMatrix3d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFMatrix3d;this.sfmatrix3dValue(i);)i.addParent(e),n.push(i),i=new t.SFMatrix3d},sfmatrix3fValue:function(e){return this.sfmatrix3dValue(e)},mfmatrix3fValue:function(e){if(e.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return e.push(this.SFMatrix3f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFMatrix3f;this.sfmatrix3fValue(i);)i.addParent(e),n.push(i),i=new t.SFMatrix3f},sfmatrix4dValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;if(this["double"]()){var r=this.value;if(this["double"]()){var o=this.value;if(this["double"]()){var s=this.value;if(this["double"]()){var a=this.value;if(this["double"]()){var u=this.value;if(this["double"]()){var l=this.value;if(this["double"]()){var c=this.value;if(this["double"]()){var h=this.value;if(this["double"]()){var d=this.value;if(this["double"]()){var p=this.value;if(this["double"]()){var f=this.value;if(this["double"]()){var g=this.value;if(this["double"]()){var m=this.value;return e.getValue().set(t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m),!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(e){if(e.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return e.push(this.SFMatrix4d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFMatrix4d;this.sfmatrix4dValue(i);)i.addParent(e),n.push(i),i=new t.SFMatrix4d},sfmatrix4fValue:function(e){return this.sfmatrix4dValue(e)},mfmatrix4fValue:function(e){if(e.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return e.push(this.SFMatrix4f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFMatrix4f;this.sfmatrix4fValue(i);)i.addParent(e),n.push(i),i=new t.SFMatrix4f},sfnodeValue:function(e){var t=this.nodeStatement();return t!==!1?(e.setValue(t),!0):!1},mfnodeValue:function(e){e.length=0;var t=this.nodeStatement();if(t!==!1)return e.push(t),!0;if(u.OpenBracket.parse(this)){if(this.nodeStatements(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(e){for(var t=this.nodeStatement();t!==!1;)e.push(t),t=this.nodeStatement()},sfrotationValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;if(this["double"]()){var r=this.value;return e.getValue().set(t,n,i,r),!0}}}}return!1},mfrotationValue:function(e){if(e.length=0,this.sfrotationValue(this.SFRotation))return e.push(this.SFRotation),!0;if(u.OpenBracket.parse(this)){if(this.sfrotationValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFRotation;this.sfrotationValue(i);)i.addParent(e),n.push(i),i=new t.SFRotation},sfstringValue:function(e){return this.string()?(e.set(this.value),!0):!1},mfstringValue:function(e){if(e.length=0,this.sfstringValue(this.SFString))return e.push(this.SFString),!0;if(u.OpenBracket.parse(this)){if(this.sfstringValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFString;this.sfstringValue(i);)i.addParent(e),n.push(i),i=new t.SFString},sftimeValue:function(e){return this.sfdoubleValue(e)},mftimeValue:function(e){if(e.length=0,this.sftimeValue(this.SFTime))return e.push(this.SFTime),!0;if(u.OpenBracket.parse(this)){if(this.sftimeValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFTime;this.sftimeValue(i);)i.addParent(e),n.push(i),i=new t.SFTime},sfvec2dValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;return e.getValue().set(t,n),!0}}return!1},mfvec2dValue:function(e){if(e.length=0,this.sfvec2dValue(this.SFVec2d))return e.push(this.SFVec2d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec2d;this.sfvec2dValue(i);)i.addParent(e),n.push(i),i=new t.SFVec2d},sfvec2fValue:function(e){return this.sfvec2dValue(e)},mfvec2fValue:function(e){if(e.length=0,this.sfvec2fValue(this.SFVec2f))return e.push(this.SFVec2f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec2f;this.sfvec2fValue(i);)i.addParent(e),n.push(i),i=new t.SFVec2f},sfvec3dValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;return e.getValue().set(t,n,i),!0}}}return!1},mfvec3dValue:function(e){if(e.length=0,this.sfvec3dValue(this.SFVec3d))return e.push(this.SFVec3d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec3d;this.sfvec3dValue(i);)i.addParent(e),n.push(i),i=new t.SFVec3d},sfvec3fValue:function(e){return this.sfvec3dValue(e)},mfvec3fValue:function(e){if(e.length=0,this.sfvec3fValue(this.SFVec3f))return e.push(this.SFVec3f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec3f;this.sfvec3fValue(i);)i.addParent(e),n.push(i),i=new t.SFVec3f},sfvec4dValue:function(e){if(this["double"]()){var t=this.value;if(this["double"]()){var n=this.value;if(this["double"]()){var i=this.value;if(this["double"]()){var r=this.value;return e.getValue().set(t,n,i,r),!0}}}}return!1},mfvec4dValue:function(e){
if(e.length=0,this.sfvec4dValue(this.SFVec4d))return e.push(this.SFVec4d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec4d;this.sfvec4dValue(i);)i.addParent(e),n.push(i),i=new t.SFVec4d},sfvec4fValue:function(e){return this.sfvec4dValue(e)},mfvec4fValue:function(e){if(e.length=0,this.sfvec4fValue(this.SFVec4f))return e.push(this.SFVec4f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(e){e.length=0;for(var n=e.getValue(),i=new t.SFVec4f;this.sfvec4Value(i);)i.addParent(e),n.push(i),i=new t.SFVec4f}},a.prototype.fieldTypes=[],a.prototype.fieldTypes[r.SFBool]=a.prototype.sfboolValue,a.prototype.fieldTypes[r.SFColor]=a.prototype.sfcolorValue,a.prototype.fieldTypes[r.SFColorRGBA]=a.prototype.sfcolorrgbaValue,a.prototype.fieldTypes[r.SFDouble]=a.prototype.sfdoubleValue,a.prototype.fieldTypes[r.SFFloat]=a.prototype.sffloatValue,a.prototype.fieldTypes[r.SFImage]=a.prototype.sfimageValue,a.prototype.fieldTypes[r.SFInt32]=a.prototype.sfint32Value,a.prototype.fieldTypes[r.SFMatrix3f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix3d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFMatrix4f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix4d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFNode]=a.prototype.sfnodeValue,a.prototype.fieldTypes[r.SFRotation]=a.prototype.sfrotationValue,a.prototype.fieldTypes[r.SFString]=a.prototype.sfstringValue,a.prototype.fieldTypes[r.SFTime]=a.prototype.sftimeValue,a.prototype.fieldTypes[r.SFVec2d]=a.prototype.sfvec2dValue,a.prototype.fieldTypes[r.SFVec2f]=a.prototype.sfvec2fValue,a.prototype.fieldTypes[r.SFVec3d]=a.prototype.sfvec3dValue,a.prototype.fieldTypes[r.SFVec3f]=a.prototype.sfvec3fValue,a.prototype.fieldTypes[r.SFVec4d]=a.prototype.sfvec4dValue,a.prototype.fieldTypes[r.SFVec4f]=a.prototype.sfvec4fValue,a.prototype.fieldTypes[r.MFBool]=a.prototype.mfboolValue,a.prototype.fieldTypes[r.MFColor]=a.prototype.mfcolorValue,a.prototype.fieldTypes[r.MFColorRGBA]=a.prototype.mfcolorrgbaValue,a.prototype.fieldTypes[r.MFDouble]=a.prototype.mfdoubleValue,a.prototype.fieldTypes[r.MFFloat]=a.prototype.mffloatValue,a.prototype.fieldTypes[r.MFImage]=a.prototype.mfimageValue,a.prototype.fieldTypes[r.MFInt32]=a.prototype.mfint32Value,a.prototype.fieldTypes[r.MFMatrix3d]=a.prototype.mfmatrix3dValue,a.prototype.fieldTypes[r.MFMatrix3f]=a.prototype.mfmatrix3fValue,a.prototype.fieldTypes[r.MFMatrix4d]=a.prototype.mfmatrix4dValue,a.prototype.fieldTypes[r.MFMatrix4f]=a.prototype.mfmatrix4fValue,a.prototype.fieldTypes[r.MFNode]=a.prototype.mfnodeValue,a.prototype.fieldTypes[r.MFRotation]=a.prototype.mfrotationValue,a.prototype.fieldTypes[r.MFString]=a.prototype.mfstringValue,a.prototype.fieldTypes[r.MFTime]=a.prototype.mftimeValue,a.prototype.fieldTypes[r.MFVec2d]=a.prototype.mfvec2dValue,a.prototype.fieldTypes[r.MFVec2f]=a.prototype.mfvec2fValue,a.prototype.fieldTypes[r.MFVec3d]=a.prototype.mfvec3dValue,a.prototype.fieldTypes[r.MFVec3f]=a.prototype.mfvec3fValue,a.prototype.fieldTypes[r.MFVec4d]=a.prototype.mfvec4dValue,a.prototype.fieldTypes[r.MFVec4f]=a.prototype.mfvec4fValue,a}),define("cobweb/Parser/XMLParser",["jquery","cobweb/Basic/X3DField","cobweb/Basic/X3DArrayField","cobweb/Fields","cobweb/Parser/Parser","cobweb/Prototype/X3DExternProtoDeclaration","cobweb/Prototype/X3DProtoDeclaration","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e,t){this.scene=e,this.xml=t,this.executionContexts=[e],this.protoDeclarations=[],this.parents=[],this.parser=new r(this.scene,"",!0),this.url=new i.MFString}var l={initializeOnly:a.initializeOnly,inputOnly:a.inputOnly,outputOnly:a.outputOnly,inputOutput:a.inputOutput};return u.prototype={constructor:u,getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts[this.executionContexts.length-1]},pushExecutionContext:function(e){return this.executionContexts.push(e)},popExecutionContext:function(){this.executionContexts.pop()},getParent:function(){return this.parents[this.parents.length-1]},pushParent:function(e){return this.parents.push(e)},popParent:function(){this.parents.pop()},parseIntoScene:function(){switch(this.xml.nodeName){case"#document":var t=e(this.xml).children("X3D");if(t.length)for(var n=0;n<t.length;++n)this.X3D(t[n]);else this.Scene(this.xml);break;case"X3D":this.X3D(this.xml);break;case"Scene":this.Scene(this.xml);break;default:this.statement(this.xml)}},X3D:function(e){this.profile(e);var t=e.getAttribute("version");t&&(this.scene.specificationVersion=t),this.scene.encoding="XML";for(var n=e.childNodes,i=0;i<n.length;++i){var e=n[i];switch(e.nodeName){case"head":this.head(e);continue;case"Scene":this.Scene(e);continue}}},profile:function(e){try{var t=e.getAttribute("profile"),n=this.getBrowser().getProfile(t||"Full");this.scene.setProfile(n)}catch(i){console.log(i)}},head:function(e){for(var t=e.childNodes,n=0;n<t.length;++n){var e=t[n];switch(e.nodeName){case"component":this.component(e);continue;case"unit":this.unit(e);continue;case"meta":this.meta(e);continue}}},component:function(e){try{var t=e.getAttribute("name");if(!t)return;var n=parseInt(e.getAttribute("level")),i=this.getBrowser().getComponent(t,n);this.scene.addComponent(i)}catch(r){console.log(r.message)}},unit:function(e){var t=e.getAttribute("category");if(t){var n=e.getAttribute("name"),i=parseFloat(e.getAttribute("conversionFactor"));this.scene.updateUnit(t,n,i)}},meta:function(e){var t=e.getAttribute("name");if(t){var n=e.getAttribute("content");this.scene.setMetaData(t,n)}},Scene:function(e){this.statements(e.childNodes)},statements:function(e){for(var t=0;t<e.length;++t)this.statement(e[t])},statement:function(e){switch(e.nodeName){case"#comment":case"#text":case"#cdata-section":return;case"ExternProtoDeclare":return void this.ExternProtoDeclare(e);case"ProtoDeclare":return void this.ProtoDeclare(e);case"ProtoInstance":return void this.ProtoInstance(e);case"ROUTE":return void this.ROUTE(e);default:return void this.node(e)}},node:function(e){try{if(this.USE(e))return;var t=this.getExecutionContext().createNode(e.nodeName,!1);this.DEF(e,t),this.addNode(e,t),this.pushParent(t),this.attributes(e.attributes,t),this.children(e.childNodes,!1),this.getExecutionContext().addUninitializedNode(t),this.popParent()}catch(n){console.warn("XML Parser Error: "+n.message)}},ProtoInstance:function(e){try{if(this.USE(e))return;var t=e.getAttribute("name");if(this.id(t)){var n=this.getExecutionContext().createProto(t,!1);this.DEF(e,n),this.addNode(e,n),this.pushParent(n),this.children(e.childNodes,!0),this.getExecutionContext().addUninitializedNode(n),this.popParent()}}catch(i){console.warn("XML Parser Error: ",i.message)}},children:function(e,t){for(var n=0;n<e.length;++n)this.child(e[n],t)},child:function(e,t){switch(e.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdata(e);case"IS":return void this.IS(e);case"field":return void this.field(e);case"fieldValue":return void(t&&this.fieldValue(e));case"ExternProtoDeclare":return void this.ExternProtoDeclare(e);case"ProtoDeclare":return void this.ProtoDeclare(e);case"ProtoInstance":return void this.ProtoInstance(e);case"ROUTE":return void this.ROUTE(e);default:return void this.node(e)}},DEF:function(e,t){try{var n=e.getAttribute("DEF");n&&this.getExecutionContext().updateNamedNode(n,t)}catch(i){console.warn("Invalid DEF name: "+i.message)}},USE:function(e){try{var t=e.getAttribute("USE");if(this.id(t)){var n=this.getExecutionContext().getNamedNode(t);return this.addNode(e,n.getValue()),!0}}catch(i){console.warn("Invalid USE name: "+i.message)}return!1},addNode:function(e,n){if(this.parents.length){var i=this.getParent();if(i instanceof t)i.getSet()===!1&&i.setSet(!0),i.getType()===a.SFNode&&i.set(n),i.getType()===a.MFNode&&i.push(n);else{try{var r=e.getAttribute("containerField");if(r){var o=i.getField(r);if(o.getType()===a.SFNode)return o.set(n);if(o.getType()===a.MFNode)return o.push(n)}}catch(s){}try{var o=i.getField(n.getContainerField());if(o.getType()===a.SFNode)return o.set(n);if(o.getType()===a.MFNode)return o.push(n)}catch(s){}}}else this.getExecutionContext().rootNodes.push(n)},attributes:function(e,t){for(var n=0;n<e.length;++n)this.attribute(e[n],t)},attribute:function(e,t){try{var n=e.name,i=e.value,r=t.getField(n),o=this.fieldTypes[r.getType()];this.parser.setInput(i),o.call(this.parser,r)}catch(s){}},cdata:function(e){var t=this.getParent(),n=t.getCDATA();n&&n.push(e.data)},field:function(e){var t=this.getParent();if(t.hasUserDefinedFields()){var n=l[e.getAttribute("accessType")];void 0===n&&(n=a.initializeOnly);var r=i[e.getAttribute("type")];if(void 0!==r){var o=e.getAttribute("name");if(this.id(o)){var s=new r;if(n&a.initializeOnly){var u=e.getAttribute("value");null!==u&&(this.parser.setInput(u),this.fieldTypes[s.getType()].call(this.parser,s),s.setSet(!0)),this.pushParent(s),this.statements(e.childNodes),this.popParent()}t.addUserDefinedField(n,o,s)}}}},fieldValue:function(e){try{var t=this.getParent(),n=e.getAttribute("name");if(!this.id(n))return;var i=t.getField(n),r=i.getAccessType();if(r&a.initializeOnly){var o=e.getAttribute("value");null!==o?(this.parser.setInput(o),this.fieldTypes[i.getType()].call(this.parser,i),i.setSet(!0)):i.setSet(!1),this.pushParent(i),this.statements(e.childNodes),this.popParent()}}catch(s){console.warn("XML Parser Error: Couldn't assign field value: "+s.message)}},IS:function(e){if(this.getExecutionContext()instanceof s)for(var t=e.childNodes,n=0;n<t.length;++n){var i=t[n];switch(i.nodeName){case"connect":this.connect(i);continue}}},connect:function(e){var t=e.getAttribute("nodeField"),n=e.getAttribute("protoField");if(t&&n)try{var i=this.getParent(),r=this.getExecutionContext(),o=i.getField(t),s=r.getField(n);if(o.getType()!==s.getType())throw new Error("Field '"+o.getName()+"' and '"+s.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.");if(!s.isReference(o.getAccessType()))throw new Error("Field '"+o.getName()+"' and '"+s.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.");o.addReference(s)}catch(a){console.warn("Couldn't create IS reference: "+a.message)}},ExternProtoDeclare:function(e){var t=e.getAttribute("name");if(this.id(t)){var n=e.getAttribute("url");null!==n?(this.parser.setInput(n),r.prototype.sfstringValues.call(this.parser,this.url)):this.url.length=0;var i=new o(this.getExecutionContext());this.pushParent(i),this.ProtoInterface(e),this.popParent(),i.setName(t),i.url_=this.url,i.setup(),this.getExecutionContext().externprotos.add(t,i)}},ProtoDeclare:function(e){var t=e.getAttribute("name");if(this.id(t)){for(var n=new s(this.getExecutionContext()),i=e.childNodes,r=0;r<i.length;++r){var o=i[r];switch(o.nodeName){case"ProtoInterface":this.pushParent(n),this.ProtoInterface(o),this.popParent();continue;case"ProtoBody":this.pushExecutionContext(n),this.ProtoBody(o),this.popExecutionContext();continue}}n.setName(t),n.setup(),this.getExecutionContext().protos.add(t,n)}},ProtoInterface:function(e){for(var t=e.childNodes,n=0;n<t.length;++n){var i=t[n];switch(i.nodeName){case"FIELD":case"field":this.field(i);continue}}},ProtoBody:function(e){this.statements(e.childNodes)},ROUTE:function(e){var t=e.getAttribute("fromNode"),n=e.getAttribute("fromField"),i=e.getAttribute("toNode"),r=e.getAttribute("toField");try{var o=this.getExecutionContext().getLocalNode(t),s=this.getExecutionContext().getLocalNode(i);this.getExecutionContext().addRoute(o,n,s,r)}catch(a){console.warn("XML Parser Error: "+a.message)}},id:function(e){return e?!0:!1}},u.prototype.fieldTypes=[],u.prototype.fieldTypes[a.SFBool]=r.prototype.sfboolValue,u.prototype.fieldTypes[a.SFColor]=r.prototype.sfcolorValue,u.prototype.fieldTypes[a.SFColorRGBA]=r.prototype.sfcolorrgbaValue,u.prototype.fieldTypes[a.SFDouble]=r.prototype.sfdoubleValue,u.prototype.fieldTypes[a.SFFloat]=r.prototype.sffloatValue,u.prototype.fieldTypes[a.SFImage]=r.prototype.sfimageValue,u.prototype.fieldTypes[a.SFInt32]=r.prototype.sfint32Value,u.prototype.fieldTypes[a.SFMatrix3f]=r.prototype.sfmatrix4dValue,u.prototype.fieldTypes[a.SFMatrix3d]=r.prototype.sfmatrix4fValue,u.prototype.fieldTypes[a.SFMatrix4f]=r.prototype.sfmatrix4dValue,u.prototype.fieldTypes[a.SFMatrix4d]=r.prototype.sfmatrix4fValue,u.prototype.fieldTypes[a.SFNode]=function(e){e.set(null)},u.prototype.fieldTypes[a.SFRotation]=r.prototype.sfrotationValue,u.prototype.fieldTypes[a.SFString]=function(e){e.set(this.input)},u.prototype.fieldTypes[a.SFTime]=r.prototype.sftimeValue,u.prototype.fieldTypes[a.SFVec2d]=r.prototype.sfvec2dValue,u.prototype.fieldTypes[a.SFVec2f]=r.prototype.sfvec2fValue,u.prototype.fieldTypes[a.SFVec3d]=r.prototype.sfvec3dValue,u.prototype.fieldTypes[a.SFVec3f]=r.prototype.sfvec3fValue,u.prototype.fieldTypes[a.SFVec4d]=r.prototype.sfvec4dValue,u.prototype.fieldTypes[a.SFVec4f]=r.prototype.sfvec4fValue,u.prototype.fieldTypes[a.MFBool]=r.prototype.sfboolValues,u.prototype.fieldTypes[a.MFColor]=r.prototype.sfcolorValues,u.prototype.fieldTypes[a.MFColorRGBA]=r.prototype.sfcolorrgbaValues,u.prototype.fieldTypes[a.MFDouble]=r.prototype.sfdoubleValues,u.prototype.fieldTypes[a.MFFloat]=r.prototype.sffloatValues,u.prototype.fieldTypes[a.MFImage]=r.prototype.sfimageValues,u.prototype.fieldTypes[a.MFInt32]=r.prototype.sfint32Values,u.prototype.fieldTypes[a.MFMatrix3d]=r.prototype.sfmatrix3dValues,u.prototype.fieldTypes[a.MFMatrix3f]=r.prototype.sfmatrix3fValues,u.prototype.fieldTypes[a.MFMatrix4d]=r.prototype.sfmatrix4dValues,u.prototype.fieldTypes[a.MFMatrix4f]=r.prototype.sfmatrix4fValues,u.prototype.fieldTypes[a.MFNode]=function(){},u.prototype.fieldTypes[a.MFRotation]=r.prototype.sfrotationValues,u.prototype.fieldTypes[a.MFString]=r.prototype.sfstringValues,u.prototype.fieldTypes[a.MFTime]=r.prototype.sftimeValues,u.prototype.fieldTypes[a.MFVec2d]=r.prototype.sfvec2dValues,u.prototype.fieldTypes[a.MFVec2f]=r.prototype.sfvec2fValues,u.prototype.fieldTypes[a.MFVec3d]=r.prototype.sfvec3dValues,u.prototype.fieldTypes[a.MFVec3f]=r.prototype.sfvec3fValues,u.prototype.fieldTypes[a.MFVec4d]=r.prototype.sfvec4dValues,u.prototype.fieldTypes[a.MFVec4f]=r.prototype.sfvec4fValues,u}),define("lib/BinaryTransport",[],function(){return function(e){e.ajaxTransport("+binary",function(e,t,n){return e.dataType&&"binary"==e.dataType?{send:function(t,n){var i=e.xhr();if(i.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)i[r]=e.xhrFields[r];e.mimeType&&i.overrideMimeType&&i.overrideMimeType(e.mimeType);for(var r in t)i.setRequestHeader(r,t[r]);i.onload=function(){i.onload=i.onerror=null;var t={};t[e.dataType]=i.response,n(i.status,i.statusText,t,i.getAllResponseHeaders())},i.onerror=function(){i.onload=i.onerror=null,n(i.status||404,i.statusText)},i.responseType=e.responseType||"blob",i.send(e.hasContent&&e.data||null)},abort:function(){var t=e.xhr();t.onload=t.onerror=null,t.abort()}}:void 0})}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("lib/pako/dist/pako_inflate",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.pako=e()}}(function(){return function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+i),r);for(var o=0;i>o;o++)e[r+o]=t[n+o]},flattenChunks:function(e){var t,n,i,r,o,s;for(i=0,t=0,n=e.length;n>t;t++)i+=e[t].length;for(s=new Uint8Array(i),r=0,t=0,n=e.length;n>t;t++)o=e[t],s.set(o,r),r+=o.length;return s}},o={arraySet:function(e,t,n,i,r){for(var o=0;i>o;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],2:[function(e,t,n){function i(e,t){if(65537>t&&(e.subarray&&s||!e.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",i=0;t>i;i++)n+=String.fromCharCode(e[i]);return n}var r=e("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(a){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){s=!1}for(var u=new r.Buf8(256),l=0;256>l;l++)u[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;u[254]=u[254]=1,n.string2buf=function(e){var t,n,i,o,s,a=e.length,u=0;for(o=0;a>o;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(i=e.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),u+=128>n?1:2048>n?2:65536>n?3:4;for(t=new r.Buf8(u),s=0,o=0;u>s;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(i=e.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),128>n?t[s++]=n:2048>n?(t[s++]=192|n>>>6,t[s++]=128|63&n):65536>n?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;i>n;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,o,s,a=t||e.length,l=new Array(2*a);for(r=0,n=0;a>n;)if(o=e[n++],128>o)l[r++]=o;else if(s=u[o],s>4)l[r++]=65533,n+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&a>n;)o=o<<6|63&e[n++],s--;s>1?l[r++]=65533:65536>o?l[r++]=o:(o-=65536,l[r++]=55296|o>>10&1023,l[r++]=56320|1023&o)}return i(l,r)},n.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+u[e[n]]>t?n:t}},{"./common":1}],3:[function(e,t,n){function i(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){s=n>2e3?2e3:n,n-=s;do r=r+t[i++]|0,o=o+r|0;while(--s);r%=65521,o%=65521}return r|o<<16|0}t.exports=i},{}],4:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,n){function i(){for(var e,t=[],n=0;256>n;n++){e=n;for(var i=0;8>i;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}function r(e,t,n,i){var r=o,s=i+n;e=-1^e;for(var a=i;s>a;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}var o=i();t.exports=r},{}],6:[function(e,t,n){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=i},{}],7:[function(e,t,n){var i=30,r=12;t.exports=function(e,t){var n,o,s,a,u,l,c,h,d,p,f,g,m,y,b,w,v,x,_,C,S,T,F,O,N;n=e.state,o=e.next_in,O=e.input,s=o+(e.avail_in-5),a=e.next_out,N=e.output,u=a-(t-e.avail_out),l=a+(e.avail_out-257),c=n.dmax,h=n.wsize,d=n.whave,p=n.wnext,f=n.window,g=n.hold,m=n.bits,y=n.lencode,b=n.distcode,w=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{15>m&&(g+=O[o++]<<m,m+=8,g+=O[o++]<<m,m+=8),x=y[g&w];t:for(;;){if(_=x>>>24,g>>>=_,m-=_,_=x>>>16&255,0===_)N[a++]=65535&x;else{if(!(16&_)){if(0===(64&_)){x=y[(65535&x)+(g&(1<<_)-1)];continue t}if(32&_){n.mode=r;break e}e.msg="invalid literal/length code",n.mode=i;break e}C=65535&x,_&=15,_&&(_>m&&(g+=O[o++]<<m,m+=8),C+=g&(1<<_)-1,g>>>=_,m-=_),15>m&&(g+=O[o++]<<m,m+=8,g+=O[o++]<<m,m+=8),x=b[g&v];n:for(;;){if(_=x>>>24,g>>>=_,m-=_,_=x>>>16&255,!(16&_)){if(0===(64&_)){x=b[(65535&x)+(g&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=i;break e}if(S=65535&x,_&=15,_>m&&(g+=O[o++]<<m,m+=8,_>m&&(g+=O[o++]<<m,m+=8)),S+=g&(1<<_)-1,S>c){e.msg="invalid distance too far back",n.mode=i;break e}if(g>>>=_,m-=_,_=a-u,S>_){if(_=S-_,_>d&&n.sane){e.msg="invalid distance too far back",n.mode=i;break e}if(T=0,F=f,0===p){if(T+=h-_,C>_){C-=_;do N[a++]=f[T++];while(--_);T=a-S,F=N}}else if(_>p){if(T+=h+p-_,_-=p,C>_){C-=_;do N[a++]=f[T++];while(--_);if(T=0,C>p){_=p,C-=_;do N[a++]=f[T++];while(--_);T=a-S,F=N}}}else if(T+=p-_,C>_){C-=_;do N[a++]=f[T++];while(--_);T=a-S,F=N}for(;C>2;)N[a++]=F[T++],N[a++]=F[T++],N[a++]=F[T++],C-=3;C&&(N[a++]=F[T++],C>1&&(N[a++]=F[T++]))}else{T=a-S;do N[a++]=N[T++],N[a++]=N[T++],N[a++]=N[T++],C-=3;while(C>2);C&&(N[a++]=N[T++],C>1&&(N[a++]=N[T++]))}break}}break}}while(s>o&&l>a);C=m>>3,o-=C,m-=C<<3,g&=(1<<m)-1,e.next_in=o,e.next_out=a,e.avail_in=s>o?5+(s-o):5-(o-s),e.avail_out=l>a?257+(l-a):257-(a-l),n.hold=g,n.bits=m}},{}],8:[function(e,t,n){function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=P,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new y.Buf32(fe),t.distcode=t.distdyn=new y.Buf32(ge),t.sane=1,t.back=-1,N):M}function s(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):M}function a(e,t){var n,i;return e&&e.state?(i=e.state,0>t?(n=0,t=-t):(n=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?M:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,s(e))):M}function u(e,t){var n,i;return e?(i=new r,e.state=i,i.window=null,n=a(e,t),n!==N&&(e.state=null),n):M}function l(e){return u(e,ye)}function c(e){if(be){var t;for(g=new y.Buf32(512),m=new y.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(x(C,e.lens,0,288,g,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;x(S,e.lens,0,32,m,0,e.work,{bits:5}),be=!1}e.lencode=g,e.lenbits=9,e.distcode=m,e.distbits=5}function h(e,t,n,i){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),i>=o.wsize?(y.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),y.arraySet(o.window,t,n-i,r,o.wnext),i-=r,i?(y.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}function d(e,t){var n,r,o,s,a,u,l,d,p,f,g,m,fe,ge,me,ye,be,we,ve,xe,_e,Ce,Se,Te,Fe=0,Oe=new y.Buf8(4),Ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return M;n=e.state,n.mode===W&&(n.mode=Y),a=e.next_out,o=e.output,l=e.avail_out,s=e.next_in,r=e.input,u=e.avail_in,d=n.hold,p=n.bits,f=u,g=l,Ce=N;e:for(;;)switch(n.mode){case P:if(0===n.wrap){n.mode=Y;break}for(;16>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(2&n.wrap&&35615===d){n.check=0,Oe[0]=255&d,Oe[1]=d>>>8&255,n.check=w(n.check,Oe,2,0),d=0,p=0,n.mode=L;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=he;break}if((15&d)!==A){e.msg="unknown compression method",n.mode=he;break}if(d>>>=4,p-=4,_e=(15&d)+8,0===n.wbits)n.wbits=_e;else if(_e>n.wbits){e.msg="invalid window size",n.mode=he;break}n.dmax=1<<_e,e.adler=n.check=1,n.mode=512&d?G:W,d=0,p=0;break;case L:for(;16>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(n.flags=d,(255&n.flags)!==A){e.msg="unknown compression method",n.mode=he;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=he;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,n.check=w(n.check,Oe,2,0)),d=0,p=0,n.mode=R;case R:for(;32>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.head&&(n.head.time=d),512&n.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,Oe[2]=d>>>16&255,Oe[3]=d>>>24&255,n.check=w(n.check,Oe,4,0)),d=0,p=0,n.mode=k;case k:for(;16>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,n.check=w(n.check,Oe,2,0)),d=0,p=0,n.mode=j;case j:if(1024&n.flags){for(;16>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,n.check=w(n.check,Oe,2,0)),d=0,p=0}else n.head&&(n.head.extra=null);n.mode=z;case z:if(1024&n.flags&&(m=n.length,m>u&&(m=u),m&&(n.head&&(_e=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),y.arraySet(n.head.extra,r,s,m,_e)),512&n.flags&&(n.check=w(n.check,r,m,s)),u-=m,s+=m,n.length-=m),n.length))break e;n.length=0,n.mode=X;case X:if(2048&n.flags){if(0===u)break e;m=0;do _e=r[s+m++],n.head&&_e&&n.length<65536&&(n.head.name+=String.fromCharCode(_e));while(_e&&u>m);if(512&n.flags&&(n.check=w(n.check,r,m,s)),u-=m,s+=m,_e)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=U;case U:if(4096&n.flags){if(0===u)break e;m=0;do _e=r[s+m++],n.head&&_e&&n.length<65536&&(n.head.comment+=String.fromCharCode(_e));while(_e&&u>m);if(512&n.flags&&(n.check=w(n.check,r,m,s)),u-=m,s+=m,_e)break e}else n.head&&(n.head.comment=null);n.mode=q;case q:if(512&n.flags){for(;16>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=he;break}d=0,p=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=W;break;case G:for(;32>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}e.adler=n.check=i(d),d=0,p=0,n.mode=H;case H:if(0===n.havedict)return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=p,D;e.adler=n.check=1,n.mode=W;case W:if(t===F||t===O)break e;case Y:if(n.last){d>>>=7&p,p-=7&p,n.mode=ue;break}for(;3>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}switch(n.last=1&d,d>>>=1,p-=1,3&d){case 0:n.mode=$;break;case 1:if(c(n),n.mode=te,t===O){d>>>=2,p-=2;break e}break;case 2:n.mode=Q;break;case 3:e.msg="invalid block type",n.mode=he}d>>>=2,p-=2;break;case $:for(d>>>=7&p,p-=7&p;32>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if((65535&d)!==(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=he;break}if(n.length=65535&d,d=0,p=0,n.mode=K,t===O)break e;case K:n.mode=Z;case Z:if(m=n.length){if(m>u&&(m=u),m>l&&(m=l),0===m)break e;y.arraySet(o,r,s,m,a),u-=m,s+=m,l-=m,a+=m,n.length-=m;break}n.mode=W;break;case Q:for(;14>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(n.nlen=(31&d)+257,d>>>=5,p-=5,n.ndist=(31&d)+1,d>>>=5,p-=5,n.ncode=(15&d)+4,d>>>=4,p-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=he;break}n.have=0,n.mode=J;case J:for(;n.have<n.ncode;){for(;3>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.lens[Ne[n.have++]]=7&d,d>>>=3,p-=3}for(;n.have<19;)n.lens[Ne[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Se={bits:n.lenbits},Ce=x(_,n.lens,0,19,n.lencode,0,n.work,Se),n.lenbits=Se.bits,Ce){e.msg="invalid code lengths set",n.mode=he;break}n.have=0,n.mode=ee;case ee:for(;n.have<n.nlen+n.ndist;){for(;Fe=n.lencode[d&(1<<n.lenbits)-1],me=Fe>>>24,ye=Fe>>>16&255,be=65535&Fe,!(p>=me);){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(16>be)d>>>=me,p-=me,n.lens[n.have++]=be;else{if(16===be){for(Te=me+2;Te>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(d>>>=me,p-=me,0===n.have){e.msg="invalid bit length repeat",n.mode=he;break}_e=n.lens[n.have-1],m=3+(3&d),d>>>=2,p-=2}else if(17===be){for(Te=me+3;Te>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}d>>>=me,p-=me,_e=0,m=3+(7&d),d>>>=3,p-=3}else{for(Te=me+7;Te>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}d>>>=me,p-=me,_e=0,m=11+(127&d),d>>>=7,p-=7}if(n.have+m>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=he;break}for(;m--;)n.lens[n.have++]=_e}}if(n.mode===he)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=he;break}if(n.lenbits=9,Se={bits:n.lenbits},Ce=x(C,n.lens,0,n.nlen,n.lencode,0,n.work,Se),n.lenbits=Se.bits,Ce){e.msg="invalid literal/lengths set",n.mode=he;break}if(n.distbits=6,n.distcode=n.distdyn,Se={bits:n.distbits},Ce=x(S,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Se),n.distbits=Se.bits,Ce){e.msg="invalid distances set",n.mode=he;break}if(n.mode=te,t===O)break e;case te:n.mode=ne;case ne:if(u>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=p,v(e,g),a=e.next_out,o=e.output,l=e.avail_out,s=e.next_in,r=e.input,u=e.avail_in,d=n.hold,p=n.bits,n.mode===W&&(n.back=-1);break}for(n.back=0;Fe=n.lencode[d&(1<<n.lenbits)-1],me=Fe>>>24,ye=Fe>>>16&255,be=65535&Fe,!(p>=me);){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(ye&&0===(240&ye)){for(we=me,ve=ye,xe=be;Fe=n.lencode[xe+((d&(1<<we+ve)-1)>>we)],me=Fe>>>24,ye=Fe>>>16&255,be=65535&Fe,!(p>=we+me);){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}d>>>=we,p-=we,n.back+=we}if(d>>>=me,p-=me,n.back+=me,n.length=be,0===ye){n.mode=ae;break}if(32&ye){n.back=-1,n.mode=W;break}if(64&ye){e.msg="invalid literal/length code",n.mode=he;break}n.extra=15&ye,n.mode=ie;case ie:if(n.extra){for(Te=n.extra;Te>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,p-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=re;case re:for(;Fe=n.distcode[d&(1<<n.distbits)-1],me=Fe>>>24,ye=Fe>>>16&255,be=65535&Fe,!(p>=me);){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(0===(240&ye)){for(we=me,ve=ye,xe=be;Fe=n.distcode[xe+((d&(1<<we+ve)-1)>>we)],me=Fe>>>24,ye=Fe>>>16&255,be=65535&Fe,!(p>=we+me);){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}d>>>=we,p-=we,n.back+=we}if(d>>>=me,p-=me,n.back+=me,64&ye){e.msg="invalid distance code",n.mode=he;break}n.offset=be,n.extra=15&ye,n.mode=oe;case oe:if(n.extra){for(Te=n.extra;Te>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,p-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=he;break}n.mode=se;case se:if(0===l)break e;if(m=g-l,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=he;break}m>n.wnext?(m-=n.wnext,fe=n.wsize-m):fe=n.wnext-m,m>n.length&&(m=n.length),ge=n.window}else ge=o,fe=a-n.offset,m=n.length;m>l&&(m=l),l-=m,n.length-=m;do o[a++]=ge[fe++];while(--m);0===n.length&&(n.mode=ne);break;case ae:if(0===l)break e;o[a++]=n.length,l--,n.mode=ne;break;case ue:if(n.wrap){for(;32>p;){if(0===u)break e;u--,d|=r[s++]<<p,p+=8}if(g-=l,e.total_out+=g,n.total+=g,g&&(e.adler=n.check=n.flags?w(n.check,o,g,a-g):b(n.check,o,g,a-g)),g=l,(n.flags?d:i(d))!==n.check){e.msg="incorrect data check",n.mode=he;break}d=0,p=0}n.mode=le;case le:if(n.wrap&&n.flags){for(;32>p;){if(0===u)break e;u--,d+=r[s++]<<p,p+=8}if(d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=he;break}d=0,p=0}n.mode=ce;case ce:Ce=V;break e;case he:Ce=B;break e;case de:return E;case pe:default:return M}return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=p,(n.wsize||g!==e.avail_out&&n.mode<he&&(n.mode<ue||t!==T))&&h(e,e.output,e.next_out,g-e.avail_out)?(n.mode=de,
E):(f-=e.avail_in,g-=e.avail_out,e.total_in+=f,e.total_out+=g,n.total+=g,n.wrap&&g&&(e.adler=n.check=n.flags?w(n.check,o,g,e.next_out-g):b(n.check,o,g,e.next_out-g)),e.data_type=n.bits+(n.last?64:0)+(n.mode===W?128:0)+(n.mode===te||n.mode===K?256:0),(0===f&&0===g||t===T)&&Ce===N&&(Ce=I),Ce)}function p(e){if(!e||!e.state)return M;var t=e.state;return t.window&&(t.window=null),e.state=null,N}function f(e,t){var n;return e&&e.state?(n=e.state,0===(2&n.wrap)?M:(n.head=t,t.done=!1,N)):M}var g,m,y=e("../utils/common"),b=e("./adler32"),w=e("./crc32"),v=e("./inffast"),x=e("./inftrees"),_=0,C=1,S=2,T=4,F=5,O=6,N=0,V=1,D=2,M=-2,B=-3,E=-4,I=-5,A=8,P=1,L=2,R=3,k=4,j=5,z=6,X=7,U=8,q=9,G=10,H=11,W=12,Y=13,$=14,K=15,Z=16,Q=17,J=18,ee=19,te=20,ne=21,ie=22,re=23,oe=24,se=25,ae=26,ue=27,le=28,ce=29,he=30,de=31,pe=32,fe=852,ge=592,me=15,ye=me,be=!0;n.inflateReset=s,n.inflateReset2=a,n.inflateResetKeep=o,n.inflateInit=l,n.inflateInit2=u,n.inflate=d,n.inflateEnd=p,n.inflateGetHeader=f,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,n){var i=e("../utils/common"),r=15,o=852,s=592,a=0,u=1,l=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,f,g,m,y,b){var w,v,x,_,C,S,T,F,O,N=b.bits,V=0,D=0,M=0,B=0,E=0,I=0,A=0,P=0,L=0,R=0,k=null,j=0,z=new i.Buf16(r+1),X=new i.Buf16(r+1),U=null,q=0;for(V=0;r>=V;V++)z[V]=0;for(D=0;f>D;D++)z[t[n+D]]++;for(E=N,B=r;B>=1&&0===z[B];B--);if(E>B&&(E=B),0===B)return g[m++]=20971520,g[m++]=20971520,b.bits=1,0;for(M=1;B>M&&0===z[M];M++);for(M>E&&(E=M),P=1,V=1;r>=V;V++)if(P<<=1,P-=z[V],0>P)return-1;if(P>0&&(e===a||1!==B))return-1;for(X[1]=0,V=1;r>V;V++)X[V+1]=X[V]+z[V];for(D=0;f>D;D++)0!==t[n+D]&&(y[X[t[n+D]]++]=D);if(e===a?(k=U=y,S=19):e===u?(k=c,j-=257,U=h,q-=257,S=256):(k=d,U=p,S=-1),R=0,D=0,V=M,C=m,I=E,A=0,x=-1,L=1<<E,_=L-1,e===u&&L>o||e===l&&L>s)return 1;for(var G=0;;){G++,T=V-A,y[D]<S?(F=0,O=y[D]):y[D]>S?(F=U[q+y[D]],O=k[j+y[D]]):(F=96,O=0),w=1<<V-A,v=1<<I,M=v;do v-=w,g[C+(R>>A)+v]=T<<24|F<<16|O|0;while(0!==v);for(w=1<<V-1;R&w;)w>>=1;if(0!==w?(R&=w-1,R+=w):R=0,D++,0===--z[V]){if(V===B)break;V=t[n+y[D]]}if(V>E&&(R&_)!==x){for(0===A&&(A=E),C+=M,I=V-A,P=1<<I;B>I+A&&(P-=z[I+A],!(0>=P));)I++,P<<=1;if(L+=1<<I,e===u&&L>o||e===l&&L>s)return 1;x=R&_,g[x]=E<<24|I<<16|C-m|0}}return 0!==R&&(g[C+R]=V-A<<24|64<<16|0),b.bits=E,0}},{"../utils/common":1}],10:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,n){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=i},{}],"/lib/inflate.js":[function(e,t,n){function i(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function r(e,t){return t=t||{},t.raw=!0,i(e,t)}var o=e("./zlib/inflate.js"),s=e("./utils/common"),a=e("./utils/strings"),u=e("./zlib/constants"),l=e("./zlib/messages"),c=e("./zlib/zstream"),h=e("./zlib/gzheader"),d=Object.prototype.toString,p=function(e){this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=o.inflateInit2(this.strm,t.windowBits);if(n!==u.Z_OK)throw new Error(l[n]);this.header=new h,o.inflateGetHeader(this.strm,this.header)};p.prototype.push=function(e,t){var n,i,r,l,c,h=this.strm,p=this.options.chunkSize,f=!1;if(this.ended)return!1;i=t===~~t?t:t===!0?u.Z_FINISH:u.Z_NO_FLUSH,"string"==typeof e?h.input=a.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new s.Buf8(p),h.next_out=0,h.avail_out=p),n=o.inflate(h,u.Z_NO_FLUSH),n===u.Z_BUF_ERROR&&f===!0&&(n=u.Z_OK,f=!1),n!==u.Z_STREAM_END&&n!==u.Z_OK)return this.onEnd(n),this.ended=!0,!1;h.next_out&&(0===h.avail_out||n===u.Z_STREAM_END||0===h.avail_in&&(i===u.Z_FINISH||i===u.Z_SYNC_FLUSH))&&("string"===this.options.to?(r=a.utf8border(h.output,h.next_out),l=h.next_out-r,c=a.buf2string(h.output,r),h.next_out=l,h.avail_out=p-l,l&&s.arraySet(h.output,h.output,r,l,0),this.onData(c)):this.onData(s.shrinkBuf(h.output,h.next_out))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((h.avail_in>0||0===h.avail_out)&&n!==u.Z_STREAM_END);return n===u.Z_STREAM_END&&(i=u.Z_FINISH),i===u.Z_FINISH?(n=o.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u.Z_OK):i===u.Z_SYNC_FLUSH?(this.onEnd(u.Z_OK),h.avail_out=0,!0):!0},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===u.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=p,n.inflate=i,n.inflateRaw=r,n.ungzip=i},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate.js":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),define("cobweb/InputOutput/Loader",["jquery","cobweb/Base/X3DObject","cobweb/Browser/Networking/urls","cobweb/Parser/Parser","cobweb/Parser/XMLParser","standard/Networking/URI","lib/BinaryTransport","lib/pako/dist/pako_inflate"],function(e,t,n,i,r,o,s,a){function u(e,n){t.call(this),this.node=e,this.browser=e.getBrowser(),this.external=this.browser.isExternal()||n,this.executionContext=this.external?e.getExecutionContext():this.browser.currentScene,this.url=[],this.URL=new o,this.fileReader=new FileReader}s(e);var l=17,c=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,h=/^data\:([^]*?)(?:;([^]*?))?(;base64)?,([^]*)$/,d=/^(?:(.*?);(.*?)$)/,p={"text/html":!0,"application/xhtml+xml":!0};return u.prototype=e.extend(Object.create(t.prototype),{constructor:u,getWorldURL:function(){return this.URL},createX3DFromString:function(t,n,r,o){var s=this.browser.createScene();if(s.setURL(this.browser.getLocation().transform(t)),r)try{setTimeout(this.importDocument.bind(this,s,e.parseXML(n),r,o),l)}catch(a){new i(s,n).parseIntoScene(),this.setScene(s,r)}else try{return this.importDocument(s,e.parseXML(n)),s}catch(u){return new i(s,n).parseIntoScene(),s}},importDocument:function(e,t,n,i){try{new r(e,t).parseIntoScene(),n&&this.setScene(e,n)}catch(o){if(!i)throw o;i(o)}},setScene:function(e,t){e.loadCount_.addInterest(this,"set_loadCount__",e,t),e.requestAsyncLoadOfExternProtos()},set_loadCount__:function(e,t,n){e.getValue()||(t.loadCount_.removeInterest(this,"set_loadCount__"),n(t),this.URL.length&&"data"!==this.URL.scheme&&console.info("Done loading scene "+this.URL))},createX3DFromURL:function(e,t,n,i){return this.bindViewpoint=n,this.foreign=i,t?this.loadDocument(e,this.createX3DFromURLAsync.bind(this,t)):this.createX3DFromURLSync(e)},createX3DFromURLAsync:function(e,t){null===t?e(null):this.createX3DFromString(this.URL,t,e,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(t){if(0===t.length)throw new Error("No URL given.");for(var n=null,i=!1,r=0;r<t.length&&(this.URL=this.transform(t[r]),e.ajax({url:this.URL,dataType:"text",async:!1,cache:this.browser.doCaching(),global:!1,context:this,success:function(e){try{n=this.createX3DFromString(this.URL,e),i=!0}catch(t){this.error(t)}},error:function(e,t,n){}}),!i);++r);if(i)return n;throw new Error("Couldn't load any url of '"+t.getValue().join(", ")+"'.")},loadScript:function(e,t){this.script=!0,this.loadDocument(e,t)},loadDocument:function(e,t){return this.url=e.copy(),this.callback=t,0===e.length?this.loadDocumentError(new Error("No URL given.")):void this.loadDocumentAsync(this.url.shift())},loadDocumentAsync:function(t){if(0==t.length)return void this.loadDocumentError(new Error("URL is empty."));try{if(this.bindViewpoint){var n=new o(t);if(0===n.filename.toString().length&&0===n.query.length)return void this.bindViewpoint(n.fragment)}}catch(i){return void this.loadDocumentError(i)}if(this.script)try{var r=c.exec(t);if(r)return void this.callback(r[1])}catch(i){return void this.loadDocumentError(i)}try{var r=h.exec(t);if(r){var s=r[4];return s=";base64"===r[3]?atob(s):unescape(s),void this.callback(s)}}catch(i){return void this.loadDocumentError(i)}this.URL=this.transform(t),e.ajax({url:this.URL,dataType:"binary",async:!0,cache:this.browser.doCaching(),global:!1,context:this,success:function(e,t,n){this.foreign&&p[this.getContentType(n)]&&this.foreign(this.URL),this.fileReader.onload=this.readAsText.bind(this,e),this.fileReader.readAsText(e)},error:function(e,t,n){this.loadDocumentError(new Error(n))}})},readAsText:function(e){try{this.callback(this.fileReader.result)}catch(t){this.fileReader.onload=this.readAsArrayBuffer.bind(this,t),this.fileReader.readAsArrayBuffer(e)}},readAsArrayBuffer:function(e){try{this.callback(a.ungzip(this.fileReader.result,{to:"string"}))}catch(t){this.loadDocumentError(e)}},loadDocumentError:function(e){this.error(e),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(e){"data"!==this.URL.scheme&&console.warn("Couldn't load URL '"+this.URL+"':",e.message)},transform:function(e){var t=this.getReferer().transform(new o(e));return t.isLocal()?t=this.browser.getLocation().getRelativePath(t):e.match(n.fallbackRx)||this.url.unshift(n.fallback+t),t},getReferer:function(){return"World"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getURL()},getContentType:function(e){var t=e.getResponseHeader("Content-Type"),n=d.exec(t);return n?n[1]:""}}),u}),define("cobweb/Components/Shaders/ShaderPart",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Networking/X3DUrlObject","cobweb/InputOutput/Loader","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.valid=!1,this.addType(a.ShaderPart)}var l={VERTEX:"VERTEX_SHADER",TESS_CONTROL:"TESS_CONTROL_SHADER",TESS_EVALUATION:"TESS_EVALUATION_SHADER",GEOMETRY:"GEOMETRY_SHADER",FRAGMENT:"FRAGMENT_SHADER",COMPUTE:"COMPUTE_SHADER"};return u.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.initializeOnly,"type",new t.SFString("VERTEX")),new n(a.inputOutput,"url",new t.MFString)]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.shader=e.createShader(e[this.getShaderType()]),this.requestImmediateLoad()},isValid:function(){return this.valid},getShader:function(){return this.shader},getShaderType:function(){var e=l[this.type_.getValue()];return e?e:"VERTEX_SHADER"},getCDATA:function(){return this.url_},requestImmediateLoad:function(){this.checkLoadState()!=a.COMPLETE_STATE&&this.checkLoadState()!=a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.valid=!1,new s(this).loadDocument(this.url_,function(e,t){if(null===e)this.setLoadState(a.FAILED_STATE);else{var n=this.getBrowser().getContext();if(n.shaderSource(this.shader,e),n.compileShader(this.shader),this.valid=n.getShaderParameter(this.shader,n.COMPILE_STATUS),!this.valid)throw new Error(this.getTypeName()+" '"+this.getName()+"': "+n.getShaderInfoLog(this.shader));this.setLoadState(a.COMPLETE_STATE)}}.bind(this)))}}),u}),define("text!cobweb/Browser/Shaders/PointSet.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform float x3d_LinewidthScaleFactor;\n// 1\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\n#define NO_FOG           0\n#define LINEAR_FOG       1\n#define EXPONENTIAL_FOG  2\n#define EXPONENTIAL2_FOG 3\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n// 5\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n// 5\n\nvoid\nclip ()\n{\n 	if (x3d_LinewidthScaleFactor >= 2.0)\n	{\n		float dist = distance (vec2 (0.5, 0.5), gl_PointCoord);\n	\n		if (dist > 0.5)\n			discard;\n	}\n\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nfloat\ngetFogInterpolant ()\n{\n	if (x3d_FogType == NO_FOG)\n		return 1.0;\n\n	float dV = length (v);\n\n	if (dV >= x3d_FogVisibilityRange)\n		return 0.0;\n\n	if (x3d_FogType == LINEAR_FOG)\n		return (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n	if (x3d_FogType == EXPONENTIAL_FOG)\n		return exp (-dV / (x3d_FogVisibilityRange - dV));\n\n	return 1.0;\n}\n\nvoid\nmain ()\n{\n	clip ();\n\n	float f0 = getFogInterpolant ();\n\n	gl_FragColor .rgb = mix (x3d_FogColor, C .rgb, f0);\n	gl_FragColor .a   = C .a;\n}\n"}),define("text!cobweb/Browser/Shaders/Wireframe.vs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Transparency;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n	gl_PointSize = x3d_LinewidthScaleFactor;\n\n	vec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n	v           = vec3 (p);\n	gl_Position = x3d_ProjectionMatrix * p;\n\n	if (x3d_Lighting)\n	{\n		float alpha = 1.0 - x3d_Transparency;\n\n		if (x3d_ColorMaterial)\n		{\n			C .rgb = x3d_Color .rgb;\n			C .a   = x3d_Color .a * alpha;\n		}\n		else\n		{\n			C .rgb = x3d_EmissiveColor;\n			C .a   = alpha;\n		}\n	}\n	else\n	{\n		if (x3d_ColorMaterial)\n			C = x3d_Color;\n		else\n			C = vec4 (1.0, 1.0, 1.0, 1.0);\n	}\n}\n"}),define("text!cobweb/Browser/Shaders/Wireframe.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform float x3d_LinewidthScaleFactor;\n// 2\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\n#define NO_FOG           0\n#define LINEAR_FOG       1\n#define EXPONENTIAL_FOG  2\n#define EXPONENTIAL2_FOG 3\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n// 5\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n// 5\n\nvoid\nclip ()\n{\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nfloat\ngetFogInterpolant ()\n{\n	if (x3d_FogType == NO_FOG)\n		return 1.0;\n\n	float dV = length (v);\n\n	if (dV >= x3d_FogVisibilityRange)\n		return 0.0;\n\n	if (x3d_FogType == LINEAR_FOG)\n		return (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n	if (x3d_FogType == EXPONENTIAL_FOG)\n		return exp (-dV / (x3d_FogVisibilityRange - dV));\n\n	return 1.0;\n}\n\nvoid\nmain ()\n{\n	clip ();\n\n	float f0 = getFogInterpolant ();\n\n	gl_FragColor .rgb = mix (x3d_FogColor, C .rgb, f0);\n	gl_FragColor .a   = C .a;\n}\n"}),define("text!cobweb/Browser/Shaders/Gouraud.vs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_TextureMatrix;\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n// 4 * 16\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n// 3\n\n#define MAX_LIGHTS        8\n#define NO_LIGHT          0\n#define DIRECTIONAL_LIGHT 1\n#define POINT_LIGHT       2\n#define SPOT_LIGHT        3\n\nuniform int   x3d_LightType [MAX_LIGHTS]; // 0: DirectionalLight, 1: PointLight, 2: SpotLight\nuniform bool  x3d_LightOn [MAX_LIGHTS];\nuniform vec3  x3d_LightColor [MAX_LIGHTS];\nuniform float x3d_LightIntensity [MAX_LIGHTS];\nuniform float x3d_LightAmbientIntensity [MAX_LIGHTS];\nuniform vec3  x3d_LightAttenuation [MAX_LIGHTS];\nuniform vec3  x3d_LightLocation [MAX_LIGHTS];\nuniform vec3  x3d_LightDirection [MAX_LIGHTS];\nuniform float x3d_LightRadius [MAX_LIGHTS];\nuniform float x3d_LightBeamWidth [MAX_LIGHTS];\nuniform float x3d_LightCutOffAngle [MAX_LIGHTS];\n// 19 * MAX_LIGHTS\n\nuniform bool x3d_SeparateBackColor;\n// 1\n\nuniform float x3d_AmbientIntensity;\nuniform vec3  x3d_DiffuseColor;\nuniform vec3  x3d_SpecularColor;\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Shininess;\nuniform float x3d_Transparency;\n// 12\n\nuniform float x3d_BackAmbientIntensity;\nuniform vec3  x3d_BackDiffuseColor;\nuniform vec3  x3d_BackSpecularColor;\nuniform vec3  x3d_BackEmissiveColor;\nuniform float x3d_BackShininess;\nuniform float x3d_BackTransparency;\n// 12\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n// 15, max 16\n\nvarying vec4  frontColor; // color\nvarying vec4  backColor;  // color\nvarying vec4  t;          // texCoord\nvarying vec3  v;          // point on geometry\n// 15, max 16\n\nvec4\ngetMaterial (vec3 N,\n             vec3 v,\n             float x3d_AmbientIntensity,\n             vec3  x3d_DiffuseColor,\n             vec3  x3d_SpecularColor,\n             vec3  x3d_EmissiveColor,\n             float x3d_Shininess,\n             float x3d_Transparency)\n{  \n	vec3 V = normalize (-v); // normalized vector from point on geometry to viewer's position\n\n	// Calculate diffuseFactor & alpha\n\n	vec3  diffuseFactor = vec3 (1.0, 1.0, 1.0);\n	float alpha         = 1.0 - x3d_Transparency;\n\n	if (x3d_ColorMaterial)\n	{\n		diffuseFactor  = x3d_Color .rgb;\n		alpha         *= x3d_Color .a;\n	}\n	else\n		diffuseFactor = x3d_DiffuseColor;\n\n	vec3 ambientTerm = diffuseFactor * x3d_AmbientIntensity;\n\n	// Apply light sources\n\n	vec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n	for (int i = 0; i < MAX_LIGHTS; ++ i)\n	{\n		int lightType = x3d_LightType [i];\n\n		if (lightType != NO_LIGHT)\n		{\n			vec3  vL = x3d_LightLocation [i] - v;\n			float dL = length (vL);\n			bool  di = lightType == DIRECTIONAL_LIGHT;\n\n			if (di || dL <= x3d_LightRadius [i])\n			{\n				vec3 d = x3d_LightDirection [i];\n				vec3 c = x3d_LightAttenuation [i];\n				vec3 L = di ? -d : normalize (vL);\n				vec3 H = normalize (L + V); // specular term\n	\n				vec3  diffuseTerm    = diffuseFactor * max (dot (N, L), 0.0);\n				float specularFactor = bool (x3d_Shininess) ? pow (max (dot (N, H), 0.0), x3d_Shininess) : 1.0;\n				vec3  specularTerm   = x3d_SpecularColor * specularFactor;\n	\n				float attenuation = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n				float spot        = 1.0;\n	\n				if (lightType == SPOT_LIGHT)\n				{\n					float spotAngle   = acos (clamp (dot (-L, d), -1.0, 1.0));\n					float cutOffAngle = x3d_LightCutOffAngle [i];\n					float beamWidth   = x3d_LightBeamWidth [i];\n					\n					if (spotAngle >= cutOffAngle)\n						spot = 0.0;\n					else if (spotAngle <= beamWidth)\n						spot = 1.0;\n					else\n						spot = (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n				}\n			\n				vec3 lightFactor  = (attenuation * spot) * x3d_LightColor [i];\n				vec3 ambientLight = (lightFactor * x3d_LightAmbientIntensity [i]) * ambientTerm;\n	\n				lightFactor *= x3d_LightIntensity [i];\n				finalColor  += ambientLight + lightFactor * (diffuseTerm + specularTerm);\n			}\n		}\n		else\n			break;\n	}\n\n	finalColor += x3d_EmissiveColor;\n\n	return vec4 (clamp (finalColor, 0.0, 1.0), alpha);\n}\n\nvoid\nmain ()\n{\n	gl_PointSize = x3d_LinewidthScaleFactor;\n\n	vec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n	t = x3d_TextureMatrix * x3d_TexCoord;\n	v = p .xyz;\n\n	gl_Position = x3d_ProjectionMatrix * p;\n\n	if (x3d_Lighting)\n	{\n		vec3 N = normalize (x3d_NormalMatrix * x3d_Normal);\n\n		float ambientIntensity = x3d_AmbientIntensity;\n		vec3  diffuseColor     = x3d_DiffuseColor;\n		vec3  specularColor    = x3d_SpecularColor;\n		vec3  emissiveColor    = x3d_EmissiveColor;\n		float shininess        = x3d_Shininess;\n		float transparency     = x3d_Transparency;\n\n		frontColor = getMaterial (N, v,\n		                          ambientIntensity,\n		                          diffuseColor,\n		                          specularColor,\n		                          emissiveColor,\n		                          shininess,\n		                          transparency);\n\n		if (x3d_SeparateBackColor)\n		{\n			ambientIntensity = x3d_BackAmbientIntensity;\n			diffuseColor     = x3d_BackDiffuseColor;\n			specularColor    = x3d_BackSpecularColor;\n			emissiveColor    = x3d_BackEmissiveColor;\n			shininess        = x3d_BackShininess;\n			transparency     = x3d_BackTransparency;\n		}\n			\n		backColor = getMaterial (-N, v,\n		                         ambientIntensity,\n		                         diffuseColor,\n		                         specularColor,\n		                         emissiveColor,\n		                         shininess,\n		                         transparency);\n	}\n	else\n	{\n	   frontColor = backColor = x3d_ColorMaterial ? x3d_Color : vec4 (1.0, 1.0, 1.0, 1.0);\n	}\n}\n"}),define("text!cobweb/Browser/Shaders/Gouraud.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\n#define GEOMETRY_2D 2\n#define GEOMETRY_3D 3\n\nuniform int x3d_GeometryType;\n// 1\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\n#define NO_FOG           0\n#define LINEAR_FOG       1\n#define EXPONENTIAL_FOG  2\n#define EXPONENTIAL2_FOG 3\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n// 5\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n// 3\n\n#define MAX_TEXTURES 1\n#define NO_TEXTURE   0\n#define TEXTURE_2D   2\n#define TEXTURE_CUBE 4\n\nuniform int         x3d_TextureType [MAX_TEXTURES]; // NO_TEXTURE, TEXTURE_2D or TEXTURE_CUBE\nuniform sampler2D   x3d_Texture [MAX_TEXTURES];\nuniform samplerCube x3d_CubeMapTexture [MAX_TEXTURES];\n// 3\n\nvarying vec4 frontColor; // color\nvarying vec4 backColor;  // color\nvarying vec4 t;          // texCoord\nvarying vec3 v;          // point on geometry\n// 15, max 16\n\nvoid\nclip ()\n{\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nfloat\ngetFogInterpolant ()\n{\n	if (x3d_FogType == NO_FOG)\n		return 1.0;\n\n	float dV = length (v);\n\n	if (dV >= x3d_FogVisibilityRange)\n		return 0.0;\n\n	if (x3d_FogType == LINEAR_FOG)\n		return (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n	if (x3d_FogType == EXPONENTIAL_FOG)\n		return exp (-dV / (x3d_FogVisibilityRange - dV));\n\n	return 1.0;\n}\n\nvec4\ngetTextureColor ()\n{\n	if (x3d_TextureType [0] == TEXTURE_2D)\n	{\n		if (x3d_GeometryType == GEOMETRY_3D || gl_FrontFacing)\n			return texture2D (x3d_Texture [0], vec2 (t));\n		\n		// If dimension is GEOMETRY_2D the texCoords must be flipped.\n		return texture2D (x3d_Texture [0], vec2 (1.0 - t .s, t .t));\n	}\n\n 	if (x3d_TextureType [0] == TEXTURE_CUBE)\n	{\n		if (x3d_GeometryType == GEOMETRY_3D || gl_FrontFacing)\n			return textureCube (x3d_CubeMapTexture [0], vec3 (t));\n		\n		// If dimension is GEOMETRY_2D the texCoords must be flipped.\n		return textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n	}\n \n	return vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nvoid\nmain ()\n{\n 	clip ();\n\n	float f0 = getFogInterpolant ();\n\n	vec4 finalColor = gl_FrontFacing ? frontColor : backColor;\n\n	if (x3d_TextureType [0] != NO_TEXTURE)\n	{\n		if (x3d_Lighting)\n			finalColor *= getTextureColor ();\n		else\n		{\n			if (x3d_ColorMaterial)\n				finalColor *= getTextureColor ();\n			else\n				finalColor = getTextureColor ();\n		}\n	}\n\n	gl_FragColor .rgb = mix (x3d_FogColor, finalColor .rgb, f0);\n	gl_FragColor .a   = finalColor .a;\n}\n"}),define("text!cobweb/Browser/Shaders/Phong.vs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_TextureMatrix;\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\n#define MAX_TEXTURES 1\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;  // true if a X3DMaterialNode is attached, otherwise false\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\nvoid\nmain ()\n{\n	gl_PointSize = x3d_LinewidthScaleFactor;\n\n	vec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n	if (x3d_Lighting)\n		vN = normalize (x3d_NormalMatrix * x3d_Normal);\n\n	t = x3d_TextureMatrix * x3d_TexCoord;\n	C = x3d_Color;\n	v = p .xyz;\n\n	gl_Position = x3d_ProjectionMatrix * p;\n}\n"}),define("text!cobweb/Browser/Shaders/Phong.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\n#define GEOMETRY_2D 2\n#define GEOMETRY_3D 3\n\nuniform int x3d_GeometryType;\n// 1\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\n#define NO_FOG           0\n#define LINEAR_FOG       1\n#define EXPONENTIAL_FOG  2\n#define EXPONENTIAL2_FOG 3\n\nuniform int   x3d_FogType;\nuniform vec3  x3d_FogColor;\nuniform float x3d_FogVisibilityRange;\n// 5\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n// 3\n\n#define MAX_LIGHTS        8\n#define NO_LIGHT          0\n#define DIRECTIONAL_LIGHT 1\n#define POINT_LIGHT       2\n#define SPOT_LIGHT        3\n\nuniform int   x3d_LightType [MAX_LIGHTS]; // 0: DirectionalLight, 1: PointLight, 2: SpotLight\nuniform bool  x3d_LightOn [MAX_LIGHTS];\nuniform vec3  x3d_LightColor [MAX_LIGHTS];\nuniform float x3d_LightIntensity [MAX_LIGHTS];\nuniform float x3d_LightAmbientIntensity [MAX_LIGHTS];\nuniform vec3  x3d_LightAttenuation [MAX_LIGHTS];\nuniform vec3  x3d_LightLocation [MAX_LIGHTS];\nuniform vec3  x3d_LightDirection [MAX_LIGHTS];\nuniform float x3d_LightRadius [MAX_LIGHTS];\nuniform float x3d_LightBeamWidth [MAX_LIGHTS];\nuniform float x3d_LightCutOffAngle [MAX_LIGHTS];\n\nuniform bool x3d_SeparateBackColor;\n\nuniform float x3d_AmbientIntensity;\nuniform vec3  x3d_DiffuseColor;\nuniform vec3  x3d_SpecularColor;\nuniform vec3  x3d_EmissiveColor;\nuniform float x3d_Shininess;\nuniform float x3d_Transparency;\n\nuniform float x3d_BackAmbientIntensity;\nuniform vec3  x3d_BackDiffuseColor;\nuniform vec3  x3d_BackSpecularColor;\nuniform vec3  x3d_BackEmissiveColor;\nuniform float x3d_BackShininess;\nuniform float x3d_BackTransparency;\n\n#define MAX_TEXTURES 1\n#define NO_TEXTURE   0\n#define TEXTURE_2D   2\n#define TEXTURE_CUBE 4\n\nuniform int         x3d_TextureType [MAX_TEXTURES]; // true if a X3DTexture2DNode is attached, otherwise false\nuniform sampler2D   x3d_Texture [MAX_TEXTURES];\nuniform samplerCube x3d_CubeMapTexture [MAX_TEXTURES];\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\nvoid\nclip ()\n{\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nfloat\ngetFogInterpolant ()\n{\n	if (x3d_FogType == NO_FOG)\n		return 1.0;\n\n	float dV = length (v);\n\n	if (dV >= x3d_FogVisibilityRange)\n		return 0.0;\n\n	if (x3d_FogType == LINEAR_FOG)\n		return (x3d_FogVisibilityRange - dV) / x3d_FogVisibilityRange;\n\n	if (x3d_FogType == EXPONENTIAL_FOG)\n		return exp (-dV / (x3d_FogVisibilityRange - dV));\n\n	return 1.0;\n}\n\nvec4\ngetTextureColor ()\n{\n	if (x3d_TextureType [0] == TEXTURE_2D)\n	{\n		if (x3d_GeometryType == GEOMETRY_3D || gl_FrontFacing)\n			return texture2D (x3d_Texture [0], vec2 (t));\n		\n		// If dimension is GEOMETRY_2D the texCoords must be flipped.\n		return texture2D (x3d_Texture [0], vec2 (1.0 - t .s, t .t));\n	}\n\n	if (x3d_TextureType [0] == TEXTURE_CUBE)\n	{\n		if (x3d_GeometryType == GEOMETRY_3D || gl_FrontFacing)\n			return textureCube (x3d_CubeMapTexture [0], vec3 (t));\n		\n		// If dimension is GEOMETRY_2D the texCoords must be flipped.\n		return textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n	}\n\n	return vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nvoid\nmain ()\n{\n	clip ();\n\n	float f0 = getFogInterpolant ();\n\n	if (x3d_Lighting)\n	{\n		vec3  N  = normalize (gl_FrontFacing ? vN : -vN);\n		vec3  V  = normalize (-v); // normalized vector from point on geometry to viewer's position\n		float dV = length (v);\n\n		// Calculate diffuseFactor & alpha\n\n		bool frontColor = gl_FrontFacing || ! x3d_SeparateBackColor;\n\n		float ambientIntensity = frontColor ? x3d_AmbientIntensity : x3d_BackAmbientIntensity;\n		vec3  diffuseColor     = frontColor ? x3d_DiffuseColor     : x3d_BackDiffuseColor;\n		vec3  specularColor    = frontColor ? x3d_SpecularColor    : x3d_BackSpecularColor;\n		vec3  emissiveColor    = frontColor ? x3d_EmissiveColor    : x3d_BackEmissiveColor;\n		float shininess        = frontColor ? x3d_Shininess        : x3d_BackShininess;\n		float transparency     = frontColor ? x3d_Transparency     : x3d_BackTransparency;\n\n		vec3  diffuseFactor = vec3 (1.0, 1.0, 1.0);\n		float alpha         = 1.0 - transparency;\n\n		if (x3d_ColorMaterial)\n		{\n			if (x3d_TextureType [0] != NO_TEXTURE)\n			{\n				vec4 T = getTextureColor ();\n\n				diffuseFactor  = T .rgb * C .rgb;\n				alpha         *= T .a;\n			}\n			else\n				diffuseFactor = C .rgb;\n\n			alpha *= C .a;\n		}\n		else\n		{\n			if (x3d_TextureType [0] != NO_TEXTURE)\n			{\n				vec4 T = getTextureColor ();\n\n				diffuseFactor  = T .rgb * diffuseColor;\n				alpha         *= T .a;\n			}\n			else\n				diffuseFactor = diffuseColor;\n		}\n\n		vec3 ambientTerm = diffuseFactor * ambientIntensity;\n\n		// Apply light sources\n\n		vec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n		for (int i = 0; i < MAX_LIGHTS; ++ i)\n		{\n			int t = x3d_LightType [i];\n\n			if (t != NO_LIGHT)\n			{\n				vec3  vL = x3d_LightLocation [i] - v;\n				float dL = length (vL);\n				bool  di = t == DIRECTIONAL_LIGHT;\n\n				if (di || dL <= x3d_LightRadius [i])\n				{\n					vec3 d = x3d_LightDirection [i];\n					vec3 c = x3d_LightAttenuation [i];\n					vec3 L = di ? -d : normalize (vL);\n					vec3 H = normalize (L + V); // specular term\n	\n					vec3  diffuseTerm    = diffuseFactor * max (dot (N, L), 0.0);\n					float specularFactor = bool (shininess) ? pow (max (dot (N, H), 0.0), shininess) : 1.0;\n					vec3  specularTerm   = specularColor * specularFactor;\n	\n					float attenuation = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n					float spot        = 1.0;\n	\n					if (t == SPOT_LIGHT)\n					{\n						float spotAngle   = acos (clamp (dot (-L, d), -1.0, 1.0));\n						float cutOffAngle = x3d_LightCutOffAngle [i];\n						float beamWidth   = x3d_LightBeamWidth [i];\n						\n						if (spotAngle >= cutOffAngle)\n							spot = 0.0;\n						else if (spotAngle <= beamWidth)\n							spot = 1.0;\n						else\n							spot = (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n					}\n	\n					finalColor += (attenuation * spot) * x3d_LightColor [i] *\n					              (x3d_LightAmbientIntensity [i] * ambientTerm +\n					               x3d_LightIntensity [i] * (diffuseTerm + specularTerm));\n				}\n			}\n			else\n				break;\n		}\n\n		finalColor += emissiveColor;\n\n		gl_FragColor = vec4 (finalColor, alpha);\n	}\n	else\n	{\n		vec4 finalColor = vec4 (1.0, 1.0, 1.0, 1.0);\n	\n		if (x3d_ColorMaterial)\n		{\n			if (x3d_TextureType [0] != NO_TEXTURE)\n			{\n				vec4 T = getTextureColor ();\n\n				finalColor = T * C;\n			}\n			else\n				finalColor = C;\n		}\n		else\n		{\n			if (x3d_TextureType [0] != NO_TEXTURE)\n				finalColor = getTextureColor ();\n		}\n\n		gl_FragColor = finalColor;\n	}\n\n	gl_FragColor .rgb = mix (x3d_FogColor, gl_FragColor .rgb, f0);\n}\n";
}),define("text!cobweb/Browser/Shaders/Depth.vs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Vertex;\n\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n	vec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n	v = p .xyz;\n\n	gl_Position = x3d_ProjectionMatrix * p;\n}\n"}),define("text!cobweb/Browser/Shaders/Depth.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nvec3\npack (float f)\n{\n	vec3 color;\n\n	f *= 255.0;\n	color .r = floor (f);\n\n	f -= color .r;\n	f *= 255.0;\n	color .g = floor (f);\n\n	f -= color .g;\n	f *= 255.0;\n	color .b = floor (f);\n\n	return color / 255.0;\n}\n\nvoid\nmain ()\n{\n	clip ();\n\n	gl_FragColor .rgb = pack (gl_FragCoord .z);\n}\n"}),define("standard/Math/Utility/MatrixStack",["jquery"],function(e){function t(t){return e.extend([new t],{top:0,set:function(e){this[this.top].assign(e)},get:function(e){return this[this.top]},push:function(){var e=++this.top;e<this.length?this[e].assign(this[e-1]):this[e]=this[e-1].copy()},pop:function(){--this.top},identity:function(){this[this.top].identity()},multLeft:function(e){this[this.top].multLeft(e)}})}return t}),define("cobweb/Browser/Rendering/X3DRenderingContext",["cobweb/Fields","cobweb/Components/Shaders/ComposedShader","cobweb/Components/Shaders/ShaderPart","text!cobweb/Browser/Shaders/PointSet.fs","text!cobweb/Browser/Shaders/Wireframe.vs","text!cobweb/Browser/Shaders/Wireframe.fs","text!cobweb/Browser/Shaders/Gouraud.vs","text!cobweb/Browser/Shaders/Gouraud.fs","text!cobweb/Browser/Shaders/Phong.vs","text!cobweb/Browser/Shaders/Phong.fs","text!cobweb/Browser/Shaders/Depth.vs","text!cobweb/Browser/Shaders/Depth.fs","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f){function g(){this.addChildren("viewport",new e.MFInt32(0,0,100,100)),this.projectionMatrix=new p,this.projectionMatrixArray=new Float32Array(16),this.modelViewMatrix=new f(p),this.clipPlanes=[]}return g.prototype={initialize:function(){var e=this.getContext();e.enable(e.SCISSOR_TEST),e.cullFace(e.BACK),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),setInterval(this.reshape.bind(this),401),this.reshape(),this.depthShader=this.createShader(this,c,h),this.pointShader=this.createShader(this,r,i),this.lineShader=this.createShader(this,r,o),this.pointShader.setGeometryType(0),this.lineShader.setGeometryType(1),this.setShading("GOURAUD"),this.setShader(this.getDefaultShader()),this.lineShader.use(),e.uniform1i(this.lineShader.dimension,1)},getVendor:function(){return this.getContext().getParameter(this.getContext().VENDOR)},getWebGLVersion:function(){return this.getContext().getParameter(this.getContext().VERSION)},getAntialiased:function(){return this.getContext().getParameter(this.getContext().SAMPLES)>0},getColorDepth:function(){var e=this.context,t=0;return t+=e.getParameter(e.RED_BITS),t+=e.getParameter(e.BLUE_BITS),t+=e.getParameter(e.GREEN_BITS),t+=e.getParameter(e.ALPHA_BITS)},setProjectionMatrix:function(e){this.projectionMatrix=e,this.projectionMatrixArray.set(e)},getProjectionMatrix:function(){return this.projectionMatrix},getProjectionMatrixArray:function(){return this.projectionMatrixArray},getModelViewMatrix:function(){return this.modelViewMatrix},getViewport:function(){return this.viewport_},createShader:function(e,i,r){var o=new n(e);o.type_="VERTEX",o.url_.push(i),o.setup();var s=new n(e);s.type_="FRAGMENT",s.url_.push(r),s.setup();var a=new t(e);return a.language_="GLSL",a.parts_.push(o),a.parts_.push(s),a.setCustom(!1),a.setup(),this.getLoadSensor().watchList_.push(o),this.getLoadSensor().watchList_.push(s),a},setShading:function(e){var t=this.context;switch(e){case"POINTSET":this.gouraudShader||(this.gouraudShader=this.createShader(this,s,a)),this.defaultShader=this.gouraudShader,this.pointShader.primitiveMode=t.POINTS,this.lineShader.primitiveMode=t.POINTS,this.pointShader.wireframe=!0,this.lineShader.wireframe=!0,this.defaultShader.setShading(e);break;case"WIREFRAME":this.gouraudShader||(this.gouraudShader=this.createShader(this,s,a)),this.defaultShader=this.gouraudShader,this.pointShader.primitiveMode=t.POINTS,this.lineShader.primitiveMode=t.LINES,this.pointShader.wireframe=!0,this.lineShader.wireframe=!0,this.defaultShader.setShading(e);break;case"PHONG":this.phongShader||(this.phongShader=this.createShader(this,u,l)),this.defaultShader=this.phongShader,this.pointShader.primitiveMode=t.POINTS,this.lineShader.primitiveMode=t.LINES,this.pointShader.wireframe=!0,this.lineShader.wireframe=!0,this.defaultShader.setShading(e);break;default:this.gouraudShader||(this.gouraudShader=this.createShader(this,s,a)),this.defaultShader=this.gouraudShader,this.pointShader.primitiveMode=t.POINTS,this.lineShader.primitiveMode=t.LINES,this.pointShader.wireframe=!0,this.lineShader.wireframe=!0,this.defaultShader.setShading(e)}var n=this.getShaders();for(var i in n)n[i].setShading(e)},getDefaultShader:function(){return this.defaultShader},getPointShader:function(){return this.pointShader},getLineShader:function(){return this.lineShader},getGouraudShader:function(){return this.gouraudShader},setShader:function(e){this.shader=e},getShader:function(){return this.shader},getDepthShader:function(){return this.depthShader},getClipPlanes:function(){return this.clipPlanes},reshape:function(){var e=this.canvas,t=e.width(),n=e.height();e=e[0],(t!==e.width||n!==e.height)&&(this.viewport_.setValue([0,0,t,n]),this.context.viewport(0,0,t,n),this.context.scissor(0,0,t,n),e.width=t,e.height=n,this.addBrowserEvent())}},g}),define("cobweb/Browser/Geometry2D/Arc2DOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Fields"],function(e,t,n){function i(e){t.call(this,e.getBrowser(),e),this.addChildren("minAngle",new n.SFFloat(Math.PI/20))}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ArcClose2DOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"arcClose2DOptions"}}),i}),define("cobweb/Browser/Geometry2D/ArcClose2DOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Fields"],function(e,t,n){function i(e){t.call(this,e.getBrowser(),e),this.addChildren("minAngle",new n.SFFloat(Math.PI/20))}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"Arc2DOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"arc2DOptions"}}),i}),define("standard/Math/Numbers/Complex",["jquery"],function(e){function t(e,t){this.real=e,this.imag=t}return t.prototype={constructor:t,copy:function(){var e=Object.create(t.prototype);return e.real=this.real,e.imag=this.imag,e},assign:function(e){return this.real=e.real,this.imag=e.imag,this},equals:function(e){return this.real===e.real&&this.imag===e.imag},setRadius:function(e){return this.setPolar(e,this.getAngle())},getRadius:function(){return this.real?this.imag?Math.sqrt(this.real*this.real+this.imag*this.imag):Math.abs(this.real):Math.abs(this.imag)},setAngle:function(e){return this.setPolar(this.getRadius(),e)},getAngle:function(){return Math.atan2(this.imag,this.real)},setPolar:function(e,t){this.real=e*Math.cos(t),this.imag=e*Math.sin(t)},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){var e=this.real*this.real+this.imag*this.imag;return this.real/=e,this.imag/=-e,this},add:function(e){return this.real+=e.real,this.imag+=e.imag,this},subtract:function(e){return this.real-=e.real,this.imag-=e.imag,this},multiply:function(e){return this.real*=e,this.imag*=e,this},multComp:function(){var e=this.real,t=this.imag;return this.real=e*value.real-t*value.imag,this.imag=e*value.imag+t*value.real,this},divComp:function(e){var t=this.real,n=this.imag,i=e.real,r=e.imag,o=i*i+r*r;return this.real=(t*i+n*r)/o,this.imag=(n*i-t*r)/o,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":String(this.real)}},e.extend(t,{Polar:function(e,n){var i=Object.create(t.prototype);return i.real=e*Math.cos(n),i.imag=e*Math.sin(n),i},multiply:function(e,t){var n=Object.create(this.prototype);return n.real=e.real*t,n.imag=e.imag*t,n},multComp:function(e,t){var n=Object.create(this.prototype);return n.real=e.real*t.real-lsh.imag*t.imag,n.imag=e.real*t.imag+lsh.imag*t.real,n}}),t}),define("cobweb/Browser/Geometry2D/Circle2DOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Fields","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(e,t,n,i,r){function o(e){t.call(this,e.getBrowser(),e),this.addChildren("segments",new n.SFInt32(40)),this.vertices=[]}return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,getTypeName:function(){return"Circle2DOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest(this,"build"),this.build()},getVertices:function(){return this.vertices},build:function(){var e=this.segments_.getValue(),t=2*Math.PI/e;this.vertices.length=0;for(var n=0;e>n;++n){var r=i.Polar(1,t*n);this.vertices.push(r.real,r.imag,0,1)}}}),o}),define("cobweb/Browser/Geometry2D/Disk2DOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Fields","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(e,t,n,i,r){function o(e){t.call(this,e.getBrowser(),e),this.addChildren("segments",new n.SFInt32(40)),this.circleVertices=[],this.diskTexCoords=[],this.diskNormals=[],this.diskVertices=[]}var s=new i(.5,.5);return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,getTypeName:function(){return"Disk2DOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest(this,"build"),this.build()},getCircleVertices:function(){return this.circleVertices},getDiskTexCoords:function(){return this.diskTexCoords},getDiskNormals:function(){return this.diskNormals},getDiskVertices:function(){return this.diskVertices},build:function(){var e=this.segments_.getValue(),t=2*Math.PI/e;this.circleVertices.length=0,this.diskTexCoords.length=0,this.diskNormals.length=0,this.diskVertices.length=0;for(var n=0;e>n;++n){var r=t*n,o=t*(n+1),a=i.Polar(.5,r).add(s),u=i.Polar(.5,o).add(s),l=i.Polar(1,r),c=i.Polar(1,o);this.circleVertices.push(l.real,l.imag,0,1),this.diskTexCoords.push(.5,.5,0,1,a.real,a.imag,0,1,u.real,u.imag,0,1),this.diskNormals.push(0,0,1,0,0,1,0,0,1),this.diskVertices.push(0,0,0,1,l.real,l.imag,0,1,c.real,c.imag,0,1)}}}),o}),define("standard/Math/Geometry/Box3",["standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3"],function(e,t){function n(t,n){switch(arguments.length){case 0:return void(this.matrix=new e(.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,0,t.y/2,0,0,0,0,t.z/2,0,n.x,n.y,n.z,1));case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.z-i.z)/2,u=(r.x+i.x)/2,l=(r.y+i.y)/2,c=(r.z+i.z)/2;return void(this.matrix=new e(o,0,0,0,0,s,0,0,0,0,a,0,u,l,c,1))}}var i=new t(0,0,0),r=new t(0,0,0),o=new t(0,0,0),s=new t(0,0,0),a=new t(0,0,0),u=new t(0,0,0),l=new t(0,0,0),c=new t(0,0,0),h=new t(0,0,0),d=new t(0,0,0),p=new t(0,0,0),f=new t(0,0,0);return n.prototype={constructor:n,copy:function(){var e=Object.create(n.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},set:function(e,t){var n=this.matrix;switch(arguments.length){case 0:return n[0]=.5,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=.5,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=.5,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,this;case 2:return n[0]=e.x/2,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e.y/2,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e.z/2,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this;case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.z-i.z)/2,u=(r.x+i.x)/2,l=(r.y+i.y)/2,c=(r.z+i.z)/2;return n[0]=o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=a,n[11]=0,n[12]=u,n[13]=l,n[14]=c,n[15]=1,this}},setExtents:function(e,t){var n=this.matrix,i=(t.x-e.x)/2,r=(t.y-e.y)/2,o=(t.z-e.z)/2,s=(t.x+e.x)/2,a=(t.y+e.y)/2,u=(t.z+e.z)/2;return n[0]=i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=o,n[11]=0,n[12]=s,n[13]=a,n[14]=u,n[15]=1,this},isEmpty:function(){return 0===this.matrix[15]},add:function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(h,d),e.getExtents(p,f),this.assign(new n(h.min(p),d.max(f),!0)))},multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(e,t){var n=this.matrix;o.set(n[0],n[1],n[2]),s.set(n[4],n[5],n[6]),a.set(n[8],n[9],n[10]),u.assign(s).add(a);var i=a.subtract(s);l.assign(o).add(u),c.assign(o).add(i);var r=u.subtract(o),h=i.subtract(o);e.assign(l),t.assign(l),e.min(r,h,c),t.max(r,h,c),l.negate(),r.negate(),h.negate(),c.negate(),e.min(l,r,h,c),t.max(l,r,h,c)},intersectsPoint:function(e){return this.getExtents(i,r),i.x<=e.x&&r.x>=e.x&&i.y<=e.y&&r.y>=e.y&&i.z<=e.z&&r.z>=e.z},toString:function(){return this.size+", "+this.center}},Object.defineProperty(n.prototype,"size",{get:function(){var e=new t(0,0,0);return this.getAbsoluteExtents(i,e),e.subtract(i)},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),n}),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t){function n(e,t){this.normal=t.copy(),this.distanceFromOrigin=t.dot(e)}var i=new e(0,0,0),r=new e(0,0,0),o=new t;return n.prototype={constructor:n,copy:function(){var e=Object.create(n.prototype);return e.normal=this.normal.copy(),e.distanceFromOrigin=this.distanceFromOrigin,e},assign:function(e){return this.normal.assign(e.normal),this.distanceFromOrigin=e.distanceFromOrigin,this},set:function(e,t){return this.normal.assign(t),this.distanceFromOrigin=t.dot(e),this},multRight:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(e).inverse(),o.multMatrixDir(i.assign(this.normal)).normalize(),e.multVecMatrix(r),this.normal.assign(i),this.distanceFromOrigin=i.dot(r),this},multLeft:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(e).inverse(),o.multDirMatrix(i.assign(this.normal)).normalize(),e.multatrixVec(r),this.normal.assign(i),this.distanceFromOrigin=i.dot(r),this},getDistanceToPoint:function(t){return e.dot(t,this.normal)-this.distanceFromOrigin},intersectsLine:function(e,t){var n=e.point,i=e.direction,r=i.dot(this.normal);if(0===r)return!1;var o=(this.distanceFromOrigin-this.normal.dot(n))/r;return t.x=n.x+i.x*o,t.y=n.y+i.y*o,t.z=n.z+i.z*o,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},n}),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("lib/poly2tri.js/dist/poly2tri.js",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.poly2tri=e()}}(function(){return function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){t.exports={version:"1.3.5"}},{}],2:[function(e,t,n){var i=function(e,t){this.point=e,this.triangle=t||null,this.next=null,this.prev=null,this.value=e.x},r=function(e,t){this.head_=e,this.tail_=t,this.search_node_=e};r.prototype.head=function(){return this.head_},r.prototype.setHead=function(e){this.head_=e},r.prototype.tail=function(){return this.tail_},r.prototype.setTail=function(e){this.tail_=e},r.prototype.search=function(){return this.search_node_},r.prototype.setSearch=function(e){this.search_node_=e},r.prototype.findSearchNode=function(){return this.search_node_},r.prototype.locateNode=function(e){var t=this.search_node_;if(e<t.value){for(;t=t.prev;)if(e>=t.value)return this.search_node_=t,t}else for(;t=t.next;)if(e<t.value)return this.search_node_=t.prev,t.prev;return null},r.prototype.locatePoint=function(e){var t=e.x,n=this.findSearchNode(t),i=n.point.x;if(t===i){if(e!==n.point)if(e===n.prev.point)n=n.prev;else{if(e!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(i>t)for(;(n=n.prev)&&e!==n.point;);else for(;(n=n.next)&&e!==n.point;);return n&&(this.search_node_=n),n},t.exports=r,t.exports.Node=i},{}],3:[function(e,t,n){function i(e,t){if(!e)throw new Error(t||"Assert Failed")}t.exports=i},{}],4:[function(e,t,n){var i=e("./xy"),r=function(e,t){this.x=+e||0,this.y=+t||0,this._p2t_edge_list=null};r.prototype.toString=function(){return i.toStringBase(this)},r.prototype.toJSON=function(){return{x:this.x,y:this.y}},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.set_zero=function(){return this.x=0,this.y=0,this},r.prototype.set=function(e,t){return this.x=+e||0,this.y=+t||0,this},r.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},r.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},r.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},r.prototype.mul=function(e){return this.x*=e,this.y*=e,this},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.normalize=function(){var e=this.length();return this.x/=e,this.y/=e,e},r.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},r.negate=function(e){return new r(-e.x,-e.y)},r.add=function(e,t){return new r(e.x+t.x,e.y+t.y)},r.sub=function(e,t){return new r(e.x-t.x,e.y-t.y)},r.mul=function(e,t){return new r(e*t.x,e*t.y)},r.cross=function(e,t){return"number"==typeof e?"number"==typeof t?e*t:new r(-e*t.y,e*t.x):"number"==typeof t?new r(t*e.y,-t*e.x):e.x*t.y-e.y*t.x},r.toString=i.toString,r.compare=i.compare,r.cmp=i.compare,r.equals=i.equals,r.dot=function(e,t){return e.x*t.x+e.y*t.y},t.exports=r},{"./xy":11}],5:[function(e,t,n){var i=e("./xy"),r=function(e,t){this.name="PointError",this.points=t=t||[],this.message=e||"Invalid Points!";for(var n=0;n<t.length;n++)this.message+=" "+i.toString(t[n])};r.prototype=new Error,r.prototype.constructor=r,t.exports=r},{"./xy":11}],6:[function(e,t,n){(function(t){var i=t.poly2tri;n.noConflict=function(){return t.poly2tri=i,n},n.VERSION=e("../dist/version.json").version,n.PointError=e("./pointerror"),n.Point=e("./point"),n.Triangle=e("./triangle"),n.SweepContext=e("./sweepcontext");var r=e("./sweep");n.triangulate=r.triangulate,n.sweep={Triangulate:r.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(e,t,n){function i(e){e.initTriangulation(),e.createAdvancingFront(),r(e),o(e)}function r(e){var t,n=e.pointCount();for(t=1;n>t;++t)for(var i=e.getPoint(t),r=s(e,i),o=i._p2t_edge_list,u=0;o&&u<o.length;++u)a(e,o[u],r)}function o(e){for(var t=e.front().head().next.triangle,n=e.front().head().next.point;!t.getConstrainedEdgeCW(n);)t=t.neighborCCW(n);e.meshClean(t)}function s(e,t){var n=e.locateNode(t),i=c(e,t,n);return t.x<=n.point.x+R&&h(e,n),d(e,i),i}function a(e,t,n){e.edge_event.constrained_edge=t,e.edge_event.right=t.p.x>t.q.x,l(n.triangle,t.p,t.q)||(v(e,t,n),u(e,t.p,t.q,n.triangle,t.q))}function u(e,t,n,i,r){if(!l(i,t,n)){var o=i.pointCCW(r),s=j(n,o,t);if(s===k.COLLINEAR)throw new I("poly2tri EdgeEvent: Collinear not supported!",[n,o,t]);var a=i.pointCW(r),c=j(n,a,t);if(c===k.COLLINEAR)throw new I("poly2tri EdgeEvent: Collinear not supported!",[n,a,t]);s===c?(i=s===k.CW?i.neighborCCW(r):i.neighborCW(r),u(e,t,n,i,r)):V(e,t,n,i,r)}}function l(e,t,n){var i=e.edgeIndex(t,n);if(-1!==i){e.markConstrainedEdgeByIndex(i);var r=e.getNeighbor(i);return r&&r.markConstrainedEdgeByPoints(t,n),!0}return!1}function c(e,t,n){var i=new A(t,n.point,n.next.point);i.markNeighbor(n.triangle),e.addToMap(i);var r=new P(t);return r.next=n.next,r.prev=n,n.next.prev=r,n.next=r,f(e,i)||e.mapTriangleToNodes(i),r}function h(e,t){var n=new A(t.prev.point,t.point,t.next.point);n.markNeighbor(t.prev.triangle),n.markNeighbor(t.triangle),e.addToMap(n),t.prev.next=t.next,t.next.prev=t.prev,f(e,n)||e.mapTriangleToNodes(n)}function d(e,t){for(var n=t.next;n.next&&!X(n.point,n.next.point,n.prev.point);)h(e,n),n=n.next;for(n=t.prev;n.prev&&!X(n.point,n.next.point,n.prev.point);)h(e,n),n=n.prev;t.next&&t.next.next&&p(t)&&y(e,t)}function p(e){var t=e.point.x-e.next.next.point.x,n=e.point.y-e.next.next.point.y;return E(n>=0,"unordered y"),t>=0||Math.abs(t)<n}function f(e,t){for(var n=0;3>n;++n)if(!t.delaunay_edge[n]){var i=t.getNeighbor(n);if(i){var r=t.getPoint(n),o=i.oppositePoint(t,r),s=i.index(o);if(i.constrained_edge[s]||i.delaunay_edge[s]){t.constrained_edge[n]=i.constrained_edge[s];continue}var a=g(r,t.pointCCW(r),t.pointCW(r),o);if(a){t.delaunay_edge[n]=!0,i.delaunay_edge[s]=!0,m(t,r,i,o);var u=!f(e,t);return u&&e.mapTriangleToNodes(t),u=!f(e,i),u&&e.mapTriangleToNodes(i),t.delaunay_edge[n]=!1,i.delaunay_edge[s]=!1,!0}}}return!1}function g(e,t,n,i){var r=e.x-i.x,o=e.y-i.y,s=t.x-i.x,a=t.y-i.y,u=r*a,l=s*o,c=u-l;if(0>=c)return!1;var h=n.x-i.x,d=n.y-i.y,p=h*o,f=r*d,g=p-f;if(0>=g)return!1;var m=s*d,y=h*a,b=r*r+o*o,w=s*s+a*a,v=h*h+d*d,x=b*(m-y)+w*g+v*c;return x>0}function m(e,t,n,i){var r,o,s,a;r=e.neighborCCW(t),o=e.neighborCW(t),s=n.neighborCCW(i),a=n.neighborCW(i);var u,l,c,h;u=e.getConstrainedEdgeCCW(t),l=e.getConstrainedEdgeCW(t),c=n.getConstrainedEdgeCCW(i),h=n.getConstrainedEdgeCW(i);var d,p,f,g;d=e.getDelaunayEdgeCCW(t),p=e.getDelaunayEdgeCW(t),f=n.getDelaunayEdgeCCW(i),g=n.getDelaunayEdgeCW(i),e.legalize(t,i),n.legalize(i,t),n.setDelaunayEdgeCCW(t,d),e.setDelaunayEdgeCW(t,p),e.setDelaunayEdgeCCW(i,f),n.setDelaunayEdgeCW(i,g),n.setConstrainedEdgeCCW(t,u),e.setConstrainedEdgeCW(t,l),e.setConstrainedEdgeCCW(i,c),n.setConstrainedEdgeCW(i,h),e.clearNeighbors(),n.clearNeighbors(),r&&n.markNeighbor(r),o&&e.markNeighbor(o),s&&e.markNeighbor(s),a&&n.markNeighbor(a),e.markNeighbor(n)}function y(e,t){for(j(t.point,t.next.point,t.next.next.point)===k.CCW?e.basin.left_node=t.next.next:e.basin.left_node=t.next,e.basin.bottom_node=e.basin.left_node;e.basin.bottom_node.next&&e.basin.bottom_node.point.y>=e.basin.bottom_node.next.point.y;)e.basin.bottom_node=e.basin.bottom_node.next;if(e.basin.bottom_node!==e.basin.left_node){for(e.basin.right_node=e.basin.bottom_node;e.basin.right_node.next&&e.basin.right_node.point.y<e.basin.right_node.next.point.y;)e.basin.right_node=e.basin.right_node.next;e.basin.right_node!==e.basin.bottom_node&&(e.basin.width=e.basin.right_node.point.x-e.basin.left_node.point.x,e.basin.left_highest=e.basin.left_node.point.y>e.basin.right_node.point.y,b(e,e.basin.bottom_node))}}function b(e,t){if(!w(e,t)){h(e,t);var n;if(t.prev!==e.basin.left_node||t.next!==e.basin.right_node){if(t.prev===e.basin.left_node){if(n=j(t.point,t.next.point,t.next.next.point),n===k.CW)return;t=t.next}else if(t.next===e.basin.right_node){if(n=j(t.point,t.prev.point,t.prev.prev.point),n===k.CCW)return;t=t.prev}else t=t.prev.point.y<t.next.point.y?t.prev:t.next;b(e,t)}}}function w(e,t){var n;return n=e.basin.left_highest?e.basin.left_node.point.y-t.point.y:e.basin.right_node.point.y-t.point.y,e.basin.width>n?!0:!1}function v(e,t,n){e.edge_event.right?x(e,t,n):T(e,t,n)}function x(e,t,n){for(;n.next.point.x<t.p.x;)j(t.q,n.next.point,t.p)===k.CCW?_(e,t,n):n=n.next}function _(e,t,n){n.point.x<t.p.x&&(j(n.point,n.next.point,n.next.next.point)===k.CCW?C(e,t,n):(S(e,t,n),_(e,t,n)))}function C(e,t,n){h(e,n.next),n.next.point!==t.p&&j(t.q,n.next.point,t.p)===k.CCW&&j(n.point,n.next.point,n.next.next.point)===k.CCW&&C(e,t,n)}function S(e,t,n){j(n.next.point,n.next.next.point,n.next.next.next.point)===k.CCW?C(e,t,n.next):j(t.q,n.next.next.point,t.p)===k.CCW&&S(e,t,n.next)}function T(e,t,n){for(;n.prev.point.x>t.p.x;)j(t.q,n.prev.point,t.p)===k.CW?F(e,t,n):n=n.prev}function F(e,t,n){n.point.x>t.p.x&&(j(n.point,n.prev.point,n.prev.prev.point)===k.CW?N(e,t,n):(O(e,t,n),F(e,t,n)))}function O(e,t,n){j(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===k.CW?N(e,t,n.prev):j(t.q,n.prev.prev.point,t.p)===k.CW&&O(e,t,n.prev)}function N(e,t,n){h(e,n.prev),n.prev.point!==t.p&&j(t.q,n.prev.point,t.p)===k.CW&&j(n.point,n.prev.point,n.prev.prev.point)===k.CW&&N(e,t,n)}function V(e,t,n,i,r){var o=i.neighborAcross(r);E(o,"FLIP failed due to missing triangle!");var s=o.oppositePoint(i,r);if(i.getConstrainedEdgeAcross(r)){var a=i.index(r);throw new I("poly2tri Intersecting Constraints",[r,s,i.getPoint((a+1)%3),i.getPoint((a+2)%3)])}if(z(r,i.pointCCW(r),i.pointCW(r),s))if(m(i,r,o,s),e.mapTriangleToNodes(i),e.mapTriangleToNodes(o),r===n&&s===t)n===e.edge_event.constrained_edge.q&&t===e.edge_event.constrained_edge.p&&(i.markConstrainedEdgeByPoints(t,n),o.markConstrainedEdgeByPoints(t,n),f(e,i),f(e,o));else{var l=j(n,s,t);i=D(e,l,i,o,r,s),V(e,t,n,i,r)}else{var c=M(t,n,o,s);B(e,t,n,i,o,c),u(e,t,n,i,r)}}function D(e,t,n,i,r,o){var s;return t===k.CCW?(s=i.edgeIndex(r,o),i.delaunay_edge[s]=!0,f(e,i),i.clearDelaunayEdges(),n):(s=n.edgeIndex(r,o),n.delaunay_edge[s]=!0,f(e,n),n.clearDelaunayEdges(),i)}function M(e,t,n,i){var r=j(t,i,e);if(r===k.CW)return n.pointCCW(i);if(r===k.CCW)return n.pointCW(i);throw new I("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[t,i,e])}function B(e,t,n,i,r,o){var s=r.neighborAcross(o);E(s,"FLIP failed due to missing triangle");var a=s.oppositePoint(r,o);if(z(n,i.pointCCW(n),i.pointCW(n),a))V(e,n,a,s,a);else{var u=M(t,n,s,a);B(e,t,n,i,s,u)}}var E=e("./assert"),I=e("./pointerror"),A=e("./triangle"),P=e("./advancingfront").Node,L=e("./utils"),R=L.EPSILON,k=L.Orientation,j=L.orient2d,z=L.inScanArea,X=L.isAngleObtuse;n.triangulate=i},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(e,t,n){var i=e("./pointerror"),r=e("./point"),o=e("./triangle"),s=e("./sweep"),a=e("./advancingfront"),u=a.Node,l=.3,c=function(e,t){if(this.p=e,this.q=t,e.y>t.y)this.q=e,this.p=t;else if(e.y===t.y)if(e.x>t.x)this.q=e,this.p=t;else if(e.x===t.x)throw new i("poly2tri Invalid Edge constructor: repeated points!",[e]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},h=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};h.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var d=function(){this.constrained_edge=null,this.right=!1},p=function(e,t){t=t||{},this.triangles_=[],this.map_=[],this.points_=t.cloneArrays?e.slice(0):e,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new h,this.edge_event=new d,this.initEdges(this.points_)};p.prototype.addHole=function(e){this.initEdges(e);var t,n=e.length;for(t=0;n>t;t++)this.points_.push(e[t]);return this},p.prototype.AddHole=p.prototype.addHole,p.prototype.addHoles=function(e){var t,n=e.length;for(t=0;n>t;t++)this.initEdges(e[t]);return this.points_=this.points_.concat.apply(this.points_,e),this},p.prototype.addPoint=function(e){return this.points_.push(e),this},p.prototype.AddPoint=p.prototype.addPoint,p.prototype.addPoints=function(e){return this.points_=this.points_.concat(e),this},p.prototype.triangulate=function(){return s.triangulate(this),this},p.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},p.prototype.getTriangles=function(){return this.triangles_},p.prototype.GetTriangles=p.prototype.getTriangles,p.prototype.front=function(){return this.front_},p.prototype.pointCount=function(){return this.points_.length},p.prototype.head=function(){return this.head_},p.prototype.setHead=function(e){this.head_=e},p.prototype.tail=function(){return this.tail_},p.prototype.setTail=function(e){this.tail_=e},p.prototype.getMap=function(){return this.map_},p.prototype.initTriangulation=function(){var e,t=this.points_[0].x,n=this.points_[0].x,i=this.points_[0].y,o=this.points_[0].y,s=this.points_.length;for(e=1;s>e;e++){var a=this.points_[e];a.x>t&&(t=a.x),a.x<n&&(n=a.x),a.y>i&&(i=a.y),a.y<o&&(o=a.y)}this.pmin_=new r(n,o),this.pmax_=new r(t,i);var u=l*(t-n),c=l*(i-o);this.head_=new r(t+u,o-c),this.tail_=new r(n-u,o-c),this.points_.sort(r.compare)},p.prototype.initEdges=function(e){var t,n=e.length;for(t=0;n>t;++t)this.edge_list.push(new c(e[t],e[(t+1)%n]))},p.prototype.getPoint=function(e){return this.points_[e]},p.prototype.addToMap=function(e){this.map_.push(e)},p.prototype.locateNode=function(e){return this.front_.locateNode(e.x)},p.prototype.createAdvancingFront=function(){var e,t,n,i=new o(this.points_[0],this.tail_,this.head_);this.map_.push(i),e=new u(i.getPoint(1),i),t=new u(i.getPoint(0),i),n=new u(i.getPoint(2)),this.front_=new a(e,n),e.next=t,t.next=n,t.prev=e,n.prev=t},p.prototype.removeNode=function(e){},p.prototype.mapTriangleToNodes=function(e){for(var t=0;3>t;++t)if(!e.getNeighbor(t)){var n=this.front_.locatePoint(e.pointCW(e.getPoint(t)));n&&(n.triangle=e)}},p.prototype.removeFromMap=function(e){var t,n=this.map_,i=n.length;for(t=0;i>t;t++)if(n[t]===e){n.splice(t,1);break}},p.prototype.meshClean=function(e){for(var t,n,i=[e];t=i.pop();)if(!t.isInterior())for(t.setInterior(!0),this.triangles_.push(t),n=0;3>n;n++)t.constrained_edge[n]||i.push(t.getNeighbor(n))},t.exports=p},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(e,t,n){var i=e("./xy"),r=function(e,t,n){this.points_=[e,t,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},o=i.toString;r.prototype.toString=function(){return"["+o(this.points_[0])+o(this.points_[1])+o(this.points_[2])+"]"},r.prototype.getPoint=function(e){return this.points_[e]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(e){return this.neighbors_[e]},r.prototype.containsPoint=function(e){var t=this.points_;return e===t[0]||e===t[1]||e===t[2]},r.prototype.containsEdge=function(e){return this.containsPoint(e.p)&&this.containsPoint(e.q)},r.prototype.containsPoints=function(e,t){return this.containsPoint(e)&&this.containsPoint(t)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(e){return this.interior_=e,this},r.prototype.markNeighborPointers=function(e,t,n){var i=this.points_;if(e===i[2]&&t===i[1]||e===i[1]&&t===i[2])this.neighbors_[0]=n;else if(e===i[0]&&t===i[2]||e===i[2]&&t===i[0])this.neighbors_[1]=n;else{if(!(e===i[0]&&t===i[1]||e===i[1]&&t===i[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},r.prototype.markNeighbor=function(e){
var t=this.points_;e.containsPoints(t[1],t[2])?(this.neighbors_[0]=e,e.markNeighborPointers(t[1],t[2],this)):e.containsPoints(t[0],t[2])?(this.neighbors_[1]=e,e.markNeighborPointers(t[0],t[2],this)):e.containsPoints(t[0],t[1])&&(this.neighbors_[2]=e,e.markNeighborPointers(t[0],t[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(e){var t=this.points_;return e===t[0]?t[2]:e===t[1]?t[0]:e===t[2]?t[1]:null},r.prototype.pointCCW=function(e){var t=this.points_;return e===t[0]?t[1]:e===t[1]?t[2]:e===t[2]?t[0]:null},r.prototype.neighborCW=function(e){return e===this.points_[0]?this.neighbors_[1]:e===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(e){return e===this.points_[0]?this.neighbors_[2]:e===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(e){return e===this.points_[0]?this.constrained_edge[1]:e===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(e){return e===this.points_[0]?this.constrained_edge[2]:e===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(e){return e===this.points_[0]?this.constrained_edge[0]:e===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(e,t){e===this.points_[0]?this.constrained_edge[1]=t:e===this.points_[1]?this.constrained_edge[2]=t:this.constrained_edge[0]=t},r.prototype.setConstrainedEdgeCCW=function(e,t){e===this.points_[0]?this.constrained_edge[2]=t:e===this.points_[1]?this.constrained_edge[0]=t:this.constrained_edge[1]=t},r.prototype.getDelaunayEdgeCW=function(e){return e===this.points_[0]?this.delaunay_edge[1]:e===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(e){return e===this.points_[0]?this.delaunay_edge[2]:e===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(e,t){e===this.points_[0]?this.delaunay_edge[1]=t:e===this.points_[1]?this.delaunay_edge[2]=t:this.delaunay_edge[0]=t},r.prototype.setDelaunayEdgeCCW=function(e,t){e===this.points_[0]?this.delaunay_edge[2]=t:e===this.points_[1]?this.delaunay_edge[0]=t:this.delaunay_edge[1]=t},r.prototype.neighborAcross=function(e){return e===this.points_[0]?this.neighbors_[0]:e===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(e,t){var n=e.pointCW(t);return this.pointCW(n)},r.prototype.legalize=function(e,t){var n=this.points_;if(e===n[0])n[1]=n[0],n[0]=n[2],n[2]=t;else if(e===n[1])n[2]=n[1],n[1]=n[0],n[0]=t;else{if(e!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=t}},r.prototype.index=function(e){var t=this.points_;if(e===t[0])return 0;if(e===t[1])return 1;if(e===t[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(e,t){var n=this.points_;if(e===n[0]){if(t===n[1])return 2;if(t===n[2])return 1}else if(e===n[1]){if(t===n[2])return 0;if(t===n[0])return 2}else if(e===n[2]){if(t===n[0])return 1;if(t===n[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(e){this.constrained_edge[e]=!0},r.prototype.markConstrainedEdgeByEdge=function(e){this.markConstrainedEdgeByPoints(e.p,e.q)},r.prototype.markConstrainedEdgeByPoints=function(e,t){var n=this.points_;t===n[0]&&e===n[1]||t===n[1]&&e===n[0]?this.constrained_edge[2]=!0:t===n[0]&&e===n[2]||t===n[2]&&e===n[0]?this.constrained_edge[1]=!0:(t===n[1]&&e===n[2]||t===n[2]&&e===n[1])&&(this.constrained_edge[0]=!0)},t.exports=r},{"./xy":11}],10:[function(e,t,n){function i(e,t,n){var i=(e.x-n.x)*(t.y-n.y),r=(e.y-n.y)*(t.x-n.x),o=i-r;return o>-s&&s>o?a.COLLINEAR:o>0?a.CCW:a.CW}function r(e,t,n,i){var r=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y);if(r>=-s)return!1;var o=(e.x-n.x)*(i.y-n.y)-(i.x-n.x)*(e.y-n.y);return s>=o?!1:!0}function o(e,t,n){var i=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y;return 0>i*o+r*s}var s=1e-12;n.EPSILON=s;var a={CW:1,CCW:-1,COLLINEAR:0};n.Orientation=a,n.orient2d=i,n.inScanArea=r,n.isAngleObtuse=o},{}],11:[function(e,t,n){function i(e){return"("+e.x+";"+e.y+")"}function r(e){var t=e.toString();return"[object Object]"===t?i(e):t}function o(e,t){return e.y===t.y?e.x-t.x:e.y-t.y}function s(e,t){return e.x===t.x&&e.y===t.y}t.exports={toString:r,toStringBase:i,compare:o,equals:s}},{}]},{},[6])(6)}),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","lib/poly2tri.js/dist/poly2tri.js"],function(e,t,n){var i=new e(0,0,0),r=new e(0,0,0),o=new e(0,0,0),s=new e(0,0,0),a=new e(0,0,0),u=new e(0,0,0),l=new t;return{area:function(e,t,n){return i.assign(v2).subtract(v1).cross(r.assign(v3).subtract(v1)).abs()/2},normal:function(e,t,n,i){var r=n.x-t.x,o=n.y-t.y,s=n.z-t.z,a=e.x-t.x,u=e.y-t.y,l=e.z-t.z;return i.set(o*l-s*u,s*a-r*l,r*u-o*a),i.normalize()},quadNormal:function(e,t,n,i,r){var o=n.x-e.x,s=n.y-e.y,a=n.z-e.z,u=i.x-t.x,l=i.y-t.y,c=i.z-t.z;return r.set(s*c-a*l,a*u-o*c,o*l-s*u),r.normalize()},removeCollinearPoints:function(e){for(var t=0,n=0,i=e.length,r=i-1;i>t;++t){var o=(t+r)%i,s=(t+1)%i;this.isCollinear(e[o],e[t],e[s])||(e[n++]=e[t])}e.length=n},isCollinear:function(e,t,n){var r=i.assign(e).subtract(t).normalize(),s=o.assign(n).subtract(t).normalize();return 0==r.abs()?!0:0==s.abs()?!0:Math.abs(r.dot(s))>=1},triangulatePolygon:function(e,t){try{this.removeCollinearPoints(e);var i=e[0],r=e[1];this.getPolygonNormal(e,u),s.assign(r).subtract(i),a.assign(u).cross(s),s.normalize(),a.normalize(),l.set(s.x,s.y,s.z,0,a.x,a.y,a.z,0,u.x,u.y,u.z,0,i.x,i.y,i.z,1),l.inverse();for(var o=0,c=e.length;c>o;++o)l.multVecMatrix(e[o]);for(var h=new n.SweepContext(e),d=h.triangulate().getTriangles(),o=0,c=d.length;c>o;++o)t.push(d[o].getPoint(0),d[o].getPoint(1),d[o].getPoint(2))}catch(p){this.triangulateConvexPolygon(e,t)}},triangulateConvexPolygon:function(e,t){for(var n=1,i=e.length-1;i>n;++n)t.push(e[0],e[n],e[n+1])},getPolygonNormal:function(e,t){t.set(0,0,0);for(var n=e[0],i=0,r=e.length;r>i;++i){var o=n,n=e[(i+1)%r];t.x+=(o.y-n.y)*(o.z+n.z),t.y+=(o.z-n.z)*(o.x+n.x),t.z+=(o.x-n.x)*(o.y+n.y)}return t.normalize()}}}),define("cobweb/Components/Rendering/X3DGeometryNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l,c,h){function d(e,r){n.call(this,e,r),this.addType(i.X3DGeometryNode),this.addChildren("transparent",new t.SFBool)}var p=[new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0),new s(1,0,0)];return d.prototype=e.extend(Object.create(n.prototype),{constructor:d,intersection:new s(0,0,0),uvt:{u:0,v:0,t:0},v0:new s(0,0,0),v1:new s(0,0,0),v2:new s(0,0,0),normal:new s(0,0,0),setup:function(){this.setTainted(!0),n.prototype.setup.call(this),this.addInterest(this,"eventsProcessed"),this.eventsProcessed(),this.setTainted(!1)},initialize:function(){n.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__");var e=this.getBrowser().getContext();if(this.min=new s(0,0,0),this.max=new s(0,0,0),this.bbox=new u(this.min,this.max,!0),this.solid=!0,this.flatShading=void 0,this.colors=[],this.texCoords=[],this.defaultTexCoords=[],this.texCoordParams={min:new s(0,0,0)},this.normals=[],this.flatNormals=[],this.vertices=[],this.vertexCount=0,this.primitiveMode=e.TRIANGLES,this.frontFace=e.CCW,this.colorBuffer=e.createBuffer(),this.texCoordBuffers=[],this.normalBuffer=e.createBuffer(),this.vertexBuffer=e.createBuffer(),this.colorArray=new Float32Array,this.texCoordArray=[],this.vertexArray=new Float32Array,this.planes=[],!this.isLineGeometry())for(var t=0;5>t;++t)this.planes[t]=new l(s.Zero,p[0]);this.setCurrentTexCoord(null),this.set_live__()},isLineGeometry:function(){return!1},getBBox:function(){return this.bbox},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return a.Identity},setPrimitiveMode:function(e){this.primitiveMode=e},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(e){this.solid=e},setCCW:function(e){this.frontFace=e?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},addColor:function(e){this.colors.push(e.r,e.g,e.b,3===e.length?1:e.a)},setColors:function(e){for(var t=this.colors,n=0,i=e.length;i>n;++n)t[n]=e[n];t.length=i},getColors:function(){return this.colors},setTexCoords:function(e){for(var t=this.texCoords,n=0,i=e.length;i>n;++n)t[n]=e[n];t.length=i},getTexCoords:function(){return this.texCoords},setCurrentTexCoord:function(e){this.currentTexCoordNode=e||this.getBrowser().getDefaultTextureCoordinate()},addNormal:function(e){this.normals.push(e.x,e.y,e.z)},setNormals:function(e){for(var t=this.normals,n=0,i=e.length;i>n;++n)t[n]=e[n];t.length=i},getNormals:function(){return this.normals},addVertex:function(e){this.min.min(e),this.max.max(e),this.vertices.push(e.x,e.y,e.z,1)},setVertices:function(e){for(var t=this.vertices,n=0,i=e.length;i>n;++n)t[n]=e[n];t.length=i},getVertices:function(){return this.vertices},buildTexCoords:function(){var e=this.getTexCoordParams(),t=e.min,n=e.Sindex,i=e.Tindex,r=e.Ssize,o=t[n],s=t[i],a=this.defaultTexCoords,u=this.vertices;a.length=0,this.texCoords.push(a);for(var l=0,c=u.length;c>l;l+=4)a.push((u[l+n]-o)/r,(u[l+i]-s)/r,0,1)},getTexCoordParams:function(){var e=this.texCoordParams,t=this.getBBox(),n=t.size,i=n.x,r=n.y,o=n.z;return e.min.assign(t.center).subtract(n.divide(2)),i>=r&&i>=o?(e.Ssize=i,e.Sindex=0,r>=o?e.Tindex=1:e.Tindex=2):r>=i&&r>=o?(e.Ssize=r,e.Sindex=1,i>=o?e.Tindex=0:e.Tindex=2):(e.Ssize=o,e.Sindex=2,i>=r?e.Tindex=0:e.Tindex=1),e},refineNormals:function(e,t,n){if(0===n)return t;var i=Math.cos(h.clamp(n,0,Math.PI)),r=[];for(var o in e)for(var a=e[o],u=0,l=a.length;l>u;++u){for(var c=a[u],d=t[c],p=new s(0,0,0),f=0;l>f;++f){var g=t[a[f]];g.dot(d)>=i&&p.add(g)}r[c]=p.normalize()}return r},set_live__:function(){var e=this.getExecutionContext().isLive().getValue()&&this.isLive().getValue();e?this.getBrowser().getBrowserOptions().Shading_.addInterest(this,"set_shading__"):this.getBrowser().getBrowserOptions().Shading_.removeInterest(this,"set_shading__")},set_shading__:function(e){if(!this.isLineGeometry()){var t="FLAT"===e.getValue();if(t!==this.flatShading){this.flatShading=t;var n=this.getBrowser().getContext();if(t&&!this.flatNormals.length)for(var i=this.frontFace===n.CW,r=this.flatNormals,o=this.vertices,s=this.v0,a=this.v1,u=this.v2,l=this.normal,h=0,d=o.length;d>h;h+=12)c.normal(s.set(o[h+0],o[h+1],o[h+2]),a.set(o[h+4],o[h+5],o[h+6]),u.set(o[h+8],o[h+9],o[h+10]),l),i&&l.negate(),r.push(l.x,l.y,l.z,l.x,l.y,l.z,l.x,l.y,l.z);n.bindBuffer(n.ARRAY_BUFFER,this.normalBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?this.flatNormals:this.normals),n.STATIC_DRAW)}}},eventsProcessed:function(){if(n.prototype.eventsProcessed.call(this),this.clear(),this.build(),this.vertices.length?this.bbox.setExtents(this.min,this.max):this.bbox.setExtents(this.min.set(0,0,0),this.max.set(0,0,0)),!this.isLineGeometry()){for(var e=this.min,t=this.max,i=0;5>i;++i)this.planes[i].set(i%2?e:t,p[i]);0===this.texCoords.length&&this.buildTexCoords()}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()},clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),this.flatShading=void 0,this.colors.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){var e=this.getBrowser().getContext(),t=this.vertices.length/4;this.colorArray.length!==this.colors.length?this.colorArray=new Float32Array(this.colors):this.colorArray.set(this.colors),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW);for(var n=this.texCoordBuffers.length,i=this.texCoords.length;i>n;++n)this.texCoordBuffers.push(e.createBuffer()),this.texCoordArray.push(new Float32Array);this.texCoordBuffers.length=this.texCoords.length;for(var n=0,i=this.texCoords.length;i>n;++n)this.texCoordArray[n].length!==this.texCoords[n].length?this.texCoordArray[n]=new Float32Array(this.texCoords[n]):this.texCoordArray[n].set(this.texCoords[n]),e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[n]),e.bufferData(e.ARRAY_BUFFER,this.texCoordArray[n],e.STATIC_DRAW);this.vertexArray.length!==this.vertices.length?this.vertexArray=new Float32Array(this.vertices):this.vertexArray.set(this.vertices),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW),this.vertexCount=t},traverse:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getShader();if(!(i.vertex<0)){if(e.colorMaterial=this.colors.length,i.setLocalUniforms(e),this.colors.length&&i.color>=0&&(n.enableVertexAttribArray(i.color),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.vertexAttribPointer(i.color,4,n.FLOAT,!1,0,0)),i.texCoord>=0&&(n.enableVertexAttribArray(i.texCoord),n.bindBuffer(n.ARRAY_BUFFER,this.texCoordBuffers[0]),n.vertexAttribPointer(i.texCoord,4,n.FLOAT,!1,0,0)),i.normal>=0&&(n.enableVertexAttribArray(i.normal),n.bindBuffer(n.ARRAY_BUFFER,this.normalBuffer),n.vertexAttribPointer(i.normal,3,n.FLOAT,!1,0,0)),n.enableVertexAttribArray(i.vertex),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.vertexAttribPointer(i.vertex,4,n.FLOAT,!1,0,0),i.wireframe)for(var r=0,o=this.vertexCount;o>r;r+=3)n.drawArrays(i.primitiveMode,r,3);else{var s=a.prototype.determinant3.call(e.modelViewMatrix)>0;n.frontFace(s?this.frontFace:this.frontFace===n.CCW?n.CW:n.CCW),e.transparent&&!this.solid?(n.enable(n.CULL_FACE),n.cullFace(n.FRONT),n.drawArrays(i.primitiveMode,0,this.vertexCount),n.cullFace(n.BACK),n.drawArrays(i.primitiveMode,0,this.vertexCount)):(this.solid?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),n.drawArrays(i.primitiveMode,0,this.vertexCount))}i.color>=0&&n.disableVertexAttribArray(i.color),i.texCoord>=0&&n.disableVertexAttribArray(i.texCoord),i.normal>=0&&n.disableVertexAttribArray(i.normal),n.disableVertexAttribArray(i.vertex)}},collision:function(e){var t=this.getBrowser(),n=t.getContext();n.enableVertexAttribArray(e.vertex),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.vertexAttribPointer(e.vertex,4,n.FLOAT,!1,0,0),n.drawArrays(this.primitiveMode,0,this.vertexCount),n.disableVertexAttribArray(e.vertex)},intersectsLine:function(e,t,n){try{var i=!1;if(this.intersectsBBox(e))for(var r=this.texCoords[0],a=this.normals,u=this.vertices,l=this.uvt,c=this.v0,h=this.v1,d=this.v2,p=0,f=this.vertexCount;f>p;p+=3){var g=4*p;if(c.x=u[g+0],c.y=u[g+1],c.z=u[g+2],h.x=u[g+4],h.y=u[g+5],h.z=u[g+6],d.x=u[g+8],d.y=u[g+9],d.z=u[g+10],e.intersectsTriangle(c,h,d,l)){var m=l.u,y=l.v,b=1-m-y,w=new s(b*u[g+0]+m*u[g+4]+y*u[g+8],b*u[g+1]+m*u[g+5]+y*u[g+9],b*u[g+2]+m*u[g+6]+y*u[g+10]);if(this.isClipped(w,n))continue;var v=new o(b*r[g+0]+m*r[g+4]+y*r[g+8],b*r[g+1]+m*r[g+5]+y*r[g+9]),x=3*p,_=new s(b*a[x+0]+m*a[x+3]+y*a[x+6],b*a[x+1]+m*a[x+4]+y*a[x+7],b*a[x+2]+m*a[x+5]+y*a[x+8]);t.push({texCoord:v,normal:_,point:w}),i=!0}}return i}catch(C){return console.log(C),!1}},intersectsBBox:function(e){var t=this.planes,n=this.min,i=this.max,r=n.x,o=i.x,s=i.x,a=n.y,u=i.y,l=n.z,s=i.z,c=this.intersection;return t[0].intersectsLine(e,c)&&c.x>=r&&c.x<=o&&c.y>=a&&c.y<=u?!0:t[1].intersectsLine(e,c)&&c.x>=r&&c.x<=o&&c.y>=a&&c.y<=u?!0:t[2].intersectsLine(e,c)&&c.x>=r&&c.x<=o&&c.z>=l&&c.z<=s?!0:t[3].intersectsLine(e,c)&&c.x>=r&&c.x<=o&&c.z>=l&&c.z<=s?!0:t[4].intersectsLine(e,c)&&c.y>=a&&c.y<=u&&c.z>=l&&c.z<=s?!0:!1},transformMatrix:function(e){return e},isClipped:function(e,t){return!this.getCurrentLayer().getClipPlanes().every(function(n){return!n.isClipped(e,t)})},intersectsSphere:function(e){for(var t=this.vertices,n=this.v0,i=this.v1,r=this.v2,o=0,s=this.vertexCount;s>o;o+=3){var a=4*o;if(n.x=t[a+0],n.y=t[a+1],n.z=t[a+2],i.x=t[a+4],i.y=t[a+5],i.z=t[a+6],r.x=t[a+8],r.y=t[a+9],r.z=t[a+10],e.intersectsTriangle(n,i,r))return!0}return!1}}),d}),define("cobweb/Components/Rendering/X3DComposedGeometryNode",["jquery","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r){function o(e,n){t.call(this,e,n),this.addType(i.X3DComposedGeometryNode),this.attribNodes=[],this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,initialize:function(){t.prototype.initialize.call(this),this.attrib_.addInterest(this,"set_attrib__"),this.color_.addInterest(this,"set_color__"),this.texCoord_.addInterest(this,"set_texCoord__"),this.normal_.addInterest(this,"set_normal__"),this.coord_.addInterest(this,"set_coord__"),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getAttrib:function(){return this.attribNodes},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].removeInterest(this,"addNodeEvent");this.attribNodes.length=0;for(var e=0,t=this.attrib_.length;t>e;++e){var r=n(i.X3DVertexAttributeNode,this.attrib_[e]);r&&this.attribNodes.push(r)}for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].addInterest(this,"addNodeEvent")},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest(this,"addNodeEvent"),this.colorNode.removeInterest(this,"set_transparent__")),this.colorNode=n(i.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest(this,"addNodeEvent"),this.colorNode.addInterest(this,"set_transparent__"),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest(this,"addNodeEvent"),this.texCoordNode=n(i.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest(this,"addNodeEvent")},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest(this,"addNodeEvent"),this.normalNode=n(i.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest(this,"addNodeEvent")},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest(this,"addNodeEvent"),this.coordNode=n(i.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest(this,"addNodeEvent")},getPolygonIndex:function(e){return e},getTriangleIndex:function(e){return e},build:function(e,t,n,i){if(this.coordNode&&!this.coordNode.isEmpty()){t-=t%e,i-=i%n;var r=this.colorPerVertex_.getValue(),o=this.normalPerVertex_.getValue(),s=this.getColor(),a=this.getTexCoord(),u=this.getNormal(),l=this.getCoord(),c=this.getTexCoords(),h=0;a&&a.init(c);for(var d=0;i>d;++d){h=Math.floor(d/n);var p=this.getPolygonIndex(this.getTriangleIndex(d));s&&(r?this.addColor(s.getColor(p)):this.addColor(s.getColor(h))),a&&a.addTexCoord(c,p),u&&(o?this.addNormal(u.getVector(p)):this.addNormal(u.getVector(h))),this.addVertex(l.getPoint(p))}this.getNormal()||this.buildNormals(e,t,i),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue()),this.setCurrentTexCoord(this.getTexCoord())}},buildNormals:function(e,t,n){for(var i=this.createNormals(e,t),r=0;n>r;++r)this.addNormal(i[this.getTriangleIndex(r)])},createNormals:function(e,t){var n=this.createFaceNormals(e,t);if(this.normalPerVertex_.getValue()){for(var i=[],r=0;t>r;++r){var o=this.getPolygonIndex(r);i[o]||(i[o]=[]),i[o].push(r)}return this.refineNormals(i,n,Math.PI)}return n},createFaceNormals:function(e,t){for(var n=!this.ccw_.getValue(),i=this.coordNode,r=[],o=0;t>o;o+=e){var s=this.getPolygonNormal(e,i);n&&s.negate();for(var a=0;e>a;++a)r.push(s)}return r},getPolygonNormal:function(e,t){for(var n=new r(0,0,0),i=t.getPoint(this.getPolygonIndex(0)),o=0;e>o;++o){var s=i,i=t.getPoint(this.getPolygonIndex((o+1)%e));n.x+=(s.y-i.y)*(s.z+i.z),n.y+=(s.z-i.z)*(s.x+i.x),n.z+=(s.x-i.x)*(s.y+i.y)}return n.normalize()}}),o}),define("cobweb/Components/Geometry3D/IndexedFaceSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.IndexedFaceSet)}var c=[0,1,2],h=[],d=[],p=[];return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"convex",new t.SFBool(!0)),new n(o.initializeOnly,"creaseAngle",new t.SFFloat),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"colorIndex",new t.MFInt32),new n(o.inputOutput,"texCoordIndex",new t.MFInt32),new n(o.inputOutput,"normalIndex",new t.MFInt32),new n(o.inputOutput,"coordIndex",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getTexCoordPerVertexIndex:function(e){return e<this.texCoordIndex_.length?this.texCoordIndex_[e]:this.coordIndex_[e]},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getNormalPerVertexIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:this.coordIndex_[e]},getNormalIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:e},build:function(){var e=this.triangulate();if(0!==e.length){var t=this.colorPerVertex_.getValue(),n=this.normalPerVertex_.getValue(),i=this.coordIndex_.getValue(),r=this.getColor(),o=this.getTexCoord(),s=this.getNormal(),a=this.getCoord(),u=this.getTexCoords(),l=0;o&&o.init(u);for(var c=0,h=e.length;h>c;++c){for(var d=e[c],p=d.vertices,f=d.triangles,g=0,m=f.length;m>g;++g){var y=p[f[g]],b=i[y].getValue();r&&(t?this.addColor(r.getColor(this.getColorPerVertexIndex(y))):this.addColor(r.getColor(this.getColorIndex(l)))),o&&o.addTexCoord(u,this.getTexCoordPerVertexIndex(y)),s&&(n?this.addNormal(s.getVector(this.getNormalPerVertexIndex(y))):this.addNormal(s.getVector(this.getNormalIndex(l)))),this.addVertex(a.getPoint(b))}++l}this.getNormal()||this.buildNormals(e),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue()),this.setCurrentTexCoord(this.getTexCoord())}},triangulate:function(){var e=this.convex_.getValue(),t=this.coordIndex_.getValue(),n=t.length,i=[];if(!this.getCoord())return i;if(n){this.coordIndex_[n-1]>-1&&(this.coordIndex_.push(-1),++n);for(var r=[],o=0;n>o;++o){var s=t[o].getValue();if(s>-1)r.push(o);else if(r.length)switch(r[0]===r[r.length-1]&&r.pop(),r.length){case 0:case 1:case 2:r.length=0;break;case 3:i.push({vertices:r,triangles:c}),r=[];break;default:var a=[],u={vertices:r,triangles:a};e?this.triangulateConvexPolygon(u):this.triangulatePolygon(u),a.length<3?r.length=0:(i.push(u),r=[])}}}return i},triangulatePolygon:function(e){for(var t=e.vertices,n=e.triangles,i=this.coordIndex_.getValue(),r=this.getCoord(),o=0,s=t.length;s>o;++o){var a=r.getPoint(i[t[o]].getValue()).copy();a.index=o,h[o]=a}h.length=s,u.triangulatePolygon(h,n);for(var o=0,s=n.length;s>o;++o)n[o]=n[o].index},triangulateConvexPolygon:function(e){for(var t=e.vertices,n=e.triangles,i=1,r=t.length-1;r>i;++i)n.push(0,i,i+1)},buildNormals:function(e){for(var t=0,n=this.createNormals(e),i=0,r=e.length;r>i;++i){for(var o=e[i],s=o.vertices,a=o.triangles,u=0,l=a.length;l>u;++u)this.addNormal(n[t+a[u]]);t+=s.length}},createNormals:function(e){var t=!this.ccw_.getValue(),n=this.coordIndex_.getValue(),i=this.getCoord(),r=null;d.length=0,p.length=0;for(var o=0,s=e.length;s>o;++o){var a=e[o],u=a.vertices,l=u.length;switch(l){case 3:r=i.getNormal(n[u[0]].getValue(),n[u[1]].getValue(),n[u[2]].getValue());break;case 4:r=i.getQuadNormal(n[u[0]].getValue(),n[u[1]].getValue(),n[u[2]].getValue(),n[u[3]].getValue());break;default:r=this.getPolygonNormal(u,n,i)}for(var c=0;l>c;++c){var h=n[u[c]].getValue();p[h]||(p[h]=[]),p[h].push(d.length+c)}t&&r.negate();for(var c=0,f=l;f>c;++c)d.push(r)}return this.refineNormals(p,d,this.creaseAngle_.getValue())},getPolygonNormal:function(e,t,n){for(var i=new s(0,0,0),r=n.getPoint(t[e[0]].getValue()),o=0,a=e.length;a>o;++o){var u=r,r=n.getPoint(t[e[(o+1)%a]].getValue());i.x+=(u.y-r.y)*(u.z+r.z),i.y+=(u.z-r.z)*(u.x+r.x),i.z+=(u.x-r.x)*(u.y+r.y)}return i.normalize()}}),l}),define("cobweb/Components/Rendering/X3DGeometricPropertyNode",["jquery","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DGeometricPropertyNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Rendering/X3DCoordinateNode",["jquery","cobweb/Components/Rendering/X3DGeometricPropertyNode","cobweb/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(e,t,n,i,r){function o(e,i){t.call(this,e,i),this.addType(n.X3DCoordinateNode),this.point=this.point_.getValue()}return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,isEmpty:function(){return 0==this.point.length},getSize:function(){return this.point.length},getPoint:function(e){return e<this.point.length?this.point[e].getValue():new r(0,0,0)},getNormal:function(e,t,n){var o=this.point,s=o.length;return s>e&&s>t&&s>n?i.normal(o[e].getValue(),o[t].getValue(),o[n].getValue(),new r(0,0,0)):new r(0,0,0)},getQuadNormal:function(e,t,n,o){var s=this.point,a=s.length;return a>e&&a>t&&a>n&&a>o?i.quadNormal(s[e].getValue(),s[t].getValue(),s[n].getValue(),s[o].getValue(),new r(0,0,0)):new r(0,0,0)}}),o}),define("cobweb/Components/Rendering/Coordinate",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DCoordinateNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.Coordinate)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),s}),define("cobweb/Components/Texturing/X3DTextureCoordinateNode",["jquery","cobweb/Components/Rendering/X3DGeometricPropertyNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DTextureCoordinateNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,init:function(e){e.push([])},addTexCoord:function(e,t){this.addTexCoordToChannel(e[0],t)}}),i}),define("cobweb/Components/Texturing/TextureCoordinate",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureCoordinateNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureCoordinate)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(e,t){if(t>=0&&t<this.point_.length){var n=this.point_[t];e.push(n.x,n.y,0,1)}else e.push(0,0,0,1)}}),s}),define("cobweb/Browser/Geometry2D/Rectangle2DOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Components/Geometry3D/IndexedFaceSet","cobweb/Components/Rendering/Coordinate","cobweb/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){t.call(this,e.getBrowser(),e)}return a.prototype=e.extend(Object.create(t.prototype),{constructor:a,getTypeName:function(){return"Rectangle2DOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"rectangle2DOptions"},initialize:function(){t.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new n(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new i(this.getExecutionContext());var e=this.geometry,t=this.geometry.texCoord_.getValue(),a=this.geometry.coord_.getValue();return e.texCoordIndex_=[0,1,2,3,-1],e.coordIndex_=[0,1,2,3,-1],t.point_=[new o(1,1),new o(0,1),new o(0,0),new o(1,0)],a.point_=[new s(1,1,0),new s(-1,1,0),new s(-1,-1,0),new s(1,-1,0)],t.setup(),a.setup(),e.setup(),this.geometry}}),a}),define("cobweb/Browser/Geometry2D/X3DGeometry2DContext",["cobweb/Browser/Geometry2D/Arc2DOptions","cobweb/Browser/Geometry2D/ArcClose2DOptions","cobweb/Browser/Geometry2D/Circle2DOptions","cobweb/Browser/Geometry2D/Disk2DOptions","cobweb/Browser/Geometry2D/Rectangle2DOptions"],function(e,t,n,i,r){function o(e,t){return this[e]?this[e]:(this[e]=new t(this),this[e].setup(),this[e])}function s(){}return s.prototype={initialize:function(){},getArc2DOptions:function(){return o.call(this,"arc2DOptions",e)},getArcClose2DOptions:function(){return o.call(this,"arcClose2DOptions",t)},getCircle2DOptions:function(){return o.call(this,"circle2DOptions",n)},getDisk2DOptions:function(){return o.call(this,"disk2DOptions",i)},getRectangle2DOptions:function(){return o.call(this,"rectangle2DOptions",r)}},s}),define("cobweb/Browser/Geometry3D/BoxOptions",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Components/Geometry3D/IndexedFaceSet","cobweb/Components/Rendering/Coordinate","cobweb/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){t.call(this,e.getBrowser(),e)}return a.prototype=e.extend(Object.create(t.prototype),{constructor:a,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"boxOptions"},initialize:function(){t.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new n(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new i(this.getExecutionContext());var e=this.geometry,t=this.geometry.texCoord_.getValue(),a=this.geometry.coord_.getValue();return e.texCoordIndex_=[0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1],e.coordIndex_=[0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1],t.point_=[new o(1,1),new o(0,1),new o(0,0),new o(1,0)],a.point_=[new s(1,1,1),new s(-1,1,1),new s(-1,-1,1),new s(1,-1,1),new s(1,1,-1),new s(-1,1,-1),new s(-1,-1,-1),new s(1,-1,-1)],t.setup(),a.setup(),
e.setup(),this.geometry}}),a}),define("cobweb/Browser/Geometry3D/ConeOptions",["jquery","cobweb/Fields","cobweb/Basic/X3DBaseNode"],function(e,t,n){function i(e){n.call(this,e.getBrowser(),e),this.addChildren("uDimension",new t.SFInt32(1),"vDimension",new t.SFInt32(20))}return i.prototype=e.extend(Object.create(n.prototype),{constructor:i,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"coneOptions"}}),i}),define("cobweb/Browser/Geometry3D/CylinderOptions",["jquery","cobweb/Fields","cobweb/Basic/X3DBaseNode"],function(e,t,n){function i(e){n.call(this,e.getBrowser(),e),this.addChildren("uDimension",new t.SFInt32(1),"vDimension",new t.SFInt32(20))}return i.prototype=e.extend(Object.create(n.prototype),{constructor:i,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"cylinderOptions"}}),i}),define("cobweb/Browser/Geometry3D/QuadSphereOptions",["jquery","cobweb/Fields","cobweb/Basic/X3DBaseNode","cobweb/Components/Geometry3D/IndexedFaceSet","cobweb/Components/Rendering/Coordinate","cobweb/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u){function l(e){n.call(this,e.getBrowser(),e),this.addChildren("uDimension",new t.SFInt32(32),"vDimension",new t.SFInt32(16))}return l.prototype=e.extend(Object.create(n.prototype),{constructor:l,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"Cobweb"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){n.prototype.initialize.call(this),this.addInterest(this,"eventsProcessed")},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){for(var e=this.uDimension_.getValue()+1,t=this.vDimension_.getValue()+1,n=this.geometry.texCoordIndex_,i=0,r=e-1;r>i;++i)n.push(i),n.push(i+e-1),n.push(i+e),n.push(-1);for(var o=e-1,s=0,a=t-3;a>s;++s,++o)for(var i=0,r=e-1;r>i;++i,++o)n.push(o),n.push(o+e),n.push(o+e+1),n.push(o+1),n.push(-1);for(var o=(t-2)*e-1,i=0,r=e-1;r>i;++i,++o)n.push(o+e),n.push(o+1),n.push(o),n.push(-1)},createTexCoord:function(){for(var e=this.uDimension_.getValue()+1,t=this.vDimension_.getValue()+1,n=this.geometry.texCoord_.getValue().point_,i=-.5/(e-1),r=1;e>r;++r){var o=r/(e-1)+i;n.push(new a(o,1))}for(var s=1,u=t-1;u>s;++s)for(var l=1-s/(t-1),r=0;e>r;++r){var o=r/(e-1);n.push(new a(o,l))}for(var r=1;e>r;++r){var o=r/(e-1)+i;n.push(new a(o,0))}},createCoordIndex:function(){for(var e=this.uDimension_.getValue()+1,t=this.vDimension_.getValue()+1,n=this.geometry.coordIndex_,i=1,r=e-1;r>i;++i)n.push(0),n.push(i),n.push(i+1),n.push(-1);n.push(0),n.push(i),n.push(1),n.push(-1);for(var o=1,s=0,a=t-3;a>s;++s,++o){for(var i=0,r=e-2;r>i;++i,++o)n.push(o),n.push(o+e-1),n.push(o+e),n.push(o+1),n.push(-1);n.push(o),n.push(o+e-1),n.push(o+1),n.push(o-e+2),n.push(-1)}for(var u=o+e-1,i=0,r=e-2;r>i;++i,++o)n.push(u),n.push(o+1),n.push(o),n.push(-1);n.push(u),n.push(u-e+1),n.push(o),n.push(-1)},createPoints:function(){var e=this.uDimension_.getValue()+1,t=this.vDimension_.getValue()+1,n=this.geometry.coord_.getValue().point_;n.push(new u(0,1,0));for(var i=1,r=t-1;r>i;++i)for(var o=s.Polar(1,-Math.PI*i/r),a=0,l=e-1;l>a;++a){var c=s.Polar(o.imag,2*Math.PI*a/l);n.push(new u(c.imag,o.real,c.real))}n.push(new u(0,-1,0))},eventsProcessed:function(){this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new o(this.getExecutionContext()),this.geometry.coord_=new r(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();var e=this.geometry,t=this.geometry.texCoord_.getValue(),n=this.geometry.coord_.getValue();e.creaseAngle_=Math.PI,t.setup(),n.setup(),e.setup()}}),l}),define("cobweb/Browser/Geometry3D/X3DGeometry3DContext",["cobweb/Browser/Geometry3D/BoxOptions","cobweb/Browser/Geometry3D/ConeOptions","cobweb/Browser/Geometry3D/CylinderOptions","cobweb/Browser/Geometry3D/QuadSphereOptions"],function(e,t,n,i){function r(e,t){return this[e]?this[e]:(this[e]=new t(this),this[e].setup(),this[e])}function o(){}return o.prototype={initialize:function(){},getBoxOptions:function(){return r.call(this,"boxOptions",e)},getConeOptions:function(){return r.call(this,"coneOptions",t)},getCylinderOptions:function(){return r.call(this,"cylinderOptions",n)},getSphereOptions:function(){return r.call(this,"sphereOptions",i)}},o}),define("cobweb/Browser/PointingDeviceSensor/PointingDevice",["jquery","cobweb/Basic/X3DBaseNode"],function(e,t){function n(e){t.call(this,e.getBrowser(),e),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return n.prototype=$.extend(Object.create(t.prototype),{constructor:n,initialize:function(){var e=this.getBrowser();e.getCanvas().bind("mousedown.PointingDevice",this.mousedown.bind(this)),e.getCanvas().bind("mouseup.PointingDevice",this.mouseup.bind(this)),e.getCanvas().bind("mousemove.PointingDevice",this.mousemove.bind(this)),e.getCanvas().bind("mouseout.PointingDevice",this.onmouseout.bind(this))},mousedown:function(e){e.preventDefault();var t=this.getBrowser();if(t.getCanvas().focus(),!(t.hasShiftKey()&&t.hasCtrlKey()||0!==e.button)){var n=t.getCanvas().offset(),i=e.pageX-n.left,r=t.getCanvas().height()-(e.pageY-n.top);t.getCanvas().unbind("mousemove.PointingDevice"),$(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),$(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),t.buttonPressEvent(i,r)&&(e.stopImmediatePropagation(),t.setCursor("HAND"),t.finished().addInterest(this,"onverifymotion",i,r))}},mouseup:function(e){e.preventDefault();var t=this.getBrowser();if(0===e.button){t.buttonReleaseEvent();var n=t.getCanvas().offset(),i=e.pageX-n.left,r=t.getCanvas().height()-(e.pageY-n.top);$(document).unbind(".PointingDevice"+this.getId()),t.getCanvas().bind("mousemove.PointingDevice",this.mousemove.bind(this)),t.setCursor(this.isOver?"HAND":"DEFAULT"),t.finished().addInterest(this,"onverifymotion",i,r),t.addBrowserEvent(),this.cursor="DEFAULT"}},mousemove:function(e){e.preventDefault();var t=this.getBrowser();if(this.motionTime!==t.getCurrentTime()){this.motionTime=t.getCurrentTime();var n=t.getCanvas().offset(),i=e.pageX-n.left,r=t.getCanvas().height()-(e.pageY-n.top);this.onmotion(i,r)}},onmotion:function(e,t){var n=this.getBrowser();n.motionNotifyEvent(e,t)?this.isOver||(this.isOver=!0,this.cursor=n.getCursor(),n.setCursor("HAND")):this.isOver&&(this.isOver=!1,n.setCursor(this.cursor))},onmouseout:function(e){e.preventDefault(),this.getBrowser().leaveNotifyEvent()},onverifymotion:function(e,t,n){this.getBrowser().finished().removeInterest(this,"onverifymotion"),this.onmotion(t,n)}}),n}),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],function(e){function t(e,t){this.point=e.copy(),this.direction=t.copy()}return t.prototype={constructor:t,u:new e(0,0,0),pvec:new e(0,0,0),tvec:new e(0,0,0),copy:function(){var e=Object.create(t.prototype);return e.point=this.point.copy(),e.direction=this.direction.copy(),e},assign:function(e){return this.point.assign(e.point),this.direction.assign(e.direction),this},multMatrixLine:function(e){return e.multMatrixVec(this.point),e.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(e){return e.multVecMatrix(this.point),e.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(e){var t=e.copy().subtract(this.point),n=t.dot(this.direction);return t.assign(this.direction).multiply(n).add(this.point)},getClosestPointToLine:function(t,n){var i=this.point,r=t.point,o=this.direction,s=t.direction,a=e.dot(o,s);if(Math.abs(a)>=1)return!1;var u=this.u.assign(r).subtract(i);return a=(e.dot(u,o)-a*e.dot(u,s))/(1-a*a),n.assign(o).multiply(a).add(i),!0},getPerpendicularVector:function(t){var n=e.subtract(this.point,t);return n.subtract(this.direction.copy().multiply(e.dot(n,this.direction)))},intersectsTriangle:function(e,t,n,i){var r=t.subtract(e),o=n.subtract(e),s=this.pvec.assign(this.direction).cross(o),a=r.dot(s);if(0===a)return!1;var u=1/a,l=this.tvec.assign(this.point).subtract(e),c=l.dot(s)*u;if(0>c||c>1)return!1;var h=l.cross(r),d=this.direction.dot(h)*u;if(0>d||c+d>1)return!1;var p=o.dot(h)*u;return i.u=c,i.v=d,i.t=p,!0},toString:function(){return this.point+", "+this.direction}},t.Points=function(n,i){var r=Object.create(t.prototype);return r.point=n.copy(),r.direction=e.subtract(i,n).normalize(),r},t}),define("standard/Math/Geometry/ViewVolume",["jquery","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s){function a(e,t,i){this.viewport=new o(0,0,0,0),this.scissor=new o(0,0,0,0),this.planes=[new n(r.Zero,r.Zero),new n(r.Zero,r.Zero),new n(r.Zero,r.Zero),new n(r.Zero,r.Zero),new n(r.Zero,r.Zero),new n(r.Zero,r.Zero)],this.set(e,t,i)}var u=new r(0,0,0),l=new r(0,0,0),c=new r(0,0,0),h=new r(0,0,0),d=new r(0,0,0),p=new r(0,0,0),f=new r(0,0,0),g=new r(0,0,0),m=new s,y=new r(0,0,0),b=new o(0,0,0,0);return a.prototype={constructor:a,set:function(e,t,n){try{this.viewport.assign(t),this.scissor.assign(n);var r=n[0],o=n[0]+n[2],s=n[1],f=n[1]+n[3];m.assign(e).inverse(),a.unProjectPointMatrix(r,f,1,m,t,u),a.unProjectPointMatrix(r,s,1,m,t,l),a.unProjectPointMatrix(r,s,0,m,t,c),a.unProjectPointMatrix(o,s,0,m,t,h),a.unProjectPointMatrix(o,f,0,m,t,d),a.unProjectPointMatrix(o,f,1,m,t,p),this.planes[0].set(h,i.normal(d,h,c,y)),this.planes[1].set(l,i.normal(c,l,u,y)),this.planes[2].set(d,i.normal(h,d,p,y)),this.planes[3].set(p,i.normal(u,p,d,y)),this.planes[4].set(c,i.normal(l,c,h,y)),this.planes[5].set(u,i.normal(p,u,l,y)),this.valid=!0}catch(g){this.valid=!1,console.log(g)}},getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},intersectsSphere:function(e,t){var n=this.planes;return n[0].getDistanceToPoint(t)+e<0?!1:n[1].getDistanceToPoint(t)+e<0?!1:n[2].getDistanceToPoint(t)+e<0?!1:n[3].getDistanceToPoint(t)+e<0?!1:n[4].getDistanceToPoint(t)+e<0?!1:n[5].getDistanceToPoint(t)+e<0?!1:!0}},e.extend(a,{unProjectPoint:function(e,t,n,i,r,o,a){var u=s.multRight(i,r).inverse();return this.unProjectPointMatrix(e,t,n,u,o,a)},unProjectPointMatrix:function(e,t,n,i,r,o){if(b.set((e-r[0])/r[2]*2-1,(t-r[1])/r[3]*2-1,2*n-1,1),i.multVecMatrix(b),0===b.w)throw new Error("Couldn't unproject point: divisor is 0.");var s=1/b.w;return o.set(b.x*s,b.y*s,b.z*s)},unProjectLine:function(e,n,i,r,o){return m.assign(i).multRight(r).inverse(),a.unProjectPointMatrix(e,n,0,m,o,f),a.unProjectPointMatrix(e,n,.9,m,o,g),new t.Points(f,g)},projectPoint:function(e,t,n,i,r){if(b.set(e.x,e.y,e.z,1),n.multVecMatrix(t.multVecMatrix(b)),0===b.w)throw new Error("Couldn't project point: divisor is 0.");var o=1/(2*b.w);return r.set((b.x*o+.5)*i[2]+i[0],(b.y*o+.5)*i[3]+i[1],b.z*o+.5)},projectLine:function(e,n,i,o){return a.projectPoint(e.point,n,i,o,f),a.projectPoint(r.multiply(e.direction,1e9).add(e.point),n,i,o,g),f.z=0,g.z=0,new t.Points(f,g)}}),a}),define("standard/Math/Algorithms/MergeSort",[],function(){function e(e,t){this.array=e,this.auxiliary=[],t&&(this.compare=t)}return e.prototype={compare:function(e,t){return t>e},sort:function(e,t){this.mergeSort(e,t-1)},mergeSort:function(e,t){if(t>e){var n=e+t>>>1;this.mergeSort(e,n),this.mergeSort(n+1,t),this.merge(e,n,t)}},merge:function(e,t,n){var i,r,o;for(i=0,r=e;t>=r;)this.auxiliary[i++]=this.array[r++];for(i=0,o=e;r>o&&n>=r;)this.compare(this.array[r],this.auxiliary[i])?this.array[o++]=this.array[r++]:this.array[o++]=this.auxiliary[i++];for(;r>o;)this.array[o++]=this.auxiliary[i++]}},e}),define("cobweb/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["jquery","cobweb/Browser/PointingDeviceSensor/PointingDevice","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l,c){function h(){this.pointingDevice=new t(this),this.pointer=new s(0,0),this.hits=[],this.enabledSensors=[{}],this.selectedLayer=null,this.overSensors={},this.activeSensors={},this.hitPointSorter=new l(this.hits,function(e,t){return e.intersection.point.z<t.intersection.point.z}),this.layerSorter=new l(this.hits,function(e,t){return e.layerNumber<t.layerNumber}),this.pickingTime=0}var d=new r(new a(0,0,0),new a(0,0,0));return h.prototype={initialize:function(){this.getCanvas().attr("tabindex",8803068),this.setCursor("DEFAULT"),this.pointingDevice.setup()},setCursor:function(e){this.cursorType=e;var t=this.getBrowser().getElement().find(".cobweb-surface");switch(e){case"HAND":t.css("cursor","pointer");break;case"MOVE":t.css("cursor","move");break;case"CROSSHAIR":t.css("cursor","crosshair");break;default:this.loadCount_.getValue()?t.css("cursor","wait"):this.pointingDevice&&this.pointingDevice.isOver?t.css("cursor","pointer"):t.css("cursor","default")}},getCursor:function(){return this.cursorType},isPointerInRectangle:function(e){return this.pointer.x>e.x&&this.pointer.x<e.x+e.z&&this.pointer.y>e.y&&this.pointer.y<e.y+e.w},setLayerNumber:function(e){this.layerNumber=e},getSelectedLayer:function(){return this.selectedLayer},setHitRay:function(e){try{return this.hitRay=o.unProjectLine(this.pointer.x,this.pointer.y,u.Identity,this.getProjectionMatrix(),e)}catch(t){return this.hitRay=d}},getHitRay:function(){return this.hitRay},getSensors:function(){return this.enabledSensors},addHit:function(e,t){this.hits.push({pointer:this.pointer,hitRay:this.hitRay,intersection:e,sensors:this.enabledSensors[this.enabledSensors.length-1],layer:t,layerNumber:this.layerNumber})},getHits:function(){return this.hits},getNearestHit:function(){return this.hits[this.hits.length-1]},buttonPressEvent:function(t,n){if(this.touch(t,n),0===this.hits.length)return!1;var i=this.getNearestHit();this.selectedLayer=i.layer,this.activeSensors=i.sensors;for(var r in this.activeSensors)this.activeSensors[r].set_active__(i,!0);return!e.isEmptyObject(i.sensors)},buttonReleaseEvent:function(){this.selectedLayer=null;for(var e in this.activeSensors)this.activeSensors[e].set_active__(null,!1);return this.activeSensors={},!0},motionNotifyEvent:function(t,n){return this.touch(t,n),this.motion(),this.hits.length&&!e.isEmptyObject(this.hits[this.hits.length-1].sensors)},leaveNotifyEvent:function(){},touch:function(e,t){var i=performance.now();this.pointer.set(e,t),this.hits.length=0,this.getWorld().traverse(n.POINTER),this.hitPointSorter.sort(0,this.hits.length),this.layerSorter.sort(0,this.hits.length),this.addBrowserEvent(),this.pickingTime=performance.now()-i},motion:function(){if(this.hits.length)var t=this.hits[this.hits.length-1];else var n=this.selectedLayer?this.selectedLayer.getHitRay():d,t={pointer:this.pointer,modelViewMatrix:new u,hitRay:n,intersection:null,sensors:{},shape:null,layer:null,layerNumber:0};if(this.hits.length)var r=c.set_difference(this.overSensors,t.sensors,{});else var r=e.extend({},this.overSensors);for(var o in r)r[o].set_over__(t,!1);if(this.hits.length){this.overSensors=t.sensors;for(var o in this.overSensors)this.overSensors[o].set_over__(t,!0)}else this.overSensors={};for(var o in this.activeSensors){var s=this.activeSensors[o];-1!==s.getType().indexOf(i.X3DDragSensorNode)&&s.set_motion__(t)}}},h}),define("cobweb/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext",["jquery"],function(e){function t(){this.keyDeviceSensorNode=null,this.shiftKey=!1,this.ctrlKey=!1,this.altKey=!1,this.altGrKey=!1}return t.prototype={initialize:function(){this.getCanvas().bind("keydown.X3DKeyDeviceSensorContext",this.keydown.bind(this)),this.getCanvas().bind("keyup.X3DKeyDeviceSensorContext",this.keyup.bind(this))},setKeyDeviceSensorNode:function(e){this.keyDeviceSensorNode=e},getKeyDeviceSensorNode:function(){return this.keyDeviceSensorNode},hasShiftKey:function(){return this.shiftKey},hasCtrlKey:function(){return this.ctrlKey},hasAltKey:function(){return this.altKey},hasAltGrKey:function(){return this.altGrKey},keydown:function(e){switch(e.preventDefault(),this.keyDeviceSensorNode&&this.keyDeviceSensorNode.keydown(e),e.which){case 16:this.shiftKey=!0;break;case 17:this.ctrlKey=!0;break;case 18:this.altKey=!0;break;case 49:this.ctrlKey&&(this.setBrowserOption("Shading","POINTSET"),this.getNotification().string_="Shading: Pointset");break;case 50:this.ctrlKey&&(this.setBrowserOption("Shading","WIREFRAME"),this.getNotification().string_="Shading: Wireframe");break;case 51:this.ctrlKey&&(this.setBrowserOption("Shading","FLAT"),this.getNotification().string_="Shading: Flat");break;case 52:this.ctrlKey&&(this.setBrowserOption("Shading","GOURAUD"),this.getNotification().string_="Shading: Gouraud");break;case 53:this.ctrlKey&&(this.setBrowserOption("Shading","PHONG"),this.getNotification().string_="Shading: Phong");break;case 83:this.ctrlKey&&(this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification().string_=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this.altGrKey=!0;break;case 171:this.ctrlKey&&(this.getBrowserTimings().enabled_=!this.getBrowserTimings().enabled_.getValue());break;case 36:this.firstViewpoint();break;case 35:this.lastViewpoint();break;case 33:this.previousViewpoint();break;case 34:this.nextViewpoint()}},keyup:function(e){switch(e.preventDefault(),this.keyDeviceSensorNode&&this.keyDeviceSensorNode.keyup(e),e.which){case 16:this.shiftKey=!1;break;case 17:this.ctrlKey=!1;break;case 18:this.altKey=!1;break;case 225:this.altGrKey=!1}}},t}),define("cobweb/Components/Core/X3DBindableNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DBindableNode),this.layers={}}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.set_live__()},getCameraObject:function(){return!0},getLayers:function(){return this.layers},bindToLayer:function(e){this.layers[e.getId()]=e},unbindFromLayer:function(e){delete this.layers[e.getId()]},transitionStart:function(){},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()}}),i}),define("cobweb/Components/Time/X3DTimeDependentNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,t){this.addType(i.X3DTimeDependentNode),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,initialize:function(){n.prototype.initialize.call(this),this.addChildren("initialized",new t.SFTime,"isEvenLive",new t.SFBool),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.isEvenLive_.addInterest(this,"set_live__"),this.initialized_.addInterest(this,"set_loop__"),this.enabled_.addInterest(this,"set_enabled__"),this.loop_.addInterest(this,"set_loop__"),this.startTime_.addInterest(this,"set_startTime__"),this.pauseTime_.addInterest(this,"set_pauseTime__"),this.resumeTime_.addInterest(this,"set_resumeTime__"),this.stopTime_.addInterest(this,"set_stopTime__"),this.startTimeValue=this.startTime_.getValue(),this.pauseTimeValue=this.pauseTime_.getValue(),this.resumeTimeValue=this.resumeTime_.getValue(),this.stopTimeValue=this.stopTime_.getValue(),this.initialized_=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},getLive:function(){return(this.getExecutionContext().isLive().getValue()||this.isEvenLive_.getValue())&&this.isLive().getValue()},set_live__:function(){this.getLive()?this.getBrowser().isLive().addInterest(this,"set_browser_live__"):this.getBrowser().isLive().removeInterest(this,"set_browser_live__"),this.set_browser_live__()},set_browser_live__:function(){this.getLive()&&this.getBrowser().isLive().getValue()?this.disabled&&(this.disabled=!1,this.isActive_.getValue()&&!this.isPaused_.getValue()&&this.real_resume()):this.disabled||!this.isActive_.getValue()||this.isPaused_.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this.enabled_.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this.enabled_.getValue()&&this.loop_.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this.startTime_.getValue(),this.enabled_.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this.pauseTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this.resumeTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this.stopTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this.isActive_.getValue()||(this.start=this.getBrowser().getCurrentTime(),this.pauseInterval=0,this.isActive_=!0,this.set_start(),this.getLive()?this.getBrowser().prepareEvents().addInterest(this,"prepareEvents"):this.disabled||(this.disabled=!0,this.real_pause()),this.elapsedTime_=0,this.cycleTime_=this.getBrowser().getCurrentTime())},do_pause:function(){this.isActive_.getValue()&&!this.isPaused_.getValue()&&(this.isPaused_=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.getLive()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().prepareEvents().removeInterest(this,"prepareEvents")},do_resume:function(){this.isActive_.getValue()&&this.isPaused_.getValue()&&(this.isPaused_=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.getLive()&&this.real_resume())},real_resume:function(){var e=(performance.now()-this.pause)/1e3;this.pauseInterval+=e,this.set_resume(e),this.getBrowser().prepareEvents().addInterest(this,"prepareEvents"),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this.isActive_.getValue()&&(this.set_stop(),this.elapsedTime_=this.getElapsedTime(),this.isPaused_.getValue()&&(this.isPaused_=!1),this.isActive_=!1,this.getLive()&&this.getBrowser().prepareEvents().removeInterest(this,"prepareEvents"))},timeout:function(e){this.enabled_.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[e]())},addTimeout:function(e,t,n){this.removeTimeout(e),this[e]=setTimeout(this.timeout.bind(this,t),1e3*(n-this.getBrowser().getCurrentTime()))},removeTimeout:function(e){clearTimeout(this[e]),this[e]=null},prepareEvents:function(){},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){}}),r}),define("cobweb/Components/Time/TimeSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DSensorNode","cobweb/Components/Time/X3DTimeDependentNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.TimeSensor),this.addChildren("range",new t.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.first=0,this.last=1,this.scale=1}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"cycleInterval",new t.SFTime(1)),new n(s.inputOutput,"loop",new t.SFBool),new n(s.inputOutput,"startTime",new t.SFTime),new n(s.inputOutput,"resumeTime",new t.SFTime),new n(s.inputOutput,"pauseTime",new t.SFTime),new n(s.inputOutput,"stopTime",new t.SFTime),new n(s.outputOnly,"isPaused",new t.SFBool),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"cycleTime",new t.SFTime),new n(s.outputOnly,"elapsedTime",new t.SFTime),new n(s.outputOnly,"fraction_changed",new t.SFFloat),new n(s.outputOnly,"time",new t.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},prepareEvents:function(){var e=this.getBrowser().getCurrentTime();if(e-this.cycle>=this.interval)this.loop_.getValue()?(this.cycle+=this.interval*Math.floor((e-this.cycle)/this.interval),this.fraction_changed_=this.last,this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=e):(this.fraction_changed_=this.last,this.stop());else{var t=(e-this.cycle)/this.interval;this.fraction_changed_=this.first+(t-Math.floor(t))*this.scale,this.elapsedTime_=this.getElapsedTime()}this.time_=e},set_start:function(){this.first=this.range_[0],this.last=this.range_[2],this.scale=this.last-this.first;var e=(this.range_[1]-this.first)*this.cycleInterval_.getValue();this.interval=this.cycleInterval_.getValue()*this.scale,this.cycle=this.getBrowser().getCurrentTime()-e,this.fraction_changed_=this.range_[1],this.time_=this.getBrowser().getCurrentTime()},set_resume:function(e){this.cycle+=e}}),a}),define("cobweb/Components/Interpolation/X3DInterpolatorNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i){function r(e,i){t.call(this,e,i),this.addType(n.X3DInterpolatorNode)}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,setup:function(){this.set_key__(),this.key_.length&&this.interpolate(0,0,0),t.prototype.setup.call(this)},initialize:function(){t.prototype.initialize.call(this),this.set_fraction_.addInterest(this,"set_fraction__"),this.key_.addInterest(this,"set_key__")},set_fraction__:function(){var e=this.key_,t=e.length,n=this.set_fraction_.getValue();switch(t){case 0:return;case 1:return this.interpolate(0,0,0);default:if(n<=e[0])return this.interpolate(0,1,0);var r=i.upperBound(e,0,t,n,i.less);if(r!==t){var o=r-1,s=(n-e[o])/(e[r]-e[o]);this.interpolate(o,r,i.clamp(s,0,1))}else this.interpolate(t-2,t-1,1)}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),r}),define("cobweb/Components/Interpolation/EaseInEaseOut",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.EaseInEaseOut)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"easeInEaseOut",new t.MFVec2f),new n(o.outputOnly,"modifiedFraction_changed",new t.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.easeInEaseOut_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){this.easeInEaseOut_.length<this.key_.length&&this.easeInEaseOut_.resize(this.key_.length,this.easeInEaseOut_.length?this.easeInEaseOut_[this.easeInEaseOut_.length-1]:new t.SFVec2f)},interpolate:function(e,t,n){var i=this.easeInEaseOut_[e].y,r=this.easeInEaseOut_[t].x,o=i+r;if(0>o)this.modifiedFraction_changed_=n;else{o>1&&(r/=o,i/=o);var s=1/(2-i-r);if(i>n)this.modifiedFraction_changed_=s/i*n*n;else if(1-r>=n)this.modifiedFraction_changed_=s*(2*n-i);else{var a=1-n;this.modifiedFraction_changed_=1-s*a*a/r}}}}),s}),define("cobweb/Components/Interpolation/PositionInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionInterpolator)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFVec3f),new n(o.outputOnly,"value_changed",new t.SFVec3f)]),keyValue:new s(0,0,0),getTypeName:function(){return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec3f)},interpolate:function(e,t,n){this.value_changed_=this.keyValue.assign(this.keyValue_[e].getValue()).lerp(this.keyValue_[t].getValue(),n)}}),a}),define("cobweb/Components/Interpolation/OrientationInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.OrientationInterpolator)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFRotation),new n(o.outputOnly,"value_changed",new t.SFRotation)]),keyValue:new s,getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFRotation)},interpolate:function(e,t,n){try{this.value_changed_=this.keyValue.assign(this.keyValue_[e].getValue()).slerp(this.keyValue_[t].getValue(),n)}catch(i){}}}),a}),define("cobweb/Components/Navigation/X3DViewpointNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DBindableNode","cobweb/Components/Time/TimeSensor","cobweb/Components/Interpolation/EaseInEaseOut","cobweb/Components/Interpolation/PositionInterpolator","cobweb/Components/Interpolation/OrientationInterpolator","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l,c,h,d){
function p(e,t){n.call(this,e,t),this.addType(u.X3DViewpointNode),this.userPosition=new c(0,1,0),this.userOrientation=new h(0,0,1,0),this.userCenterOfRotation=new c(0,0,0),this.transformationMatrix=new d,this.cameraSpaceMatrix=new d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.inverseCameraSpaceMatrix=new d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1),this.timeSensor=new i(e.getPrivateScene()),this.easeInEaseOut=new r(e.getPrivateScene()),this.positionInterpolator=new o(e.getPrivateScene()),this.orientationInterpolator=new s(e.getPrivateScene()),this.scaleInterpolator=new o(e.getPrivateScene()),this.scaleOrientationInterpolator=new s(e.getPrivateScene())}var f=new c(0,1,0),g=new c(0,0,1),m=new c(0,0,0),y=new h(0,0,1,0),b=new c(0,0,0),w=new h(0,0,1,0),v=new c(0,0,0),x=new c(0,0,0),_=new c(0,0,0),C=new c(0,0,0),S=new h(0,0,1,0);return p.prototype=e.extend(Object.create(n.prototype),{constructor:p,initialize:function(){n.prototype.initialize.call(this),this.addChildren("positionOffset",new t.SFVec3f,"orientationOffset",new t.SFRotation,"scaleOffset",new t.SFVec3f(1,1,1),"scaleOrientationOffset",new t.SFRotation,"centerOfRotationOffset",new t.SFVec3f,"fieldOfViewScale",new t.SFFloat(1)),this.timeSensor.stopTime_=1,this.timeSensor.setup(),this.easeInEaseOut.key_=[0,1],this.easeInEaseOut.easeInEaseOut_=[new l(0,0),new l(0,0)],this.easeInEaseOut.setup(),this.positionInterpolator.key_=[0,1],this.orientationInterpolator.key_=[0,1],this.scaleInterpolator.key_=[0,1],this.scaleOrientationInterpolator.key_=[0,1],this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor.fraction_changed_.addFieldInterest(this.easeInEaseOut.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.positionInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.orientationInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleOrientationInterpolator.set_fraction_),this.positionInterpolator.value_changed_.addFieldInterest(this.positionOffset_),this.orientationInterpolator.value_changed_.addFieldInterest(this.orientationOffset_),this.scaleInterpolator.value_changed_.addFieldInterest(this.scaleOffset_),this.scaleOrientationInterpolator.value_changed_.addFieldInterest(this.scaleOrientationOffset_),this.isBound_.addInterest(this,"set_bind__")},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},bindToLayer:function(e){n.prototype.bindToLayer.call(this,e),e.getViewpointStack().push(this)},unbindFromLayer:function(e){n.prototype.unbindFromLayer.call(this,e),e.getViewpointStack().pop(this)},removeFromLayer:function(e){e.getViewpointStack().remove(this)},getPosition:function(){return this.position_.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this.positionOffset_.getValue())},getOrientation:function(){return this.orientation_.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this.orientationOffset_.getValue())},getCenterOfRotation:function(){return this.centerOfRotation_.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this.centerOfRotationOffset_.getValue())},getTransformationMatrix:function(){return this.transformationMatrix},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getUpVector:function(){return f},getSpeedFactor:function(){return 1},getMaxZFar:function(){return 1e5},transitionStart:function(e,t){try{if(!e)for(var n in this.getLayers()){e=this.getLayers()[n];break}if(this.jump_.getValue()){this.retainUserOffsets_.getValue()||this.resetUserOffsets();for(var n in this.getLayers())this.getLayers()[n].getNavigationInfo().transitionStart_=!0;if(e)var i=e.getNavigationInfo(),r=i.getTransitionType(),o=i.transitionTime_.getValue();else var r="LINEAR",o=1;switch(r){case"TELEPORT":return void(e&&(e.getNavigationInfo().transitionComplete_=!0));case"ANIMATE":this.easeInEaseOut.easeInEaseOut_=[new l(0,1),new l(1,0)];break;default:this.easeInEaseOut.easeInEaseOut_=[new l(0,0),new l(0,0)]}this.timeSensor.cycleInterval_=o,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest(this,"set_active__"),this.getRelativeTransformation(t,m,y,b,w),this.positionInterpolator.keyValue_=[m,this.positionOffset_.getValue()],this.orientationInterpolator.keyValue_=[y,this.orientationOffset_.getValue()],this.scaleInterpolator.keyValue_=[b,this.scaleOffset_.getValue()],this.scaleOrientationInterpolator.keyValue_=[w,this.scaleOrientationOffset_.getValue()],this.positionOffset_=m,this.orientationOffset_=y,this.scaleOffset_=b,this.scaleOrientationOffset_=w,this.setInterpolators(t)}else this.getRelativeTransformation(t,m,y,b,w),this.positionOffset_=m,this.orientationOffset_=y,this.scaleOffset_=b,this.scaleOrientationOffset_=w,this.setInterpolators(t)}catch(s){console.log(s)}},transitionStop:function(){this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.removeInterest(this,"set_active__")},resetUserOffsets:function(){this.positionOffset_=c.Zero,this.orientationOffset_=h.Identity,this.scaleOffset_=c.One,this.scaleOrientationOffset_=h.Identity,this.centerOfRotationOffset_=c.Zero,this.fieldOfViewScale_=1},getRelativeTransformation:function(e,t,n,i,r){var o=this.transformationMatrix.copy().multRight(e.getInverseCameraSpaceMatrix()).inverse();o.get(t,n,i,r),t.subtract(this.position_.getValue()),n.assign(this.orientation_.getValue().copy().inverse().multRight(n))},straightenHorizon:function(e){return e.multVecRot(x.assign(g)),e.multVecRot(v.assign(f)),_.assign(x).cross(this.getUpVector()),C.assign(x).cross(v),S.setFromToVec(C,_),e.multRight(S)},lookAtPoint:function(e,t,n){if(this.getBrowser().getActiveLayer())try{this.getCameraSpaceMatrix().multVecMatrix(e),d.inverse(this.getTransformationMatrix()).multVecMatrix(e);var i=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearPlane();this.lookAt(e,i,t,n)}catch(r){console.error(r)}},lookAt:function(e,t,n,i){var r=e.copy().add(this.getUserOrientation().multVecRot(new c(0,0,t))).subtract(this.getPosition());for(var o in this.getLayers())this.getLayers()[o].getNavigationInfo().transitionStart_=!0;this.timeSensor.cycleInterval_=.2,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest(this,"set_active__"),this.easeInEaseOut.easeInEaseOut_=[new l(0,1),new l(1,0)];var s=c.lerp(this.positionOffset_.getValue(),r,n),a=c.add(this.getPosition(),s).subtract(e),u=h.multRight(this.orientationOffset_.getValue(),new h(this.getUserOrientation().multVecRot(new c(0,0,1)),a));i&&(u=h.inverse(this.getOrientation()).multRight(this.straightenHorizon(h.multRight(this.getOrientation(),u)))),this.positionInterpolator.keyValue_=[this.positionOffset_.getValue(),s],this.orientationInterpolator.keyValue_=[this.orientationOffset_.getValue(),u],this.scaleInterpolator.keyValue_=[this.scaleOffset_.getValue(),this.scaleOffset_.getValue()],this.scaleOrientationInterpolator.keyValue_=[this.scaleOrientationOffset_.getValue(),this.scaleOrientationOffset_.getValue()],this.centerOfRotationOffset_=c.subtract(e,this.getCenterOfRotation()),this.set_bind_=!0},set_active__:function(e){if(!e.getValue()&&1===this.timeSensor.fraction_changed_.getValue()){for(var t in this.getLayers()){var n=this.getLayers()[t].getNavigationInfo();n.transitionComplete_=!0}this.easeInEaseOut.set_fraction_=1}},set_bind__:function(){this.isBound_.getValue()?this.getBrowser().getNotification().string_=this.description_:this.timeSensor.stopTime_=this.getBrowser().getCurrentTime()},reshape:function(){var e=this.getCurrentNavigationInfo(),t=this.getProjectionMatrix(e.getNearPlane(),e.getFarPlane(this),this.getCurrentViewport().getRectangle());this.getBrowser().setProjectionMatrix(t)},transform:function(){this.getBrowser().getModelViewMatrix().set(this.inverseCameraSpaceMatrix)},traverse:function(e){this.getCurrentLayer().getViewpoints().push(this),this.transformationMatrix.assign(this.getBrowser().getModelViewMatrix().get())},update:function(){try{this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this.scaleOffset_.getValue(),this.scaleOrientationOffset_.getValue()),this.cameraSpaceMatrix.multRight(this.transformationMatrix),this.inverseCameraSpaceMatrix.assign(this.cameraSpaceMatrix).inverse()}catch(e){console.log(e)}}}),p}),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Matrix4"],function(e){return{frustum:function(e,t,n,i,r,o,s){var a=t-e,u=i-n,l=o-r,c=2*r,h=(t+e)/a,d=(i+n)/u,p=-(o+r)/l,f=-c*o/l,g=c/a,m=c/u;return s.set(g,0,0,0,0,m,0,0,h,d,p,-1,0,0,f,0)},perspective:function(e,t,n,i,r){var o=i[2],s=i[3],a=Math.tan(e/2)*t;if(o>s){var u=o*a/s;return this.frustum(-u,u,-a,a,t,n,r)}var u=s*a/o;return this.frustum(-a,a,-u,u,t,n,r)},ortho:function(e,t,n,i,r,o,s){var a=t-e,u=i-n,l=o-r,c=2/a,h=2/u,d=-2/l,p=-(t+e)/a,f=-(i+n)/u,g=-(o+r)/l;return s.set(c,0,0,0,0,h,0,0,0,0,d,0,p,f,g,1)}}}),define("cobweb/Components/Navigation/OrthoViewpoint",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Navigation/X3DViewpointNode","cobweb/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(o.OrthoViewpoint),this.projectionMatrix=new l}var h=new u(0,0,0),d=new a(0,0);return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_bind",new t.SFBool),new n(o.inputOutput,"description",new t.SFString),new n(o.inputOutput,"position",new t.SFVec3f(0,0,10)),new n(o.inputOutput,"orientation",new t.SFRotation),new n(o.inputOutput,"centerOfRotation",new t.SFVec3f),new n(o.inputOutput,"fieldOfView",new t.MFFloat([-1,-1,1,1])),new n(o.inputOutput,"jump",new t.SFBool(!0)),new n(o.inputOutput,"retainUserOffsets",new t.SFBool),new n(o.outputOnly,"isBound",new t.SFBool),new n(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.fieldOfView_.addInterest(this,"set_fieldOfView___"),this.fieldOfViewScale_.addInterest(this,"set_fieldOfView___"),this.set_fieldOfView___()},set_fieldOfView___:function(){var e=this.fieldOfView_.length,t=this.fieldOfViewScale_.getValue();this.minimumX=(e>0?this.fieldOfView_[0]:-1)*t,this.minimumY=(e>1?this.fieldOfView_[1]:-1)*t,this.maximumX=(e>2?this.fieldOfView_[2]:1)*t,this.maximumY=(e>3?this.fieldOfView_[3]:1)*t,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getScreenScale:function(e,t){var n=t[2],i=t[3],r=this.sizeX,o=this.sizeY,s=n/i;if(s>r/o){var a=o/i;return h.set(a,a,a)}var a=r/n;return h.set(a,a,a)},getViewportSize:function(e){var t=e[2],n=e[3],i=this.sizeX,r=this.sizeY,o=t/n;return o>i/r?d.set(r*o,r):d.set(i,i/o)},getLookAtDistance:function(e){return e.size.abs()/2+10},getProjectionMatrix:function(e,t,n){var i=n[2],r=n[3],o=i/r,a=this.sizeX,u=this.sizeY;if(o>a/u){var l=(this.minimumX+this.maximumX)/2,c=u*o/2;return s.ortho(l-c,l+c,this.minimumY,this.maximumY,e,t,this.projectionMatrix)}var l=(this.minimumY+this.maximumY)/2,c=a/o/2;return s.ortho(this.minimumX,this.maximumX,l-c,l+c,e,t,this.projectionMatrix)}}),c}),define("cobweb/Browser/Navigation/X3DViewer",["jquery","cobweb/Basic/X3DBaseNode","cobweb/Components/Navigation/OrthoViewpoint","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o){function s(e,n){t.call(this,e,n)}function a(e,t,n){var i=Math.sqrt(t*t+n*n);if(i<e*Math.sqrt(.5))return Math.sqrt(e*e-i*i);var r=e/Math.sqrt(2);return r*r/i}var u=new r(0,0,0);return s.prototype=e.extend(Object.create(t.prototype),{constructor:s,initialize:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},getPointOnCenterPlane:function(e,t){try{var s=this.getViewport().getRectangle(),a=this.getNavigationInfo(),l=this.getActiveViewpoint(),c=l.getProjectionMatrix(a.getNearPlane(),a.getFarPlane(l),s),h=new o;if(i.unProjectPoint(e,this.getBrowser().getViewport()[3]-t,.9,h,c,s,u),l instanceof n)return new r(u.x,u.y,-this.getDistanceToCenter().abs());var d=u.normalize();return r.multiply(d,this.getDistanceToCenter().abs()/d.dot(new r(0,0,-1)))}catch(p){return console.log(p),new r(0,0,0)}},getDistanceToCenter:function(){var e=this.getActiveViewpoint();return r.subtract(e.getUserPosition(),e.getUserCenterOfRotation())},trackballProjectToSphere:function(e,t){return e=e/this.getBrowser().getViewport()[2]-.5,t=-t/this.getBrowser().getViewport()[3]+.5,new r(e,t,a(.5,e,t))},dispose:function(){}}),s});var jQueryMouseWheel=function(e){function t(t){var n=t||window.event,i=[].slice.call(arguments,1),r=0,o=0,s=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(r=n.wheelDelta/120),n.detail&&(r=-n.detail/3),s=r,void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(s=0,o=-1*r),void 0!==n.wheelDeltaY&&(s=n.wheelDeltaY/120),void 0!==n.wheelDeltaX&&(o=-1*n.wheelDeltaX/120),i.unshift(t,r,o,s),(e.event.dispatch||e.event.handle).apply(this,i)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var i=n.length;i;)e.event.fixHooks[n[--i]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})};define("jquery-mousewheel/jquery.mousewheel",["jquery"],jQueryMouseWheel),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],function(e){return e}),define("cobweb/Browser/Navigation/ExamineViewer",["jquery","cobweb/Browser/Navigation/X3DViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","lib/gettext","jquery-mousewheel"],function(e,t,n,i,r){function o(e){t.call(this,e.getBrowser(),e),this.button=-1,this.orientationOffset=new i(0,0,1,0),this.rotation=new i(0,0,1,0),this.fromVector=new n(0,0,0),this.fromPoint=new n(0,0,0),this.pressTime=0,this.motionTime=0,this.spinId=void 0}var s=50,a=10,u=.006,l=.6,c=.02,h=60;return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),n=e.getCanvas();n.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),n.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),n.bind("mousemove.ExamineViewer",this.mousemove.bind(this)),n.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this))},mousedown:function(t){if(!(this.button>=0)){this.pressTime=performance.now();var n=this.getBrowser().getCanvas().offset(),r=t.pageX-n.left,o=t.pageY-n.top;switch(t.button){case 0:this.button=t.button,this.getBrowser().getCanvas().unbind("mousemove.ExamineViewer"),e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t.preventDefault(),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.fromVector=this.trackballProjectToSphere(r,o),this.rotation=new i,this.motionTime=0;break;case 1:this.button=t.button,this.getBrowser().getCanvas().unbind("mousemove.ExamineViewer"),e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t.preventDefault(),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.fromPoint=this.getPointOnCenterPlane(r,o)}}},mouseup:function(t){if(t.button===this.button)switch(this.button=-1,e(document).unbind(".ExamineViewer"+this.getId()),this.getBrowser().getCanvas().bind("mousemove.ExamineViewer",this.mousemove.bind(this)),t.button){case 0:if(t.preventDefault(),this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>u&&performance.now()-this.motionTime<a)try{this.rotation=new i(0,0,1,0).slerp(this.rotation,l),this.addSpinning()}catch(n){}break;case 1:t.preventDefault(),this.getBrowser().setCursor("DEFAULT")}},mousemove:function(e){var t=this.getBrowser().getCanvas().offset(),r=e.pageX-t.left,o=e.pageY-t.top;switch(this.button){case 0:var a=this.getActiveViewpoint(),l=this.trackballProjectToSphere(r,o);if(this.rotation=new i(l,this.fromVector),Math.abs(this.rotation.angle)<u&&performance.now()-this.pressTime<s)return!1;a.orientationOffset_=this.getOrientationOffset(),a.positionOffset_=this.getPositionOffset(),this.fromVector=l,this.motionTime=performance.now();break;case 1:e.preventDefault();var a=this.getActiveViewpoint(),c=this.getPointOnCenterPlane(r,o),h=a.getUserOrientation().multVecRot(n.subtract(this.fromPoint,c));a.positionOffset_=n.add(a.positionOffset_.getValue(),h),a.centerOfRotationOffset_=n.add(a.centerOfRotationOffset_.getValue(),h),this.fromPoint=c}},mousewheel:function(e){e.preventDefault();var t=0;e.originalEvent.wheelDelta?t=-e.originalEvent.wheelDelta/120:e.originalEvent.detail&&(t=e.originalEvent.detail/3);var i=this.getActiveViewpoint(),r=this.getDistanceToCenter().multiply(c),o=i.getUserOrientation().multVecRot(new n(0,0,r.abs()));0>t?i.positionOffset_=i.positionOffset_.getValue().subtract(o):t>0&&(i.positionOffset_=i.positionOffset_.getValue().add(o))},getPositionOffset:function(){var e=this.getActiveViewpoint(),t=this.getDistanceToCenter();return this.orientationOffset.copy().inverse().multRight(e.orientationOffset_.getValue()).multVecRot(t.copy()).subtract(t).add(e.positionOffset_.getValue())},getOrientationOffset:function(){var e=this.getActiveViewpoint();return this.orientationOffset.assign(e.orientationOffset_.getValue()),e.getOrientation().copy().inverse().multRight(this.rotation).multRight(e.getUserOrientation())},spin:function(){var e=this.getActiveViewpoint();e.orientationOffset_=this.getOrientationOffset(),e.positionOffset_=this.getPositionOffset()},addSpinning:function(){this.spinId||(this.spinId=setInterval(this.spin.bind(this),1e3/h))},disconnect:function(){clearInterval(this.spinId),this.spinId=void 0},dispose:function(){this.disconnect(),this.getBrowser().getCanvas().unbind(".ExamineViewer"),e(document).unbind(".ExamineViewer"+this.getId())}}),o}),define("cobweb/Browser/Navigation/X3DFlyViewer",["jquery","cobweb/Browser/Navigation/X3DViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],function(e,t,n,i,r,o){function s(e){t.call(this,e.getBrowser(),e);var o=this.getBrowser().getContext();this.button=-1,this.fromVector=new n(0,0,0),this.toVector=new n(0,0,0),this.direction=new n(0,0,0),this.sourceRotation=new i(0,0,1,0),this.destinationRotation=new i(0,0,1,0),this.startTime=0,this.lineBuffer=o.createBuffer(),this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.projectionMatrix=new r,this.projectionMatrixArray=new Float32Array(this.projectionMatrix),this.modelViewMatrixArray=new Float32Array(this.projectionMatrix)}var a=.007,u=4*a,l=1.4,c=40,h=a,d=1.4*h,p=Math.PI/32,f=.2,g=new n(0,1,0),m=new n(0,0,1),y=new Float32Array([0,0,0]),b=new Float32Array([1,1,1]),w=new n(0,0,0),v=new n(0,0,0),x=0,_=1;return s.prototype=e.extend(Object.create(t.prototype),{constructor:s,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser().getCanvas();e.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),e.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),e.bind("mousemove.X3DFlyViewer",this.mousemove.bind(this)),e.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this))},addCollision:function(){},removeCollision:function(){},mousedown:function(t){if(!(this.button>=0)){var n=this.getBrowser().getCanvas().offset(),i=t.pageX-n.left,r=t.pageY-n.top;switch(t.button){case 0:this.button=t.button,this.getBrowser().getCanvas().unbind("mousemove.X3DFlyViewer"),e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),t.preventDefault(),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().hasCtrlKey()?this.fromVector=this.trackballProjectToSphere(i,r):(this.fromVector.set(i,0,r),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest(this,"display",x));break;case 1:this.button=t.button,this.getBrowser().getCanvas().unbind("mousemove.X3DFlyViewer"),e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),t.preventDefault(),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(i,-r,0),this.toVector.assign(this.fromVector),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest(this,"display",_)}}},mouseup:function(t){t.button===this.button&&(this.button=-1,e(document).unbind(".X3DFlyViewer"+this.getId()),this.getBrowser().getCanvas().bind("mousemove.X3DFlyViewer",this.mousemove.bind(this)),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision())},mousemove:function(e){this.getBrowser().addBrowserEvent();var t=this.getBrowser().getCanvas().offset(),n=e.pageX-t.left,r=e.pageY-t.top;switch(this.button){case 0:if(this.getBrowser().hasCtrlKey()){var o=this.getActiveViewpoint(),s=o.getUserOrientation(),a=this.trackballProjectToSphere(n,r);s=new i(a,this.fromVector).multRight(s),o.straightenHorizon(s),o.orientationOffset_=o.getOrientation().copy().inverse().multRight(s),this.fromVector.assign(a)}else this.toVector.set(n,0,r),this.direction.assign(this.toVector).subtract(this.fromVector),this.addFly();break;case 1:e.preventDefault(),this.toVector.set(n,-r,0),this.direction.assign(this.toVector).subtract(this.fromVector),this.addPan()}},mousewheel:function(e){e.preventDefault();var t=0;e.originalEvent.wheelDelta?t=-e.originalEvent.wheelDelta/120:e.originalEvent.detail&&(t=e.originalEvent.detail/3);var r=this.getActiveViewpoint();r.transitionStop(),0>t?(this.sourceRotation.assign(r.orientationOffset_.getValue()),this.destinationRotation=this.sourceRotation.multRight(new i(r.getUserOrientation().multVecRot(new n(-1,0,0)),p)),this.addRoll()):t>0&&(this.sourceRotation.assign(r.orientationOffset_.getValue()),this.destinationRotation=this.sourceRotation.multRight(new i(r.getUserOrientation().multVecRot(new n(1,0,0)),p)),this.addRoll())},fly:function(){var e=performance.now(),t=(e-this.startTime)/1e3,r=this.getNavigationInfo(),o=this.getActiveViewpoint(),s=o.getUpVector(),h=new i(g,s),d=this.direction.z>0?new i(h.multVecRot(this.direction.copy()),h.multVecRot(m.copy())):new i(h.multVecRot(n.negate(m)),h.multVecRot(this.direction.copy())),p=this.direction.abs(),f=1-d.angle/(Math.PI/2);f*=r.speed_.getValue(),f*=o.getSpeedFactor(),f*=this.getBrowser().hasShiftKey()?u:a,f*=t;var y=this.getTranslationOffset(n.multiply(this.direction,f));o.positionOffset_=this.getActiveLayer().constrainTranslation(y).add(o.positionOffset_.getValue());var b=l*t;b*=Math.pow(p/(p+c),2),o.orientationOffset_=(new i).slerp(d,b).multLeft(o.orientationOffset_.getValue());var w=new i(s,o.getUpVector());o.orientationOffset_=w.multLeft(o.orientationOffset_.getValue()),this.startTime=e},pan:function(){var e=performance.now(),t=(e-this.startTime)/1e3,n=this.getNavigationInfo(),r=this.getActiveViewpoint(),o=r.getUpVector(),s=1;s*=n.speed_.getValue(),s*=r.getSpeedFactor(),s*=this.getBrowser().hasShiftKey()?d:h,s*=t;var a=r.getUserOrientation().multRight(new i(r.getUserOrientation().multVecRot(g.copy()),o)),u=a.multVecRot(this.direction.copy().multiply(s));r.positionOffset_=this.getActiveLayer().constrainTranslation(u).add(r.positionOffset_.getValue()),this.startTime=e},roll:function(){var e=performance.now(),t=(e-this.startTime)/1e3;if(t>f)return this.disconnect();var n=this.getActiveViewpoint();n.orientationOffset_=i.slerp(this.sourceRotation,this.destinationRotation,t/f)},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest(this,"fly"),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest(this,"pan"),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest(this,"roll"),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},display:function(e,t){var n=this.getBrowser(),i=n.getViewport(),r=i[2],s=i[3];o.ortho(0,r,0,s,-1,1,this.projectionMatrix),this.projectionMatrixArray.set(this.projectionMatrix),t===x?(w.set(this.fromVector.x,s-this.fromVector.z,0),v.set(this.toVector.x,s-this.toVector.z,0)):(w.set(this.fromVector.x,s+this.fromVector.y,0),v.set(this.toVector.x,s+this.toVector.y,0)),this.transfer(w,v);var a=n.getContext(),u=n.getLineShader(),l=a.getParameter(a.LINE_WIDTH);u.use(),a.uniform4fv(u.clipPlane[0],u.noClipPlane),a.uniform1i(u.fogType,0),a.uniform1i(u.colorMaterial,!1),a.uniform1i(u.lighting,!0),a.uniformMatrix4fv(u.projectionMatrix,!1,this.projectionMatrixArray),a.uniformMatrix4fv(u.modelViewMatrix,!1,this.modelViewMatrixArray),a.disable(a.DEPTH_TEST),a.lineWidth(2),a.uniform3fv(u.emissiveColor,y),a.uniform1f(u.transparency,0),a.enableVertexAttribArray(u.vertex),a.bindBuffer(a.ARRAY_BUFFER,this.lineBuffer),a.vertexAttribPointer(u.vertex,4,a.FLOAT,!1,0,0),a.drawArrays(a.LINES,0,this.lineCount),a.lineWidth(1),a.uniform3fv(u.emissiveColor,b),a.drawArrays(a.LINES,0,this.lineCount),a.disableVertexAttribArray(u.vertex),a.enable(a.DEPTH_TEST),a.lineWidth(l)},transfer:function(e,t){var n=this.getBrowser().getContext(),i=this.lineVertices;i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=1,i[4]=t.x,i[5]=t.y,i[6]=t.z,i[7]=1,this.lineArray.set(i),n.bindBuffer(n.ARRAY_BUFFER,this.lineBuffer),n.bufferData(n.ARRAY_BUFFER,this.lineArray,n.STATIC_DRAW)},disconnect:function(){var e=this.getBrowser();e.addBrowserEvent(),e.prepareEvents().removeInterest(this,"fly"),e.prepareEvents().removeInterest(this,"pan"),e.prepareEvents().removeInterest(this,"roll"),e.finished().removeInterest(this,"display"),this.startTime=0},dispose:function(){this.disconnect(),this.getBrowser().getCanvas().unbind(".X3DFlyViewer"),e(document).unbind(".X3DFlyViewer"+this.getId())}}),s}),define("cobweb/Browser/Navigation/WalkViewer",["cobweb/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","lib/gettext"],function(e,t,n,i){function r(t){e.call(this,t.getBrowser(),t)}var o=new t(0,1,0);return r.prototype=$.extend(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getTranslationOffset:function(e){var t=this.getActiveViewpoint(),i=t.getUpVector(),r=t.getUserOrientation().copy(),s=r.multRight(new n(r.multVecRot(o.copy()),i));return s.multVecRot(e)},dispose:function(){this.getBrowser().removeCollision(this),e.prototype.dispose.call(this)}}),r}),define("cobweb/Browser/Navigation/FlyViewer",["cobweb/Browser/Navigation/X3DFlyViewer","lib/gettext"],function(e,t){function n(t){e.call(this,t.getBrowser(),t)}return n.prototype=$.extend(Object.create(e.prototype),{constructor:n,addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getTranslationOffset:function(e){return this.getActiveViewpoint().getUserOrientation().multVecRot(e)}}),n}),define("cobweb/Components/Interpolation/ScalarInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.ScalarInterpolator)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFFloat),new n(o.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.key_,t=this.keyValue_;t.length<e.length&&t.resize(e.length,t.length?t[t.length-1]:0)},interpolate:function(e,t,n){this.value_changed_=s.lerp(this.keyValue_[e],this.keyValue_[t],n)}}),a}),define("cobweb/Components/Navigation/Viewpoint",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Navigation/X3DViewpointNode","cobweb/Components/Interpolation/ScalarInterpolator","cobweb/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(s.Viewpoint),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new o(this.getBrowser().getPrivateScene()),this.fieldOfViewInterpolator.setName("Default")}var h=new u(0,0,1),d=new u(0,0,0);return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_bind",new t.SFBool),new n(s.inputOutput,"description",new t.SFString),new n(s.inputOutput,"position",new t.SFVec3f(0,0,10)),new n(s.inputOutput,"orientation",new t.SFRotation),new n(s.inputOutput,"centerOfRotation",new t.SFVec3f),new n(s.inputOutput,"fieldOfView",new t.SFFloat(Math.PI/4)),new n(s.inputOutput,"jump",new t.SFBool(!0)),new n(s.inputOutput,"retainUserOffsets",new t.SFBool),new n(s.outputOnly,"isBound",new t.SFBool),new n(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.fieldOfViewInterpolator.key_=[0,1],this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_);
},setInterpolators:function(e){if(e.getType().indexOf(s.Viewpoint)<0)this.fieldOfViewInterpolator.keyValue_=[this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()];else{var t=e.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=[t,this.fieldOfViewScale_.getValue()],this.fieldOfViewScale_=t}},getFieldOfView:function(){var e=this.fieldOfView_*this.fieldOfViewScale_;return e>0&&e<Math.PI?e:Math.PI/4},getScreenScale:function(e,t){var n=t[2],i=t[3],r=2*Math.tan(this.getFieldOfView()/2)*e.abs();return r*=Math.abs(e.normalize().dot(h)),r/=n>i?i:n,d.set(r,r,r)},getLookAtDistance:function(e){return e.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrix:function(e,t,n){return a.perspective(this.getFieldOfView(),e,t,n,this.projectionMatrix)}}),c}),define("cobweb/Components/Geospatial/X3DGeospatialObject",["jquery","cobweb/Bits/X3DConstants"],function(e,t){function n(e,n){this.addType(t.X3DGeospatialObject)}return n.prototype={constructor:n,initialize:function(){}},n}),define("cobweb/Components/Geospatial/GeoViewpoint",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Navigation/X3DViewpointNode","cobweb/Components/Geospatial/X3DGeospatialObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.GeoViewpoint)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_bind",new t.SFBool),new n(s.inputOutput,"description",new t.SFString),new n(s.initializeOnly,"geoSystem",new t.MFString(["GD","WE"])),new n(s.inputOutput,"position",new t.SFVec3d(0,0,1e5)),new n(s.inputOutput,"orientation",new t.SFRotation),new n(s.inputOutput,"centerOfRotation",new t.SFVec3d),new n(s.inputOutput,"fieldOfView",new t.SFFloat(.785398)),new n(s.inputOutput,"jump",new t.SFBool(!0)),new n(s.inputOutput,"retainUserOffsets",new t.SFBool),new n(s.inputOutput,"navType",new t.MFString(["EXAMINE","ANY"])),new n(s.inputOutput,"headlight",new t.SFBool(!0)),new n(s.initializeOnly,"speedFactor",new t.SFFloat(1)),new n(s.outputOnly,"isBound",new t.SFBool),new n(s.outputOnly,"bindTime",new t.SFTime),new n(s.initializeOnly,"geoOrigin",new t.SFNode)]),getTypeName:function(){return"GeoViewpoint"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"}}),a}),define("cobweb/Browser/Navigation/PlaneViewer",["jquery","cobweb/Browser/Navigation/X3DViewer","cobweb/Components/Navigation/Viewpoint","cobweb/Components/Geospatial/GeoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","lib/gettext","jquery-mousewheel"],function(e,t,n,i,r,o,s){function a(e){t.call(this,e.getBrowser(),e),this.button=-1,this.fromPoint=new r(0,0,0)}var u=.05;return a.prototype=e.extend(Object.create(t.prototype),{constructor:a,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),n=e.getCanvas();n.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),n.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),n.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),n.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(t){if(!(this.button>=0)){this.pressTime=performance.now();var n=this.getBrowser().getCanvas().offset(),i=t.pageX-n.left,r=t.pageY-n.top;switch(t.button){case 1:this.button=t.button,this.getBrowser().getCanvas().unbind("mousemove.PlaneViewer"),e(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),t.preventDefault(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.fromPoint=this.getPointOnCenterPlane(i,r)}}},mouseup:function(t){t.button===this.button&&(this.button=-1,e(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getCanvas().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"))},mousemove:function(e){var t=this.getBrowser().getCanvas().offset(),n=e.pageX-t.left,i=e.pageY-t.top;switch(this.button){case 1:e.preventDefault();var o=this.getActiveViewpoint(),s=this.getPointOnCenterPlane(n,i),a=o.getUserOrientation().multVecRot(r.subtract(this.fromPoint,s));o.positionOffset_=r.add(o.positionOffset_.getValue(),a),o.centerOfRotationOffset_=r.add(o.centerOfRotationOffset_.getValue(),a),this.fromPoint=s}},mousewheel:function(e){e.preventDefault();var t=this.getBrowser().getCanvas().offset(),n=e.pageX-t.left,i=e.pageY-t.top,o=0;e.originalEvent.wheelDelta?o=-e.originalEvent.wheelDelta/120:e.originalEvent.detail&&(o=e.originalEvent.detail/3);var s=this.getActiveViewpoint(),a=this.getPointOnCenterPlane(n,i);s.transitionStop(),0>o?s.fieldOfViewScale_=Math.max(1e-5,s.fieldOfViewScale_.getValue()*(1-u)):o>0&&(s.fieldOfViewScale_=s.fieldOfViewScale_.getValue()*(1+u),this.constrainFieldOfViewScale());var l=this.getPointOnCenterPlane(n,i),c=s.getUserOrientation().multVecRot(r.subtract(a,l));s.positionOffset_=r.add(s.positionOffset_.getValue(),c),s.centerOfRotationOffset_=r.add(s.centerOfRotationOffset_.getValue(),c)},constrainFieldOfViewScale:function(){var e=this.getActiveViewpoint();(e instanceof n||e instanceof i)&&e.fieldOfView_.getValue()*e.fieldOfViewScale_.getValue()>=Math.PI&&(e.fieldOfViewScale_=(Math.PI-.001)/e.fieldOfView_.getValue())},dispose:function(){this.getBrowser().getCanvas().unbind(".PlaneViewer"),e(document).unbind(".PlaneViewer"+this.getId())}}),a}),define("cobweb/Browser/Navigation/NoneViewer",["jquery","cobweb/Browser/Navigation/X3DViewer","lib/gettext"],function(e,t,n){function i(e){t.call(this,e.getBrowser(),e)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Browser/Navigation/LookAtViewer",["jquery","cobweb/Browser/Navigation/X3DViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","lib/gettext","jquery-mousewheel"],function(e,t,n,i,r){function o(e){t.call(this,e.getBrowser(),e),this.button=-1}return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),n=e.getCanvas();n.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),n.bind("mouseup.LookAtViewer",this.mouseup.bind(this))},mousedown:function(t){if(!(this.button>=0))switch(this.pressTime=performance.now(),t.button){case 0:this.button=t.button,e(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),t.preventDefault(),this.getActiveViewpoint().transitionStop()}},mouseup:function(t){if(t.button===this.button){this.button=-1,e(document).unbind(".LookAtViewer"+this.getId());var n=this.getBrowser().getCanvas().offset(),i=t.pageX-n.left,r=this.getBrowser().getCanvas().height()-(t.pageY-n.top);switch(t.button){case 0:t.preventDefault(),this.lookAt(i,r)}}},lookAt:function(e,t){if(this.touch(e,t)){var n=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(n.intersection.point,.381966)}},touch:function(e,t){return this.getBrowser().touch(e,t),this.getBrowser().getHits().length},dispose:function(){this.getBrowser().getCanvas().unbind(".LookAtViewer"),e(document).unbind(".LookAtViewer"+this.getId())}}),o}),define("cobweb/Components/Lighting/X3DLightNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,n){t.call(this,e,n),this.addType(i.X3DLightNode)}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,push:function(){this.on_.getValue()&&(this.global_.getValue()?this.getBrowser().getGlobalLights().push(this.getLights().pop(this)):this.getCurrentLayer().getLocalLights().push(this.getLights().pop(this)))},pop:function(){if(this.on_.getValue()){if(this.global_.getValue())return;this.getBrowser().getLocalLights().push(this.getCurrentLayer().getLocalLights().pop())}}}),r}),define("standard/Utility/ObjectCache",[],function(){return function(e){return{stack:[],last:-1,pop:function(){if(this.last>-1){var t=this.stack[this.last];t.set.apply(t,arguments),this.last--}else{var t=Object.create(e.prototype);e.apply(t,arguments)}return t},push:function(e){this.last++,this.stack[this.last]=e},clear:function(){this.stack.length=0,this.last=-1}}}}),define("cobweb/Components/Lighting/DirectionalLight",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Lighting/X3DLightNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Utility/ObjectCache"],function(e,t,n,i,r,o,s,a){function u(e){this.direction=new s(0,0,0),this.set(e)}function l(e){r.call(this,e.getBrowser(),e),this.addType(o.DirectionalLight)}var c=a(u);return u.prototype={constructor:u,set:function(e){this.color=e.color_.getValue(),this.intensity=e.intensity_.getValue(),this.ambientIntensity=e.ambientIntensity_.getValue(),e.getBrowser().getModelViewMatrix().get().multDirMatrix(this.direction.assign(e.direction_.getValue())).normalize()},use:function(e,t,n){e.uniform1i(t.lightType[n],1),e.uniform3f(t.lightColor[n],this.color.r,this.color.g,this.color.b),e.uniform1f(t.lightIntensity[n],this.intensity),e.uniform1f(t.lightAmbientIntensity[n],this.ambientIntensity),e.uniform3f(t.lightAttenuation[n],1,0,0),e.uniform3f(t.lightDirection[n],this.direction.x,this.direction.y,this.direction.z)},recycle:function(){c.push(this)}},l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"global",new t.SFBool(!0)),new n(o.inputOutput,"on",new t.SFBool(!0)),new n(o.inputOutput,"color",new t.SFColor(1,1,1)),new n(o.inputOutput,"intensity",new t.SFFloat(1)),new n(o.inputOutput,"ambientIntensity",new t.SFFloat),new n(o.inputOutput,"direction",new t.SFVec3f(0,0,-1))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return c}}),l}),define("cobweb/Browser/Navigation/X3DNavigationContext",["cobweb/Fields","cobweb/Browser/Navigation/ExamineViewer","cobweb/Browser/Navigation/WalkViewer","cobweb/Browser/Navigation/FlyViewer","cobweb/Browser/Navigation/PlaneViewer","cobweb/Browser/Navigation/NoneViewer","cobweb/Browser/Navigation/LookAtViewer","cobweb/Components/Lighting/DirectionalLight"],function(e,t,n,i,r,o,s,a){function u(e){var t=new a(e);t.setup();var n=t.getLights().pop(t);return n.recycle=function(){},n}function l(){this.addChildren("availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this.collisions=[],this.activeCollisions={},this.collisionCount=0,this.activeLayerNode=null,this.navigationInfoNode=null,this.viewerNode=null}return l.prototype={initialize:function(){this.viewer_.addInterest(this,"set_viewer__"),this.initialized().addInterest(this,"set_world__"),this.shutdown().addInterest(this,"remove_world__"),this.headlight=u(this)},getHeadlight:function(){return this.headlight},getActiveLayer:function(){return this.activeLayerNode},getCurrentViewer:function(){return this.viewer_.getValue()},getCollisions:function(){return this.collisions},addCollision:function(e){this.activeCollisions.hasOwnProperty(e.getId())||(this.activeCollisions[e.getId()]=!0,++this.collisionCount)},removeCollision:function(e){this.activeCollisions.hasOwnProperty(e.getId())&&(delete this.activeCollisions[e.getId()],--this.collisionCount)},getCollisionCount:function(){return this.collisionCount},remove_world__:function(){this.getWorld().activeLayer_.removeInterest(this,"set_activeLayer__")},set_world__:function(){this.getWorld().activeLayer_.addInterest(this,"set_activeLayer__"),this.set_activeLayer__()},set_activeLayer__:function(){this.activeLayerNode&&this.activeLayerNode.getNavigationInfoStack().removeInterest(this,"set_navigationInfo__"),this.activeLayerNode=this.getWorld().getActiveLayer(),this.activeLayerNode&&this.activeLayerNode.getNavigationInfoStack().addInterest(this,"set_navigationInfo__"),this.set_navigationInfo__()},set_navigationInfo__:function(){return this.navigationInfoNode&&this.navigationInfoNode.viewer_.removeFieldInterest(this.viewer_),this.activeLayerNode?(this.navigationInfoNode=this.activeLayerNode.getNavigationInfo(),this.navigationInfoNode.viewer_.addFieldInterest(this.viewer_),void(this.viewer_=this.navigationInfoNode.viewer_)):(this.navigationInfoNode=null,void(this.viewer_="NONE"))},set_viewer__:function(e){switch(this.navigationInfoNode?this.availableViewers_=this.navigationInfoNode.availableViewers_:this.availableViewers_.length=0,this.viewerNode&&this.viewerNode.dispose(),e.getValue()){case"EXAMINE":this.viewerNode=new t(this);break;case"WALK":this.viewerNode=new n(this);break;case"FLY":this.viewerNode=new i(this);break;case"PLANE":case"PLANE_create3000.de":this.viewerNode=new r(this);break;case"NONE":this.viewerNode=new o(this);break;case"LOOKAT":this.viewerNode=new s(this);break;default:this.viewerNode=new t(this)}this.viewerNode.setup()}},l}),define("cobweb/Components/Grouping/X3DBoundedObject",["jquery","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,n,i,r){function o(e,t){this.addType(n.X3DBoundedObject)}return o.prototype={constructor:o,defaultBBoxSize:new i(-1,-1,-1),initialize:function(){}},o.getBBox=function(e){for(var i=new r,o=0,s=e.length;s>o;++o){var a=t(n.X3DBoundedObject,e[o]);a&&(a.getBBox()||console.log(a.getTypeName()),i.add(a.getBBox()))}return i},o}),define("cobweb/Components/Grouping/X3DGroupingNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DChildNode","cobweb/Components/Grouping/X3DBoundedObject","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o,s){function a(e,t,n,i,r,o,s){s||(s=a.getId);for(var l={},c=r;o>c;++c)l[s(i[c])]=!0;return u(e,t,n,l,s)}function u(t,n,i,r,o){if(e.isEmptyObject(r))return i;for(var s=0;n!==i;++n)if(r[o(t[n])]){++s;break}e:for(;;){for(var a=n+s;a!==i;++n,++a){if(r[o(t[a])]){++s;continue e}t[n]=t[a]}break}for(var a=n+s;a!==i;++n,++a)t[n]=t[a];return n}function l(e){return e?e.getValue().getId():-1}function c(e,t){n.call(this,e,t),i.call(this,e,t),this.addType(o.X3DGroupingNode),this.hidden=!1,this.pointingDeviceSensors=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.clipPlanes=[],this.localFogs=[],this.lights=[],this.childNodes=[]}a.getId=function(e){return e};var h=new t.MFBool;return c.prototype=e.extend(Object.create(n.prototype),i.prototype,{constructor:c,initialize:function(){n.prototype.initialize.call(this),i.prototype.initialize.call(this),this.addChildren_.addInterest(this,"set_addChildren__"),this.removeChildren_.addInterest(this,"set_removeChildren__"),this.children_.addInterest(this,"set_children__"),this.set_children__()},getBBox:function(){return this.bboxSize_.getValue().equals(this.defaultBBoxSize)?i.getBBox(this.children_.getValue()):new s(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},setHidden:function(e){e!==this.hidden&&(this.hidden=e,this.set_children__())},getVisible:function(){return h},getChild:function(e){try{if(e>=0&&e<this.children_.length){var t=this.children_[e];if(t)return t.getValue().getInnerNode()}}catch(n){}return null},set_addChildren__:function(){0!==this.addChildren_.length&&(this.addChildren_.setTainted(!0),this.addChildren_.erase(a(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length,l),this.addChildren_.length),this.children_.getTainted()||(this.children_.removeInterest(this,"set_children__"),this.children_.addInterest(this,"connectChildren")),this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1))},set_removeChildren__:function(){0!==this.removeChildren_.length&&0!==this.children_.length&&(this.children_.getTainted()||(this.children_.removeInterest(this,"set_children__"),this.children_.addInterest(this,"connectChildren")),this.children_.erase(a(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length,l),this.children_.length),this.removeChildren_.set([]),this.set_children__())},set_children__:function(){this.clear(),this.add(this.children_)},connectChildren:function(){this.children_.removeInterest(this,"connectChildren"),this.children_.addInterest(this,"set_children__")},add:function(e){if(!this.hidden){for(var t=this.getVisible(),n=t.length,i=0,r=e.length;r>i;++i){var s=e[i];if(s&&(i>=n||t[i]))try{for(var a=s.getValue().getInnerNode(),u=a.getType(),l=u.length-1;l>=0;--l){switch(u[l]){case o.X3DPointingDeviceSensorNode:this.pointingDeviceSensors.push(a);break;case o.ClipPlane:this.clipPlanes.push(a);break;case o.LocalFog:this.localFogs.push(a);break;case o.X3DLightNode:this.lights.push(a);break;case o.X3DBindableNode:this.maybeCameraObjects.push(a);break;case o.X3DBackgroundNode:case o.X3DChildNode:a.isCameraObject_.addInterest(this,"set_cameraObjects__"),this.maybeCameraObjects.push(a),this.childNodes.push(a);break;case o.BooleanFilter:case o.BooleanToggle:case o.NurbsOrientationInterpolator:case o.NurbsPositionInterpolator:case o.NurbsSurfaceInterpolator:case o.TimeSensor:case o.X3DFollowerNode:case o.X3DInfoNode:case o.X3DInterpolatorNode:case o.X3DLayoutNode:case o.X3DScriptNode:case o.X3DSequencerNode:case o.X3DTriggerNode:break;default:continue}break}}catch(c){}}this.set_cameraObjects__()}},clear:function(){for(var e=0,t=this.childNodes.length;t>e;++e)this.childNodes[e].isCameraObject_.removeInterest(this,"set_cameraObjects__");this.pointingDeviceSensors.length=0,this.maybeCameraObjects.length=0,this.cameraObjects.length=0,this.clipPlanes.length=0,this.localFogs.length=0,this.lights.length=0,this.childNodes.length=0},set_cameraObjects__:function(){this.cameraObjects.length=0;for(var e=0,t=this.maybeCameraObjects.length;t>e;++e){var n=this.maybeCameraObjects[e];n.getCameraObject()&&this.cameraObjects.push(n)}this.setCameraObject(this.cameraObjects.length)},traverse:function(e){switch(e){case r.POINTER:var t=this.pointingDeviceSensors,n=this.clipPlanes,i=this.childNodes;if(t.length){var o={};this.getBrowser().getSensors().push(o);for(var s=0,a=t.length;a>s;++s)t[s].traverse(o)}for(var s=0,a=n.length;a>s;++s)n[s].push();for(var s=0,a=i.length;a>s;++s)i[s].traverse(e);for(var s=0,a=n.length;a>s;++s)n[s].pop();return void(t.length&&this.getBrowser().getSensors().pop());case r.CAMERA:for(var u=this.cameraObjects,s=0,a=u.length;a>s;++s)u[s].traverse(e);return;case r.COLLISION:for(var n=this.clipPlanes,i=this.childNodes,s=0,a=n.length;a>s;++s)n[s].push();for(var s=0,a=i.length;a>s;++s)i[s].traverse(e);for(var s=0,a=n.length;a>s;++s)n[s].pop();return;case r.DISPLAY:for(var n=this.clipPlanes,l=this.localFogs,c=this.lights,i=this.childNodes,s=0,a=n.length;a>s;++s)n[s].push();for(var s=0,a=l.length;a>s;++s)l[s].push();for(var s=0,a=c.length;a>s;++s)c[s].push();for(var s=0,a=i.length;a>s;++s)i[s].traverse(e);for(var s=0,a=c.length;a>s;++s)c[s].pop();for(var s=0,a=l.length;a>s;++s)l[s].pop();for(var s=0,a=n.length;a>s;++s)n[s].pop();return}}}),c}),define("cobweb/Components/Layering/X3DViewportNode",["jquery","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DViewportNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Layering/Viewport",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Layering/X3DViewportNode","cobweb/Bits/X3DConstants","cobweb/Bits/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(o.Viewport),this.rectangle=new l(0,0,0,0)}var h=a(u);return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"clipBoundary",new t.MFFloat(0,1,0,1)),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},initialize:function(){r.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.getBrowser().getViewport().addInterest(this,"set_rectangle__"),this.clipBoundary_.addInterest(this,"set_rectangle__"),this.set_live__()},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?(this.getBrowser().getViewport().addInterest(this,"set_rectangle__"),this.set_rectangle__()):this.getBrowser().getViewport().removeInterest(this,"set_rectangle__")},set_rectangle__:function(){var e=this.getBrowser().getViewport(),t=Math.floor(e[2]*this.getLeft()),n=Math.floor(e[2]*this.getRight()),i=Math.floor(e[3]*this.getBottom()),r=Math.floor(e[3]*this.getTop());this.rectangle.set(t,i,Math.max(0,n-t),Math.max(0,r-i))},getRectangle:function(){return this.rectangle},getLeft:function(){return this.clipBoundary_.length>0?this.clipBoundary_[0]:0},getRight:function(){return this.clipBoundary_.length>1?this.clipBoundary_[1]:1},getBottom:function(){return this.clipBoundary_.length>2?this.clipBoundary_[2]:0},getTop:function(){return this.clipBoundary_.length>3?this.clipBoundary_[3]:1},traverse:function(e){switch(this.push(),e){case s.POINTER:this.getBrowser().isPointerInRectangle(this.rectangle)&&r.prototype.traverse.call(this,e);break;default:r.prototype.traverse.call(this,e)}this.pop()},push:function(){var e=this.getCurrentLayer(),t=e.getViewVolumes(),n=t.length?t[0].getViewport():this.rectangle;e.getViewVolumes().push(h.pop(this.getBrowser().getProjectionMatrix(),n,this.rectangle))},pop:function(){h.push(this.getCurrentLayer().getViewVolumes().pop())}}),c}),define("cobweb/Browser/Layering/X3DLayeringContext",["cobweb/Components/Layering/Viewport"],function(e){function t(){this.defaultViewport=new e(this),this.layers=[]}return t.prototype={initialize:function(){this.defaultViewport.setup()},getDefaultViewport:function(){return this.defaultViewport},getLayers:function(){return this.layers}},t}),define("cobweb/Browser/Layout/X3DLayoutContext",[],function(){function e(){this.layouts=[]}return e.prototype={initialize:function(){},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.length?this.layouts[this.layouts.length-1]:null}},e}),define("cobweb/Components/Texturing/TextureProperties",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureProperties)}var a={CLAMP:"CLAMP_TO_EDGE",CLAMP_TO_EDGE:"CLAMP_TO_EDGE",CLAMP_TO_BOUNDARY:"CLAMP_TO_EDGE",MIRRORED_REPEAT:"MIRRORED_REPEAT",REPEAT:"REPEAT"},u={AVG_PIXEL_AVG_MIPMAP:"LINEAR_MIPMAP_LINEAR",AVG_PIXEL:"LINEAR",AVG_PIXEL_NEAREST_MIPMAP:"LINEAR_MIPMAP_NEAREST",NEAREST_PIXEL_AVG_MIPMAP:"NEAREST_MIPMAP_LINEAR",NEAREST_PIXEL_NEAREST_MIPMAP:"NEAREST_MIPMAP_NEAREST",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR_MIPMAP_LINEAR",FASTEST:"NEAREST"},l={AVG_PIXEL:"LINEAR",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR",FASTEST:"NEAREST"};return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"borderColor",new t.SFColorRGBA),new n(o.inputOutput,"borderWidth",new t.SFInt32),new n(o.inputOutput,"anisotropicDegree",new t.SFFloat(1)),new n(o.initializeOnly,"generateMipMaps",new t.SFBool),new n(o.inputOutput,"minificationFilter",new t.SFString("FASTEST")),new n(o.inputOutput,"magnificationFilter",new t.SFString("FASTEST")),new n(o.inputOutput,"boundaryModeS",new t.SFString("REPEAT")),new n(o.inputOutput,"boundaryModeT",new t.SFString("REPEAT")),new n(o.inputOutput,"boundaryModeR",new t.SFString("REPEAT")),new n(o.inputOutput,"textureCompression",new t.SFString("FASTEST")),new n(o.inputOutput,"texturePriority",new t.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBoundaryMode:function(e){var t=a[e];return void 0!==t?t:"REPEAT"},getBoundaryModeS:function(){return this.getBoundaryMode(this.boundaryModeS_.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this.boundaryModeT_.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this.boundaryModeR_.getValue())},getMinificationFilter:function(){if(this.generateMipMaps_.getValue()){var e=u[this.minificationFilter_.getValue()];return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"},getMagnificationFilter:function(){var e=l[this.magnificationFilter_.getValue()];return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}),s}),define("text!cobweb/Browser/Shaders/BackgroundSphereVertexShader.vs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n	vec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n	v           = p .xyz;\n	gl_Position = x3d_ProjectionMatrix * p;\n	C           = x3d_Color;\n}\n"}),define("text!cobweb/Browser/Shaders/BackgroundSphereFragmentShader.fs",[],function(){return"data:text/plain;charset=utf-8,\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\n\n#define MAX_CLIP_PLANES 6\n\nuniform vec4 x3d_ClipPlane [MAX_CLIP_PLANES];\n// 24\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n	for (int i = 0; i < MAX_CLIP_PLANES; ++ i)\n	{\n		if (x3d_ClipPlane [i] == vec4 (0.0, 0.0, 0.0, 0.0))\n			break;\n\n		if (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n			discard;\n	}\n}\n\nvoid\nmain ()\n{\n	clip ();\n\n	gl_FragColor = C;\n}\n"}),define("cobweb/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["cobweb/Components/Shaders/ComposedShader","cobweb/Components/Shaders/ShaderPart","cobweb/Components/Texturing/TextureProperties","text!cobweb/Browser/Shaders/BackgroundSphereVertexShader.vs","text!cobweb/Browser/Shaders/BackgroundSphereFragmentShader.fs"],function(e,t,n,i,r){function o(){this.backgroundTextureProperties=new n(this)}return o.prototype={initialize:function(){this.backgroundSphereShader=this.createShader(this,i,r),this.backgroundTextureProperties.boundaryModeS_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeT_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeR_="CLAMP_TO_EDGE",this.backgroundTextureProperties.minificationFilter_="NICEST",this.backgroundTextureProperties.magnificationFilter_="NICEST",this.backgroundTextureProperties.setup()},getBackgroundSphereShader:function(){return this.backgroundSphereShader},getBackgroundTextureProperties:function(){return this.backgroundTextureProperties}},o}),define("cobweb/Browser/Lighting/X3DLightingContext",["cobweb/Components/Layering/Viewport"],function(e){function t(){this.globalLights=[],this.localLights=[]}return t.prototype={initialize:function(){},getGlobalLights:function(){return this.globalLights},getLocalLights:function(){return this.localLights}},t}),define("cobweb/Browser/Sound/X3DSoundContext",["cobweb/Fields","lib/dataStorage"],function(e,t){function n(){this.addChildren("volume",new e.SFFloat(1)),this.addChildren("mute",new e.SFBool)}return n.prototype={initialize:function(){this.volume_.addInterest(this,"set_volume__"),this.mute_.addInterest(this,"set_mute__");var e=t["X3DSoundContext.volume"],n=t["X3DSoundContext.mute"];void 0!==e&&(this.volume_=e),void 0!==n&&(this.mute_=n)},set_volume__:function(e){t["X3DSoundContext.volume"]=e.getValue()},set_mute__:function(e){t["X3DSoundContext.mute"]=e.getValue()}},n}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("lib/opentype.js/dist/opentype.js",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.opentype=e()}}(function(){return function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){n.argument=function(e,t){if(!e)throw new Error(t)},n.assert=n.argument},{}],2:[function(e,t,n){function i(e,t,n,i,r){e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke()}n.line=i},{}],3:[function(e,t,n){function i(e){this.font=e}function r(e){this.cmap=e}function o(e,t){this.encoding=e,this.charset=t}function s(e){var t;switch(e.version){case 1:this.names=n.standardNames.slice();break;case 2:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<n.standardNames.length?this.names[t]=n.standardNames[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-n.standardNames.length];break;case 2.5:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)this.names[t]=n.standardNames[t+e.glyphNameIndex[t]];break;case 3:this.names=[]}}function a(e){for(var t,n=e.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var o=i[r],s=n[o];t=e.glyphs.get(s),t.addUnicode(parseInt(o))}for(r=0;r<e.glyphs.length;r+=1)t=e.glyphs.get(r),e.cffEncoding?t.name=e.cffEncoding.charset[r]:t.name=e.glyphNames.glyphIndexToName(r)}var u=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],c=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],h=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];
i.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),n=this.font.glyphs;if(!n)return null;for(var i=0;i<n.length;i+=1)for(var r=n.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===t)return i},r.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),n=this.encoding[t];return this.charset.indexOf(n)},s.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},s.prototype.glyphIndexToName=function(e){return this.names[e]},n.cffStandardStrings=u,n.cffStandardEncoding=l,n.cffExpertEncoding=c,n.standardNames=h,n.DefaultEncoding=i,n.CmapEncoding=r,n.CffEncoding=o,n.GlyphNames=s,n.addGlyphNames=a},{}],4:[function(e,t,n){function i(e){e=e||{},this.familyName=e.familyName||" ",this.styleName=e.styleName||" ",this.designer=e.designer||" ",this.designerURL=e.designerURL||" ",this.manufacturer=e.manufacturer||" ",this.manufacturerURL=e.manufacturerURL||" ",this.license=e.license||" ",this.licenseURL=e.licenseURL||" ",this.version=e.version||"Version 0.1",this.description=e.description||" ",this.copyright=e.copyright||" ",this.trademark=e.trademark||" ",this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.supported=!0,this.glyphs=new a.GlyphSet(this,e.glyphs||[]),this.encoding=new s.DefaultEncoding(this),this.tables={}}var r=e("./path"),o=e("./tables/sfnt"),s=e("./encoding"),a=e("./glyphset");i.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},i.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},i.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},i.prototype.stringToGlyphs=function(e){for(var t=[],n=0;n<e.length;n+=1){var i=e[n];t.push(this.charToGlyph(i))}return t},i.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},i.prototype.nameToGlyph=function(e){var t=this.nametoGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},i.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},i.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var n=this.getGposKerningValue;return n?n(e,t):this.kerningPairs[e+","+t]||0},i.prototype.forEachGlyph=function(e,t,n,i,r,o){t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:72,r=r||{};for(var s=void 0===r.kerning?!0:r.kerning,a=1/this.unitsPerEm*i,u=this.stringToGlyphs(e),l=0;l<u.length;l+=1){var c=u[l];if(o(c,t,n,i,r),c.advanceWidth&&(t+=c.advanceWidth*a),s&&l<u.length-1){var h=this.getKerningValue(c,u[l+1]);t+=h*a}}},i.prototype.getPath=function(e,t,n,i,o){var s=new r.Path;return this.forEachGlyph(e,t,n,i,o,function(e,t,n,i){var r=e.getPath(t,n,i);s.extend(r)}),s},i.prototype.draw=function(e,t,n,i,r,o){this.getPath(t,n,i,r,o).draw(e)},i.prototype.drawPoints=function(e,t,n,i,r,o){this.forEachGlyph(t,n,i,r,o,function(t,n,i,r){t.drawPoints(e,n,i,r)})},i.prototype.drawMetrics=function(e,t,n,i,r,o){this.forEachGlyph(t,n,i,r,o,function(t,n,i,r){t.drawMetrics(e,n,i,r)})},i.prototype.validate=function(){function e(e,t){e||n.push(t)}function t(t){e(i[t]&&i[t].trim().length>0,"No "+t+" specified.")}var n=[],i=this;t("familyName"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),e(this.unitsPerEm>0,"No unitsPerEm specified.")},i.prototype.toTables=function(){return o.fontToTable(this)},i.prototype.toBuffer=function(){for(var e=this.toTables(),t=e.encode(),n=new ArrayBuffer(t.length),i=new Uint8Array(n),r=0;r<t.length;r++)i[r]=t[r];return n},i.prototype.download=function(){var e=this.familyName.replace(/\s/g,"")+"-"+this.styleName+".otf",t=this.toBuffer();window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,t.byteLength,function(n){n.root.getFile(e,{create:!0},function(e){e.createWriter(function(n){var i=new DataView(t),r=new Blob([i],{type:"font/opentype"});n.write(r),n.addEventListener("writeend",function(){location.href=e.toURL()},!1)})})},function(e){throw e})},n.Font=i},{"./encoding":3,"./glyphset":6,"./path":9,"./tables/sfnt":24}],5:[function(e,t,n){function i(e,t){var n=t||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(e){n=e}}}function r(e){this.bindConstructorValues(e)}var o=e("./check"),s=e("./draw"),a=e("./path");r.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",i(this,e.path))},r.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},r.prototype.getPath=function(e,t,n){e=void 0!==e?e:0,t=void 0!==t?t:0,n=void 0!==n?n:72;for(var i=1/this.path.unitsPerEm*n,r=new a.Path,o=this.path.commands,s=0;s<o.length;s+=1){var u=o[s];"M"===u.type?r.moveTo(e+u.x*i,t+-u.y*i):"L"===u.type?r.lineTo(e+u.x*i,t+-u.y*i):"Q"===u.type?r.quadraticCurveTo(e+u.x1*i,t+-u.y1*i,e+u.x*i,t+-u.y*i):"C"===u.type?r.curveTo(e+u.x1*i,t+-u.y1*i,e+u.x2*i,t+-u.y2*i,e+u.x*i,t+-u.y*i):"Z"===u.type&&r.closePath()}return r},r.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],n=0;n<this.points.length;n+=1){var i=this.points[n];t.push(i),i.lastPointOfContour&&(e.push(t),t=[])}return o.argument(0===t.length,"There are still points left in the current contour."),e},r.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],n=[],i=0;i<e.length;i+=1){var r=e[i];"Z"!==r.type&&(t.push(r.x),n.push(r.y)),("Q"===r.type||"C"===r.type)&&(t.push(r.x1),n.push(r.y1)),"C"===r.type&&(t.push(r.x2),n.push(r.y2))}var o={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,n),leftSideBearing:0};return o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},r.prototype.draw=function(e,t,n,i){this.getPath(t,n,i).draw(e)},r.prototype.drawPoints=function(e,t,n,i){function r(t,n,i,r){var o=2*Math.PI;e.beginPath();for(var s=0;s<t.length;s+=1)e.moveTo(n+t[s].x*r,i+t[s].y*r),e.arc(n+t[s].x*r,i+t[s].y*r,2,0,o,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:24;for(var o=1/this.path.unitsPerEm*i,s=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var c=u.commands[l];void 0!==c.x&&s.push({x:c.x,y:-c.y}),void 0!==c.x1&&a.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&a.push({x:c.x2,y:-c.y2})}e.fillStyle="blue",r(s,t,n,o),e.fillStyle="red",r(a,t,n,o)},r.prototype.drawMetrics=function(e,t,n,i){var r;t=void 0!==t?t:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,e.lineWidth=1,e.strokeStyle="black",s.line(e,t,-1e4,t,1e4),s.line(e,-1e4,n,1e4,n);var o=this.xMin||0,a=this.yMin||0,u=this.xMax||0,l=this.yMax||0,c=this.advanceWidth||0;e.strokeStyle="blue",s.line(e,t+o*r,-1e4,t+o*r,1e4),s.line(e,t+u*r,-1e4,t+u*r,1e4),s.line(e,-1e4,n+-a*r,1e4,n+-a*r),s.line(e,-1e4,n+-l*r,1e4,n+-l*r),e.strokeStyle="green",s.line(e,t+c*r,-1e4,t+c*r,1e4)},n.Glyph=r},{"./check":1,"./draw":2,"./path":9}],6:[function(e,t,n){function i(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var n=0;n<t.length;n++)this.glyphs[n]=t[n];this.length=t&&t.length||0}function r(e,t){return new a.Glyph({index:t,font:e})}function o(e,t,n,i,r,o){return function(){var s=new a.Glyph({index:t,font:e});return s.path=function(){n(s,i,r);var t=o(e.glyphs,s);return t.unitsPerEm=e.unitsPerEm,t},s}}function s(e,t,n,i){return function(){var r=new a.Glyph({index:t,font:e});return r.path=function(){var t=n(e,r,i);return t.unitsPerEm=e.unitsPerEm,t},r}}var a=e("./glyph");i.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},i.prototype.push=function(e,t){this.glyphs[e]=t,this.length++},n.GlyphSet=i,n.glyphLoader=r,n.ttfGlyphLoader=o,n.cffGlyphLoader=s},{"./glyph":5}],7:[function(e,t,n){function i(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;i+=1)n[i]=e[i];return t}function r(t,n){var r=e("fs");r.readFile(t,function(e,t){return e?n(e.message):void n(null,i(t))})}function o(e,t){var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return 200!==n.status?t("Font could not be loaded: "+n.statusText):t(null,n.response)},n.send()}function s(e){var t,n,i,r,o,s,a,u=new c.Font,h=new DataView(e,0),p=d.getFixed(h,0);if(1===p)u.outlinesFormat="truetype";else{if(p=d.getTag(h,0),"OTTO"!==p)throw new Error("Unsupported OpenType version "+p);u.outlinesFormat="cff"}for(var O=d.getUShort(h,4),N=12,V=0;O>V;V+=1){var D=d.getTag(h,N),M=d.getULong(h,N+8);switch(D){case"cmap":u.tables.cmap=f.parse(h,M),u.encoding=new l.CmapEncoding(u.tables.cmap);break;case"head":u.tables.head=b.parse(h,M),u.unitsPerEm=u.tables.head.unitsPerEm,t=u.tables.head.indexToLocFormat;break;case"hhea":u.tables.hhea=w.parse(h,M),u.ascender=u.tables.hhea.ascender,u.descender=u.tables.hhea.descender,u.numberOfHMetrics=u.tables.hhea.numberOfHMetrics;break;case"hmtx":n=M;break;case"maxp":u.tables.maxp=C.parse(h,M),u.numGlyphs=u.tables.maxp.numGlyphs;break;case"name":u.tables.name=S.parse(h,M),u.familyName=u.tables.name.fontFamily,u.styleName=u.tables.name.fontSubfamily;break;case"OS/2":u.tables.os2=T.parse(h,M);break;case"post":u.tables.post=F.parse(h,M),u.glyphNames=new l.GlyphNames(u.tables.post);break;case"glyf":i=M;break;case"loca":r=M;break;case"CFF ":o=M;break;case"kern":s=M;break;case"GPOS":a=M}N+=16}if(i&&r){var B=0===t,E=_.parse(h,r,u.numGlyphs,B);u.glyphs=m.parse(h,i,E,u),v.parse(h,n,u.numberOfHMetrics,u.numGlyphs,u.glyphs),l.addGlyphNames(u)}else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");g.parse(h,o,u),l.addGlyphNames(u)}return s?u.kerningPairs=x.parse(h,s):u.kerningPairs={},a&&y.parse(h,a,u),u}function a(e,t){var n="undefined"==typeof window,i=n?r:o;i(e,function(e,n){if(e)return t(e);var i=s(n);return t(null,i)})}function u(t){var n=e("fs"),r=n.readFileSync(t);return s(i(r))}var l=e("./encoding"),c=e("./font"),h=e("./glyph"),d=e("./parse"),p=e("./path"),f=e("./tables/cmap"),g=e("./tables/cff"),m=e("./tables/glyf"),y=e("./tables/gpos"),b=e("./tables/head"),w=e("./tables/hhea"),v=e("./tables/hmtx"),x=e("./tables/kern"),_=e("./tables/loca"),C=e("./tables/maxp"),S=e("./tables/name"),T=e("./tables/os2"),F=e("./tables/post");n._parse=d,n.Font=c.Font,n.Glyph=h.Glyph,n.Path=p.Path,n.parse=s,n.load=a,n.loadSync=u},{"./encoding":3,"./font":4,"./glyph":5,"./parse":8,"./path":9,"./tables/cff":11,"./tables/cmap":12,"./tables/glyf":13,"./tables/gpos":14,"./tables/head":15,"./tables/hhea":16,"./tables/hmtx":17,"./tables/kern":18,"./tables/loca":19,"./tables/maxp":20,"./tables/name":21,"./tables/os2":22,"./tables/post":23,fs:void 0}],8:[function(e,t,n){function i(e,t){this.data=e,this.offset=t,this.relativeOffset=0}n.getByte=function(e,t){return e.getUint8(t)},n.getCard8=n.getByte,n.getUShort=function(e,t){return e.getUint16(t,!1)},n.getCard16=n.getUShort,n.getShort=function(e,t){return e.getInt16(t,!1)},n.getULong=function(e,t){return e.getUint32(t,!1)},n.getFixed=function(e,t){var n=e.getInt16(t,!1),i=e.getUint16(t+2,!1);return n+i/65535},n.getTag=function(e,t){for(var n="",i=t;t+4>i;i+=1)n+=String.fromCharCode(e.getInt8(i));return n},n.getOffset=function(e,t,n){for(var i=0,r=0;n>r;r+=1)i<<=8,i+=e.getUint8(t+r);return i},n.getBytes=function(e,t,n){for(var i=[],r=t;n>r;r+=1)i.push(e.getUint8(r));return i},n.bytesToString=function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return t};var r={"byte":1,uShort:2,"short":2,uLong:4,fixed:4,longDateTime:8,tag:4};i.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},i.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},i.prototype.parseCard8=i.prototype.parseByte,i.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},i.prototype.parseCard16=i.prototype.parseUShort,i.prototype.parseSID=i.prototype.parseUShort,i.prototype.parseOffset16=i.prototype.parseUShort,i.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},i.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},i.prototype.parseULong=function(){var e=n.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},i.prototype.parseFixed=function(){var e=n.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},i.prototype.parseOffset16List=i.prototype.parseUShortList=function(e){for(var t=new Array(e),i=this.data,r=this.offset+this.relativeOffset,o=0;e>o;o++)t[o]=n.getUShort(i,r),r+=2;return this.relativeOffset+=2*e,t},i.prototype.parseString=function(e){var t=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=e;for(var r=0;e>r;r++)i+=String.fromCharCode(t.getUint8(n+r));return i},i.prototype.parseTag=function(){return this.parseString(4)},i.prototype.parseLongDateTime=function(){var e=n.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,e},i.prototype.parseFixed=function(){var e=n.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e/65536},i.prototype.parseVersion=function(){var e=n.getUShort(this.data,this.offset+this.relativeOffset),t=n.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e+t/4096/10},i.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=r[e]*t},n.Parser=i},{}],9:[function(e,t,n){function i(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}i.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},i.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},i.prototype.curveTo=i.prototype.bezierCurveTo=function(e,t,n,i,r,o){this.commands.push({type:"C",x1:e,y1:t,x2:n,y2:i,x:r,y:o})},i.prototype.quadTo=i.prototype.quadraticCurveTo=function(e,t,n,i){this.commands.push({type:"Q",x1:e,y1:t,x:n,y:i})},i.prototype.close=i.prototype.closePath=function(){this.commands.push({type:"Z"})},i.prototype.extend=function(e){e.commands&&(e=e.commands),Array.prototype.push.apply(this.commands,e)},i.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var n=this.commands[t];"M"===n.type?e.moveTo(n.x,n.y):"L"===n.type?e.lineTo(n.x,n.y):"C"===n.type?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},i.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function n(){for(var e="",n=0;n<arguments.length;n+=1){var i=arguments[n];i>=0&&n>0&&(e+=" "),e+=t(i)}return e}e=void 0!==e?e:2;for(var i="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];"M"===o.type?i+="M"+n(o.x,o.y):"L"===o.type?i+="L"+n(o.x,o.y):"C"===o.type?i+="C"+n(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?i+="Q"+n(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(i+="Z")}return i},i.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&"black"!==this.fill&&(t+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},n.Path=i},{}],10:[function(e,t,n){function i(e,t,n){var i;for(i=0;i<t.length;i+=1){var r=t[i];this[r.name]=r.value}if(this.tableName=e,this.fields=t,n){var o=Object.keys(n);for(i=0;i<o.length;i+=1){var s=o[i],a=n[s];void 0!==this[s]&&(this[s]=a)}}}var r=e("./check"),o=e("./types").encode,s=e("./types").sizeOf;i.prototype.sizeOf=function(){for(var e=0,t=0;t<this.fields.length;t+=1){var n=this.fields[t],i=this[n.name];if(void 0===i&&(i=n.value),"function"==typeof i.sizeOf)e+=i.sizeOf();else{var o=s[n.type];r.assert("function"==typeof o,"Could not find sizeOf function for field"+n.name),e+=o(i)}}return e},i.prototype.encode=function(){return o.TABLE(this)},n.Table=i},{"./check":1,"./types":25}],11:[function(e,t,n){function i(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(!i(e[n],t[n]))return!1;return!0}return!1}function r(e,t,n){var i,r,o,s=[],a=[],u=A.getCard16(e,t);if(0!==u){var l=A.getByte(e,t+2);r=t+(u+1)*l+2;var c=t+3;for(i=0;u+1>i;i+=1)s.push(A.getOffset(e,c,l)),c+=l;o=r+s[u]}else o=t+2;for(i=0;i<s.length-1;i+=1){var h=A.getBytes(e,r+s[i],r+s[i+1]);n&&(h=n(h)),a.push(h)}return{objects:a,startOffset:t,endOffset:o}}function o(e){for(var t="",n=15,i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=e.parseByte(),o=r>>4,s=15&r;if(o===n)break;if(t+=i[o],s===n)break;t+=i[s]}return parseFloat(t)}function s(e,t){var n,i,r,s;if(28===t)return n=e.parseByte(),i=e.parseByte(),n<<8|i;if(29===t)return n=e.parseByte(),i=e.parseByte(),r=e.parseByte(),s=e.parseByte(),n<<24|i<<16|r<<8|s;if(30===t)return o(e);if(t>=32&&246>=t)return t-139;if(t>=247&&250>=t)return n=e.parseByte(),256*(t-247)+n+108;if(t>=251&&254>=t)return n=e.parseByte(),256*-(t-251)-n-108;throw new Error("Invalid b0 "+t)}function a(e){for(var t={},n=0;n<e.length;n+=1){var i,r=e[n][0],o=e[n][1];if(i=1===o.length?o[0]:o,t.hasOwnProperty(r))throw new Error("Object "+t+" already has key "+r);t[r]=i}return t}function u(e,t,n){t=void 0!==t?t:0;var i=new A.Parser(e,t),r=[],o=[];for(n=void 0!==n?n:e.length;i.relativeOffset<n;){var u=i.parseByte();21>=u?(12===u&&(u=1200+i.parseByte()),r.push([u,o]),o=[]):o.push(s(i,u))}return a(r)}function l(e,t){return t=390>=t?E.cffStandardStrings[t]:e[t-391]}function c(e,t,n){for(var i={},r=0;r<t.length;r+=1){var o=t[r],s=e[o.op];void 0===s&&(s=void 0!==o.value?o.value:null),"SID"===o.type&&(s=l(n,s)),i[o.name]=s}return i}function h(e,t){var n={};return n.formatMajor=A.getCard8(e,t),n.formatMinor=A.getCard8(e,t+1),n.size=A.getCard8(e,t+2),n.offsetSize=A.getCard8(e,t+3),n.startOffset=t,n.endOffset=t+4,n}function d(e,t){var n=u(e,0,e.byteLength);return c(n,R,t)}function p(e,t,n,i){var r=u(e,t,n);return c(r,k,i)}function f(e,t,n,i){var r,o,s,a=new A.Parser(e,t);n-=1;var u=[".notdef"],c=a.parseCard8();if(0===c)for(r=0;n>r;r+=1)o=a.parseSID(),u.push(l(i,o));else if(1===c)for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard8(),r=0;s>=r;r+=1)u.push(l(i,o)),o+=1;else{if(2!==c)throw new Error("Unknown charset format "+c);for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard16(),r=0;s>=r;r+=1)u.push(l(i,o)),o+=1}return u}function g(e,t,n){var i,r,o={},s=new A.Parser(e,t),a=s.parseCard8();if(0===a){var u=s.parseCard8();for(i=0;u>i;i+=1)r=s.parseCard8(),o[r]=i}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();for(r=1,i=0;l>i;i+=1)for(var c=s.parseCard8(),h=s.parseCard8(),d=c;c+h>=d;d+=1)o[d]=r,r+=1}return new E.CffEncoding(o,n)}function m(e,t,n){function i(e,t){g&&c.closePath(),c.moveTo(e,t),g=!0}function r(){var t;t=h.length%2!==0,t&&!p&&(f=h.shift()+e.nominalWidthX),d+=h.length>>1,h.length=0,p=!0}function o(n){for(var b,w,v,x,_,C,S,T,F,O,N,V,D=0;D<n.length;){var M=n[D];switch(D+=1,M){case 1:r();break;case 3:r();break;case 4:h.length>1&&!p&&(f=h.shift()+e.nominalWidthX,p=!0),y+=h.pop(),i(m,y);break;case 5:for(;h.length>0;)m+=h.shift(),y+=h.shift(),c.lineTo(m,y);break;case 6:for(;h.length>0&&(m+=h.shift(),c.lineTo(m,y),0!==h.length);)y+=h.shift(),c.lineTo(m,y);break;case 7:for(;h.length>0&&(y+=h.shift(),c.lineTo(m,y),0!==h.length);)m+=h.shift(),c.lineTo(m,y);break;case 8:for(;h.length>0;)s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l+h.shift(),c.curveTo(s,a,u,l,m,y);break;case 10:_=h.pop()+e.subrsBias,C=e.subrs[_],C&&o(C);break;case 11:return;case 12:switch(M=n[D],D+=1,M){case 35:s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),S=u+h.shift(),T=l+h.shift(),F=S+h.shift(),O=T+h.shift(),N=F+h.shift(),V=O+h.shift(),m=N+h.shift(),y=V+h.shift(),h.shift(),c.curveTo(s,a,u,l,S,T),c.curveTo(F,O,N,V,m,y);break;case 34:s=m+h.shift(),a=y,u=s+h.shift(),l=a+h.shift(),S=u+h.shift(),T=l,F=S+h.shift(),O=l,N=F+h.shift(),V=y,m=N+h.shift(),c.curveTo(s,a,u,l,S,T),c.curveTo(F,O,N,V,m,y);break;case 36:s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),S=u+h.shift(),T=l,F=S+h.shift(),O=l,N=F+h.shift(),V=O+h.shift(),m=N+h.shift(),c.curveTo(s,a,u,l,S,T),c.curveTo(F,O,N,V,m,y);break;case 37:s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),S=u+h.shift(),T=l+h.shift(),F=S+h.shift(),O=T+h.shift(),N=F+h.shift(),V=O+h.shift(),Math.abs(N-m)>Math.abs(V-y)?m=N+h.shift():y=V+h.shift(),c.curveTo(s,a,u,l,S,T),c.curveTo(F,O,N,V,m,y);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+M),h.length=0}break;case 14:h.length>0&&!p&&(f=h.shift()+e.nominalWidthX,p=!0),g&&(c.closePath(),g=!1);break;case 18:r();break;case 19:case 20:r(),D+=d+7>>3;break;case 21:h.length>2&&!p&&(f=h.shift()+e.nominalWidthX,p=!0),y+=h.pop(),m+=h.pop(),i(m,y);break;case 22:h.length>1&&!p&&(f=h.shift()+e.nominalWidthX,p=!0),m+=h.pop(),i(m,y);break;case 23:r();break;case 24:for(;h.length>2;)s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l+h.shift(),c.curveTo(s,a,u,l,m,y);m+=h.shift(),y+=h.shift(),c.lineTo(m,y);break;case 25:for(;h.length>6;)m+=h.shift(),y+=h.shift(),c.lineTo(m,y);s=m+h.shift(),a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l+h.shift(),c.curveTo(s,a,u,l,m,y);break;case 26:for(h.length%2&&(m+=h.shift());h.length>0;)s=m,a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u,y=l+h.shift(),c.curveTo(s,a,u,l,m,y);break;case 27:for(h.length%2&&(y+=h.shift());h.length>0;)s=m+h.shift(),a=y,u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l,c.curveTo(s,a,u,l,m,y);break;case 28:b=n[D],w=n[D+1],h.push((b<<24|w<<16)>>16),D+=2;break;case 29:_=h.pop()+e.gsubrsBias,C=e.gsubrs[_],C&&o(C);break;case 30:for(;h.length>0&&(s=m,a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l+(1===h.length?h.shift():0),c.curveTo(s,a,u,l,m,y),0!==h.length);)s=m+h.shift(),a=y,u=s+h.shift(),l=a+h.shift(),y=l+h.shift(),m=u+(1===h.length?h.shift():0),c.curveTo(s,a,u,l,m,y);break;case 31:for(;h.length>0&&(s=m+h.shift(),a=y,u=s+h.shift(),l=a+h.shift(),y=l+h.shift(),m=u+(1===h.length?h.shift():0),c.curveTo(s,a,u,l,m,y),0!==h.length);)s=m,a=y+h.shift(),u=s+h.shift(),l=a+h.shift(),m=u+h.shift(),y=l+(1===h.length?h.shift():0),c.curveTo(s,a,u,l,m,y);break;default:32>M?console.log("Glyph "+t.index+": unknown operator "+M):247>M?h.push(M-139):251>M?(b=n[D],D+=1,h.push(256*(M-247)+b+108)):255>M?(b=n[D],D+=1,h.push(256*-(M-251)-b-108)):(b=n[D],w=n[D+1],v=n[D+2],x=n[D+3],D+=4,h.push((b<<24|w<<16|v<<8|x)/65536))}}}var s,a,u,l,c=new P.Path,h=[],d=0,p=!1,f=e.defaultWidthX,g=!1,m=0,y=0;return o(n),t.advanceWidth=f,c}function y(e){var t;return t=e.length<1240?107:e.length<33900?1131:32768}function b(e,t,n){n.tables.cff={};var i=h(e,t),o=r(e,i.endOffset,A.bytesToString),s=r(e,o.endOffset),a=r(e,s.endOffset,A.bytesToString),u=r(e,a.endOffset);n.gsubrs=u.objects,n.gsubrsBias=y(n.gsubrs);var l=new DataView(new Uint8Array(s.objects[0]).buffer),c=d(l,a.objects);n.tables.cff.topDict=c;var b=t+c["private"][1],w=p(e,b,c["private"][0],a.objects);if(n.defaultWidthX=w.defaultWidthX,n.nominalWidthX=w.nominalWidthX,0!==w.subrs){var v=b+w.subrs,x=r(e,v);n.subrs=x.objects,n.subrsBias=y(n.subrs)}else n.subrs=[],n.subrsBias=0;var _=r(e,t+c.charStrings);n.nGlyphs=_.objects.length;var C=f(e,t+c.charset,n.nGlyphs,a.objects);0===c.encoding?n.cffEncoding=new E.CffEncoding(E.cffStandardEncoding,C):1===c.encoding?n.cffEncoding=new E.CffEncoding(E.cffExpertEncoding,C):n.cffEncoding=g(e,t+c.encoding,C),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new I.GlyphSet(n);for(var S=0;S<n.nGlyphs;S+=1){var T=_.objects[S];n.glyphs.push(S,I.cffGlyphLoader(n,S,m,T))}}function w(e,t){var n,i=E.cffStandardStrings.indexOf(e);return i>=0&&(n=i),i=t.indexOf(e),i>=0?n=i+E.cffStandardStrings.length:(n=E.cffStandardStrings.length+t.length,t.push(e)),n}function v(){return new L.Table("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function x(e){var t=new L.Table("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var n=0;n<e.length;n+=1)t.names.push({name:"name_"+n,type:"NAME",value:e[n]});return t}function _(e,t,n){for(var r={},o=0;o<e.length;o+=1){var s=e[o],a=t[s.name];void 0===a||i(a,s.value)||("SID"===s.type&&(a=w(a,n)),r[s.op]={name:s.name,type:s.type,value:a})}return r}function C(e,t){var n=new L.Table("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=_(R,e,t),n}function S(e){var t=new L.Table("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function T(e){var t=new L.Table("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var n=0;n<e.length;n+=1)t.strings.push({name:"string_"+n,type:"STRING",value:e[n]});return t}function F(){return new L.Table("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function O(e,t){for(var n=new L.Table("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<e.length;i+=1){var r=e[i],o=w(r,t);n.fields.push({name:"glyph_"+i,type:"SID",value:o})}return n}function N(e){var t=[],n=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var i=0,r=0,o=0;o<n.commands.length;o+=1){var s,a,u=n.commands[o];if("Q"===u.type){var l=1/3,c=2/3;u={type:"C",x:u.x,y:u.y,x1:l*i+c*u.x1,y1:l*r+c*u.y1,x2:l*u.x+c*u.x1,y2:l*u.y+c*u.y1}}if("M"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rlineto",type:"OP",value:5}),i=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var h=Math.round(u.x1-i),d=Math.round(u.y1-r),p=Math.round(u.x2-u.x1),f=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),t.push({name:"dx1",type:"NUMBER",value:h}),t.push({name:"dy1",type:"NUMBER",value:d}),t.push({name:"dx2",type:"NUMBER",value:p}),t.push({name:"dy2",type:"NUMBER",value:f}),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(u.x),r=Math.round(u.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function V(e){for(var t=new L.Table("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<e.length;n+=1){var i=e.get(n),r=N(i);t.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return t}function D(e,t){var n=new L.Table("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=_(k,e,t),n}function M(e){var t=new L.Table("Private DICT INDEX",[{name:"privateDicts",type:"INDEX",value:[]}]);return t.privateDicts=[{name:"privateDict_0",type:"TABLE",value:e}],t}function B(e,t){for(var n,i=new L.Table("CFF ",[{name:"header",type:"TABLE"},{name:"nameIndex",type:"TABLE"},{name:"topDictIndex",type:"TABLE"},{name:"stringIndex",type:"TABLE"},{name:"globalSubrIndex",type:"TABLE"},{name:"charsets",type:"TABLE"},{name:"charStringsIndex",type:"TABLE"},{name:"privateDictIndex",type:"TABLE"}]),r=1/t.unitsPerEm,o={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,"private":[0,999]},s={},a=[],u=1;u<e.length;u+=1)n=e.get(u),a.push(n.name);var l=[];i.header=v(),i.nameIndex=x([t.postScriptName]);var c=C(o,l);i.topDictIndex=S(c),i.globalSubrIndex=F(),i.charsets=O(a,l),i.charStringsIndex=V(e);var h=D(s,l);i.privateDictIndex=M(h),i.stringIndex=T(l);var d=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return o.charset=d,o.encoding=0,o.charStrings=o.charset+i.charsets.sizeOf(),o["private"][1]=o.charStrings+i.charStringsIndex.sizeOf(),c=C(o,l),i.topDictIndex=S(c),i}var E=e("../encoding"),I=e("../glyphset"),A=e("../parse"),P=e("../path"),L=e("../table"),R=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],k=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];n.parse=b,n.make=B},{"../encoding":3,"../glyphset":6,"../parse":8,"../path":9,"../table":10}],12:[function(e,t,n){function i(e,t){var n,i={};i.version=u.getUShort(e,t),a.argument(0===i.version,"cmap table version should be 0."),i.numTables=u.getUShort(e,t+2);var r=-1;for(n=0;n<i.numTables;n+=1){var o=u.getUShort(e,t+4+8*n),s=u.getUShort(e,t+4+8*n+2);if(3===o&&(1===s||0===s)){r=u.getULong(e,t+4+8*n+4);break}}if(-1===r)return null;var l=new u.Parser(e,t+r);i.format=l.parseUShort(),a.argument(4===i.format,"Only format 4 cmap tables are supported."),i.length=l.parseUShort(),i.language=l.parseUShort();var c;i.segCount=c=l.parseUShort()>>1,l.skip("uShort",3),i.glyphIndexMap={};var h=new u.Parser(e,t+r+14),d=new u.Parser(e,t+r+16+2*c),p=new u.Parser(e,t+r+16+4*c),f=new u.Parser(e,t+r+16+6*c),g=t+r+16+8*c;for(n=0;c-1>n;n+=1)for(var m,y=h.parseUShort(),b=d.parseUShort(),w=p.parseShort(),v=f.parseUShort(),x=b;y>=x;x+=1)0!==v?(g=f.offset+f.relativeOffset-2,g+=v,g+=2*(x-b),m=u.getUShort(e,g),0!==m&&(m=m+w&65535)):m=x+w&65535,i.glyphIndexMap[x]=m;return i}function r(e,t,n){e.segments.push({end:t,start:t,delta:-(t-n),offset:0})}function o(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function s(e){var t,n=new l.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(n.segments=[],t=0;t<e.length;t+=1){for(var i=e.get(t),s=0;s<i.unicodes.length;s+=1)r(n,i.unicodes[s],t);n.segments=n.segments.sort(function(e,t){return e.start-t.start})}o(n);var a;a=n.segments.length,n.segCountX2=2*a,n.searchRange=2*Math.pow(2,Math.floor(Math.log(a)/Math.log(2))),n.entrySelector=Math.log(n.searchRange/2)/Math.log(2),n.rangeShift=n.segCountX2-n.searchRange;var u=[],c=[],h=[],d=[],p=[];for(t=0;a>t;t+=1){var f=n.segments[t];u=u.concat({name:"end_"+t,type:"USHORT",value:f.end
}),c=c.concat({name:"start_"+t,type:"USHORT",value:f.start}),h=h.concat({name:"idDelta_"+t,type:"SHORT",value:f.delta}),d=d.concat({name:"idRangeOffset_"+t,type:"USHORT",value:f.offset}),void 0!==f.glyphId&&(p=p.concat({name:"glyph_"+t,type:"USHORT",value:f.glyphId}))}return n.fields=n.fields.concat(u),n.fields.push({name:"reservedPad",type:"USHORT",value:0}),n.fields=n.fields.concat(c),n.fields=n.fields.concat(h),n.fields=n.fields.concat(d),n.fields=n.fields.concat(p),n.length=14+2*u.length+2+2*c.length+2*h.length+2*d.length+2*p.length,n}var a=e("../check"),u=e("../parse"),l=e("../table");n.parse=i,n.make=s},{"../check":1,"../parse":8,"../table":10}],13:[function(e,t,n){function i(e,t,n,i,r){var o;return(t&i)>0?(o=e.parseByte(),0===(t&r)&&(o=-o),o=n+o):o=(t&r)>0?n:n+e.parseShort(),o}function r(e,t,n){var r=new d.Parser(t,n);e.numberOfContours=r.parseShort(),e.xMin=r.parseShort(),e.yMin=r.parseShort(),e.xMax=r.parseShort(),e.yMax=r.parseShort();var o,s;if(e.numberOfContours>0){var a,u=e.endPointIndices=[];for(a=0;a<e.numberOfContours;a+=1)u.push(r.parseUShort());for(e.instructionLength=r.parseUShort(),e.instructions=[],a=0;a<e.instructionLength;a+=1)e.instructions.push(r.parseByte());var l=u[u.length-1]+1;for(o=[],a=0;l>a;a+=1)if(s=r.parseByte(),o.push(s),(8&s)>0)for(var h=r.parseByte(),p=0;h>p;p+=1)o.push(s),a+=1;if(c.argument(o.length===l,"Bad flags."),u.length>0){var f,g=[];if(l>0){for(a=0;l>a;a+=1)s=o[a],f={},f.onCurve=!!(1&s),f.lastPointOfContour=u.indexOf(a)>=0,g.push(f);var m=0;for(a=0;l>a;a+=1)s=o[a],f=g[a],f.x=i(r,s,m,2,16),m=f.x;var y=0;for(a=0;l>a;a+=1)s=o[a],f=g[a],f.y=i(r,s,y,4,32),y=f.y}e.points=g}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var b=!0;b;){o=r.parseUShort();var w={glyphIndex:r.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&o)>0?(w.dx=r.parseShort(),w.dy=r.parseShort()):(w.dx=r.parseChar(),w.dy=r.parseChar()),(8&o)>0?w.xScale=w.yScale=r.parseF2Dot14():(64&o)>0?(w.xScale=r.parseF2Dot14(),w.yScale=r.parseF2Dot14()):(128&o)>0&&(w.xScale=r.parseF2Dot14(),w.scale01=r.parseF2Dot14(),w.scale10=r.parseF2Dot14(),w.yScale=r.parseF2Dot14()),e.components.push(w),b=!!(32&o)}}}function o(e,t){for(var n=[],i=0;i<e.length;i+=1){var r=e[i],o={x:t.xScale*r.x+t.scale01*r.y+t.dx,y:t.scale10*r.x+t.yScale*r.y+t.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(o)}return n}function s(e){for(var t=[],n=[],i=0;i<e.length;i+=1){var r=e[i];n.push(r),r.lastPointOfContour&&(t.push(n),n=[])}return c.argument(0===n.length,"There are still points left in the current contour."),t}function a(e){var t=new p.Path;if(!e)return t;for(var n=s(e),i=0;i<n.length;i+=1){var r,o,a=n[i],u=a[0],l=a[a.length-1];u.onCurve?(r=null,o=!0):(u=l.onCurve?l:{x:(u.x+l.x)/2,y:(u.y+l.y)/2},r=u,o=!1),t.moveTo(u.x,u.y);for(var c=o?1:0;c<a.length;c+=1){var h=a[c],d=0===c?u:a[c-1];if(d.onCurve&&h.onCurve)t.lineTo(h.x,h.y);else if(d.onCurve&&!h.onCurve)r=h;else if(d.onCurve||h.onCurve){if(d.onCurve||!h.onCurve)throw new Error("Invalid state.");t.quadraticCurveTo(r.x,r.y,h.x,h.y),r=null}else{var f={x:(d.x+h.x)/2,y:(d.y+h.y)/2};t.quadraticCurveTo(d.x,d.y,f.x,f.y),r=h}}u!==l&&(r?t.quadraticCurveTo(r.x,r.y,u.x,u.y):t.lineTo(u.x,u.y))}return t.closePath(),t}function u(e,t){if(t.isComposite)for(var n=0;n<t.components.length;n+=1){var i=t.components[n],r=e.get(i.glyphIndex);if(r.points){var s=o(r.points,i);t.points=t.points.concat(s)}}return a(t.points)}function l(e,t,n,i){var o,s=new h.GlyphSet(i);for(o=0;o<n.length-1;o+=1){var a=n[o],l=n[o+1];a!==l?s.push(o,h.ttfGlyphLoader(i,o,r,e,t+a,u)):s.push(o,h.glyphLoader(i,o))}return s}var c=e("../check"),h=e("../glyphset"),d=e("../parse"),p=e("../path");n.parse=l},{"../check":1,"../glyphset":6,"../parse":8,"../path":9}],14:[function(e,t,n){function i(e,t){for(var n=new c.Parser(e,t),i=n.parseUShort(),r=[],o=0;i>o;o++)r[n.parseTag()]={offset:n.parseUShort()};return r}function r(e,t){var n=new c.Parser(e,t),i=n.parseUShort(),r=n.parseUShort();if(1===i)return n.parseUShortList(r);if(2===i){for(var o=[];r--;)for(var s=n.parseUShort(),a=n.parseUShort(),u=n.parseUShort(),l=s;a>=l;l++)o[u++]=l;return o}}function o(e,t){var n=new c.Parser(e,t),i=n.parseUShort();if(1===i){var r=n.parseUShort(),o=n.parseUShort(),s=n.parseUShortList(o);return function(e){return s[e-r]||0}}if(2===i){for(var a=n.parseUShort(),u=[],l=[],h=[],d=0;a>d;d++)u[d]=n.parseUShort(),l[d]=n.parseUShort(),h[d]=n.parseUShort();return function(e){for(var t=0,n=u.length-1;n>t;){var i=t+n+1>>1;e<u[i]?n=i-1:t=i}return u[t]<=e&&e<=l[t]?h[t]||0:0}}}function s(e,t){var n,i,s=new c.Parser(e,t),a=s.parseUShort(),u=s.parseUShort(),l=r(e,t+u),h=s.parseUShort(),d=s.parseUShort();if(4===h&&0===d){var p={};if(1===a){for(var f=s.parseUShort(),g=[],m=s.parseOffset16List(f),y=0;f>y;y++){var b=m[y],w=p[b];if(!w){w={},s.relativeOffset=b;for(var v=s.parseUShort();v--;){var x=s.parseUShort();h&&(n=s.parseShort()),d&&(i=s.parseShort()),w[x]=n}}g[l[y]]=w}return function(e,t){var n=g[e];return n?n[t]:void 0}}if(2===a){for(var _=s.parseUShort(),C=s.parseUShort(),S=s.parseUShort(),T=s.parseUShort(),F=o(e,t+_),O=o(e,t+C),N=[],V=0;S>V;V++)for(var D=N[V]=[],M=0;T>M;M++)h&&(n=s.parseShort()),d&&(i=s.parseShort()),D[M]=n;var B={};for(V=0;V<l.length;V++)B[l[V]]=1;return function(e,t){if(B[e]){var n=F(e),i=O(t),r=N[n];return r?r[i]:void 0}}}}}function a(e,t){var n=new c.Parser(e,t),i=n.parseUShort(),r=n.parseUShort(),o=16&r,a=n.parseUShort(),u=n.parseOffset16List(a),l={lookupType:i,lookupFlag:r,markFilteringSet:o?n.parseUShort():-1};if(2===i){for(var h=[],d=0;a>d;d++)h.push(s(e,t+u[d]));l.getKerningValue=function(e,t){for(var n=h.length;n--;){var i=h[n](e,t);if(void 0!==i)return i}return 0}}return l}function u(e,t,n){var r=new c.Parser(e,t),o=r.parseFixed();l.argument(1===o,"Unsupported GPOS table version."),i(e,t+r.parseUShort()),i(e,t+r.parseUShort());var s=r.parseUShort();r.relativeOffset=s;for(var u=r.parseUShort(),h=r.parseOffset16List(u),d=t+s,p=0;u>p;p++){var f=a(e,d+h[p]);2!==f.lookupType||n.getGposKerningValue||(n.getGposKerningValue=f.getKerningValue)}}var l=e("../check"),c=e("../parse");n.parse=u},{"../check":1,"../parse":8}],15:[function(e,t,n){function i(e,t){var n={},i=new s.Parser(e,t);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),o.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n}function r(e){return new a.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}var o=e("../check"),s=e("../parse"),a=e("../table");n.parse=i,n.make=r},{"../check":1,"../parse":8,"../table":10}],16:[function(e,t,n){function i(e,t){var n={},i=new o.Parser(e,t);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n}function r(e){return new s.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}var o=e("../parse"),s=e("../table");n.parse=i,n.make=r},{"../parse":8,"../table":10}],17:[function(e,t,n){function i(e,t,n,i,r){for(var s,a,u=new o.Parser(e,t),l=0;i>l;l+=1){n>l&&(s=u.parseUShort(),a=u.parseShort());var c=r.get(l);c.advanceWidth=s,c.leftSideBearing=a}}function r(e){for(var t=new s.Table("hmtx",[]),n=0;n<e.length;n+=1){var i=e.get(n),r=i.advanceWidth||0,o=i.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),t.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return t}var o=e("../parse"),s=e("../table");n.parse=i,n.make=r},{"../parse":8,"../table":10}],18:[function(e,t,n){function i(e,t){var n={},i=new o.Parser(e,t),s=i.parseUShort();r.argument(0===s,"Unsupported kern table version."),i.skip("uShort",1);var a=i.parseUShort();r.argument(0===a,"Unsupported kern sub-table version."),i.skip("uShort",2);var u=i.parseUShort();i.skip("uShort",3);for(var l=0;u>l;l+=1){var c=i.parseUShort(),h=i.parseUShort(),d=i.parseShort();n[c+","+h]=d}return n}var r=e("../check"),o=e("../parse");n.parse=i},{"../check":1,"../parse":8}],19:[function(e,t,n){function i(e,t,n,i){for(var o=new r.Parser(e,t),s=i?o.parseUShort:o.parseULong,a=[],u=0;n+1>u;u+=1){var l=s.call(o);i&&(l*=2),a.push(l)}return a}var r=e("../parse");n.parse=i},{"../parse":8}],20:[function(e,t,n){function i(e,t){var n={},i=new o.Parser(e,t);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n}function r(e){return new s.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}var o=e("../parse"),s=e("../table");n.parse=i,n.make=r},{"../parse":8,"../table":10}],21:[function(e,t,n){function i(e,t){var n={},i=new l.Parser(e,t);n.format=i.parseUShort();for(var r=i.parseUShort(),o=i.offset+i.parseUShort(),s=0,a=0;r>a;a++){var u=i.parseUShort(),c=i.parseUShort(),d=i.parseUShort(),p=i.parseUShort(),f=h[p],g=i.parseUShort(),m=i.parseUShort();if(3===u&&1===c&&1033===d){for(var y=[],b=g/2,w=0;b>w;w++,m+=2)y[w]=l.getShort(e,o+m);var v=String.fromCharCode.apply(null,y);f?n[f]=v:(s++,n["unknown"+s]=v)}}return 1===n.format&&(n.langTagCount=i.parseUShort()),n}function r(e,t,n,i,r,o){return new c.Table("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function o(e,t,n,i){var o=u.STRING(n);return e.records.push(r(1,0,0,t,o.length,i)),e.strings.push(o),i+=o.length}function s(e,t,n,i){var o=u.UTF16(n);return e.records.push(r(3,1,1033,t,o.length,i)),e.strings.push(o),i+=o.length}function a(e){var t=new c.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:0},{name:"stringOffset",type:"USHORT",value:0}]);t.records=[],t.strings=[];var n,i,r=0;for(n=0;n<h.length;n+=1)void 0!==e[h[n]]&&(i=e[h[n]],r=o(t,n,i,r));for(n=0;n<h.length;n+=1)void 0!==e[h[n]]&&(i=e[h[n]],r=s(t,n,i,r));for(t.count=t.records.length,t.stringOffset=6+12*t.count,n=0;n<t.records.length;n+=1)t.fields.push({name:"record_"+n,type:"TABLE",value:t.records[n]});for(n=0;n<t.strings.length;n+=1)t.fields.push({name:"string_"+n,type:"LITERAL",value:t.strings[n]});return t}var u=e("../types").encode,l=e("../parse"),c=e("../table"),h=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","licence","licenceURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];n.parse=i,n.make=a},{"../parse":8,"../table":10,"../types":25}],22:[function(e,t,n){function i(e){for(var t=0;t<u.length;t+=1){var n=u[t];if(e>=n.begin&&e<n.end)return t}return-1}function r(e,t){var n={},i=new s.Parser(e,t);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;10>r;r++)n.panose[r]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),n.version>=1&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),n.version>=2&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n}function o(e){return new a.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}var s=e("../parse"),a=e("../table"),u=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];n.unicodeRanges=u,n.getUnicodeRange=i,n.parse=r,n.make=o},{"../parse":8,"../table":10}],23:[function(e,t,n){function i(e,t){var n,i={},r=new s.Parser(e,t);switch(i.version=r.parseVersion(),i.italicAngle=r.parseFixed(),i.underlinePosition=r.parseShort(),i.underlineThickness=r.parseShort(),i.isFixedPitch=r.parseULong(),i.minMemType42=r.parseULong(),i.maxMemType42=r.parseULong(),i.minMemType1=r.parseULong(),i.maxMemType1=r.parseULong(),i.version){case 1:i.names=o.standardNames.slice();break;case 2:for(i.numberOfGlyphs=r.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.glyphNameIndex[n]=r.parseUShort();for(i.names=[],n=0;n<i.numberOfGlyphs;n++)if(i.glyphNameIndex[n]>=o.standardNames.length){var a=r.parseChar();i.names.push(r.parseString(a))}break;case 2.5:for(i.numberOfGlyphs=r.parseUShort(),i.offset=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.offset[n]=r.parseChar()}return i}function r(){return new a.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var o=e("../encoding"),s=e("../parse"),a=e("../table");n.parse=i,n.make=r},{"../encoding":3,"../parse":8,"../table":10}],24:[function(e,t,n){function i(e){return Math.log(e)/Math.log(2)|0}function r(e){for(;e.length%4!==0;)e.push(0);for(var t=0,n=0;n<e.length;n+=4)t+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return t%=Math.pow(2,32)}function o(e,t,n,i){return new h.Table("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function s(e){var t=new h.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var n=Math.pow(2,i(t.numTables));t.searchRange=16*n,t.entrySelector=i(n),t.rangeShift=16*t.numTables-t.searchRange;for(var s=[],a=[],u=t.sizeOf()+o().sizeOf()*t.numTables;u%4!==0;)u+=1,a.push({name:"padding",type:"BYTE",value:0});for(var l=0;l<e.length;l+=1){var d=e[l];c.argument(4===d.tableName.length,"Table name"+d.tableName+" is invalid.");var p=d.sizeOf(),f=o(d.tableName,r(d.encode()),u,p);for(s.push({name:f.tag+" Table Record",type:"TABLE",value:f}),a.push({name:d.tableName+" table",type:"TABLE",value:d}),u+=p,c.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!==0;)u+=1,a.push({name:"padding",type:"BYTE",value:0})}return s.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(s),t.fields=t.fields.concat(a),t}function a(e,t,n){for(var i=0;i<t.length;i+=1){var r=e.charToGlyphIndex(t[i]);if(r>0){var o=e.glyphs.get(r);return o.getMetrics()}}return n}function u(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length}function l(e){for(var t,n=[],i=[],o=[],l=[],c=[],h=[],x=[],_=0,C=0,S=0,T=0,F=0,O=0;O<e.glyphs.length;O+=1){var N=e.glyphs.get(O),V=0|N.unicode;(t>V||null===t)&&(t=V),V>_&&(_=V);var D=w.getUnicodeRange(V);if(32>D)C|=1<<D;else if(64>D)S|=1<<D-32;else if(96>D)T|=1<<D-64;else{if(!(123>D))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");F|=1<<D-96}if(".notdef"!==N.name){var M=N.getMetrics();n.push(M.xMin),i.push(M.yMin),o.push(M.xMax),l.push(M.yMax),h.push(M.leftSideBearing),x.push(M.rightSideBearing),c.push(N.advanceWidth)}}var B={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,c),advanceWidthAvg:u(c),minLeftSideBearing:Math.min.apply(null,h),maxLeftSideBearing:Math.max.apply(null,h),minRightSideBearing:Math.min.apply(null,x)};B.ascender=void 0!==e.ascender?e.ascender:B.yMax,B.descender=void 0!==e.descender?e.descender:B.yMin;var E=f.make({unitsPerEm:e.unitsPerEm,xMin:B.xMin,yMin:B.yMin,xMax:B.xMax,yMax:B.yMax}),I=g.make({ascender:B.ascender,descender:B.descender,advanceWidthMax:B.advanceWidthMax,minLeftSideBearing:B.minLeftSideBearing,minRightSideBearing:B.minRightSideBearing,xMaxExtent:B.maxLeftSideBearing+(B.xMax-B.xMin),numberOfHMetrics:e.glyphs.length}),A=y.make(e.glyphs.length),P=w.make({xAvgCharWidth:Math.round(B.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:t,usLastCharIndex:_,ulUnicodeRange1:C,ulUnicodeRange2:S,ulUnicodeRange3:T,ulUnicodeRange4:F,sTypoAscender:B.ascender,sTypoDescender:B.descender,sTypoLineGap:0,usWinAscent:B.ascender,usWinDescent:-B.descender,sxHeight:a(e,"xyvw",{yMax:0}).yMax,sCapHeight:a(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",B).yMax,usBreakChar:e.hasChar(" ")?32:0}),L=m.make(e.glyphs),R=d.make(e.glyphs),k=e.familyName+" "+e.styleName,j=e.familyName.replace(/\s/g,"")+"-"+e.styleName,z=b.make({copyright:e.copyright,fontFamily:e.familyName,fontSubfamily:e.styleName,uniqueID:e.manufacturer+":"+k,fullName:k,version:e.version,postScriptName:j,trademark:e.trademark,manufacturer:e.manufacturer,designer:e.designer,description:e.description,manufacturerURL:e.manufacturerURL,designerURL:e.designerURL,license:e.license,licenseURL:e.licenseURL,preferredFamily:e.familyName,preferredSubfamily:e.styleName}),X=v.make(),U=p.make(e.glyphs,{version:e.version,fullName:k,familyName:e.familyName,weightName:e.styleName,postScriptName:j,unitsPerEm:e.unitsPerEm}),q=[E,I,A,P,z,R,X,U,L],G=s(q),H=G.encode(),W=r(H),Y=G.fields,$=!1;for(O=0;O<Y.length;O+=1)if("head table"===Y[O].name){Y[O].value.checkSumAdjustment=2981146554-W,$=!0;break}if(!$)throw new Error("Could not find head table with checkSum to adjust.");return G}var c=e("../check"),h=e("../table"),d=e("./cmap"),p=e("./cff"),f=e("./head"),g=e("./hhea"),m=e("./hmtx"),y=e("./maxp"),b=e("./name"),w=e("./os2"),v=e("./post");n.computeCheckSum=r,n.make=s,n.fontToTable=l},{"../check":1,"../table":10,"./cff":11,"./cmap":12,"./head":15,"./hhea":16,"./hmtx":17,"./maxp":20,"./name":21,"./os2":22,"./post":23}],25:[function(e,t,n){function i(e){return function(){return e}}var r=e("./check"),o=32768,s=2147483648,a={},u={},l={};u.BYTE=function(e){return r.argument(e>=0&&255>=e,"Byte value should be between 0 and 255."),[e]},l.BYTE=i(1),u.CHAR=function(e){return[e.charCodeAt(0)]},l.CHAR=i(1),u.CHARARRAY=function(e){for(var t=[],n=0;n<e.length;n+=1)t.push(e.charCodeAt(n));return t},l.CHARARRAY=function(e){return e.length},u.USHORT=function(e){return[e>>8&255,255&e]},l.USHORT=i(2),u.SHORT=function(e){return e>=o&&(e=-(2*o-e)),[e>>8&255,255&e]},l.SHORT=i(2),u.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},l.UINT24=i(3),u.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},l.ULONG=i(4),u.LONG=function(e){return e>=s&&(e=-(2*s-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},l.LONG=i(4),u.FIXED=u.ULONG,l.FIXED=l.ULONG,u.FWORD=u.SHORT,l.FWORD=l.SHORT,u.UFWORD=u.USHORT,l.UFWORD=l.USHORT,u.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},l.LONGDATETIME=i(8),u.TAG=function(e){return r.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},l.TAG=i(4),u.Card8=u.BYTE,l.Card8=l.BYTE,u.Card16=u.USHORT,l.Card16=l.USHORT,u.OffSize=u.BYTE,l.OffSize=l.BYTE,u.SID=u.USHORT,l.SID=l.USHORT,u.NUMBER=function(e){return e>=-107&&107>=e?[e+139]:e>=108&&1131>=e?(e-=108,[(e>>8)+247,255&e]):e>=-1131&&-108>=e?(e=-e-108,[(e>>8)+251,255&e]):e>=-32768&&32767>=e?u.NUMBER16(e):u.NUMBER32(e)},l.NUMBER=function(e){return u.NUMBER(e).length},u.NUMBER16=function(e){return[28,e>>8&255,255&e]},l.NUMBER16=i(3),u.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},l.NUMBER32=i(5),u.REAL=function(e){var t=e.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));t=(Math.round(e*i)/i).toString()}var r,o,s="";for(r=0,o=t.length;o>r;r+=1){var a=t[r];s+="e"===a?"-"===t[++r]?"c":"b":"."===a?"a":"-"===a?"e":a}s+=1&s.length?"f":"ff";var u=[30];for(r=0,o=s.length;o>r;r+=2)u.push(parseInt(s.substr(r,2),16));return u},l.REAL=function(e){return u.REAL(e).length},u.NAME=u.CHARARRAY,l.NAME=l.CHARARRAY,u.STRING=u.CHARARRAY,l.STRING=l.CHARARRAY,u.UTF16=function(e){for(var t=[],n=0;n<e.length;n+=1){var i=e.charCodeAt(n);t.push(i>>8&255),t.push(255&i)}return t},l.UTF16=function(e){return 2*e.length},u.INDEX=function(e){var t,n=1,i=[n],r=[],o=0;for(t=0;t<e.length;t+=1){var s=u.OBJECT(e[t]);Array.prototype.push.apply(r,s),o+=s.length,n+=s.length,i.push(n)}if(0===r.length)return[0,0];var a=[],l=1+Math.floor(Math.log(o)/Math.log(2))/8|0,c=[void 0,u.BYTE,u.USHORT,u.UINT24,u.ULONG][l];for(t=0;t<i.length;t+=1){var h=c(i[t]);Array.prototype.push.apply(a,h)}return Array.prototype.concat(u.Card16(e.length),u.OffSize(l),a,r)},l.INDEX=function(e){return u.INDEX(e).length},u.DICT=function(e){for(var t=[],n=Object.keys(e),i=n.length,r=0;i>r;r+=1){var o=parseInt(n[r],0),s=e[o];t=t.concat(u.OPERAND(s.value,s.type)),t=t.concat(u.OPERATOR(o))}return t},l.DICT=function(e){return u.DICT(e).length},u.OPERATOR=function(e){return 1200>e?[e]:[12,e-1200]},u.OPERAND=function(e,t){var n=[];if(Array.isArray(t))for(var i=0;i<t.length;i+=1)r.argument(e.length===t.length,"Not enough arguments given for type"+t),n=n.concat(u.OPERAND(e[i],t[i]));else if("SID"===t)n=n.concat(u.NUMBER(e));else if("offset"===t)n=n.concat(u.NUMBER32(e));else if("number"===t)n=n.concat(u.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);n=n.concat(u.REAL(e))}return n},u.OP=u.BYTE,l.OP=l.BYTE;var c="function"==typeof WeakMap&&new WeakMap;u.CHARSTRING=function(e){if(c&&c.has(e))return c.get(e);for(var t=[],n=e.length,i=0;n>i;i+=1){var r=e[i];t=t.concat(u[r.type](r.value))}return c&&c.set(e,t),t},l.CHARSTRING=function(e){return u.CHARSTRING(e).length},u.OBJECT=function(e){var t=u[e.type];return r.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},l.OBJECT=function(e){var t=l[e.type];return r.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},u.TABLE=function(e){for(var t=[],n=e.fields.length,i=0;n>i;i+=1){var o=e.fields[i],s=u[o.type];r.argument(void 0!==s,"No encoding function for field type "+o.type);var a=e[o.name];void 0===a&&(a=o.value);var l=s(a);t=t.concat(l)}return t},l.TABLE=function(e){for(var t=0,n=e.fields.length,i=0;n>i;i+=1){var o=e.fields[i],s=l[o.type];r.argument(void 0!==s,"No sizeOf function for field type "+o.type);var a=e[o.name];void 0===a&&(a=o.value),t+=s(a)}return t},u.LITERAL=function(e){return e},l.LITERAL=function(e){return e.length},n.decode=a,n.encode=u,n.sizeOf=l},{"./check":1}]},{},[7])(7)}),define("cobweb/Components/Text/X3DFontStyleNode",["jquery","cobweb/Components/Core/X3DNode","cobweb/InputOutput/Loader","cobweb/Bits/X3DConstants","cobweb/Browser/Networking/urls","standard/Networking/URI","lib/opentype.js/dist/opentype.js"],function(e,t,n,i,r,o,s){function a(e,r){t.call(this,e,r),this.addType(i.X3DFontStyleNode),this.family=[],this.alignments=[],this.loader=new n(this,!0)}var u=["https://cdn.rawgit.com/create3000/cobweb/master/cobweb.js/fonts/","http://cdn.rawgit.com/create3000/cobweb/master/cobweb.js/fonts/","https://rawgit.com/create3000/cobweb/master/cobweb.js/fonts/","http://rawgit.com/create3000/cobweb/master/cobweb.js/fonts/","http://titania.create3000.de/fileadmin/cobweb/fonts/"],l={SERIF:{PLAIN:"DroidSerif-Regular.ttf",ITALIC:"DroidSerif-Italic.ttf",BOLD:"DroidSerif-Bold.ttf",BOLDITALIC:"DroidSerif-BoldItalic.ttf"},SANS:{PLAIN:"Ubuntu-R.ttf",ITALIC:"Ubuntu-RI.ttf",BOLD:"Ubuntu-B.ttf",BOLDITALIC:"Ubuntu-BI.ttf"},TYPEWRITER:{PLAIN:"UbuntuMono-R.ttf",ITALIC:"UbuntuMono-RI.ttf",BOLD:"UbuntuMono-B.ttf",BOLDITALIC:"UbuntuMono-BI.ttf"}},c=0,h={BEGIN:++c,FIRST:++c,MIDDLE:++c,END:++c};return a.prototype=e.extend(Object.create(t.prototype),{constructor:a,initialize:function(){t.prototype.initialize.call(this),this.style_.addInterest(this,"set_style__"),this.justify_.addInterest(this,"set_justify__"),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__()},getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1];
},set_style__:function(){this.requestAsyncLoad()},set_justify__:function(){var e=this.horizontal_.getValue()?this.leftToRight_.getValue():this.topToBottom_.getValue();this.alignments[0]=this.justify_.length>0?this.getAlignment(0,e):e?h.BEGIN:h.END;var t=this.horizontal_.getValue()?this.topToBottom_.getValue():this.leftToRight_.getValue();this.alignments[1]=this.justify_.length>1?this.getAlignment(1,t):t?h.FIRST:h.END},getAlignment:function(e,t){if(t)switch(this.justify_[e]){case"FIRST":return h.FIRST;case"BEGIN":return h.BEGIN;case"MIDDLE":return h.MIDDLE;case"END":return h.END}else switch(this.justify_[e]){case"FIRST":return h.END;case"BEGIN":return h.END;case"MIDDLE":return h.MIDDLE;case"END":return h.BEGIN}return e?h.FIRST:h.BEGIN},requestAsyncLoad:function(){this.familyIndex=0,this.family.length=0;var e=this.family_.copy();e.push("SERIF");for(var t=0;t<e.length;++t){var n=e[t],i=this.getDefaultFont(n);if(i)for(var r=0;r<u.length;++r)this.family.push(u[r]+i);else this.family.push(n)}this.loadFont()},loadFont:function(){try{if(this.familyIndex<this.family.length){var e=this.family[this.familyIndex],t=this.loader.transform(e);s.load(t,this.setFont.bind(this))}}catch(n){this.setError(n.message)}},getDefaultFont:function(e){var t=l[e];if(t){var n=t[this.style_.getValue()];return n?n:t.PLAIN}},setFont:function(e,t){if(e)this.setError(e);else{this.font=t,t.fontName=t.familyName+t.styleName;for(var n=0;n<this.font.numGlyphs;++n)this.font.glyphs.get(n).getPath(0,0,1);this.addNodeEvent()}},getFont:function(){return this.font},setError:function(e){var t=this.family[this.familyIndex],n=new o(t);this.font=null,this.familyIndex++,n.isLocal()||t.toString().match(r.fallbackRx)||this.family.splice(this.familyIndex,0,r.fallback+t),console.warn("Error loading font '"+t+"':",e),this.loadFont()}}),a.Alignment=h,a}),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],function(e,t){function n(t,n){switch(arguments.length){case 0:return void(this.matrix=new e(.5,0,0,0,.5,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,t.y/2,0,n.x,n.y,1));case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.x+i.x)/2,u=(r.y+i.y)/2;return void(this.matrix=new e(o,0,0,0,s,0,a,u,1))}}var i=new t(0,0),r=new t(0,0),o=new t(0,0),s=new t(0,0),a=new t(0,0),u=new t(0,0),l=new t(0,0),c=new t(0,0),h=new t(0,0);return n.prototype={constructor:n,copy:function(){var e=Object.create(n.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},set:function(e,t){var n=this.matrix;return n[0]=e.x/2,n[1]=0,n[2]=0,n[3]=0,n[4]=e.y/2,n[5]=0,n[6]=t.x,n[7]=t.y,n[8]=1,this},set:function(e,t){var n=this.matrix;switch(arguments.length){case 0:return n[0]=.5,n[1]=0,n[2]=0,n[3]=0,n[4]=.5,n[5]=0,n[6]=0,n[7]=0,n[8]=0,this;case 2:return n[0]=e.x/2,n[1]=0,n[2]=0,n[3]=0,n[4]=e.y/2,n[5]=0,n[6]=t.x,n[7]=t.y,n[8]=1,this;case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.x+i.x)/2,u=(r.y+i.y)/2;return n[0]=o,n[1]=0,n[2]=0,n[3]=0,n[4]=s,n[5]=0,n[6]=a,n[7]=u,n[8]=1,this}},setExtents:function(e,t){var n=this.matrix,i=(t.x-e.x)/2,r=(t.y-e.y)/2,o=(t.x+e.x)/2,s=(t.y+e.y)/2;return n[0]=i,n[1]=0,n[2]=0,n[3]=0,n[4]=r,n[5]=0,n[6]=o,n[7]=s,n[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(u,l),e.getExtents(c,h),this.assign(new n(u.min(c),l.max(h),!0)))},multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(e,t){var n=this.matrix;i.set(n[0],n[1]),r.set(n[3],n[4]),a.assign(i).add(r);var o=r.subtract(i);e.assign(a).min(o),t.assign(a).max(o),a.negate(),o.negate(),e.min(a,o),t.max(a,o)},intersectsPoint:function(e){return this.getExtents(o,s),o.x<=e.x&&s.x>=e.x&&o.y<=e.y&&s.y>=e.y},toString:function(){return this.size+", "+this.center}},Object.defineProperty(n.prototype,"size",{get:function(){var e=new t(0,0);return this.getAbsoluteExtents(o,e),e.subtract(o)},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),n}),define("standard/Math/Geometry/Triangle2",[],function(){return{isPointInTriangle:function(e,t,n,i){var r=(t.y-n.y)*(e.x-n.x)+(n.x-t.x)*(e.y-n.y),o=((t.y-n.y)*(i.x-n.x)+(n.x-t.x)*(i.y-n.y))/r;if(0>o||o>1)return!1;var s=((n.y-e.y)*(i.x-n.x)+(e.x-n.x)*(i.y-n.y))/r;if(0>s||s>1)return!1;var a=1-o-s;return 0>a||a>1?!1:!0}}}),define("lib/bezierjs/bezier.js",[],function(){var e=Math.abs,n=Math.min,i=Math.max,r=Math.cos,o=Math.sin,s=Math.acos,a=(Math.asin,Math.atan2),u=Math.sqrt,l=function(e){return 0>e?-Math.pow(-e,1/3):Math.pow(e,1/3)},c=Math.PI,h=2*c,d=c/2,p={x:0,y:0,z:0},f={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){var n=t(e),i=n.x*n.x+n.y*n.y;return"undefined"!=typeof n.z&&(i+=n.z*n.z),u(i)},length:function(e){var t,n,i=.5,r=0,o=this.Tvalues.length;for(t=0;o>t;t++)n=i*this.Tvalues[t]+i,r+=this.Cvalues[t]*this.arcfn(n,e);return i*r},map:function(e,t,n,i,r){var o=n-t,s=r-i,a=e-t,u=a/o;return i+s*u},lerp:function(e,t,n){var i={x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)};return t.z&&n.z&&(i.z=t.z+e*(n.z-t.z)),i},pointToString:function(e){var t=e.x+"/"+e.y;return"undefined"!=typeof e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map(this.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,n){var i,r=t.x-e.x,o=t.y-e.y,s=n.x-e.x,l=n.y-e.y,c=r*l-o*s,h=u(r*r+o*o),d=u(s*s+l*l);return r/=h,o/=h,s/=d,l/=d,i=r*s+o*l,a(c,i)},dist:function(e,t){var n=e.x-t.x,i=e.y-t.y;return u(n*n+i*i)},lli8:function(e,t,n,i,r,o,s,a){var u=(e*i-t*n)*(r-s)-(e-n)*(r*a-o*s),l=(e*i-t*n)*(o-a)-(t-i)*(r*a-o*s),c=(e-n)*(o-a)-(t-i)*(r-s);return 0==c?!1:{x:u/c,y:l/c}},lli4:function(e,t,n,i){var r=e.x,o=e.y,s=t.x,a=t.y,u=n.x,l=n.y,c=i.x,h=i.y;return this.lli8(r,o,s,a,u,l,c,h)},lli:function(e,t){return this.lli4(e,e.c,t,t.c)},makeline:function(e,t){var n=e.x,i=e.y,r=t.x,o=t.y,s=(r-n)/3,a=(o-i)/3;return new m(n,i,n+s,i+a,n+2*s,i+2*a,r,o)},findbbox:function(e){var t=99999999,n=t,i=-t,r=i;return e.forEach(function(e){var o=e.bbox();t>o.x.min&&(t=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),r<o.y.max&&(r=o.y.max)}),{x:{min:t,mid:(t+i)/2,max:i,size:i-t},y:{min:n,mid:(n+r)/2,max:r,size:r-n}}},shapeintersections:function(e,t,n,i){if(!this.bboxoverlap(t,i))return[];var r=[],o=[e.startcap,e.forward,e.back,e.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(t){t.virtual||s.forEach(function(i){if(!i.virtual){var o=t.intersects(i);o.length>0&&(o.c1=t,o.c2=i,o.s1=e,o.s2=n,r.push(o))}})}),r},makeshape:function(e,t){var n=t.points.length,i=e.points.length,r=this.makeline(t.points[n-1],e.points[0]),o=this.makeline(e.points[i-1],t.points[0]),s={startcap:r,forward:e,back:t,endcap:o,bbox:this.findbbox([r,e,t,o])},a=this;return s.intersections=function(e){return a.shapeintersections(s,s.bbox,e,e.bbox)},s},getminmax:function(e,t,n){if(!n)return{min:0,max:0};var i,r,o=0x10000000000000000,s=-o;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(var a=0,u=n.length;u>a;a++)i=n[a],r=e.get(i),r[t]<o&&(o=r[t]),r[t]>s&&(s=r[t]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(e,t){var n=t.p1.x,i=t.p1.y,s=-a(t.p2.y-i,t.p2.x-n),u=function(e){return{x:(e.x-n)*r(s)-(e.y-i)*o(s),y:(e.x-n)*o(s)+(e.y-i)*r(s)}};return e.map(u)},roots:function(e,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};var n=e.length-1,i=this.align(e,t),o=function(e){return e>=0&&1>=e};if(2===n){var a=i[0].y,c=i[1].y,d=i[2].y,p=a-2*c+d;if(0!==p){var f=-u(c*c-a*d),g=-a+c,m=-(f+g)/p,y=-(-f+g)/p;return[m,y].filter(o)}return c!==d&&0===p?[(2*c-d)/2*(c-d)].filter(o):[]}var b,m,w,v,x,_=i[0].y,C=i[1].y,S=i[2].y,T=i[3].y,p=-_+3*C-3*S+T,a=(3*_-6*C+3*S)/p,c=(-3*_+3*C)/p,d=_/p,i=(3*c-a*a)/3,F=i/3,O=(2*a*a*a-9*a*c+27*d)/27,N=O/2,V=N*N+F*F*F;if(0>V){var D=-i/3,M=D*D*D,B=u(M),E=-O/(2*B),I=-1>E?-1:E>1?1:E,A=s(I),P=l(B),L=2*P;return w=L*r(A/3)-a/3,v=L*r((A+h)/3)-a/3,x=L*r((A+2*h)/3)-a/3,[w,v,x].filter(o)}if(0===V)return b=0>N?l(-N):-l(N),w=2*b-a/3,v=-b-a/3,[w,v].filter(o);var R=u(V);return b=l(-N+R),m=l(N+R),[b-m-a/3].filter(o)},droots:function(e){if(3===e.length){var t=e[0],n=e[1],i=e[2],r=t-2*n+i;if(0!==r){var o=-u(n*n-t*i),s=-t+n,a=-(o+s)/r,l=-(-o+s)/r;return[a,l]}return n!==i&&0===r?[(2*n-i)/(2*(n-i))]:[]}if(2===e.length){var t=e[0],n=e[1];return t!==n?[t/(t-n)]:[]}},bboxoverlap:function(t,n){var i,r,o,s,a,u=["x","y"],l=u.length;for(i=0;l>i;i++)if(r=u[i],o=t[r].mid,s=n[r].mid,a=(t[r].size+n[r].size)/2,e(o-s)>=a)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t){var n=e.bbox(),i=t.bbox(),r=1e5,o=.5;if(n.x.size+n.y.size<o&&i.x.size+i.y.size<o)return[(r*(e._t1+e._t2)/2|0)/r+"/"+(r*(t._t1+t._t2)/2|0)/r];var s=e.split(.5),a=t.split(.5),u=[{left:s.left,right:a.left},{left:s.left,right:a.right},{left:s.right,right:a.right},{left:s.right,right:a.left}];u=u.filter(function(e){return f.bboxoverlap(e.left.bbox(),e.right.bbox())});var l=[];return 0===u.length?l:(u.forEach(function(e){l=l.concat(f.pairiteration(e.left,e.right))}),l=l.filter(function(e,t){return l.indexOf(e)===t}))},getccenter:function(e,t,n){var i,s=t.x-e.x,u=t.y-e.y,l=n.x-t.x,c=n.y-t.y,p=s*r(d)-u*o(d),g=s*o(d)+u*r(d),m=l*r(d)-c*o(d),y=l*o(d)+c*r(d),b=(e.x+t.x)/2,w=(e.y+t.y)/2,v=(t.x+n.x)/2,x=(t.y+n.y)/2,_=b+p,C=w+g,S=v+m,T=x+y,F=f.lli8(b,w,_,C,v,x,S,T),O=f.dist(F,e),N=a(e.y-F.y,e.x-F.x),V=a(t.y-F.y,t.x-F.x),D=a(n.y-F.y,n.x-F.x);return D>N?((N>V||V>D)&&(N+=h),N>D&&(i=D,D=N,N=i)):V>D&&N>V?(i=D,D=N,N=i):D+=h,F.s=N,F.e=D,F.r=O,F}},g=function(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)};g.prototype={valueOf:function(){return this.toString()},toString:function(){return f.pointsToString(this.points)},addCurve:function(e){this.curves.push(e),this._3d=this._3d||e._3d},length:function(){return this.curves.map(function(e){return e.length()}).reduce(function(e,t){return e+t})},curve:function(e){return this.curves[e]},bbox:function(){for(var e=this.curves,t=e[0].bbox(),n=1;n<e.length;n++)f.expandbox(t,e[n].bbox());return t},offset:function(e){var t=[];return this.curves.forEach(function(n){t=t.concat(n.offset(e))}),new g(t)}};var m=function(t){var n=t&&t.forEach?t:arguments;if("object"==typeof n[0]){n=[];for(var i=0;i<t.length;i++)["x","y","z"].forEach(function(e){"undefined"!=typeof t[i][e]&&n.push(t[i][e])})}var r=n.length;if(6!==r&&8!==r&&9!==r&&12!==r)throw console.log(t),new Error("This Bezier curve library only supports quadratic and cubic curves (in 2d and 3d)");var o=9===r||12===r;this._3d=o;for(var s=[],a=0,u=o?3:2;r>a;a+=u){var l={x:n[a],y:n[a+1]};o&&(l.z=n[a+2]),s.push(l)}this.order=s.length-1,this.points=s;var c=["x","y"];o&&c.push("z"),this.dims=c,this.dimlen=c.length,function(t){for(var n=f.align(s,{p1:s[0],p2:s[t.order]}),i=0;i<n.length;i++)if(e(n[i].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()};return m.fromSVG=function(e){var t=e.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat),n=/[cq]/.test(e);return n?(t=t.map(function(e,n){return 2>n?e:e+t[n%2]}),new m(t)):new m(t)},m.utils=f,m.prototype={valueOf:function(){return this.toString()},toString:function(){return f.pointsToString(this.points)},toSVG:function(e){if(this._3d)return!1;for(var t=this.points,n=t[0].x,i=t[0].y,r=["M",n,i,2===this.order?"Q":"C"],o=1,s=t.length;s>o;o++)r.push(t[o].x),r.push(t[o].y);return r.join(" ")},update:function(){this.dpoints=[];for(var e=this.points,t=e.length,n=t-1;t>1;t--,n--){for(var i,r=[],o=0;n>o;o++)i={x:n*(e[o+1].x-e[o].x),y:n*(e[o+1].y-e[o].y)},this._3d&&(i.z=n*(e[o+1].z-e[o].z)),r.push(i);this.dpoints.push(r),e=r}this.computedirection()},computedirection:function(){var e=this.points,t=f.angle(e[0],e[this.order],e[1]);this.clockwise=t>0},length:function(){return f.length(this.derivative.bind(this))},getLUT:function(e){e=e||100;for(var t=[],n=0;e>=n;n++)t.push(this.compute(n/e));return t},get:function(e){return this.compute(e)},point:function(e){return this.points[e]},compute:function(e){if(0===e)return this.points[0];if(1===e)return this.points[this.order];var t,n,i,r=1-e,o=r*r,s=e*e,a=0,u=this.points;2===this.order&&(u=[u[0],u[1],u[2],p],t=o,n=r*e*2,i=s),3===this.order&&(t=o*r,n=o*e*3,i=r*s*3,a=e*s);var l={x:t*u[0].x+n*u[1].x+i*u[2].x+a*u[3].x,y:t*u[0].y+n*u[1].y+i*u[2].y+a*u[3].y};return this._3d&&(l.z=t*u[0].z+n*u[1].z+i*u[2].z+a*u[3].z),l},raise:function(){for(var e,t,n,i=this.points,r=[i[0]],o=i.length,e=1;o>e;e++)t=i[e],n=i[e-1],r[e]={x:(o-e)/o*t.x+e/o*n.x,y:(o-e)/o*t.y+e/o*n.y};return r[o]=i[o-1],new m(r)},derivative:function(e){var t,n,i=1-e,r=0,o=this.dpoints[0];2===this.order&&(o=[o[0],o[1],p],t=i,n=e),3===this.order&&(t=i*i,n=i*e*2,r=e*e);var s={x:t*o[0].x+n*o[1].x+r*o[2].x,y:t*o[0].y+n*o[1].y+r*o[2].y};return this._3d&&(s.z=t*o[0].z+n*o[1].z+r*o[2].z),s},normal:function(e){return this._3d?this.__normal3(e):this.__normal2(e)},__normal2:function(e){var t=this.derivative(e),n=u(t.x*t.x+t.y*t.y);return{x:-t.y/n,y:t.x/n}},__normal3:function(){var e=this.derivative(t),n=this.derivative(t+.01),i=u(e.x*e.x+e.y*e.y+e.z*e.z),r=u(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=i,e.y/=i,e.z/=i,n.x/=r,n.y/=r,n.z/=r;var o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},s=u(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;var a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z],l={x:a[0]*e.x+a[1]*e.y+a[2]*e.z,y:a[3]*e.x+a[4]*e.y+a[5]*e.z,z:a[6]*e.x+a[7]*e.y+a[8]*e.z};return l},split:function(e,t){if(0===e&&t)return this.split(t).left;if(1===t)return this.split(e).right;var n,i=this.points,r=[],o=[],s=0,a=0,u=0;for(o[s++]=i[0],o[s++]=i[1],o[s++]=i[2],3===this.order&&(o[s++]=i[3]);i.length>1;){for(r=[],a=0,u=i.length-1;u>a;a++)n=f.lerp(e,i[a],i[a+1]),o[s++]=n,r.push(n);i=r}var l={left:new m(2===this.order?[o[0],o[3],o[5]]:[o[0],o[4],o[7],o[9]]),right:new m(2===this.order?[o[5],o[4],o[2]]:[o[9],o[8],o[6],o[3]]),span:o};if(l.left._t1=f.map(0,0,1,this._t1,this._t2),l.left._t2=f.map(e,0,1,this._t1,this._t2),l.right._t1=f.map(e,0,1,this._t1,this._t2),l.right._t2=f.map(1,0,1,this._t1,this._t2),!t)return l;t=f.map(t,e,1,0,1);var c=l.right.split(t);return c.left},inflections:function(){var e,t,n=this.dims,i=(this.dimlen,{}),r=[];return n.forEach(function(n){t=function(e){return e[n]},e=this.dpoints[0].map(t),i[n]=f.droots(e),3===this.order&&(e=this.dpoints[1].map(t),i[n]=i[n].concat(f.droots(e))),i[n]=i[n].filter(function(e){return e>=0&&1>=e}),r=r.concat(i[n].sort())}.bind(this)),r.sort(),i.values=r,i},bbox:function(){var e=this.inflections(),t={};return this.dims.forEach(function(n){t[n]=f.getminmax(this,n,e[n])}.bind(this)),t},overlaps:function(e){var t=this.bbox(),n=e.bbox();return f.bboxoverlap(t,n)},offset:function(e,t){if("undefined"!=typeof t){var n=this.get(e),i=this.normal(e),r={c:n,n:i,x:n.x+i.x*t,y:n.y+i.y*t};return this._3d&&(r.z=n.z+i.z*t),r}if(this._linear){var o=this.normal(0),s=this.points.map(function(t){var n={x:t.x+e*o.x,y:t.y+e*o.y};return t.z&&i.z&&(n.z=t.z+e*o.z),n});return[new m(s)]}var a=this.reduce();return a.map(function(t){return t.scale(e)})},simple:function(){if(3===this.order){var t=f.angle(this.points[0],this.points[3],this.points[1]),n=f.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&0>n||0>t&&n>0)return!1}var i=this.normal(0),r=this.normal(1),o=i.x*r.x+i.y*r.y;this._3d&&(o+=i.z*r.z);var a=e(s(o));return c/3>a},reduce:function(){var t,n,i=0,r=0,o=.01,s=[],a=[],u=this.inflections().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),i=u[0],t=1;t<u.length;t++)r=u[t],n=this.split(i,r),n._t1=i,n._t2=r,s.push(n),i=r;return s.forEach(function(t){for(i=0,r=0;1>=r;)for(r=i+o;1+o>=r;r+=o)if(n=t.split(i,r),!n.simple()){if(r-=o,e(i-r)<o)return[];n=t.split(i,r),n._t1=f.map(i,0,1,t._t1,t._t2),n._t2=f.map(r,0,1,t._t1,t._t2),a.push(n),i=r;break}1>i&&(n=t.split(i,1),n._t1=f.map(i,0,1,t._t1,t._t2),n._t2=t._t2,a.push(n))}),a},scale:function(e){var t=this.order,n=!1;if("function"==typeof e&&(n=e),n&&2===t)return this.raise().scale(n);var i=this.clockwise,r=n?n(0):e,o=n?n(1):e,s=[this.offset(0,10),this.offset(1,10)],a=f.lli4(s[0],s[0].c,s[1],s[1].c);if(!a)throw"cannot scale this curve. Try reducing it first.";var l=this.points,c=[];return[0,1].forEach(function(e){var n=c[e*t]=f.copy(l[e*t]);n.x+=(e?o:r)*s[e].n.x,n.y+=(e?o:r)*s[e].n.y}.bind(this)),n?([0,1].forEach(function(r){if(2!==this.order||!r){var o=l[r+1],s={x:o.x-a.x,y:o.y-a.y},h=n?n((r+1)/t):e;n&&!i&&(h=-h);var d=u(s.x*s.x+s.y*s.y);s.x/=d,s.y/=d,c[r+1]={x:o.x+h*s.x,y:o.y+h*s.y}}}.bind(this)),new m(c)):([0,1].forEach(function(e){if(2!==this.order||!e){var n=c[e*t],i=this.derivative(e),r={x:n.x+i.x,y:n.y+i.y};c[e+1]=f.lli4(n,r,a,l[e+1])}}.bind(this)),new m(c))},outline:function(e,t,n,i){function r(e,t,n,i,r){return function(o){var s=i/n,a=(i+r)/n,u=t-e;return f.map(o,0,1,e+s*u,e+a*u)}}t="undefined"==typeof t?e:t;var o,s=this.reduce(),a=s.length,u=(this.order,[]),l=[],c=0,h=this.length(),d="undefined"!=typeof n&&"undefined"!=typeof i;s.forEach(function(o){_=o.length(),d?(u.push(o.scale(r(e,n,h,c,_))),l.push(o.scale(r(-t,-i,h,c,_)))):(u.push(o.scale(e)),l.push(o.scale(-t))),c+=_}),l=l.map(function(e){return o=e.points,o[3]?e.points=[o[3],o[2],o[1],o[0]]:e.points=[o[2],o[1],o[0]],e}).reverse();var p=u[0].points[0],m=u[a-1].points[u[a-1].points.length-1],y=l[a-1].points[l[a-1].points.length-1],b=l[0].points[0],w=f.makeline(y,p),v=f.makeline(m,b),x=[w].concat(u).concat([v]).concat(l),_=x.length;return new g(x)},outlineshapes:function(e,t){t=t||e;for(var n=this.outline(e,t).curves,i=[],r=1,o=n.length;o/2>r;r++){var s=f.makeshape(n[r],n[o-r]);s.startcap.virtual=r>1,s.endcap.virtual=o/2-1>r,i.push(s)}return i},intersects:function(e){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof m&&(e=e.reduce()),this.curveintersects(this.reduce(),e)):this.selfintersects()},lineIntersects:function(e){var t=n(e.p1.x,e.p2.x),r=n(e.p1.y,e.p2.y),o=i(e.p1.x,e.p2.x),s=i(e.p1.y,e.p2.y),a=this;return f.roots(this.points,e).filter(function(e){var n=a.get(e);return t<=n.x&&n.x<=o&&r<=n.y&&n.y<=s})},selfintersects:function(){var e,t,n,i,r=this.reduce(),o=r.length-2,s=[];for(e=0;o>e;e++)n=r.slice(e,e+1),i=r.slice(e+2),t=this.curveintersects(n,i),s=s.concat(t);return s},curveintersects:function(e,t){var n=[];e.forEach(function(e){t.forEach(function(t){e.overlaps(t)&&n.push({left:e,right:t})})});var i=[];return n.forEach(function(e){var t=f.pairiteration(e.left,e.right);t.length>0&&(i=i.concat(t))}),i},arcs:function(e){e=e||.5;var t=[];return this._iterate(e,t)},_error:function(t,n,i,r){var o=(r-i)/4,s=this.get(i+o),a=this.get(r-o),u=f.dist(t,n),l=f.dist(t,s),c=f.dist(t,a);return e(l-u)+e(c-u)},_iterate:function(e,t){var n,i=0,r=1;do{n=0,r=1;var o,s,a,u,l,c=this.get(i),h=!1,d=!1,p=r,g=1,m=0;do{d=h,u=a,p=(i+r)/2,m++,o=this.get(p),s=this.get(r),a=f.getccenter(c,o,s);var y=this._error(a,c,i,r);if(h=e>=y,l=d&&!h,l||(g=r),h){if(r>=1){g=1,u=a;break}r+=(r-i)/2}else r=p}while(!l&&n++<100);if(n>=100){console.error("arc abstraction somehow failed...");break}u=u?u:a,t.push(u),i=g}while(1>r);return t}},m}),define("lib/earcut/src/earcut.js",[],function(){function e(e,r,o){o=o||2;var s=r&&r.length,u=s?r[0]*o:e.length,l=n(e,t(e,0,u,o,!0)),c=[];if(!l)return c;var h,d,p,f,g,m,y;if(s&&(l=a(e,r,l,o)),e.length>80*o){h=p=e[0],d=f=e[1];for(var b=o;u>b;b+=o)g=e[b],m=e[b+1],h>g&&(h=g),d>m&&(d=m),g>p&&(p=g),m>f&&(f=m);y=Math.max(p-h,f-d)}return i(e,l,c,o,h,d,y),c}function t(e,t,n,i,r){var o,s,a,u=0;for(o=t,s=n-i;n>o;o+=i)u+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;if(r===u>0)for(o=t;n>o;o+=i)a=_(o,a);else for(o=n-i;o>=t;o-=i)a=_(o,a);return a}function n(e,t,n){n||(n=t);var i,r=t;do if(i=!1,r.steiner||!m(e,r.i,r.next.i)&&0!==g(e,r.prev.i,r.i,r.next.i))r=r.next;else{if(r.prev.next=r.next,r.next.prev=r.prev,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ),r=n=r.prev,r===r.next)return null;i=!0}while(i||r!==n);return n}function i(e,t,a,u,l,h,d,p){if(t){p||void 0===l||c(e,t,l,h,d);for(var f,g,m=t;t.prev!==t.next;)if(f=t.prev,g=t.next,r(e,t,l,h,d))a.push(f.i/u),a.push(t.i/u),a.push(g.i/u),g.prev=f,f.next=g,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ),t=g.next,m=g.next;else if(t=g,t===m){p?1===p?(t=o(e,t,a,u),i(e,t,a,u,l,h,d,2)):2===p&&s(e,t,a,u,l,h,d):i(e,n(e,t),a,u,l,h,d,1);break}}}function r(e,t,n,i,r){var o=t.prev.i,s=t.i,a=t.next.i,u=e[o],l=e[o+1],c=e[s],h=e[s+1],p=e[a],f=e[a+1],g=u*h-l*c,m=u*f-l*p,y=p*h-f*c,b=g-m-y;if(0>=b)return!1;var w,v,x,_,C,S,T,F=f-l,O=u-p,N=l-h,V=c-u;if(void 0!==n){var D=c>u?p>u?u:p:p>c?c:p,M=h>l?f>l?l:f:f>h?h:f,B=u>c?u>p?u:p:c>p?c:p,E=l>h?l>f?l:f:h>f?h:f,I=d(D,M,n,i,r),A=d(B,E,n,i,r);for(T=t.nextZ;T&&T.z<=A;)if(w=T.i,T=T.nextZ,w!==o&&w!==a&&(v=e[w],x=e[w+1],_=F*v+O*x-m,_>=0&&(C=N*v+V*x+g,C>=0&&(S=b-_-C,S>=0&&(_&&C||_&&S||C&&S)))))return!1;for(T=t.prevZ;T&&T.z>=I;)if(w=T.i,T=T.prevZ,w!==o&&w!==a&&(v=e[w],x=e[w+1],_=F*v+O*x-m,_>=0&&(C=N*v+V*x+g,C>=0&&(S=b-_-C,S>=0&&(_&&C||_&&S||C&&S)))))return!1}else for(T=t.next.next;T!==t.prev;)if(w=T.i,T=T.next,v=e[w],x=e[w+1],_=F*v+O*x-m,_>=0&&(C=N*v+V*x+g,C>=0&&(S=b-_-C,S>=0&&(_&&C||_&&S||C&&S))))return!1;return!0}function o(e,t,n,i){var r=t;do{var o=r.prev,s=r.next.next;if(o.i!==s.i&&y(e,o.i,r.i,r.next.i,s.i)&&w(e,o,s)&&w(e,s,o)){n.push(o.i/i),n.push(r.i/i),n.push(s.i/i),o.next=s,s.prev=o;var a=r.prevZ,u=r.nextZ&&r.nextZ.nextZ;a&&(a.nextZ=u),u&&(u.prevZ=a),r=t=s}r=r.next}while(r!==t);return r}function s(e,t,r,o,s,a,u){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&f(e,l,c)){var h=x(l,c);return l=n(e,l,l.next),h=n(e,h,h.next),i(e,l,r,o,s,a,u),void i(e,h,r,o,s,a,u)}c=c.next}l=l.next}while(l!==t)}function a(e,i,r,o){var s,a,l,c,h,d=[];for(s=0,a=i.length;a>s;s++)l=i[s]*o,c=a-1>s?i[s+1]*o:e.length,h=t(e,l,c,o,!1),h===h.next&&(h.steiner=!0),h=n(e,h),h&&d.push(p(e,h));for(d.sort(function(t,n){return e[t.i]-e[n.i]}),s=0;s<d.length;s++)u(e,d[s],r),r=n(e,r,r.next);return r}function u(e,t,i){if(i=l(e,t,i)){var r=x(i,t);n(e,r,r.next)}}function l(e,t,n){var i,r,o,s=n,a=t.i,u=e[a],l=e[a+1],c=-(1/0);do{if(r=s.i,o=s.next.i,l<=e[r+1]&&l>=e[o+1]){var h=e[r]+(l-e[r+1])*(e[o]-e[r])/(e[o+1]-e[r+1]);u>=h&&h>c&&(c=h,i=e[r]<e[o]?s:s.next)}s=s.next}while(s!==n);if(!i)return null;var d,p,f,g,m,y,b=e[i.i],v=e[i.i+1],x=u*v-l*b,_=u*l-l*c,C=l-l,S=u-c,T=l-v,F=b-u,O=x-_-(c*v-l*b),N=0>=O?-1:1,V=i,D=1/0;for(s=i.next;s!==V;)d=e[s.i],p=e[s.i+1],f=u-d,f>=0&&d>=b&&(g=(C*d+S*p-_)*N,g>=0&&(m=(T*d+F*p+x)*N,m>=0&&O*N-g-m>=0&&(y=Math.abs(l-p)/f,D>y&&w(e,s,t)&&(i=s,D=y)))),s=s.next;return i}function c(e,t,n,i,r){var o=t;do null===o.z&&(o.z=d(e[o.i],e[o.i+1],n,i,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,h(o)}function h(e){var t,n,i,r,o,s,a,u,l=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,i=n,a=0,t=0;l>t&&(a++,i=i.nextZ,i);t++);for(u=l;a>0||u>0&&i;)0===a?(r=i,i=i.nextZ,u--):0!==u&&i?n.z<=i.z?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--):(r=n,n=n.nextZ,a--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(s>1);return e}function d(e,t,n,i,r){return e=1e3*(e-n)/r,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=1e3*(t-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function p(e,t){var n=t,i=t;do e[n.i]<e[i.i]&&(i=n),n=n.next;while(n!==t);return i}function f(e,t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!b(e,t,t.i,n.i)&&w(e,t,n)&&w(e,n,t)&&v(e,t,t.i,n.i)}function g(e,t,n,i){var r=(e[n+1]-e[t+1])*(e[i]-e[n])-(e[n]-e[t])*(e[i+1]-e[n+1]);return r>0?1:0>r?-1:0}function m(e,t,n){return e[t]===e[n]&&e[t+1]===e[n+1]}function y(e,t,n,i,r){return g(e,t,n,i)!==g(e,t,n,r)&&g(e,i,r,t)!==g(e,i,r,n)}function b(e,t,n,i){var r=t;do{var o=r.i,s=r.next.i;if(o!==n&&s!==n&&o!==i&&s!==i&&y(e,o,s,n,i))return!0;r=r.next}while(r!==t);return!1}function w(e,t,n){return-1===g(e,t.prev.i,t.i,t.next.i)?-1!==g(e,t.i,n.i,t.next.i)&&-1!==g(e,t.i,t.prev.i,n.i):-1===g(e,t.i,n.i,t.prev.i)||-1===g(e,t.i,t.next.i,n.i)}function v(e,t,n,i){var r=t,o=!1,s=(e[n]+e[i])/2,a=(e[n+1]+e[i+1])/2;do{var u=r.i,l=r.next.i;e[u+1]>a!=e[l+1]>a&&s<(e[l]-e[u])*(a-e[u+1])/(e[l+1]-e[u+1])+e[u]&&(o=!o),r=r.next}while(r!==t);return o}function x(e,t){var n=new C(e.i),i=new C(t.i),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function _(e,t){var n=new C(e);return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function C(e){this.i=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return e}),define("cobweb/Components/Text/FontStyle",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Text/X3DFontStyleNode","cobweb/Bits/X3DConstants","cobweb/Browser/Core/PrimitiveQuality","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Geometry/Triangle2","standard/Math/Algorithm","lib/bezierjs/bezier.js","lib/poly2tri.js/dist/poly2tri.js","lib/earcut/src/earcut.js"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g){function m(e,t){this.text=e,this.fontStyle=t,this.glyphs=[],this.minorAlignment=new l(0,0),this.translations=[],this.charSpacings=[],this.bearing=new l(0,0),this.bbox=new u}function y(e,t){m.call(this,e,t),this.texCoords=[]}function b(e){r.call(this,e.getBrowser(),e),this.addType(o.FontStyle)}var w={},v=new a,x=new l(0,0),_=new l(0,0),C=new l(0,0),S=new l(0,0),T=new c(0,0,0),F=new c(0,0,0),O=new l(0,0),N=new l(0,0),V=new l(0,0),D=new c(0,0,0),M=new a,B=new l(0,0),E=new c(0,0,0),I=1;m.prototype={constructor:m,getBrowser:function(){return this.text.getBrowser()},getText:function(){return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var e=this.text,t=this.fontStyle,n=e.string_.length;return e.lineBounds_.length=n,this.glyphs.length=0,this.resizeArray(this.translations,n),this.resizeArray(this.charSpacings,n),0!==n&&t.getFont()?void(t.horizontal_.getValue()?this.horizontal(e,t):this.horizontal(e,t)):(e.origin_.setValue(E),e.textBounds_.setValue(B),void this.bbox.set())},resizeArray:function(e,t){for(var n=e.length;t>n;++n)e.push(new l(0,0));e.length=t},horizontal:function(e,t){var n=e.string_.getValue(),i=n.length,o=t.topToBottom_.getValue(),s=t.spacing_.getValue(),a=t.getScale();v.set();for(var u=o?0:i-1,l=o?i:-1,c=o?1:-1,h=u;h!==l;h+=c){var d=n[h],p=this.getLineExtents(t,d,x,_,h);O.assign(_).subtract(x);var f=o?h:i-h-1,g=0,m=e.getLength(h);switch(V.set(O.x,0==f?O.y:s).multiply(a),e.maxExtent_.getValue()&&(m=m?Math.min(e.maxExtent_.getValue(),m):Math.min(e.maxExtent_.getValue(),O.x*a)),m&&(g=(m-V.x)/(p.length-1),V.x=m,O.x=m/a),this.charSpacings[h]=g,e.lineBounds_[h]=V,t.getMajorAlignment()){case r.Alignment.BEGIN:case r.Alignment.FIRST:this.translations[h].set(0,-(h*s));break;case r.Alignment.MIDDLE:this.translations[h].set(-x.x-O.x/2,-(h*s));break;case r.Alignment.END:this.translations[h].set(-x.x-O.x,-(h*s))}N.assign(x).add(O).divide(2),v.add(M.set(O.multiply(a),N.add(this.translations[h]).multiply(a))),this.translations[h].multiply(a)}switch(v.getExtents(x,_),O.assign(_).subtract(x),e.textBounds_=O,this.bearing.set(0,-_.y),t.getMinorAlignment()){case r.Alignment.BEGIN:this.minorAlignment.assign(this.bearing);break;case r.Alignment.FIRST:this.minorAlignment.set(0,0);break;case r.Alignment.MIDDLE:this.minorAlignment.set(0,O.y/2-_.y);break;case r.Alignment.END:this.minorAlignment.set(0,(i-1)*s*a)}x.add(this.minorAlignment),_.add(this.minorAlignment),e.origin_.setValue(D.set(x.x,_.y,0)),this.bbox.set(T.set(x.x,x.y,0),F.set(_.x,_.y,0),!0)},vertical:function(e,t){},stringToGlyphs:function(e,t,n,i){t=t.getValue();var r=w[e.fontName],o=this.glyphs[i];r||(r=w[e.fontName]=[]),o||(o=this.glyphs[i]=[]),o.length=t.length;for(var s=n?0:t.length-1,a=n?t.length:-1,u=n?1:-1,l=s,c=0;l!==a;l+=u,++c){var h=t.charCodeAt(l),d=null;(d=r[h])||(d=e.stringToGlyphs(t[l])[0],r[h]=d,d.extents={}),o[c]=d}return o},getLineExtents:function(e,t,n,i,o){for(var s=e.getFont(),a=e.horizontal_.getValue()?e.leftToRight_.getValue():e.topToBottom_.getValue(),u=this.stringToGlyphs(s,t,a,o),l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),c=0,h=0,d=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,f=0,g=u.length;g>f;++f){var m=u[f],y=g>f+1?s.getKerningValue(m,u[f+1]):0;this.getGlyphExtents(m,l,C,S),h+=m.advanceWidth+y,d=Math.min(d,C.y),p=Math.max(p,S.y)}switch(u.length?(this.getGlyphExtents(u[0],l,C,S),c=C.x):(d=0,p=0),n.set(c,d),i.set(h/s.unitsPerEm,p),e.getMajorAlignment()){case r.Alignment.BEGIN:case r.Alignment.FIRST:n.x=0;break;case r.Alignment.MIDDLE:case r.Alignment.END:}return u}};var x=new c(0,0,0),_=new c(0,0,0);return y.prototype=e.extend(Object.create(m.prototype),{constructor:y,build:function(){var e=this.getFontStyle(),t=this.getGlyphs(),n=this.getMinorAlignment(),i=this.getTranslations(),r=this.getCharSpacings();if(e.getFont()&&(this.texCoords.length=0,this.getText().getTexCoords().push(this.texCoords),this.getBBox().getExtents(x,_),this.getText().getMin().assign(x),this.getText().getMax().assign(_),e.horizontal_.getValue()))for(var o=e.getScale(),s=0,a=t.length;a>s;++s)this.render(t[s],n,o,i[s],r[s])},render:function(e,t,n,i,r){for(var o=this.getText(),s=this.getFontStyle(),a=s.getFont(),u=0,l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),c=n/I,h=n/a.unitsPerEm,d=this.texCoords,p=o.getNormals(),f=o.getVertices(),g=0,m=e.length;m>g;++g){for(var y=e[g],b=this.getGlyphGeometry(y,l),w=0,v=b.length;v>w;++w){var x=b[w].x*c+t.x+g*r+i.x+u,_=b[w].y*c+t.y+i.y;p.push(0,0,1),f.push(x,_,0,1),d.push(x/c,_/c,0,1)}var C=0;g+1<e.length&&(C=a.getKerningValue(y,e[g+1])),u+=(y.advanceWidth+C)*h}},getGlyphExtents:function(e,t,n,i){var r=e.extents[t];if(r)return n.assign(r.min),void i.assign(r.max);var o=this.getGlyphGeometry(e,t);if(o.length){var s=o[0];n.assign(s),i.assign(s);for(var a=1,u=o.length;u>a;++a){var s=o[a];n.min(s),i.max(s)}}else n.set(0,0,0),i.set(0,0,0);var r=e.extents[t]={};r.min=n.copy(),r.max=i.copy()},getGlyphGeometry:function(e,t){var n=this.getFontStyle(),i=n.getFont(),r=this.getBrowser().getFontGeometryCache(),o=r[i.fontName];o||(r[i.fontName]=o=[[],[],[]]);var s=o[t][e.index];return s?s:(s=o[t][e.index]=[],this.createGlyphGeometry(e,s,t),s)},createGlyphGeometry:function(e,t,n){var i=this.getFontStyle(),r=i.getFont(),o=[],s=[],a=[],u=this.getBezierDimension(n),l="cff"===r.outlinesFormat;
if(o.length=0,s.length=0,a.length=0,e.isComposite)for(var c=0;c<e.components.length;++c){var h=e.components[c];o.push(r.glyphs.get(h.glyphIndex).getPath(h.dx/r.unitsPerEm,h.dy/-r.unitsPerEm,I))}else o.push(e.getPath(0,0,I));for(var d=0,f=0,g=0;g<o.length;++g)for(var m=o[g],y=0;y<m.commands.length;++y){var b=m.commands[y];switch(b.type){case"M":case"Z":s.length>2&&(s[0].x===s[s.length-1].x&&s[0].y===s[s.length-1].y&&s.pop(),a.push(l?s.reverse().slice():s.slice())),s.length=0,"M"===b.type&&s.push({x:b.x,y:-b.y});break;case"L":s.push({x:b.x,y:-b.y});break;case"C":for(var w=new p(d,-f,b.x1,-b.y1,b.x2,-b.y2,b.x,-b.y),v=w.getLUT(u),x=1;x<v.length;++x)s.push(v[x]);break;case"Q":for(var w=new p(d,-f,b.x1,-b.y1,b.x,-b.y),v=w.getLUT(u),x=1;x<v.length;++x)s.push(v[x]);break;default:continue}d=b.x,f=b.y}var _=[],C=[];switch(a.length){case 0:break;case 1:_=a;break;default:for(var y=0;y<a.length;++y){var w=a[y],S=this.getCurveOrientation(w);0>S?_.push(w):C.push(w)}}switch(_.map(this.removeCollinearPoints),C.map(this.removeCollinearPoints),_.length){case 0:break;case 1:_[0].holes=C;break;default:for(var c=0;c<_.length;++c)_[c].holes=[];for(var T=0;T<C.length;++T)for(var F=C[T],c=0;c<_.length;++c){var O=_[c];if(this.isPointInPolygon(O.slice(),F[0])){O.holes.push(F);break}}}for(var y=0;y<_.length;++y)this.triangulate(_[y],_[y].holes,t)},getBezierDimension:function(e){switch(e){case s.LOW:return 2;case s.HIGH:return 5;default:return 3}},getCurveOrientation:function(e){for(var t=Number.POSITIVE_INFINITY,n=0,i=0,r=e.length;r>i;++i)e[i].x<t&&(t=e[i].x,n=i);var o=e[(n+r-1)%r],s=e[n],a=e[(n+2)%r];return(s.x-o.x)*(a.y-o.y)-(a.x-o.x)*(s.y-o.y)},isPointInPolygon:function(e,t){try{for(var n=new f.SweepContext(e),i=n.triangulate().getTriangles(),r=0;r<i.length;++r){var o=i[r].getPoint(0),s=i[r].getPoint(1),a=i[r].getPoint(2);if(h.isPointInTriangle(o,s,a,t))return!0}return!1}catch(u){}},removeCollinearPoints:function(e){function t(e,t,n){return Math.abs((e.y-t.y)*(e.x-n.x)-(e.y-n.y)*(e.x-t.x))<1e-8}for(var n=0,i=0;n<e.length;++n){var r=(n-1+e.length)%e.length,o=(n+1)%e.length;t(e[r],e[n],e[o])||(e[i++]=e[n])}e.length=i},triangulate:function(e,t,n){try{for(var i=new f.SweepContext(e).addHoles(t),r=i.triangulate().getTriangles(),o=0;o<r.length;++o)n.push(r[o].getPoint(0)),n.push(r[o].getPoint(1)),n.push(r[o].getPoint(2))}catch(s){this.earcutTriangulate(e,t,n)}},earcutTriangulate:function(e,t,n){try{for(var i=[],r=[],o=0;o<e.length;++o)i.push(e[o].x,e[o].y);for(var s=0;s<t.length;++s)for(var a=t[s],o=0;o<a.length;++o)r.push(i.length/2),i.push(a[o].x,a[o].y),e.push(a[o]);for(var u=g(i,r),l=0;l<u.length;++l)n.push(e[u[l]])}catch(c){}},draw:function(){}}),b.prototype=e.extend(Object.create(r.prototype),{constructor:b,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"language",new t.SFString),new n(o.initializeOnly,"family",new t.MFString("SERIF")),new n(o.initializeOnly,"style",new t.SFString("PLAIN")),new n(o.initializeOnly,"size",new t.SFFloat(1)),new n(o.initializeOnly,"spacing",new t.SFFloat(1)),new n(o.initializeOnly,"horizontal",new t.SFBool(!0)),new n(o.initializeOnly,"leftToRight",new t.SFBool(!0)),new n(o.initializeOnly,"topToBottom",new t.SFBool(!0)),new n(o.initializeOnly,"justify",new t.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(e){return new y(e,this)},getScale:function(){return this.size_.getValue()}}),b}),define("cobweb/Browser/Text/X3DTextContext",["cobweb/Components/Text/FontStyle"],function(e){function t(){this.fontGeometryCache={}}return t.prototype={initialize:function(){this.getBrowser().shutdown().addInterest(this,"set_shutdown_TextContext")},getDefaultFontStyle:function(){return this.defaultFontStyle||(this.defaultFontStyle=new e(this.getPrivateScene()),this.defaultFontStyle.setup()),this.defaultFontStyle},getFontGeometryCache:function(){return this.fontGeometryCache},set_shutdown_TextContext:function(){this.fontGeometryCache={}}},t}),define("cobweb/Components/Texturing/X3DTextureTransformNode",["jquery","cobweb/Components/Shape/X3DAppearanceChildNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,n,i){function r(e,r){t.call(this,e,r),this.addType(n.X3DTextureTransformNode),this.matrix=new i,this.matrixArray=new Float32Array(this.matrix)}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,setMatrix:function(e){this.matrixArray.set(e)},getMatrix:function(){return this.matrix},getMatrixArray:function(){return this.matrixArray},traverse:function(){this.getBrowser().getTextureTransform()[0]=this}}),r}),define("cobweb/Components/Texturing/TextureTransform",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureTransformNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureTransform),this.matrix3=new a}var c=new s(0,0);return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"translation",new t.SFVec2f),new n(o.inputOutput,"rotation",new t.SFFloat),new n(o.inputOutput,"scale",new t.SFVec2f(1,1)),new n(o.inputOutput,"center",new t.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){r.prototype.initialize.call(this),this.addInterest(this,"eventsProcessed"),this.eventsProcessed()},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var e=this.translation_.getValue(),t=this.rotation_.getValue(),n=this.scale_.getValue(),i=this.center_.getValue(),o=this.matrix3;o.identity(),i.equals(s.Zero)||o.translate(c.assign(i).negate()),n.equals(s.One)||o.scale(n),0!==t&&o.rotate(t),i.equals(s.Zero)||o.translate(i),e.equals(s.Zero)||o.translate(e);var a=this.getMatrix();a[0]=o[0],a[1]=o[1],a[4]=o[3],a[5]=o[4],a[12]=o[6],a[13]=o[7],this.setMatrix(a)}}),l}),define("cobweb/Browser/Texturing/X3DTexturingContext",["cobweb/Components/Texturing/TextureProperties","cobweb/Components/Texturing/TextureTransform","cobweb/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(e,t,n,i,r){function o(){this.textureUnits=[],this.combinedTextureUnits=[],this.textureStages=1,this.textureTransform=[],this.defaultTextureProperties=new e(this),this.defaultTextureTransform=new t(this),this.defaultTextureCoordinate=new n(this)}return o.prototype={initialize:function(){var e=this.getBrowser().getContext();this.defaultTextureProperties.magnificationFilter_.setValue("NICEST"),this.defaultTextureProperties.minificationFilter_.setValue("AVG_PIXEL_AVG_MIPMAP"),this.defaultTextureProperties.textureCompression_.setValue("NICEST"),this.defaultTextureProperties.generateMipMaps_.setValue(!0),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxCombinedTextureUnits=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);for(var t=this.textureUnits,n=this.combinedTextureUnits,i=this.maxTextureUnits-1;i>=0;--i)t.push(i);for(var i=this.maxTextureUnits,r=this.maxCombinedTextureUnits;r>i;++i)n.push(i);this.defaultTextureProperties.setup(),this.defaultTextureTransform.setup(),this.defaultTextureCoordinate.setup()},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this.maxTextureSize},getMaxTextureUnits:function(){return this.maxTextureUnits},getMaxCombinedTextureUnits:function(){return this.maxCombinedTextureUnits},getTextureUnits:function(){return this.textureUnits},getCombinedTextureUnits:function(){return this.combinedTextureUnits},getTextureTransform:function(){return this.textureTransform},getDefaultTextureProperties:function(){return this.defaultTextureProperties},getDefaultTextureTransform:function(){return this.defaultTextureTransform},getDefaultTextureCoordinate:function(){return this.defaultTextureCoordinate}},o}),define("cobweb/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],function(e){function t(){this.currentPosition=new e(0,0,0)}var n=new e(0,0,0);return t.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this.currentTime},advanceTime:function(e){e+=performance.timing.navigationStart;var t=this.currentTime;if(this.currentTime=e/1e3,this.currentFrameRate=1/(this.currentTime-t),this.getWorld()&&this.getActiveLayer()){var i=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();n.assign(this.currentPosition),this.currentPosition.set(i[12],i[13],i[14]),this.currentSpeed=n.subtract(this.currentPosition).abs()*this.currentFrameRate}else this.currentSpeed=0}},t}),define("cobweb/Rendering/DepthBuffer",[],function(){function e(e,t,n){var i=e.getContext();this.browser=e,this.width=t,this.height=n,this.array=new Uint8Array(t*n*4),this.buffer=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this.buffer),this.depthTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.depthTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,n,0,i.RGBA,i.UNSIGNED_BYTE,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.depthTexture,0),i.bindTexture(i.TEXTURE_2D,null);var r=i.createRenderbuffer();if(i.bindRenderbuffer(i.RENDERBUFFER,r),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,n),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,r),i.checkFramebufferStatus(i.FRAMEBUFFER)!==i.FRAMEBUFFER_COMPLETE)throw new Error("Couldn't create frame buffer.");i.bindFramebuffer(i.FRAMEBUFFER,null)}return e.prototype={constructor:e,getDistance:function(e,t,n){var i=this.browser.getContext();i.readPixels(0,0,this.width,this.height,i.RGBA,i.UNSIGNED_BYTE,this.array);for(var r=this.array,o=Number.POSITIVE_INFINITY,s=2/(this.width-1),a=2/(this.height-1),u=n-t,l=0,c=0;l<this.height;++l)for(var h=Math.pow((l*a-1)*e,2),d=0;d<this.width;++d,c+=4){var p=(d*s-1)*e,f=t+u*(r[c]/255+r[c+1]/65025+r[c+2]/16581375);o=Math.min(o,Math.sqrt(p*p+h+f*f))}return o},bind:function(){var e=this.browser.getContext();e.bindFramebuffer(e.FRAMEBUFFER,this.buffer),e.viewport(0,0,this.width,this.height),e.scissor(0,0,this.width,this.height),e.clearColor(1,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},unbind:function(){var e=this.browser.getContext();e.bindFramebuffer(e.FRAMEBUFFER,null)}},e}),define("standard/Math/Algorithms/QuickSort",[],function(){function e(e,t){this.array=e,t&&(this.compare=t)}return e.prototype={compare:function(e,t){return t>e},sort:function(e,t){t-e>1&&this.quicksort(e,t-1)},quicksort:function(e,t){for(var n=e,i=t,r=this.array,o=this.compare,s=r[e+t>>>1];;){for(;o(r[n],s);)++n;for(;o(s,r[i]);)--i;if(!(i>n)){n===i&&(++n,--i);break}var a=r[n];r[n]=r[i],r[i]=a,n++,i--}i>e&&this.quicksort(e,i),t>n&&this.quicksort(n,t)}},e}),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],function(e){function t(e,t){this.radius=e,this.center=t.copy()}var n=new e(0,0,0),i=new e(0,0,0),r=new e(0,0,0),o=new e(0,0,0),s=new e(0,0,0),a=new e(0,0,0),u=new e(0,0,0),l=new e(0,0,0);return t.prototype={constructor:t,set:function(e,t){this.radius=e,this.center.assign(t)},intersectsLine:function(t,i,r){n.assign(this.center).subtract(t.point);var o=e.dot(n,t.direction);if(0>o)return!1;var s=e.dot(n,n)-Math.pow(o,2),a=Math.pow(this.radius,2);if(s>a)return!1;var u=Math.sqrt(a-s),l=o-u,c=o+u;return i.assign(t.direction).multiply(l).add(t.point),r.assign(t.direction).multiply(c).add(t.point),!0},intersectsTriangle:function(t,n,c){var h=this.center,d=this.radius;t.subtract(h),n.subtract(h),c.subtract(h),i.assign(n).subtract(t),r.assign(c).subtract(t);var p=d*d,f=i.cross(r),g=e.dot(t,f),m=e.dot(f,f),y=g*g>p*m;if(y)return!1;var b=e.dot(t,t),w=e.dot(t,n),v=e.dot(t,c),x=e.dot(n,n),_=e.dot(n,c),C=e.dot(c,c),S=b>p&&w>b&&v>b,T=x>p&&w>x&&_>x,F=C>p&&v>C&&_>C;if(S||T||F)return!1;i.assign(n).subtract(t),o.assign(c).subtract(n),s.assign(t).subtract(c);var O=w-b,N=_-x,V=v-C,D=e.dot(i,i),M=e.dot(o,o),B=e.dot(s,s);a.assign(t).multiply(D).subtract(i.multiply(O)),u.assign(n).multiply(M).subtract(o.multiply(N)),l.assign(c).multiply(B).subtract(s.multiply(V));var E=c.multiply(D).subtract(a),I=t.multiply(M).subtract(u),A=n.multiply(B).subtract(l),P=e.dot(a,a)>p*D*D&&e.dot(a,E)>0,L=e.dot(u,u)>p*M*M&&e.dot(u,I)>0,R=e.dot(l,l)>p*B*B&&e.dot(l,A)>0;return P||L||R?!1:!0},toString:function(){return this.radius+" "+this.center.toString()}},t}),define("cobweb/Rendering/X3DRenderer",["jquery","cobweb/Rendering/DepthBuffer","cobweb/Bits/TraverseType","standard/Math/Algorithms/QuickSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Sphere3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l,c){function h(e,t){return e.distance<t.distance}function d(e,n){this.viewVolumes=[],this.clipPlanes=[],this.localLights=[],this.localFogs=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new i(this.transparentShapes,h),this.collisionShapes=[],this.activeCollisions={},this.collisionSphere=new o(0,s.Zero),this.invModelViewMatrix=new l,this.speed=0;try{this.depthBuffer=new t(this.getBrowser(),p,f)}catch(r){console.error(r),this.getDepth=function(){return 0}}}var p=16,f=16,g=new l,m=new l,y=new u(0,0,1,0),b=new s(0,1,0),w=new s(0,0,1),v=new s(0,0,0),x=new u(0,0,1,0);return d.prototype={constructor:d,bboxSize:new s(0,0,0),bboxCenter:new s(0,0,0),translation:new s(0,0,0),initialize:function(){},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes[this.viewVolumes.length-1]},getClipPlanes:function(){return this.clipPlanes},getLocalLights:function(){return this.localLights},setGlobalFog:function(e){this.localFog=this.localFogs[0]=e},pushLocalFog:function(e){this.localFogs.push(e),this.localFog=e},popLocalFog:function(){this.localFogs.pop(),this.localFog=this.localFogs[this.localFogs.length-1]},addShape:function(e){var t=this.getBrowser().getModelViewMatrix().get(),n=t.multDirMatrix(this.bboxSize.assign(e.getBBoxSize())),i=t.multVecMatrix(this.bboxCenter.assign(e.getBBoxCenter())),r=n.abs()/2,o=i.z,s=this.viewVolumes[this.viewVolumes.length-1];if(s.intersectsSphere(r,i)){if(e.isTransparent()){this.numTransparentShapes===this.transparentShapes.length&&this.transparentShapes.push({transparent:!0,modelViewMatrix:new Float32Array(16),scissor:new a(0,0,0,0),clipPlanes:[],localLights:[]});var u=this.transparentShapes[this.numTransparentShapes];++this.numTransparentShapes}else{this.numOpaqueShapes===this.opaqueShapes.length&&this.opaqueShapes.push({transparent:!1,modelViewMatrix:new Float32Array(16),scissor:new a(0,0,0,0),clipPlanes:[],localLights:[]});var u=this.opaqueShapes[this.numOpaqueShapes];++this.numOpaqueShapes}u.modelViewMatrix.set(t),u.shapeNode=e,u.scissor.assign(s.getScissor()),u.distance=o-r,u.fogNode=this.localFog;for(var l=this.getClipPlanes(),c=u.clipPlanes,h=0,d=l.length;d>h;++h)c[h]=l[h];c.length=l.length;for(var p=this.getLocalLights(),f=u.localLights,h=0,d=p.length;d>h;++h)f[h]=p[h];f.length=p.length}},addCollision:function(e){var t=this.getBrowser().getModelViewMatrix().get(),n=this.viewVolumes[this.viewVolumes.length-1];this.numCollisionShapes===this.collisionShapes.length&&this.collisionShapes.push({modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});var i=this.collisionShapes[this.numCollisionShapes];++this.numCollisionShapes,i.modelViewMatrix.set(t),i.shapeNode=e,i.scissor=n.getScissor();for(var r=this.getBrowser().getCollisions(),o=i.collisions,s=0,a=r.length;a>s;++s)o[s]=r[s];o.length=r.length;for(var u=this.getClipPlanes(),l=i.clipPlanes,s=0,a=u.length;a>s;++s)l[s]=u[s];l.length=u.length},constrainTranslation:function(e){var t=performance.now(),n=this.getNavigationInfo(),i=this.getDistance(e),r=n.getFarPlane(this.getViewpoint());if(r-i>0){var o=n.getCollisionRadius();if(i-=o,i>0){var s=e.abs();return s>i?e.normalize().multiply(i):e}return e.normalize().multiply(i)}return this.collisionTime+=performance.now()-t,e},getDistance:function(e){try{var t=this.getViewpoint(),n=this.getNavigationInfo(),i=n.getCollisionRadius(),o=n.getStepHeight()-n.getAvatarHeight(),s=n.getNearPlane(),a=n.getFarPlane(t);return r.ortho(-i,i,Math.min(o,-i),i,s,a,g),y.assign(t.orientation_.getValue()).inverse().multRight(t.getOrientation()),x.setFromToVec(w,v.assign(e).negate()).multRight(y),m.assign(t.getTransformationMatrix()),m.translate(t.getUserPosition()),m.rotate(x),m.inverse(),this.getBrowser().setProjectionMatrix(m.multRight(g)),this.getDepth()}catch(u){console.log(u)}},getDepth:function(){var e=this.getBrowser(),t=e.getContext(),n=e.getDepthShader(),i=this.collisionShapes;n.use(),t.uniformMatrix4fv(n.projectionMatrix,!1,e.getProjectionMatrixArray()),this.depthBuffer.bind(),t.enable(t.DEPTH_TEST),t.depthMask(!0),t.disable(t.BLEND),t.disable(t.CULL_FACE);for(var r=0,o=this.numCollisionShapes;o>r;++r){var s=i[r],a=s.scissor,u=s.clipPlanes;if(t.scissor(a.x,a.y,a.z,a.w),u.length){for(var l=0,c=Math.min(n.maxClipPlanes,u.length);c>l;++l)u[l].use(t,n,l);l<n.maxClipPlanes&&t.uniform4fv(n.clipPlane[l],n.noClipPlane)}else t.uniform4fv(n.clipPlane[0],n.noClipPlane);t.uniformMatrix4fv(n.modelViewMatrix,!1,s.modelViewMatrix),s.shapeNode.collision(n)}var h=this.getNavigationInfo(),d=this.getViewpoint(),p=h.getNearPlane(),f=h.getFarPlane(d),g=h.getCollisionRadius(),m=this.depthBuffer.getDistance(g,p,f);return this.depthBuffer.unbind(),m},render:function(e){switch(e){case n.COLLISION:this.numCollisionShapes=0,this.collect(e),this.collide(),this.gravite();break;case n.DISPLAY:this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),this.collect(e),this.draw()}},collide:function(){var t={};this.collisionSphere.radius=1.2*this.getNavigationInfo().getCollisionRadius();for(var n=0;n<this.numCollisionShapes;++n)try{var i=this.collisionShapes[n],r=i.collisions;if(r.length&&(this.invModelViewMatrix.assign(i.modelViewMatrix).multRight(this.getViewpoint().getInverseCameraSpaceMatrix()).inverse(),this.collisionSphere.center.set(this.invModelViewMatrix[12],this.invModelViewMatrix[13],this.invModelViewMatrix[14]),i.shapeNode.intersectsSphere(this.collisionSphere)))for(var o=0;o<r.length;++o)t[r[o].getId()]=r[o]}catch(s){}if(!e.isEmptyObject(this.activeCollisions)){var a=e.isEmptyObject(t)?this.activeCollisions:c.set_difference(this.activeCollisions,t,{});for(var u in a)a[u].set_active(!1)}this.activeCollisions=t;for(var u in t)t[u].set_active(!0)},gravite:function(){try{if("WALK"!==this.getBrowser().getCurrentViewer())return;var e=this.getNavigationInfo(),t=this.getViewpoint(),n=e.getCollisionRadius(),i=e.getNearPlane(),o=e.getFarPlane(t),s=e.getAvatarHeight(),a=e.getStepHeight();r.ortho(-n,n,-n,n,i,o,g);var u=t.getUpVector(),l=x.setFromToVec(w,u);m.assign(t.getTransformationMatrix()),m.translate(t.getUserPosition()),m.rotate(l),m.inverse(),this.getBrowser().setProjectionMatrix(m.multRight(g));var c=this.getDepth();if(o-c>0){c-=s;var h=x.setFromToVec(b,u);if(c>0){var d=this.speed?this.getBrowser().getCurrentFrameRate():1e6;this.speed-=this.getBrowser().getBrowserOptions().Gravity_.getValue()/d;var p=this.speed/d;-c>p&&(p=-c,this.speed=0),t.positionOffset_=t.positionOffset_.getValue().add(h.multVecRot(v.set(0,p,0)))}else if(this.speed=0,c=-c,c>.01&&a>c){var p=this.constrainTranslation(h.multVecRot(this.translation.set(0,c,0)));t.positionOffset_=p.add(t.positionOffset_.getValue())}}else this.speed=0}catch(f){console.log(f)}},draw:function(){var e=this.getBrowser(),t=e.getContext(),n=this.currentViewport.getRectangle(),i=this.opaqueShapes,r=this.transparentShapes,o=e.getShaders();t.viewport(n[0],n[1],n[2],n[3]),t.scissor(n[0],n[1],n[2],n[3]),this.getBackground().draw(n),e.getPointShader().setGlobalUniforms(),e.getLineShader().setGlobalUniforms(),e.getDefaultShader().setGlobalUniforms();for(var s in o)o[s].setGlobalUniforms();t.enable(t.DEPTH_TEST),t.depthMask(!0),t.disable(t.BLEND),t.clear(t.DEPTH_BUFFER_BIT);for(var a=0,u=this.numOpaqueShapes;u>a;++a){var l=i[a],c=l.scissor;t.scissor(c.x,c.y,c.z,c.w),l.shapeNode.draw(l)}t.depthMask(!1),t.enable(t.BLEND),this.transparencySorter.sort(0,this.numTransparentShapes);for(var a=0,u=this.numTransparentShapes;u>a;++a){var l=r[a],c=l.scissor;t.scissor(c.x,c.y,c.z,c.w),l.shapeNode.draw(l)}t.depthMask(!0),t.disable(t.BLEND);for(var h=this.getBrowser().getClipPlanes(),a=0,u=h.length;u>a;++a)h[a].recycle();h.length=0;for(var d=this.getBrowser().getGlobalLights(),a=0,u=d.length;u>a;++a)d[a].recycle();d.length=0;for(var d=this.getBrowser().getLocalLights(),a=0,u=d.length;u>a;++a)d[a].recycle();d.length=0}},d}),define("cobweb/Execution/BindableStack",["jquery","cobweb/Basic/X3DBaseNode"],function(e,t){function n(e,n,i){t.call(this,e.getBrowser(),e),this.layer=n,this.array=[i]}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n,get:function(){return this.array},top:function(){return this.array[this.array.length-1]},forcePush:function(e){e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),e.bindToLayer(this.layer)},push:function(e){if(e!==this.array[0]){var t=this.top();e!==t&&(t.isBound_.getValue()&&(t.isBound_=!1),this.pushOnTop(e),e.isBound_.getValue()||(e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),e.transitionStart(this.layer,t)),this.addNodeEvent())}},pushOnTop:function(e){var t=this.array.indexOf(e);t>-1&&this.array.splice(t,1),this.array.push(e)},remove:function(e){if(e!==this.array[0]){var t=this.top();if(e===t)return this.pop(e);var n=this.array.indexOf(e);n>-1&&this.array.splice(n,1)}},pop:function(e){if(e!==this.array[0]){var t=this.top();e===t&&(e.isBound_.getValue()&&(e.isBound_=!1),this.array.pop(),t=this.top(),t.isBound_.getValue()||(t.set_bind_=!0,t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),t.transitionStart(this.layer,e)),this.addNodeEvent())}}}),n}),define("cobweb/Execution/BindableList",["jquery","cobweb/Basic/X3DBaseNode"],function(e,t){function n(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function i(e,n,i){t.call(this,e.getBrowser(),e),this.layer=n,this.collected=[i],this.array=[i]}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.array[0].set_bind_.addInterest(this,"set_bind__",this.array[0])},get:function(){return this.array},getBound:function(){for(var e=1;e<this.array.length;++e){var t=this.array[e];if(t.isBound_.getValue())return t}return this.array.length>1?this.array[1]:this.array[0]},push:function(e){return this.collected.push(e)},update:function(){if(!n(this.collected,this.array)){for(var e=1;e<this.array.length;++e)this.array[e].set_bind_.removeInterest(this,"set_bind__",this.array[e]);var t=this.array;this.array=this.collected,this.collected=t;for(var e=1;e<this.array.length;++e)this.array[e].set_bind_.addInterest(this,"set_bind__",this.array[e])}this.collected.length=1},set_bind__:function(e,t){e.getValue()?t.bindToLayer(this.layer):t.unbindFromLayer(this.layer)}}),i}),define("cobweb/Components/Navigation/NavigationInfo",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DBindableNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.NavigationInfo),this.addChildren("availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE"))}function u(){this.getBrowser().getGlobalLights().push(this.getBrowser().getHeadlight())}var l={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_bind",new t.SFBool),new n(s.inputOutput,"type",new t.MFString(["EXAMINE","ANY"])),new n(s.inputOutput,"avatarSize",new t.MFFloat([.25,1.6,.75])),new n(s.inputOutput,"speed",new t.SFFloat(1)),new n(s.inputOutput,"headlight",new t.SFBool(!0)),new n(s.inputOutput,"visibilityLimit",new t.SFFloat),new n(s.inputOutput,"transitionType",new t.MFString("LINEAR")),new n(s.inputOutput,"transitionTime",new t.SFTime(1)),new n(s.outputOnly,"transitionComplete",new t.SFBool),new n(s.outputOnly,"isBound",new t.SFBool),new n(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.type_.addInterest(this,"set_type__"),this.headlight_.addInterest(this,"set_headlight__"),this.set_type__(),this.set_headlight__()},set_type__:function(){this.availableViewers_.length=0;var e=!1,t=!1,n=!1,i=!1,r=!1,o=!1;this.viewer_="EXAMINE";for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this.viewer_=a;break;case"PLANE_create3000.de":this.viewer_="PLANE";break;default:continue}break}if(this.type_.length){for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":e=!0;continue;case"WALK":t=!0;continue;case"FLY":n=!0;continue;case"LOOKAT":o=!0;continue;case"PLANE":i=!0;continue;case"NONE":r=!0;continue}if("ANY"==a){e=!0,t=!0,n=!0,i=!0,r=!0,o=!0;break}e=!0}e&&this.availableViewers_.push("EXAMINE"),t&&this.availableViewers_.push("WALK"),n&&this.availableViewers_.push("FLY"),i&&this.availableViewers_.push("PLANE"),o&&this.availableViewers_.push("LOOKAT"),r&&this.availableViewers_.push("NONE")}else e=!0,t=!0,n=!0,i=!0,r=!0,o=!0},set_headlight__:function(){this.headlight_.getValue()?this.enable=u:delete this.enable},bindToLayer:function(e){r.prototype.bindToLayer.call(this,e),e.getNavigationInfoStack().push(this)},unbindFromLayer:function(e){r.prototype.unbindFromLayer.call(this,e),e.getNavigationInfoStack().pop(this)},removeFromLayer:function(e){e.getNavigationInfoStack().remove(this)},getViewer:function(){return this.viewer_.getValue()},getCollisionRadius:function(){return this.avatarSize_.length>0&&this.avatarSize_[0]>0?this.avatarSize_[0]:.25},getAvatarHeight:function(){return this.avatarSize_.length>1?this.avatarSize_[1]:1.6},getStepHeight:function(){return this.avatarSize_.length>2?this.avatarSize_[2]:.75},getNearPlane:function(){var e=this.getCollisionRadius();return 0===e?1e-5:e/2},getFarPlane:function(e){return this.visibilityLimit_.getValue()?this.visibilityLimit_.getValue():e.getMaxZFar()},getTransitionType:function(){for(var e=0,t=this.transitionType_.length;t>e;++e){var n=this.transitionType_[e],i=l[n];if(i)return n}return"LINEAR"},enable:function(){},traverse:function(){this.getCurrentLayer().getNavigationInfos().push(this)}}),a}),define("cobweb/Components/EnvironmentalEffects/X3DFogObject",["jquery","cobweb/Bits/X3DConstants"],function(e,t){function n(e,n){this.addType(t.X3DFogObject),this.hidden=!1}return n.prototype={constructor:n,initialize:function(){this.fogType_.addInterest(this,"set_fogType__"),this.set_fogType__()},set_fogType__:function(){switch(this.fogType_.getValue()){case"EXPONENTIAL":this.fogType=2;break;default:this.fogType=1}},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},use:function(e,t){if(this.hidden)e.uniform1i(t.fogType,0);else{var n=this.color_.getValue(),i=Math.max(0,this.visibilityRange_.getValue());0===i&&(i=this.getCurrentNavigationInfo().getFarPlane(this.getCurrentViewpoint())),e.uniform1i(t.fogType,this.fogType),e.uniform3f(t.fogColor,n.r,n.g,n.b),e.uniform1f(t.fogVisibilityRange,i)}}},n}),define("cobweb/Components/EnvironmentalEffects/Fog",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DBindableNode","cobweb/Components/EnvironmentalEffects/X3DFogObject","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(a.Fog)}return u.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOnly,"set_bind",new t.SFBool),new n(a.inputOutput,"fogType",new t.SFString("LINEAR")),new n(a.inputOutput,"color",new t.SFColor(1,1,1)),new n(a.inputOutput,"visibilityRange",new t.SFFloat),new n(a.outputOnly,"isBound",new t.SFBool),new n(a.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},bindToLayer:function(e){r.prototype.bindToLayer.call(this,e),e.getFogStack().push(this)},unbindFromLayer:function(e){r.prototype.unbindFromLayer.call(this,e),e.getFogStack().pop(this)},removeFromLayer:function(e){e.getFogStack().remove(this)},traverse:function(){this.getCurrentLayer().getFogs().push(this)}}),u}),define("cobweb/Components/EnvironmentalEffects/X3DBackgroundNode",["jquery","cobweb/Components/Core/X3DBindableNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm","standard/Math/Geometry/Camera"],function(e,t,n,i,r,o,s,a,u,l){function c(e,n){t.call(this,e,n),this.addType(i.X3DBackgroundNode),this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.transformationMatrix=new a,this.modelViewMatrixArray=new Float32Array(16),this.clipPlanes=[],this.colors=[],this.sphere=[],this.textures=0}var h=1e4,d=20,p=new o(0,0,h),f=Math.sqrt(Math.pow(2*h,2)/2)/2,g=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],m=[f,f,-f,1,-f,f,-f,1,-f,-f,-f,1,f,f,-f,1,-f,-f,-f,1,f,-f,-f,1],y=[-f,f,f,1,f,f,f,1,f,-f,f,1,-f,f,f,1,f,-f,f,1,-f,-f,f,1],b=[-f,f,-f,1,-f,f,f,1,-f,-f,f,1,-f,f,-f,1,-f,-f,f,1,-f,-f,-f,1],w=[f,f,f,1,f,f,-f,1,f,-f,-f,1,f,f,f,1,f,-f,-f,1,f,-f,f,1],v=[f,f,f,1,-f,f,f,1,-f,f,-f,1,f,f,f,1,-f,f,-f,1,f,f,-f,1],x=[f,-f,-f,1,-f,-f,-f,1,-f,-f,f,1,f,-f,-f,1,-f,-f,f,1,f,-f,f,1],_=new r(0,0),C=new r(0,0),S=new r(0,0),T=new r(0,0),F=new r(0,0),O=new r(0,0);return c.prototype=e.extend(Object.create(t.prototype),{constructor:c,rotation:new s,textureMatrixArray:new Float32Array(new a),rectangleCount:6,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.colorBuffer=e.createBuffer(),this.sphereBuffer=e.createBuffer(),this.texCoordBuffer=e.createBuffer(),this.cubeBuffer=e.createBuffer(),this.texCoordsBuffer=e.createBuffer(),this.frontBuffer=e.createBuffer(),this.backBuffer=e.createBuffer(),this.leftBuffer=e.createBuffer(),this.rightBuffer=e.createBuffer(),this.topBuffer=e.createBuffer(),this.bottomBuffer=e.createBuffer(),this.groundAngle_.addInterest(this,"build"),this.groundColor_.addInterest(this,"build"),this.skyAngle_.addInterest(this,"build"),this.skyColor_.addInterest(this,"build"),this.transparency_.addInterest(this,"build"),this.build(),this.transferRectangle()},set_frontTexture__:function(e){this.setTexture("frontTexture",e,0)},set_backTexture__:function(e){this.setTexture("backTexture",e,1)},set_leftTexture__:function(e){this.setTexture("leftTexture",e,2)},set_rightTexture__:function(e){
this.setTexture("rightTexture",e,3)},set_topTexture__:function(e){this.setTexture("topTexture",e,4)},set_bottomTexture__:function(e){this.setTexture("bottomTexture",e,5)},setTexture:function(e,t,n){this[e]&&this[e].loadState_.removeInterest(this,"setTextureBit"),this[e]=t,t?(t.loadState_.addInterest(this,"setTextureBit",n),this.setTextureBit(t.loadState_,n)):this.textures&=~(1<<n)},setTextureBit:function(e,t){e.getValue()===i.COMPLETE_STATE?this.textures|=1<<t:this.textures&=~(1<<t)},bindToLayer:function(e){t.prototype.bindToLayer.call(this,e),e.getBackgroundStack().push(this)},unbindFromLayer:function(e){t.prototype.unbindFromLayer.call(this,e),e.getBackgroundStack().pop(this)},removeFromLayer:function(e){e.getBackgroundStack().remove(this)},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getColor:function(e,t,n){var i=u.upperBound(n,0,n.length,e,u.less);return t[i]},build:function(){if(this.colors.length=0,this.sphere.length=0,!(this.transparency_.getValue()>=1)){var e=1-u.clamp(this.transparency_.getValue(),0,1);if(0===this.groundColor_.length&&1==this.skyColor_.length){var t=h;this.sphere.vertices=36,this.sphere.push(t,t,-t,1,-t,t,-t,1,-t,-t,-t,1,t,t,-t,1,-t,-t,-t,1,t,-t,-t,1,-t,t,t,1,t,t,t,1,-t,-t,t,1,-t,-t,t,1,t,t,t,1,t,-t,t,1,-t,t,-t,1,-t,t,t,1,-t,-t,t,1,-t,t,-t,1,-t,-t,t,1,-t,-t,-t,1,t,t,t,1,t,t,-t,1,t,-t,t,1,t,-t,t,1,t,t,-t,1,t,-t,-t,1,t,t,t,1,-t,t,t,1,-t,t,-t,1,t,t,t,1,-t,t,-t,1,t,t,-t,1,-t,-t,t,1,t,-t,t,1,-t,-t,-t,1,-t,-t,-t,1,t,-t,t,1,t,-t,-t,1);for(var n=this.skyColor_[0],i=0,r=this.sphere.vertices;r>i;++i)this.colors.push(n.r,n.g,n.b,e)}else{var o=Math.sqrt(2*Math.pow(h,2));if(this.skyColor_.length>this.skyAngle_.length){for(var s=[],i=0,a=this.skyAngle_.length;a>i;++i)s.push(this.skyAngle_[i]);(0===s.length||s[0]>0)&&s.unshift(0);var l=this.groundColor_.length>this.groundAngle_.length?Math.PI/2:Math.PI;s[s.length-1]<l&&s.push(l),this.buildSphere(o,s,this.skyAngle_,this.skyColor_,e,!1)}if(this.groundColor_.length>this.groundAngle_.length){for(var s=[],i=0,a=this.groundAngle_.length;a>i;++i)s.push(this.groundAngle_[i]);s.reverse(),(0===s.length||s[0]<Math.PI/2)&&s.unshift(Math.PI/2),s[s.length-1]>0&&s.push(0),this.buildSphere(o,s,this.groundAngle_,this.groundColor_,e,!0)}}this.transferSphere()}},buildSphere:function(e,t,n,i,r,o){for(var s=0,a=o?Math.PI/2:Math.PI,l=t.length-1,c=0;l>c;++c){var h=u.clamp(t[c],0,a),p=u.clamp(t[c+1],0,a);o&&(h=Math.PI-h,p=Math.PI-p),_.setPolar(e,h),C.setPolar(e,p);for(var f=this.getColor(t[c],i,n),g=this.getColor(t[c+1],i,n),m=0;d>m;++m){var y=d-1>m?m+1:0;s=2*Math.PI*(m/d),S.setPolar(-_.imag,s),T.setPolar(-C.imag,s),s=2*Math.PI*(y/d),F.setPolar(-C.imag,s),O.setPolar(-_.imag,s),this.colors.push(f.r,f.g,f.b,r,g.r,g.g,g.b,r,g.r,g.g,g.b,r,f.r,f.g,f.b,r,f.r,f.g,f.b,r,g.r,g.g,g.b,r),this.sphere.push(S.imag,_.real,S.real,1,F.imag,C.real,F.real,1,T.imag,C.real,T.real,1,S.imag,_.real,S.real,1,O.imag,_.real,O.real,1,F.imag,C.real,F.real,1)}}},transferSphere:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.colors),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.sphereBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sphere),e.STATIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.texCoordsBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(g),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.frontBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.backBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(y),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.leftBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(b),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.rightBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(w),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.topBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(v),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.bottomBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(x),e.STATIC_DRAW)},traverse:function(e){switch(e){case n.CAMERA:this.getCurrentLayer().getBackgrounds().push(this),this.transformationMatrix.assign(this.getBrowser().getModelViewMatrix().get());break;case n.DISPLAY:for(var t=this.getCurrentLayer().getClipPlanes(),i=this.clipPlanes,r=0,o=t.length;o>r;++r)i[r]=t[r];i.length=t.length}},draw:function(e){if(!this.hidden){var t=this.getBrowser(),n=t.getContext();n.disable(n.DEPTH_TEST),n.depthMask(!1),n.enable(n.CULL_FACE),n.frontFace(n.CCW);var i=this.getCurrentViewpoint(),r=i.getScreenScale(p,e),o=this.rotation,s=this.transformationMatrix;r.multiply(Math.max(e[2],e[3])),this.projectionMatrixArray.set(i.getProjectionMatrix(1,Math.max(2,3*h*r.z),e)),s.multLeft(i.getInverseCameraSpaceMatrix()),s.get(null,o),s.identity(),s.scale(r),s.rotate(o),this.modelViewMatrixArray.set(s),this.drawSphere(),this.textures&&this.drawCube()}},drawSphere:function(){var e=this.transparency_.getValue();if(!(e>=1)){var t=this.getBrowser(),n=t.getContext(),i=t.getBackgroundSphereShader(),r=this.clipPlanes;if(i.use(),r.length){for(var o=0,s=Math.min(i.maxClipPlanes,r.length);s>o;++o)r[o].use(n,i,o);o<i.maxClipPlanes&&n.uniform4fv(i.clipPlane[o],i.noClipPlane)}else n.uniform4fv(i.clipPlane[0],i.noClipPlane);n.uniformMatrix4fv(i.projectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(i.modelViewMatrix,!1,this.modelViewMatrixArray),e?n.enable(n.BLEND):n.disable(n.BLEND),n.enableVertexAttribArray(i.color),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.vertexAttribPointer(i.color,4,n.FLOAT,!1,0,0),n.enableVertexAttribArray(i.vertex),n.bindBuffer(n.ARRAY_BUFFER,this.sphereBuffer),n.vertexAttribPointer(i.vertex,4,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLES,0,this.sphereCount),n.disableVertexAttribArray(i.color),n.disableVertexAttribArray(i.vertex)}},drawCube:function(){var e=this.getBrowser(),t=e.getContext(),n=e.getGouraudShader(),i=this.clipPlanes;if(n.use(),i.length){for(var r=0,o=Math.min(n.maxClipPlanes,i.length);o>r;++r)i[r].use(t,n,r);r<n.maxClipPlanes&&t.uniform4fv(n.clipPlane[r],n.noClipPlane)}else t.uniform4fv(n.clipPlane[0],n.noClipPlane);t.uniform1i(n.fogType,0),t.uniform1i(n.colorMaterial,!1),t.uniform1i(n.lighting,!1),t.uniform1i(n.texturing,!0),t.uniform1i(n.textureType,2),t.uniformMatrix4fv(n.textureMatrix,!1,this.textureMatrixArray),t.uniformMatrix4fv(n.projectionMatrix,!1,this.projectionMatrixArray),t.uniformMatrix4fv(n.modelViewMatrix,!1,this.modelViewMatrixArray),t.enableVertexAttribArray(n.texCoord),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordsBuffer),t.vertexAttribPointer(n.texCoord,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n.vertex),this.drawRectangle(t,n,this.frontTexture,this.frontBuffer),this.drawRectangle(t,n,this.backTexture,this.backBuffer),this.drawRectangle(t,n,this.leftTexture,this.leftBuffer),this.drawRectangle(t,n,this.rightTexture,this.rightBuffer),this.drawRectangle(t,n,this.topTexture,this.topBuffer),this.drawRectangle(t,n,this.bottomTexture,this.bottomBuffer),t.disableVertexAttribArray(n.texCoord),t.disableVertexAttribArray(n.vertex)},drawRectangle:function(e,t,n,r){n&&n.checkLoadState()===i.COMPLETE_STATE&&(n.traverse(e,t,0),n.transparent_.getValue()?e.enable(e.BLEND):e.disable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(t.vertex,4,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,this.rectangleCount))}}),c}),define("cobweb/Components/Texturing/X3DTextureNode",["jquery","cobweb/Fields","cobweb/Components/Shape/X3DAppearanceChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,r){n.call(this,e,r),this.addType(i.X3DTextureNode),this.addChildren("transparent",new t.SFBool)}var o=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return r.prototype=e.extend(Object.create(n.prototype),{constructor:r,initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.texture=e.createTexture()},getTexture:function(){return this.texture},updateTextureProperties:function(e,t,n,i,r,s,a,u){var l=this.getBrowser().getContext();l.bindTexture(e,this.getTexture()),Math.max(i,r)<this.getBrowser().getMinTextureSize()&&!t?(l.texParameteri(e,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l.NEAREST)):(n.generateMipMaps_.getValue()&&l.generateMipmap(e),l.texParameteri(e,l.TEXTURE_MIN_FILTER,l[n.getMinificationFilter()]),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l[n.getMagnificationFilter()])),t?(l.texParameteri(e,l.TEXTURE_WRAP_S,l[n.getBoundaryModeS()]),l.texParameteri(e,l.TEXTURE_WRAP_T,l[n.getBoundaryModeT()])):(l.texParameteri(e,l.TEXTURE_WRAP_S,s?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(e,l.TEXTURE_WRAP_T,a?l.REPEAT:l.CLAMP_TO_EDGE));for(var c=0;c<o.length;++c){var h=l.getExtension(o[c]);if(h){l.texParameterf(e,h.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropicDegree_.getValue());break}}l.bindTexture(e,null)}}),r}),define("cobweb/Components/Texturing/X3DTexture2DNode",["jquery","cobweb/Fields","cobweb/Components/Texturing/X3DTextureNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r){function o(e,t){n.call(this,e,t),this.addType(r.X3DTexture2DNode),this.width=0,this.height=0,this.flipY=!1,this.data=null}return o.prototype=e.extend(Object.create(n.prototype),{constructor:o,initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.target=e.TEXTURE_2D,this.repeatS_.addInterest(this,"updateTextureProperties"),this.repeatT_.addInterest(this,"updateTextureProperties"),this.textureProperties_.addInterest(this,"set_textureProperties__"),this.set_textureProperties__()},set_textureProperties__:function(){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest(this,"updateTextureProperties"),this.texturePropertiesNode=i(r.TextureProperties,this.textureProperties_),this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest(this,"updateTextureProperties"),this.updateTextureProperties()},getTarget:function(){return this.target},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},setTexture:function(e,t,n,i,r){this.transparent_=n,this.width=e,this.height=t,this.flipY=r,this.data=i;var o=this.getBrowser().getContext();o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.bindTexture(o.TEXTURE_2D,this.getTexture()),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,t,0,o.RGBA,o.UNSIGNED_BYTE,i),o.bindTexture(o.TEXTURE_2D,null),this.updateTextureProperties()},updateTexture:function(e){this.data=e;var t=this.getBrowser().getContext();t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,e),this.texturePropertiesNode.generateMipMaps_.getValue()&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},updateTextureProperties:function(){var e=this.getBrowser().getContext();n.prototype.updateTextureProperties.call(this,e.TEXTURE_2D,this.textureProperties_.getValue(),this.texturePropertiesNode,this.width,this.height,this.repeatS_.getValue(),this.repeatT_.getValue(),!1)},clear:function(){this.setTexture(1,1,!1,new Uint8Array([255,255,255,255]),!1)},resize:function(e,t,n,i,r){for(var o=new Uint8Array(i*r*4),s=i/t,a=r/n,u=0;r>u;++u)for(var l=Math.floor(u/a)*t,c=u*i,h=0;i>h;++h){var d=4*(l+Math.floor(h/s)),p=4*(c+h);o[p]=e[d],o[p+1]=e[d+1],o[p+2]=e[d+2],o[p+3]=e[d+3]}return o},traverse:function(e,t,n){t.textureTypeArray[n]=2,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.getTexture()),e.uniform1iv(t.textureType,t.textureTypeArray)}}),o}),define("cobweb/Components/Texturing/ImageTexture",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTexture2DNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Bits/X3DConstants","cobweb/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.ImageTexture),this.urlStack=new t.MFString}return c.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:c,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"url",new t.MFString),new n(s.initializeOnly,"repeatS",new t.SFBool(!0)),new n(s.initializeOnly,"repeatT",new t.SFBool(!0)),new n(s.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest(this,"set_url__"),this.canvas=e("<canvas>"),this.image=e("<img>"),this.image.load(this.setImage.bind(this)),this.image.error(this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image.attr("crossOrigin","anonymous"),this.requestAsyncLoad()},set_url__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.urlStack.setValue(this.url_),this.loadNext())},loadNext:function(){return 0===this.urlStack.length?(this.clear(),void this.setLoadState(s.FAILED_STATE)):(this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),void this.image.attr("src",this.URL))},setError:function(){var e=this.URL.toString();this.URL.isLocal()||e.match(a.fallbackRx)||this.urlStack.unshift(a.fallback+e),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){"data"!==this.URL.scheme&&console.info("Done loading image:",this.URL.toString());try{var e=this.image[0],t=e.width,n=e.height,i=this.canvas[0],r=i.getContext("2d");l.isPowerOfTwo(t)&&l.isPowerOfTwo(n)?(i.width=t,i.height=n,r.drawImage(e,0,0)):(t=l.nextPowerOfTwo(t),n=l.nextPowerOfTwo(n),i.width=t,i.height=n,r.drawImage(e,0,0,e.width,e.height,0,0,t,n));for(var o=r.getImageData(0,0,t,n).data,a=!0,u=3;u<o.length;u+=4)if(255!==o[u]){a=!1;break}setTimeout(function(){this.setTexture(t,n,!a,new Uint8Array(o),!0),this.setLoadState(s.COMPLETE_STATE)}.bind(this),16)}catch(c){console.log(c.message),this.setError()}}}),c}),define("cobweb/Components/EnvironmentalEffects/Background",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EnvironmentalEffects/X3DBackgroundNode","cobweb/Components/Texturing/ImageTexture","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.Background)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_bind",new t.SFBool),new n(s.inputOutput,"frontUrl",new t.MFString),new n(s.inputOutput,"backUrl",new t.MFString),new n(s.inputOutput,"leftUrl",new t.MFString),new n(s.inputOutput,"rightUrl",new t.MFString),new n(s.inputOutput,"topUrl",new t.MFString),new n(s.inputOutput,"bottomUrl",new t.MFString),new n(s.inputOutput,"skyAngle",new t.MFFloat),new n(s.inputOutput,"skyColor",new t.MFColor(new t.SFColor)),new n(s.inputOutput,"groundAngle",new t.MFFloat),new n(s.inputOutput,"groundColor",new t.MFColor),new n(s.inputOutput,"transparency",new t.SFFloat),new n(s.outputOnly,"isBound",new t.SFBool),new n(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this);var e=new o(this.getExecutionContext()),t=new o(this.getExecutionContext()),n=new o(this.getExecutionContext()),i=new o(this.getExecutionContext()),s=new o(this.getExecutionContext()),a=new o(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this.frontUrl_.addFieldInterest(e.url_),this.backUrl_.addFieldInterest(t.url_),this.leftUrl_.addFieldInterest(n.url_),this.rightUrl_.addFieldInterest(i.url_),this.topUrl_.addFieldInterest(s.url_),this.bottomUrl_.addFieldInterest(a.url_),e.url_=this.frontUrl_,t.url_=this.backUrl_,n.url_=this.leftUrl_,i.url_=this.rightUrl_,s.url_=this.topUrl_,a.url_=this.bottomUrl_,e.textureProperties_=u,t.textureProperties_=u,n.textureProperties_=u,i.textureProperties_=u,s.textureProperties_=u,a.textureProperties_=u,e.setup(),t.setup(),n.setup(),i.setup(),s.setup(),a.setup(),this.set_frontTexture__(e),this.set_backTexture__(t),this.set_leftTexture__(n),this.set_rightTexture__(i),this.set_topTexture__(s),this.set_bottomTexture__(a)}}),a}),define("cobweb/Components/Layering/X3DLayerNode",["jquery","cobweb/Components/Core/X3DNode","cobweb/Rendering/X3DRenderer","cobweb/Components/Layering/X3DViewportNode","cobweb/Execution/BindableStack","cobweb/Execution/BindableList","cobweb/Components/Navigation/NavigationInfo","cobweb/Components/EnvironmentalEffects/Fog","cobweb/Components/EnvironmentalEffects/Background","cobweb/Bits/X3DCast","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Geometry/Line3","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p){function f(e,i,l,c){t.call(this,e,i),n.call(this,e,i),this.addType(h.X3DLayerNode),this.groupNode=c,this.currentViewport=null,this.defaultBackground=new u(i),this.defaultFog=new a(i),this.defaultNavigationInfo=new s(i),this.defaultViewpoint=l,this.backgroundStack=new r(this.getExecutionContext(),this,this.defaultBackground),this.fogStack=new r(this.getExecutionContext(),this,this.defaultFog),this.navigationInfoStack=new r(this.getExecutionContext(),this,this.defaultNavigationInfo),this.viewpointStack=new r(this.getExecutionContext(),this,this.defaultViewpoint),this.backgrounds=new o(this.getExecutionContext(),this,this.defaultBackground),this.fogs=new o(this.getExecutionContext(),this,this.defaultFog),this.navigationInfos=new o(this.getExecutionContext(),this,this.defaultNavigationInfo),this.viewpoints=new o(this.getExecutionContext(),this,this.defaultViewpoint),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.hitRay=g,this.collisionTime=0}var g=new d(new p(0,0,0),new p(0,0,0));return f.prototype=e.extend(Object.create(t.prototype),n.prototype,{constructor:f,layer0:!1,initialize:function(){t.prototype.initialize.call(this),n.prototype.initialize.call(this),this.groupNode.children_=this.children_,this.groupNode.setup(),this.collect=this.groupNode.traverse.bind(this.groupNode),this.defaultNavigationInfo.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.defaultViewpoint.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgrounds.setup(),this.fogs.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.viewport_.addInterest(this,"set_viewport__"),this.addChildren_.addFieldInterest(this.groupNode.addChildren_),this.removeChildren_.addFieldInterest(this.groupNode.removeChildren_),this.children_.addFieldInterest(this.groupNode.children_),this.set_viewport__()},isLayer0:function(e){this.layer0=e,this.defaultBackground.setHidden(!e)},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var e=[],t=0;t<this.viewpoints.get().length;++t){var n=this.viewpoints.get()[t];n.description_.length&&e.push(n)}return e},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getHitRay:function(){return this.hitRay},getBBox:function(){return this.groupNode.getBBox()},set_viewport__:function(){this.currentViewport=l(h.X3DViewportNode,this.viewport_),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(){this.traverse(c.CAMERA),this.navigationInfoStack.forcePush(this.navigationInfos.getBound()),this.backgroundStack.forcePush(this.backgrounds.getBound()),this.fogStack.forcePush(this.fogs.getBound()),this.viewpointStack.forcePush(this.viewpoints.getBound())},traverse:function(e){var t=this.getBrowser();switch(t.getLayers().push(this),e){case c.POINTER:this.pointer();break;case c.CAMERA:this.camera();break;case c.COLLISION:this.collision();break;case c.DISPLAY:this.display()}t.getLayers().pop()},pointer:function(){if(this.isPickable_.getValue()){var e=this.currentViewport.getRectangle();if(this.getBrowser().getSelectedLayer()){if(this.getBrowser().getSelectedLayer()!==this)return}else if(!this.getBrowser().isPointerInRectangle(e))return;this.getViewpoint().reshape(),this.getViewpoint().transform(),this.hitRay=this.getBrowser().setHitRay(e),this.currentViewport.push(),this.collect(c.POINTER),this.currentViewport.pop()}},camera:function(){this.getViewpoint().reshape(),this.getBrowser().getModelViewMatrix().identity(),this.currentViewport.push(),this.collect(c.CAMERA),this.currentViewport.pop(),this.navigationInfos.update(),this.backgrounds.update(),this.fogs.update(),this.viewpoints.update(),this.getViewpoint().update()},collision:function(){this.collisionTime=0,this.getViewpoint().reshape(),this.getBrowser().getModelViewMatrix().identity(),this.currentViewport.push(),this.render(c.COLLISION),this.currentViewport.pop()},display:function(e){this.getNavigationInfo().enable(),this.getViewpoint().reshape(),this.getViewpoint().transform(),this.currentViewport.push(),this.render(c.DISPLAY),this.currentViewport.pop()},collect:function(e){}}),f}),define("cobweb/Components/Grouping/Group",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.Group)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("cobweb/Components/Layering/Layer",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Layering/X3DLayerNode","cobweb/Components/Navigation/Viewpoint","cobweb/Components/Grouping/Group","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e,new o(e),new s(e)),this.addType(a.Layer)}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"isPickable",new t.SFBool(!0)),new n(a.inputOutput,"viewport",new t.SFNode),new n(a.inputOnly,"addChildren",new t.MFNode),new n(a.inputOnly,"removeChildren",new t.MFNode),new n(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"}}),u}),define("cobweb/Components/Layering/LayerSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Layering/Layer","cobweb/Bits/X3DCast","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(u.LayerSet),this.layerNodes=[new o(e)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(u.inputOutput,"metadata",new t.SFNode),new n(u.inputOutput,"activeLayer",new t.SFInt32),new n(u.inputOutput,"order",new t.MFInt32(0)),new n(u.inputOutput,"layers",new t.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this.activeLayer_.addInterest(this,"set_activeLayer"),this.order_.addInterest(this,"set_layers"),this.layers_.addInterest(this,"set_layers"),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(e){this.layerNode0=e,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this.activeLayer_.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{var e=this.activeLayer_-1;e>=0&&e<this.layers_.length?this.activeLayerNode!==this.layers_[e].getValue()&&(this.activeLayerNode=this.layers_[e].getValue()):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){var e=this.layers_.getValue();this.layerNodes.length=0;for(var t=0;t<this.order_.length;++t){var n=this.order_[t];if(0===n)this.layerNodes.push(this.layerNode0);else if(--n,n>=0&&n<e.length){var i=s(u.X3DLayerNode,e[n]);i&&this.layerNodes.push(i)}}this.set_activeLayer()},bind:function(){var e=this.layers_.getValue();this.layerNode0.bind();for(var t=0,n=e.length;n>t;++t){var i=s(u.X3DLayerNode,e[t]);i&&i.bind()}},traverse:function(e){var t=this.layerNodes;if(e===a.POINTER)for(var n=0,i=t.length;i>n;++n)this.getBrowser().setLayerNumber(n),t[n].traverse(e);else for(var n=0,i=t.length;i>n;++n)t[n].traverse(e)}}),l}),define("cobweb/Execution/World",["jquery","cobweb/Fields/SFNode","cobweb/Basic/X3DBaseNode","cobweb/Components/Layering/LayerSet","cobweb/Components/Layering/Layer","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){n.call(this,e.getBrowser(),e),this.layerSet=new i(e),this.defaultLayerSet=this.layerSet,this.layer0=new r(e),this.addChildren("activeLayer",new t(this.layer0))}return a.prototype=e.extend(Object.create(n.prototype),{constructor:a,getTypeName:function(){return"World"},initialize:function(){n.prototype.initialize.call(this),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet.activeLayer_.addInterest(this,"set_activeLayer"),this.getExecutionContext().getRootNodes().addInterest(this,"set_rootNodes"),this.getExecutionContext().setup(),this.set_rootNodes(),this.layer0.isLayer0(!0),this.layer0.setup(),this.bind()},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this.activeLayer_.getValue()},set_rootNodes:function(){var e=this.layerSet;this.layerSet=this.defaultLayerSet;var t=this.getExecutionContext().getRootNodes();this.layer0.children_=t;for(var n=0;n<t.length;++n){var i=o(s.LayerSet,t[n]);i&&(i.setLayer0(this.layer0),this.layerSet=i)}this.layerSet!==e&&(e.activeLayer_.removeInterest(this,"set_activeLayer"),this.layerSet.activeLayer_.addInterest(this,"set_activeLayer"),this.set_activeLayer()),this.traverse=this.layerSet.traverse.bind(this.layerSet)},set_activeLayer:function(){this.activeLayer_=this.layerSet.getActiveLayer()},bind:function(){this.layerSet.bind();try{var e=this.getExecutionContext().getURL().fragment;e.length&&this.getExecutionContext().changeViewpoint(e)}catch(t){}}}),a}),define("cobweb/Browser/X3DBrowserContext",["jquery","cobweb/Fields/SFTime","cobweb/Basic/X3DBaseNode","cobweb/Browser/Core/X3DCoreContext","cobweb/Routing/X3DRoutingContext","cobweb/Browser/Scripting/X3DScriptingContext","cobweb/Browser/Networking/X3DNetworkingContext","cobweb/Browser/Shaders/X3DShadersContext","cobweb/Browser/Shape/X3DShapeContext","cobweb/Browser/Rendering/X3DRenderingContext","cobweb/Browser/Geometry2D/X3DGeometry2DContext","cobweb/Browser/Geometry3D/X3DGeometry3DContext","cobweb/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","cobweb/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext","cobweb/Browser/Navigation/X3DNavigationContext","cobweb/Browser/Layering/X3DLayeringContext","cobweb/Browser/Layout/X3DLayoutContext","cobweb/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","cobweb/Browser/Lighting/X3DLightingContext","cobweb/Browser/Sound/X3DSoundContext","cobweb/Browser/Text/X3DTextContext","cobweb/Browser/Texturing/X3DTexturingContext","cobweb/Browser/Time/X3DTimeContext","cobweb/Execution/World","cobweb/Bits/TraverseType"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y,b,w,v,x,_,C,S){function T(e){n.call(this,this,this),r.call(this),i.call(this,e),o.call(this),s.call(this),a.call(this),u.call(this),l.call(this),c.call(this),h.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),y.call(this),b.call(this),w.call(this),v.call(this),x.call(this),_.call(this),this.addChildren("initialized",new t,"shutdown",new t,"prepareEvents",new t,"sensors",new t,"finished",new t),this.changedTime=0,this.renderCallback=this.traverse.bind(this),this.systemTime=0,this.systemStartTime=0,this.browserTime=0,this.pickingTime=0,this.cameraTime=0,this.collisionTime=0,this.displayTime=0}return T.prototype=e.extend(Object.create(n.prototype),r.prototype,i.prototype,o.prototype,s.prototype,a.prototype,u.prototype,l.prototype,c.prototype,h.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,y.prototype,b.prototype,w.prototype,v.prototype,x.prototype,_.prototype,{constructor:T,initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),i.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),c.prototype.initialize.call(this),h.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),y.prototype.initialize.call(this),b.prototype.initialize.call(this),w.prototype.initialize.call(this),v.prototype.initialize.call(this),x.prototype.initialize.call(this),_.prototype.initialize.call(this)},initialized:function(){return this.initialized_},shutdown:function(){return this.shutdown_},prepareEvents:function(){return this.prepareEvents_},sensors:function(){return this.sensors_},finished:function(){return this.finished_},getURL:function(){return this.getExecutionContext().getURL()},getWorld:function(){return this.world},setExecutionContext:function(e){this.world=new C(e),this.world.setup()},getExecutionContext:function(){return this.world.getExecutionContext()},addBrowserEvent:function(){this.changedTime!==this.getCurrentTime()&&(this.changedTime=this.getCurrentTime(),requestAnimationFrame(this.renderCallback))},traverse:function(e){var t=this.getContext(),n=performance.now();this.systemTime=n-this.systemStartTime,this.advanceTime(e),this.prepareEvents_.processInterests(),this.processEvents();var i=performance.now();this.world.traverse(S.CAMERA),this.cameraTime=performance.now()-i;var r=performance.now();this.getCollisionCount()&&this.world.traverse(S.COLLISION),this.collisionTime=performance.now()-r,
this.sensors_.processInterests(),this.processEvents();var o=performance.now();t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),this.world.traverse(S.DISPLAY),this.displayTime=performance.now()-o,this.browserTime=performance.now()-n,this.systemStartTime=performance.now(),this.finished_.processInterests()}}),T}),define("cobweb/Browser/Version",[],function(){return"1.22a"}),define("cobweb/Configuration/ComponentInfo",["jquery"],function(e){function t(e,t,n,i){this.name=e,this.level=t,this.title=n,this.providerUrl=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return e.extend(t.prototype,{constructor:t}),t}),define("cobweb/Configuration/ProfileInfo",["jquery"],function(e){function t(e,t,n,i){this.name=e,this.title=t,this.providerUrl=n,this.components=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return e.extend(t.prototype,{constructor:t}),t}),define("cobweb/Configuration/ProfileInfoArray",["jquery","cobweb/Configuration/X3DInfoArray"],function(e,t){function n(){return t.call(this)}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n}),n}),define("cobweb/Configuration/SupportedComponents",["jquery","cobweb/Configuration/ComponentInfo","cobweb/Configuration/ComponentInfoArray","cobweb/Browser/Networking/urls"],function(e,t,n,i){function r(e,n,r){o.add(n,new t(n,r,e,i.provider))}var o=new n;return r("Computer-Aided Design (CAD) model geometry","CADGeometry",2),r("Core","Core",2),r("Cube map environmental texturing","CubeMapTexturing",3),r("Distributed interactive simulation (DIS)","DIS",2),r("Environmental effects","EnvironmentalEffects",4),r("Environmental sensor","EnvironmentalSensor",3),r("Event utilities","EventUtilities",1),r("Followers","Followers",1),r("Geometry2D","Geometry2D",2),r("Geometry3D","Geometry3D",4),r("Geospatial","Geospatial",2),r("Grouping","Grouping",3),r("Humanoid animation (H-Anim)","H-Anim",1),r("Interpolation","Interpolation",5),r("Key device sensor","KeyDeviceSensor",2),r("Layering","Layering",1),r("Layout","Layout",2),r("Lighting","Lighting",3),r("Navigation","Navigation",3),r("Networking","Networking",4),r("Non-uniform Rational B-Spline (NURBS)","NURBS",4),r("Particle systems","ParticleSystems",3),r("Picking sensor","Picking",3),r("Pointing device sensor","PointingDeviceSensor",1),r("Programmable shaders","Shaders",1),r("Rendering","Rendering",5),r("Rigid body physics","RigidBodyPhysics",2),r("Scripting","Scripting",1),r("Shape","Shape",4),r("Sound","Sound",1),r("Text","Text",1),r("Texturing","Texturing",3),r("Texturing3D","Texturing3D",2),r("Time","Time",2),r("Volume rendering","VolumeRendering",4),r("Cobweb","Cobweb",1),Object.preventExtensions(o),Object.freeze(o),Object.seal(o),o}),define("cobweb/Configuration/SupportedProfiles",["jquery","cobweb/Configuration/ProfileInfo","cobweb/Configuration/ProfileInfoArray","cobweb/Configuration/ComponentInfoArray","cobweb/Configuration/SupportedComponents","cobweb/Browser/Networking/urls"],function(e,t,n,i,r,o){function s(e,n,r){a.add(n,new t(n,e,o.povider,new i(r)))}var a=new n;return s("Computer-Aided Design (CAD) interchange","CADInterchange",[r.Core,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Lighting,r.Texturing,r.Navigation,r.Shaders,r.CADGeometry]),s("Core","Core",[r.Core]),s("Full","Full",[r.Core,r.Time,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Geometry3D,r.Geometry2D,r.Text,r.Sound,r.Lighting,r.Texturing,r.Interpolation,r.PointingDeviceSensor,r.KeyDeviceSensor,r.EnvironmentalSensor,r.Navigation,r.EnvironmentalEffects,r.Geospatial,r["H-Anim"],r.NURBS,r.DIS,r.Scripting,r.EventUtilities,r.Shaders,r.CADGeometry,r.Texturing3D,r.CubeMapTexturing,r.Layering,r.Layout,r.RigidBodyPhysics,r.Picking,r.Followers,r.ParticleSystems]),s("Immersive","Immersive",[r.Core,r.Time,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Geometry3D,r.Geometry2D,r.Text,r.Sound,r.Lighting,r.Texturing,r.Interpolation,r.PointingDeviceSensor,r.KeyDeviceSensor,r.EnvironmentalSensor,r.Navigation,r.EnvironmentalEffects,r.Scripting,r.EventUtilities]),s("Interactive","Interactive",[r.Core,r.Time,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Geometry3D,r.Lighting,r.Texturing,r.Interpolation,r.PointingDeviceSensor,r.KeyDeviceSensor,r.EnvironmentalSensor,r.Navigation,r.EnvironmentalEffects,r.EventUtilities]),s("Interchange","Interchange",[r.Core,r.Time,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Geometry3D,r.Lighting,r.Texturing,r.Interpolation,r.Navigation,r.EnvironmentalEffects]),s("MPEG-4 interactive","MPEG-4",[r.Core,r.Time,r.Networking,r.Grouping,r.Rendering,r.Shape,r.Geometry3D,r.Lighting,r.Texturing,r.Interpolation,r.PointingDeviceSensor,r.EnvironmentalSensor,r.Navigation,r.EnvironmentalEffects]),Object.preventExtensions(a),Object.freeze(a),Object.seal(a),a}),define("cobweb/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["jquery","cobweb/Components/Core/X3DSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r){function o(e,i){t.call(this,e,i),this.addType(n.X3DPointingDeviceSensorNode)}return o.prototype=e.extend(Object.create(t.prototype),{constructor:o,initialize:function(){t.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.matrices={}},getMatrices:function(){return this.matrices},set_enabled__:function(){this.enabled_.getValue()||(this.isActive_.getValue()&&(this.isActive_=!1),this.isOver_.getValue()&&(this.isOver_=!1))},set_over__:function(e,t){t!==this.isOver_.getValue()&&(this.isOver_=t,this.isOver_.getValue()&&(this.getBrowser().getNotification().string_=this.description_))},set_active__:function(e,t){t!==this.isActive_.getValue()&&(this.isActive_=t)},traverse:function(e){if(this.enabled_.getValue()){var t=this.getCurrentLayer();e[this.getId()]=this,t.getId()in this.matrices||(this.matrices[t.getId()]={modelViewMatrix:new r,projectionMatrix:new r,viewport:new i});var n=this.matrices[t.getId()];n.modelViewMatrix.assign(this.getBrowser().getModelViewMatrix().get()),n.projectionMatrix.assign(this.getBrowser().getProjectionMatrix()),n.viewport.assign(t.getViewport().getRectangle())}}}),o}),define("cobweb/Components/PointingDeviceSensor/X3DTouchSensorNode",["jquery","cobweb/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DTouchSensorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,set_active__:function(e,n){t.prototype.set_active__.call(this,e,n),this.enabled_.getValue()&&this.isOver_.getValue()&&!n&&(this.touchTime_=this.getBrowser().getCurrentTime())}}),i}),define("cobweb/Components/PointingDeviceSensor/TouchSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/PointingDeviceSensor/X3DTouchSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(o.TouchSensor)}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.inputOutput,"description",new t.SFString),new n(o.outputOnly,"hitTexCoord_changed",new t.SFVec2f),new n(o.outputOnly,"hitNormal_changed",new t.SFVec3f),new n(o.outputOnly,"hitPoint_changed",new t.SFVec3f),new n(o.outputOnly,"isOver",new t.SFBool),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"touchTime",new t.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(e,t){try{if(r.prototype.set_over__.call(this,e,t),this.isOver_.getValue()){var n=e.intersection,i=this.getMatrices()[e.layer.getId()].modelViewMatrix,o=a.inverse(i);this.hitTexCoord_changed_=n.texCoord,this.hitNormal_changed_=i.multMatrixDir(n.normal.copy()).normalize(),this.hitPoint_changed_=o.multVecMatrix(n.point.copy())}}catch(s){console.log(s)}}}),u}),define("cobweb/Components/Networking/Anchor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Components/PointingDeviceSensor/TouchSensor","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","cobweb/InputOutput/Loader"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(u.Anchor),this.touchSensorNode=new s(e)}return c.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:c,fieldDefinitions:new i([new n(u.inputOutput,"metadata",new t.SFNode),new n(u.inputOutput,"description",new t.SFString),new n(u.inputOutput,"url",new t.MFString),new n(u.inputOutput,"parameter",new t.MFString),new n(u.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(u.initializeOnly,"bboxCenter",new t.SFVec3f),new n(u.inputOnly,"addChildren",new t.MFNode),new n(u.inputOnly,"removeChildren",new t.MFNode),new n(u.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.touchSensorNode.touchTime_.addInterest(this,"requestAsyncLoad"),this.description_.addFieldInterest(this.touchSensorNode.description_),this.touchSensorNode.description_=this.description_,this.touchSensorNode.setup()},requestAsyncLoad:function(){this.setLoadState(u.IN_PROGRESS_STATE,!1);for(var e,t=0,n=this.parameter_.length;n>t;++t){var i=this.parameter_[t].split("=");2===i.length&&"target"===i[0]&&(e=i[1])}new l(this).createX3DFromURL(this.url_,function(e){e?(this.getBrowser().replaceWorld(e),this.setLoadState(u.COMPLETE_STATE,!1)):this.setLoadState(u.FAILED_STATE,!1)}.bind(this),function(e){try{this.getExecutionContext().changeViewpoint(e)}catch(t){}this.setLoadState(u.COMPLETE_STATE,!1)}.bind(this),function(t){e?window.open(t,e):location=t,this.setLoadState(u.COMPLETE_STATE,!1)}.bind(this))},traverse:function(e){if(e===a.POINTER){var t={};this.getBrowser().getSensors().push(t),this.touchSensorNode.traverse(t),r.prototype.traverse.call(this,e),this.getBrowser().getSensors().pop()}else r.prototype.traverse.call(this,e)}}),c}),define("cobweb/Components/Rendering/X3DLineGeometryNode",["jquery","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DLineGeometryNode),this.shader=e.getLineShader()}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,isLineGeometry:function(){return!0},setShader:function(e){this.shader=e},traverse:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getShader();i===t.getDefaultShader()&&(i=this.shader),i.vertex<0||(e.colorMaterial=this.colors.length,i.setLocalUniforms(e),this.colors.length&&i.color>=0&&(n.enableVertexAttribArray(i.color),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.vertexAttribPointer(i.color,4,n.FLOAT,!1,0,0)),n.enableVertexAttribArray(i.vertex),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.vertexAttribPointer(i.vertex,4,n.FLOAT,!1,0,0),n.drawArrays(i.primitiveMode===n.POINTS?n.POINTS:this.primitiveMode,0,this.vertexCount),i.color>=0&&n.disableVertexAttribArray(i.color),n.disableVertexAttribArray(i.vertex))}}),i}),define("cobweb/Components/Geometry2D/Arc2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.Arc2D)}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"startAngle",new t.SFFloat),new n(o.inputOutput,"endAngle",new t.SFFloat(1.5708)),new n(o.initializeOnly,"radius",new t.SFFloat(1))]),getTypeName:function(){return"Arc2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getArc2DOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getArc2DOptions().removeInterest(this,"eventsProcessed")},getAngle:function(){var e=u.interval(this.startAngle_.getValue(),0,2*Math.PI),t=u.interval(this.endAngle_.getValue(),0,2*Math.PI);if(e===t)return 2*Math.PI;var n=Math.abs(t-e);return e>t?2*Math.PI-n:isNaN(n)?0:n},build:function(){var e=this.getBrowser().getContext(),t=this.getBrowser().getArc2DOptions(),n=t.minAngle_.getValue(),i=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getAngle(),a=Math.ceil(o/n),u=o/a,l=this.getVertices();o<2*Math.PI?(++a,this.setPrimitiveMode(e.LINE_STRIP)):this.setPrimitiveMode(e.LINE_LOOP);for(var c=0;a>c;++c){var h=i+u*c,d=s.Polar(r,h);l.push(d.real,d.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(!1),this.setCurrentTexCoord(null)}}),l}),define("cobweb/Components/Geometry2D/ArcClose2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.ArcClose2D)}var c=new s(.5,.5);return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"closureType",new t.SFString("PIE")),new n(o.inputOutput,"startAngle",new t.SFFloat),new n(o.inputOutput,"endAngle",new t.SFFloat(1.5708)),new n(o.initializeOnly,"radius",new t.SFFloat(1)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"ArcClose2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getArcClose2DOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getArcClose2DOptions().removeInterest(this,"eventsProcessed")},getAngle:function(){var e=u.interval(this.startAngle_.getValue(),0,2*Math.PI),t=u.interval(this.endAngle_.getValue(),0,2*Math.PI);if(e===t)return 2*Math.PI;var n=Math.abs(t-e);return e>t?2*Math.PI-n:isNaN(n)?0:n},build:function(){var e=this.getBrowser().getArcClose2DOptions(),t="CHORD"===this.closureType_.getValue(),n=e.minAngle_.getValue(),i=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getAngle(),a=Math.ceil(o/n),u=o/a,l=[],h=this.getNormals(),d=this.getVertices(),p=[],f=[];this.getTexCoords().push(l);for(var g=0,m=a+1;m>g;++g){var y=i+u*g;p.push(s.Polar(.5,y).add(c)),f.push(s.Polar(r,y))}if(t)for(var b=p[0],w=f[0],v=1;a>v;++v){var x=p[v],_=p[v+1],C=f[v],S=f[v+1];l.push(b.real,b.imag,0,1,x.real,x.imag,0,1,_.real,_.imag,0,1),h.push(0,0,1,0,0,1,0,0,1),d.push(w.real,w.imag,0,1,C.real,C.imag,0,1,S.real,S.imag,0,1)}else for(var v=0;a>v;++v){var x=p[v],_=p[v+1],C=f[v],S=f[v+1];l.push(.5,.5,0,1,x.real,x.imag,0,1,_.real,_.imag,0,1),h.push(0,0,1,0,0,1,0,0,1),d.push(0,0,0,1,C.real,C.imag,0,1,S.real,S.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null)},traverse:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getShader();i.use(),n.uniform1i(i.geometryType,2),r.prototype.traverse.call(this,e),n.uniform1i(i.geometryType,3)}}),l}),define("cobweb/Components/Sound/X3DSoundSourceNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Components/Time/X3DTimeDependentNode","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,r){t.call(this,e,r),n.call(this,e,r),this.addType(i.X3DSoundSourceNode),this.volume=0,this.media=null}return r.prototype=e.extend(Object.create(t.prototype),n.prototype,{constructor:r,initialize:function(){t.prototype.initialize.call(this),n.prototype.initialize.call(this)},set_browser_live__:function(){n.prototype.set_browser_live__.call(this),this.getDisabled()?(this.getBrowser().volume_.removeInterest(this,"set_volume__"),this.getBrowser().mute_.removeInterest(this,"set_volume__")):(this.getBrowser().volume_.addInterest(this,"set_volume__"),this.getBrowser().mute_.addInterest(this,"set_volume__"),this.set_volume__())},setMedia:function(e){if(this.media&&(this.media[0].volume=0,this.media[0].pause(),this.media.unbind("ended")),this.media=e,e){var t=e[0];this.setVolume(0),this.duration_changed_=t.duration,this.isActive_.getValue()&&(this.loop_.getValue()?t.currentTime=this.getElapsedTime()%t.duration:t.currentTime=this.getElapsedTime(),this.isPaused_.getValue()||this.speed_.getValue()&&t.play())}},getMedia:function(){return this.media},setVolume:function(e){this.volume=e,this.set_volume__()},set_volume__:function(){this.media&&(this.media[0].volume=!this.getBrowser().mute_.getValue()*this.getBrowser().volume_.getValue()*this.volume)},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this.speed_.getValue()&&(this.media[0].currentTime=0,this.media[0].play())},set_pause:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_resume:function(){this.media&&this.speed_.getValue()&&this.media[0].play()},set_stop:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_ended:function(){if(this.media){var e=this.media[0];if(e.currentTime<e.duration)return;this.loop_.getValue()?(this.speed_.getValue()&&e.play(),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=this.getBrowser().getCurrentTime()):this.stop()}},prepareEvents:function(){this.set_ended(),this.elapsedTime_=this.getElapsedTime()}}),r}),define("cobweb/Components/Sound/AudioClip",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Sound/X3DSoundSourceNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Bits/X3DConstants","cobweb/Browser/Networking/urls","standard/Networking/URI"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.AudioClip),this.urlStack=new t.MFString}return l.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"description",new t.SFString),new n(s.inputOutput,"url",new t.MFString),new n(s.inputOutput,"speed",new t.SFFloat(1)),new n(s.inputOutput,"pitch",new t.SFFloat(1)),new n(s.inputOutput,"loop",new t.SFBool),new n(s.inputOutput,"startTime",new t.SFTime),new n(s.inputOutput,"resumeTime",new t.SFTime),new n(s.inputOutput,"pauseTime",new t.SFTime),new n(s.inputOutput,"stopTime",new t.SFTime),new n(s.outputOnly,"isPaused",new t.SFBool),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"cycleTime",new t.SFTime),new n(s.outputOnly,"elapsedTime",new t.SFTime),new n(s.outputOnly,"duration_changed",new t.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest(this,"set_url__"),this.audio=e("<audio>"),this.audio.error(this.setError.bind(this)),this.audio.bind("abort",this.setError.bind(this)),this.audio.attr("preload","auto"),this.audio.attr("volume",0),this.audio.attr("crossOrigin","anonymous"),this.requestAsyncLoad()},set_url__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.setMedia(null),this.urlStack.setValue(this.url_),this.audio.bind("canplaythrough",this.setAudio.bind(this)),this.loadNext())},loadNext:function(){return 0===this.urlStack.length?(this.duration_changed_=-1,void this.setLoadState(s.FAILED_STATE)):(this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),void this.audio.attr("src",this.URL))},setError:function(){var e=this.URL.toString();this.URL.isLocal()||e.match(a.fallbackRx)||this.urlStack.unshift(a.fallback+e),"data"!==this.URL.scheme&&console.warn("Error loading audio:",this.URL.toString()),this.loadNext()},setAudio:function(){"data"!==this.URL.scheme&&console.info("Done loading audio:",this.URL.toString()),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(s.COMPLETE_STATE)}}),l}),define("cobweb/Components/Navigation/Billboard",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.Billboard),this.matrix=new u}var c=new u,h=new s(0,1,0),d=new s(0,0,1),p=new s(0,0,0),f=new s(0,0,0),g=new s(0,0,0),m=new s(0,0,0),y=new s(0,0,0),b=new a(0,0,1,0);return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"axisOfRotation",new t.SFVec3f(0,1,0)),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},rotate:function(e){try{this.getModelViewMatrix(e,c).inverse();var t=c.origin.normalize();if(this.axisOfRotation_.getValue().equals(s.Zero)){c.multDirMatrix(p.assign(h)).normalize(),f.assign(p).cross(t),g.assign(t).cross(f);var n=t;f.normalize(),g.normalize(),this.matrix.set(f[0],f[1],f[2],0,g[0],g[1],g[2],0,n[0],n[1],n[2],0,0,0,0,1)}else m.assign(this.axisOfRotation_.getValue()).cross(t),y.assign(this.axisOfRotation_.getValue()).cross(d),this.matrix.setRotation(b.setFromToVec(y,m));this.getBrowser().getModelViewMatrix().multLeft(this.matrix)}catch(i){}},traverse:function(e){this.getBrowser().getModelViewMatrix().push(),this.rotate(e),r.prototype.traverse.call(this,e),this.getBrowser().getModelViewMatrix().pop()}}),l}),define("cobweb/Components/EventUtilities/BooleanFilter",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.BooleanFilter)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_boolean",new t.SFBool),new n(o.outputOnly,"inputTrue",new t.SFBool),new n(o.outputOnly,"inputFalse",new t.SFBool),new n(o.outputOnly,"inputNegate",new t.SFBool)]),getTypeName:function(){return"BooleanFilter"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest(this,"set_boolean__")},set_boolean__:function(){var e=this.set_boolean_.getValue();e?this.inputTrue_=!0:this.inputFalse_=!0,this.inputNegate_=!e}}),s}),define("cobweb/Components/EventUtilities/X3DSequencerNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i){function r(e,i){t.call(this,e,i),this.addType(n.X3DSequencerNode),this.index=-1}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.set_fraction_.addInterest(this,"set_fraction__"),this.previous_.addInterest(this,"set_previous__"),this.next_.addInterest(this,"set_next__"),this.key_.addInterest(this,"set_index__")},set_fraction__:function(){var e=this.set_fraction_.getValue(),t=this.key_,n=t.length;if(0!==n){var r=0;if(1===n||e<=t[0])r=0;else if(e>=t[n-1])r=this.getSize()-1;else{var o=i.upperBound(t,0,n,e,i.less);r=o-1}r!==this.index&&r<this.getSize()&&this.sequence(this.index=r)}},set_previous__:function(){this.previous_.getValue()&&(this.index<=0?this.index=this.getSize()-1:--this.index,this.index<this.getSize()&&this.sequence(this.index))},set_next__:function(){this.next_.getValue()&&(this.index>=this.getSize()-1?this.index=0:++this.index,this.index<this.getSize()&&this.sequence(this.index))},set_index__:function(){this.index=-1}}),r}),define("cobweb/Components/EventUtilities/BooleanSequencer",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EventUtilities/X3DSequencerNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.BooleanSequencer)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOnly,"previous",new t.SFBool),new n(o.inputOnly,"next",new t.SFBool),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFBool),new n(o.outputOnly,"value_changed",new t.SFBool)]),getTypeName:function(){return"BooleanSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_index__")},getSize:function(){return this.keyValue_.length},sequence:function(e){this.value_changed_=this.keyValue_[e]}}),s}),define("cobweb/Components/EventUtilities/BooleanToggle",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.BooleanToggle)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_boolean",new t.SFBool),new n(o.inputOutput,"toggle",new t.SFBool)]),getTypeName:function(){return"BooleanToggle"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest(this,"set_boolean__")},set_boolean__:function(){this.set_boolean_.getValue()&&(this.toggle_=!this.toggle_.getValue())}}),s}),define("cobweb/Components/EventUtilities/X3DTriggerNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DTriggerNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/EventUtilities/BooleanTrigger",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EventUtilities/X3DTriggerNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.BooleanTrigger)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_triggerTime",new t.SFTime),new n(o.outputOnly,"triggerTrue",new t.SFBool)]),getTypeName:function(){return"BooleanTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_triggerTime_.addInterest(this,"set_triggerTime__")},set_triggerTime__:function(){this.triggerTrue_=!0}}),s}),define("cobweb/Components/Geometry3D/Box",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Box)}var u=new s(2,2,2);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"size",new t.SFVec3f(2,2,2)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){var e=this.getBrowser().getBoxOptions(),t=e.getGeometry(),n=this.size_.getValue();if(this.setNormals(t.getNormals()),this.setTexCoords(t.getTexCoords()),n.equals(u))this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var i=s.divide(n,2),r=i.x,o=i.y,a=i.z,l=t.getVertices(),c=this.getVertices(),h=0;h<l.length;h+=4)c.push(r*l[h],o*l[h+1],a*l[h+2],1);this.getMin().set(-r,-o,-a),this.getMax().set(r,o,a)}this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null)}}),a}),define("cobweb/Components/CADGeometry/X3DProductStructureChildNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DProductStructureChildNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/CADGeometry/CADAssembly",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Components/CADGeometry/X3DProductStructureChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.CADAssembly)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(s.initializeOnly,"bboxCenter",new t.SFVec3f),new n(s.inputOnly,"addChildren",new t.MFNode),new n(s.inputOnly,"removeChildren",new t.MFNode),new n(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADAssembly"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"}}),a}),define("cobweb/Components/CADGeometry/CADFace",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/CADGeometry/X3DProductStructureChildNode","cobweb/Components/Grouping/X3DBoundedObject","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o,s,a,u){function l(e){this.shapeNode.traverse(e)}function c(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(a.CADFace),this.shapeNode=null}return c.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:c,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"name",new t.SFString),new n(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(a.initializeOnly,"bboxCenter",new t.SFVec3f),new n(a.inputOutput,"shape",new t.SFNode)]),getTypeName:function(){return"CADFace"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),
o.prototype.initialize.call(this),this.shape_.addInterest(this,"set_shape__"),this.set_shape__()},getBBox:function(){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=s(a.X3DBoundedObject,this.shape_);return e?e.getBBox():new u}return new u(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_shape__:function(){this.shapeNode&&this.shapeNode.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.shapeNode=null;try{for(var e=this.shape_.getValue().getInnerNode(),t=e.getType(),n=t.length-1;n>=0;--n)switch(t[n]){case a.LOD:case a.Transform:case a.X3DShapeNode:e.isCameraObject_.addFieldInterest(this.isCameraObject_),this.shapeNode=e;break;default:continue}}catch(i){}this.shapeNode?this.traverse=l:delete this.traverse}}),c}),define("cobweb/Components/CADGeometry/CADLayer",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.CADLayer)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"name",new t.SFString),new n(o.inputOutput,"visible",new t.MFBool),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADLayer"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.visible_.addInterest(this,"set_children__")},getVisible:function(){return this.visible_}}),s}),define("cobweb/Components/Grouping/X3DTransformMatrix4DNode",["jquery","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o){function s(e){var n=this.getBrowser().getModelViewMatrix();n.push(),n.multLeft(this.matrix),t.prototype.traverse.call(this,e),n.pop()}function a(e,i){t.call(this,e,i),this.addType(n.X3DTransformMatrix4DNode),this.matrix=new o}return a.prototype=e.extend(Object.create(t.prototype),{constructor:a,getBBox:function(){var e=t.prototype.getBBox.call(this);return this.traverse===s?e.multRight(this.matrix):e},setTransform:function(e,n,o,a,u){e.equals(i.Zero)&&n.equals(r.Identity)&&o.equals(i.One)?(this.matrix.identity(),this.traverse=t.prototype.traverse):(this.matrix.set(e,n,o,a,u),this.traverse=s)}}),a}),define("cobweb/Components/Grouping/X3DTransformNode",["jquery","cobweb/Components/Grouping/X3DTransformMatrix4DNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DTransformNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.addInterest(this,"eventsProcessed"),this.eventsProcessed()},eventsProcessed:function(){t.prototype.eventsProcessed.call(this),this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),i}),define("cobweb/Components/CADGeometry/CADPart",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DTransformNode","cobweb/Components/CADGeometry/X3DProductStructureChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.CADPart)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"translation",new t.SFVec3f),new n(s.inputOutput,"rotation",new t.SFRotation),new n(s.inputOutput,"scale",new t.SFVec3f(1,1,1)),new n(s.inputOutput,"scaleOrientation",new t.SFRotation),new n(s.inputOutput,"center",new t.SFVec3f),new n(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(s.initializeOnly,"bboxCenter",new t.SFVec3f),new n(s.inputOnly,"addChildren",new t.MFNode),new n(s.inputOnly,"removeChildren",new t.MFNode),new n(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADPart"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this)}}),a}),define("cobweb/Components/Geometry2D/Circle2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Circle2D)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"radius",new t.SFFloat(1))]),getTypeName:function(){return"Circle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getCircle2DOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getCircle2DOptions().removeInterest(this,"eventsProcessed")},build:function(){var e=this.getBrowser().getCircle2DOptions(),t=this.radius_.getValue(),n=e.getVertices(),i=this.getVertices();if(1===t)this.setVertices(n);else for(var r=0,o=n.length;o>r;r+=4)i.push(n[r]*t,n[r+1]*t,0,1);this.getMin().set(-t,-t,0),this.getMax().set(t,t,0)}}),a}),define("cobweb/Components/Rendering/ClipPlane",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],function(e,t,n,i,r,o,s,a,u,l){function c(e){this.plane=new u(d,d),this.set(e)}function h(e){r.call(this,e.getBrowser(),e),this.addType(o.ClipPlane),this.enabled=!1,this.plane=new a(0,0,0,0)}var d=new s(0,0,0),p=new u(d,d),f=l(c);return c.prototype={constructor:c,isClipped:function(e,t){try{var n=p.assign(this.plane).multRight(t).getDistanceToPoint(e);return 0>n}catch(i){return!1}},set:function(e){var t=this.plane,n=e.plane;t.normal.assign(n),t.distanceFromOrigin=-n.w,t.multRight(e.getBrowser().getModelViewMatrix().get())},use:function(e,t,n){var i=this.plane,r=i.normal;e.uniform4f(t.clipPlane[n],r.x,r.y,r.z,i.distanceFromOrigin)},recycle:function(){f.push(this)}},h.prototype=e.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.inputOutput,"plane",new t.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.plane_.addInterest(this,"set_enabled__"),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this.plane_.getValue()),this.enabled=this.enabled_.getValue()&&!this.plane.equals(a.Zero)},push:function(){this.enabled&&this.getCurrentLayer().getClipPlanes().push(f.pop(this))},pop:function(){this.enabled&&this.getBrowser().getClipPlanes().push(this.getCurrentLayer().getClipPlanes().pop())}}),h}),define("cobweb/Components/Navigation/Collision",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Components/Core/X3DSensorNode","cobweb/Bits/X3DCast","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(u.Collision),this.addAlias("collide",this.enabled_)}return l.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new n(u.inputOutput,"metadata",new t.SFNode),new n(u.inputOutput,"enabled",new t.SFBool(!0)),new n(u.outputOnly,"isActive",new t.SFBool),new n(u.outputOnly,"collideTime",new t.SFTime),new n(u.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(u.initializeOnly,"bboxCenter",new t.SFVec3f),new n(u.initializeOnly,"proxy",new t.SFNode),new n(u.inputOnly,"addChildren",new t.MFNode),new n(u.inputOnly,"removeChildren",new t.MFNode),new n(u.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.enabled_.addInterest(this,"set_live__"),this.proxy_.addInterest(this,"set_proxy__"),this.set_live__(),this.set_proxy__()},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()&&this.enabled_.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(e){this.isActive_.getValue()!==e&&(this.isActive_=e,e&&(this.collideTime_=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=s(u.X3DChildNode,this.proxy_)},traverse:function(e){switch(e){case a.COLLISION:if(this.enabled_.getValue()){var t=this.getBrowser().getCollisions();t.push(this),this.proxyNode?this.proxyNode.traverse(e):r.prototype.traverse.call(this,e),t.pop()}break;default:r.prototype.traverse.call(this,e)}}}),l}),define("cobweb/Components/Rendering/X3DColorNode",["jquery","cobweb/Components/Rendering/X3DGeometricPropertyNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DColorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Rendering/Color",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DColorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Color),this.color=this.color_.getValue()}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"color",new t.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},isTransparent:function(){return!1},getColor:function(e){return e>=0&&e<this.color.length?this.color[e].getValue():new s(1,1,1)}}),a}),define("cobweb/Components/Followers/X3DFollowerNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,copy:function(e){return e.copy()},getBuffer:function(){return this.buffer},getValue:function(){return this.set_value_.getValue()},getDestination:function(){return this.set_destination_.getValue()},getInitialValue:function(){return this.initialValue_.getValue()},getInitialDestination:function(){return this.initialDestination_.getValue()},setValue:function(e){this.value_changed_=e},assign:function(e,t,n){e[t].assign(n)},equals:function(e,t,n){return this.a.assign(e).subtract(t).abs()<n},interpolate:function(e,t,n){return this.vector.assign(e).lerp(t,n)},set_active:function(e){e!==this.isActive_.getValue()&&(this.isActive_=e,this.isActive_.getValue()?(this.getBrowser().prepareEvents().addInterest(this,"prepareEvents"),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest(this,"prepareEvents"))}}),i}),define("cobweb/Components/Followers/X3DChaserNode",["jquery","cobweb/Components/Followers/X3DFollowerNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getArray()}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.set_value_.addInterest(this,"set_value__"),this.set_destination_.addInterest(this,"set_destination__"),this.duration_.addInterest(this,"set_duration__"),this.set_duration__();var e=this.getBuffer(),n=this.getInitialValue(),i=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.copy(n),e[0]=this.copy(i);for(var o=1;r>o;++o)e[o]=this.copy(n);this.destination=this.copy(i),this.equals(i,n,this.getTolerance())?this.setValue(i):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(e){this.previousValue.assign(e)},step:function(e,t,n){this.output.add(this.deltaOut.assign(e).subtract(t).multiply(n))},stepResponse:function(e){if(0>=e)return 0;var t=this.duration_.getValue();return e>=t?1:.5-.5*Math.cos(e/t*Math.PI)},set_value__:function(){this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var e=this.getBuffer(),t=this.getValue(),n=1,i=e.length;i>n;++n)this.assign(e,n,t);this.setPreviousValue(t),this.setValue(t),this.set_active(!0)},set_destination__:function(){this.destination=this.copy(this.getDestination()),this.bufferEndTime=this.getBrowser().getCurrentTime(),this.set_active(!0)},set_duration__:function(){this.stepTime=this.duration_.getValue()/this.getNumBuffers()},prepareEvents:function(){var e=this.getBuffer(),t=e.length,n=this.updateBuffer();this.output=this.interpolate(this.previousValue,e[t-1],this.stepResponse((t-1+n)*this.stepTime));for(var i=t-2;i>=0;--i)this.step(e[i],e[i+1],this.stepResponse((i+n)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)},updateBuffer:function(){var e=this.getBuffer(),t=e.length,n=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(n>=1){var i=Math.floor(n);if(n-=i,t>i){this.setPreviousValue(e[t-i]);for(var r=t-1;r>=i;--r)this.assign(e,r,e[r-i]);for(var r=0;i>r;++r){var o=r/i;this.assign(e,r,this.interpolate(this.destination,e[i],o))}}else{this.setPreviousValue(i==t?e[0]:this.destination);for(var r=0;t>r;++r)this.assign(e,r,this.destination)}this.bufferEndTime+=i*this.stepTime}return n}}),i}),define("cobweb/Components/Followers/ColorChaser",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.ColorChaser)}var c=new a(0,0,0),h=new a(0,0,0),d=new a(0,0,0),p=new a(0,0,0);return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFColor),new n(o.inputOnly,"set_destination",new t.SFColor),new n(o.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new n(o.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new n(o.initializeOnly,"duration",new t.SFTime(1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(p)},getDestination:function(){return this.set_destination_.getValue().getHSV(p)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(c)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(h)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},interpolate:function(e,t,n){return s.lerp(e,t,n,p)},step:function(e,t,n){d.assign(this.output).add(e).subtract(t),s.lerp(this.output,d,n,this.output)}}),l}),define("cobweb/Components/Followers/X3DDamperNode",["jquery","cobweb/Components/Followers/X3DFollowerNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i){function r(e,i){t.call(this,e,i),this.addType(n.X3DDamperNode)}return r.prototype=e.extend(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.order_.addInterest(this,"set_order__"),this.set_value_.addInterest(this,"set_value__"),this.set_destination_.addInterest(this,"set_destination__");var e=this.getBuffer(),n=this.getInitialValue(),i=this.getInitialDestination();e[0]=this.copy(i);for(var r=1,o=this.getOrder()+1;o>r;++r)e[r]=this.copy(n);this.equals(i,n,this.getTolerance())?this.setValue(i):this.set_active(!0)},getOrder:function(){return i.clamp(this.order_.getValue(),0,5)},getTolerance:function(){return this.tolerance_.getValue()<0?1e-8:this.tolerance_.getValue()},prepareEvents:function(){var e=this.getBuffer(),t=e.length-1;if(this.tau_.getValue()){for(var n=1/this.getBrowser().currentFrameRate,i=Math.exp(-n/this.tau_.getValue()),r=0;t>r;++r)this.assign(e,r+1,this.interpolate(e[r],e[r+1],i));if(this.setValue(e[t]),!this.equals(e[t],e[0],this.getTolerance()))return}else this.setValue(e[0]),t=0;for(var r=1,o=e.length;o>r;++r)this.assign(e,r,e[t]);this.set_active(!1)},set_value__:function(){for(var e=this.getBuffer(),t=this.getValue(),n=1,i=e.length;i>n;++n)this.assign(e,n,t);this.setValue(t),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var e=this.getBuffer(),t=e[e.length-1],n=e.length,i=this.getOrder()+1;i>n;++n)e[n]=this.copy(t);e.length=i}}),r}),define("cobweb/Components/Followers/ColorDamper",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(o.ColorDamper)}var l=new a(0,0,0),c=new a(0,0,0),h=new a(0,0,0),d=new a(0,0,0);return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFColor),new n(o.inputOnly,"set_destination",new t.SFColor),new n(o.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new n(o.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new n(o.initializeOnly,"order",new t.SFInt32(3)),new n(o.inputOutput,"tau",new t.SFTime(.3)),new n(o.inputOutput,"tolerance",new t.SFFloat(-1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(d)},getDestination:function(){return this.set_destination_.getValue().getHSV(d)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(c)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(h)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},equals:function(e,t,n){return l.assign(e).subtract(t).abs()<n},interpolate:function(e,t,n){return s.lerp(e,t,n,d)}}),u}),define("cobweb/Components/Interpolation/ColorInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.ColorInterpolator),this.hsv=[]}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFColor),new n(o.outputOnly,"value_changed",new t.SFColor)]),value:[],getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.keyValue_.getValue();e.length<this.key_.length&&this.keyValue_.resize(this.key_.length,e.length?e[this.keyValue_.length-1]:new t.SFColor),this.hsv.length=0;for(var n=0,i=e.length;i>n;++n)this.hsv.push(e[n].getHSV([]))},interpolate:function(e,t,n){var i=s.lerp(this.hsv[e],this.hsv[t],n,this.value);this.value_changed_.setHSV(i[0],i[1],i[2])}}),a}),define("cobweb/Components/Rendering/ColorRGBA",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DColorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color4"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.ColorRGBA),this.color=this.color_.getValue()}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"color",new t.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},isTransparent:function(){return!0},getColor:function(e){return e>=0&&e<this.color.length?this.color[e].getValue():new s(1,1,1,1)}}),a}),define("cobweb/Components/CubeMapTexturing/X3DEnvironmentTextureNode",["jquery","cobweb/Components/Texturing/X3DTextureNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DEnvironmentTextureNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/CubeMapTexturing/ComposedCubeMapTexture",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/CubeMapTexturing/X3DEnvironmentTextureNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.ComposedCubeMapTexture),this.textures=[null,null,null,null,null,null]}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"front",new t.SFNode),new n(s.inputOutput,"back",new t.SFNode),new n(s.inputOutput,"left",new t.SFNode),new n(s.inputOutput,"right",new t.SFNode),new n(s.inputOutput,"bottom",new t.SFNode),new n(s.inputOutput,"top",new t.SFNode)]),getTypeName:function(){return"ComposedCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.target=e.TEXTURE_CUBE_MAP,this.targets=[e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y],this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.front_.addInterest(this,"set_texture__",0),this.back_.addInterest(this,"set_texture__",1),this.left_.addInterest(this,"set_texture__",2),this.right_.addInterest(this,"set_texture__",3),this.top_.addInterest(this,"set_texture__",5),this.bottom_.addInterest(this,"set_texture__",4),this.set_texture__(this.front_,0),this.set_texture__(this.back_,1),this.set_texture__(this.left_,2),this.set_texture__(this.right_,3),this.set_texture__(this.top_,4),this.set_texture__(this.bottom_,5),this.set_live__()},getTarget:function(){return this.target},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?(this.getBrowser().getBrowserOptions().TextureQuality_.addInterest(this,"set_textureQuality__"),this.set_textureQuality__()):this.getBrowser().getBrowserOptions().TextureQuality_.removeInterest(this,"set_textureQuality__")},set_textureQuality__:function(){var e=this.getBrowser().getDefaultTextureProperties();this.updateTextureProperties(this.target,!1,e,128,128,!1,!1,!1)},set_texture__:function(e,t){this.textures[t]&&this.textures[t].loadState_.removeInterest(this,"setTexture");var n=this.textures[t]=o(s.X3DTexture2DNode,e);n&&n.loadState_.addInterest(this,"setTexture",t,n),this.setTexture(null,t,n)},setTexture:function(e,t,n){var i=this.getBrowser().getContext(),r=this.targets[t];if(this.set_transparent__(),n&&n.checkLoadState()==s.COMPLETE_STATE){var i=this.getBrowser().getContext(),o=n.getWidth(),a=n.getHeight(),u=n.getData();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!n.getFlipY()),i.pixelStorei(i.UNPACK_ALIGNMENT,1),i.bindTexture(i.TEXTURE_CUBE_MAP,this.getTexture()),i.texImage2D(r,0,i.RGBA,o,a,!1,i.RGBA,i.UNSIGNED_BYTE,u),i.bindTexture(i.TEXTURE_CUBE_MAP,null),this.set_textureQuality__()}else i.bindTexture(this.target,this.getTexture()),i.texImage2D(r,0,i.RGBA,1,1,!1,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),i.bindTexture(this.target,null)},set_transparent__:function(){for(var e=this.textures,t=!1,n=0;6>n;++n){var i=e[n];if(i&&i.transparent_.getValue()){t=!0;break}}t!==this.transparent_.getValue()&&(this.transparent_=t)},traverse:function(e,t,n){t.textureTypeArray[n]=4,e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_CUBE_MAP,this.getTexture()),e.uniform1iv(t.textureType,t.textureTypeArray)}}),a}),define("cobweb/Components/Geometry3D/Cone",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.Cone)}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"side",new t.SFBool(!0)),new n(o.initializeOnly,"bottom",new t.SFBool(!0)),new n(o.initializeOnly,"height",new t.SFFloat(2)),new n(o.initializeOnly,"bottomRadius",new t.SFFloat(1)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getConeOptions().removeInterest(this,"eventsProcessed")},build:function(){var e=this.getBrowser().getConeOptions(),t=e.vDimension_.getValue(),n=this.height_.getValue(),i=this.bottomRadius_.getValue(),r=[],o=this.getNormals(),l=this.getVertices();this.getTexCoords().push(r);var c=n/2,h=-c,d=s.Polar(1,-Math.PI/2+Math.atan(i/n));if(this.side_.getValue())for(var p=0;t>p;++p){var f=(p+.5)/t,g=2*Math.PI*f,m=s.Polar(d.imag,g),y=p/t,b=2*Math.PI*y,w=s.Polar(-i,b),v=s.Polar(d.imag,b),x=(p+1)/t,_=2*Math.PI*x,C=s.Polar(-i,_),S=s.Polar(d.imag,_);r.push(f,1,0,1),o.push(m.imag,d.real,m.real),l.push(0,c,0,1),r.push(y,0,0,1),o.push(v.imag,d.real,v.real),l.push(w.imag,h,w.real,1),r.push(x,0,0,1),o.push(S.imag,d.real,S.real),l.push(C.imag,h,C.real,1)}if(this.bottom_.getValue()){for(var T=[],F=[],p=t-1;p>-1;--p){var O=p/t,N=2*Math.PI*O,V=s.Polar(-1,N),D=s.multiply(V,i);T.push(new a((V.imag+1)/2,(V.real+1)/2)),F.push(new u(D.imag,h,D.real))}for(var M=T[0],B=F[0],p=1,E=F.length-1;E>p;++p){var I=T[p],A=T[p+1],P=F[p],w=F[p+1];r.push(M.x,M.y,0,1),o.push(0,-1,0),l.push(B.x,B.y,B.z,1),r.push(I.x,I.y,0,1),o.push(0,-1,0),l.push(P.x,P.y,P.z,1),r.push(A.x,A.y,0,1),o.push(0,-1,0),l.push(w.x,w.y,w.z,1)}}this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null),this.setNormals(o),this.setExtents()},setExtents:function(){var e=this.bottomRadius_.getValue(),t=this.height_.getValue()/2,n=-t;this.side_.getValue()||this.bottom_.getValue()?this.side_.getValue()?(this.getMin().set(-e,n,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,n,-e),this.getMax().set(e,n,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),l}),define("cobweb/Browser/Followers/X3DArrayFollowerTemplate",[],function(){return function(e){function t(){this.array=this.getArray()}return t.prototype={getValue:function(){return this.set_value_},getDestination:function(){return this.set_destination_},getInitialValue:function(){return this.initialValue_},getInitialDestination:function(){return this.initialDestination_},assign:function(e,t,n){e[t].setValue(n)},equals:function(e,t,n){for(var i=this.a,r=e.getValue(),o=t.getValue(),s=0,a=0,u=r.length;u>a;++a)s=Math.max(i.assign(r[a].getValue()).subtract(o[a].getValue()).abs());return n>s},interpolate:function(e,t,n){var i=this.array.getValue(),r=e.getValue(),o=t.getValue();this.array.length=r.length;for(var s=0,a=r.length;a>s;++s)i[s].getValue().assign(r[s].getValue()).lerp(o[s].getValue(),n);return this.array},set_value__:function(){this.getBuffer()[0].length=this.set_value_.length,e.prototype.set_value__.call(this)},set_destination__:function(){for(var t=this.getBuffer(),n=this.set_destination_.length,i=0,r=t.length;r>i;++i)t[i].length=n;e.prototype.set_destination__.call(this)}},t}}),define("cobweb/Browser/Followers/X3DArrayChaserTemplate",["jquery","cobweb/Browser/Followers/X3DArrayFollowerTemplate"],function(e,t){return function(n){function i(){this.array=this.getArray()}return i.prototype=e.extend(Object.create(t(n).prototype),{setPreviousValue:function(e){this.previousValue.setValue(e)},step:function(e,t,n){var i=this.output.getValue(),r=this.deltaOut.getValue();e=e.getValue(),t=t.getValue(),this.deltaOut.length=i.length;for(var o=0,s=i.length;s>o;++o)i[o].getValue().add(r[o].getValue().assign(e[o].getValue()).subtract(t[o].getValue()).multiply(n))}}),i}}),define("cobweb/Components/Followers/CoordinateChaser",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Browser/Followers/X3DArrayChaserTemplate","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),l.call(this,e.getBrowser(),e),this.addType(s.CoordinateChaser)}var l=o(r);return u.prototype=e.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_value",new t.MFVec3f),new n(s.inputOnly,"set_destination",new t.MFVec3f),new n(s.initializeOnly,"initialValue",new t.MFVec3f(new a(0,0,0))),new n(s.initializeOnly,"initialDestination",new t.MFVec3f(new a(0,0,0))),new n(s.initializeOnly,"duration",new t.SFTime(1)),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){
return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new t.MFVec3f}}),u}),define("cobweb/Components/Followers/CoordinateDamper",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Browser/Followers/X3DArrayFollowerTemplate","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),l.call(this,e.getBrowser(),e),this.addType(s.CoordinateDamper)}var l=o(r);return u.prototype=e.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_value",new t.MFVec3f),new n(s.inputOnly,"set_destination",new t.MFVec3f),new n(s.initializeOnly,"initialValue",new t.MFVec3f(new a(0,0,0))),new n(s.initializeOnly,"initialDestination",new t.MFVec3f(new a(0,0,0))),new n(s.initializeOnly,"order",new t.SFInt32(3)),new n(s.inputOutput,"tau",new t.SFTime(.3)),new n(s.inputOutput,"tolerance",new t.SFFloat(-1)),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new t.MFVec3f}}),u}),define("cobweb/Components/NURBS/CoordinateDouble",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DCoordinateNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.CoordinateDouble)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec3d)]),getTypeName:function(){return"CoordinateDouble"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"coord"}}),s}),define("cobweb/Components/Interpolation/CoordinateInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.CoordinateInterpolator)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFVec3f),new n(o.outputOnly,"value_changed",new t.MFVec3f)]),keyValue:new s(0,0,0),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,n){var i=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length>1?Math.floor(i.length/this.key_.length):0;e*=o,t=e+o,this.value_changed_.length=o;for(var s=0;o>s;++s)r[s].getValue().assign(i[e+s].getValue()).lerp(i[t+s].getValue(),n);this.value_changed_.addEvent()}}),a}),define("cobweb/Components/Interpolation/CoordinateInterpolator2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.CoordinateInterpolator2D)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFVec2f),new n(o.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,n){var i=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length>1?Math.floor(this.keyValue_.length/this.key_.length):0;e*=o,t=e+o,this.value_changed_.length=o;for(var s=0;o>s;++s)r[s].getValue().assign(i[e+s].getValue()).lerp(i[t+s].getValue(),n);this.value_changed_.addEvent()}}),a}),define("cobweb/Components/Geometry3D/Cylinder",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.Cylinder)}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"top",new t.SFBool(!0)),new n(o.initializeOnly,"side",new t.SFBool(!0)),new n(o.initializeOnly,"bottom",new t.SFBool(!0)),new n(o.initializeOnly,"height",new t.SFFloat(2)),new n(o.initializeOnly,"radius",new t.SFFloat(1)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getCylinderOptions().removeInterest(this,"eventsProcessed")},build:function(){var e=this.getBrowser().getCylinderOptions(),t=e.vDimension_.getValue(),n=[],i=this.getNormals(),r=this.getVertices();this.getTexCoords().push(n);var o=this.radius_.getValue(),l=this.height_.getValue()/2,c=-l;if(this.side_.getValue())for(var h=0;t>h;++h){var d=h/t,p=2*Math.PI*d,f=s.Polar(-1,p),g=s.multiply(f,o),m=(h+1)/t,y=2*Math.PI*m,b=s.Polar(-1,y),w=s.multiply(b,o);n.push(d,1,0,1),i.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),n.push(d,0,0,1),i.push(f.imag,0,f.real),r.push(g.imag,c,g.real,1),n.push(m,0,0,1),i.push(b.imag,0,b.real),r.push(w.imag,c,w.real,1),n.push(d,1,0,1),i.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),n.push(m,0,0,1),i.push(b.imag,0,b.real),r.push(w.imag,c,w.real,1),n.push(m,1,0,1),i.push(b.imag,0,b.real),r.push(w.imag,l,w.real,1)}if(this.top_.getValue()){for(var v=[],x=[],h=0;t>h;++h){var _=h/t,C=2*Math.PI*_,S=s.Polar(-1,C);v.push(new a((S.imag+1)/2,-(S.real-1)/2)),x.push(new u(S.imag*o,l,S.real*o))}for(var T=v[0],F=x[0],h=1,O=x.length-1;O>h;++h){var N=v[h],V=v[h+1],g=x[h],w=x[h+1];n.push(T.x,T.y,0,1),i.push(0,1,0),r.push(F.x,F.y,F.z,1),n.push(N.x,N.y,0,1),i.push(0,1,0),r.push(g.x,g.y,g.z,1),n.push(V.x,V.y,0,1),i.push(0,1,0),r.push(w.x,w.y,w.z,1)}}if(this.bottom_.getValue()){for(var v=[],x=[],h=t-1;h>-1;--h){var _=h/t,C=2*Math.PI*_,S=s.Polar(-1,C);v.push(new a((S.imag+1)/2,(S.real+1)/2)),x.push(new u(S.imag*o,c,S.real*o))}for(var T=v[0],F=x[0],h=1,O=x.length-1;O>h;++h){var N=v[h],V=v[h+1],g=x[h],w=x[h+1];n.push(T.x,T.y,0,1),i.push(0,-1,0),r.push(F.x,F.y,F.z,1),n.push(N.x,N.y,0,1),i.push(0,-1,0),r.push(g.x,g.y,g.z,1),n.push(V.x,V.y,0,1),i.push(0,-1,0),r.push(w.x,w.y,w.z,1)}}this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null),this.setNormals(i),this.setExtents()},setExtents:function(){var e=this.radius_.getValue(),t=this.height_.getValue()/2,n=-t;this.top_.getValue()||this.side_.getValue()||this.bottom_.getValue()?this.top_.getValue()||this.side_.getValue()?this.bottom_.getValue()||this.side_.getValue()?(this.getMin().set(-e,n,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,t,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,n,-e),this.getMax().set(e,n,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),l}),define("cobweb/Components/PointingDeviceSensor/X3DDragSensorNode",["jquery","cobweb/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DDragSensorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,set_motion__:function(e){}}),i}),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],function(e,t,n,i){function r(e,t){this.axis=e.copy(),this.radius=t}return r.prototype={constructor:r,intersectsLine:function(r,o,s){var a=new t(this.axis.direction,new e(0,1,0)),u=n.Rotation(a),l=1/this.radius,c=new n;c.scale(new e(l,l,l)),c.multLeft(u);var h=e.subtract(r.point,this.axis.point),d=new i(h,r.direction),p=d.multLineMatrix(c),f=this.unitCylinderIntersectsLine(p,o,s);if(f){var g=c.inverse();g.multVecMatrix(o),o.add(this.axis.point),g.multVecMatrix(s),s.add(this.axis.point)}return f},unitCylinderIntersectsLine:function(e,t,n){var i,r,o=e.point,s=e.direction,a=s[0]*s[0]+s[2]*s[2],u=2*(o[0]*s[0]+o[2]*s[2]),l=o[0]*o[0]+o[2]*o[2]-1,c=u*u-4*a*l;if(0>c)return!1;var h=Math.sqrt(c);return u>0?(i=-(2*l)/(h+u),r=-(h+u)/(2*a)):(i=2*l/(h-u),r=(h-u)/(2*a)),t.assign(s).multiply(i).add(o),n.assign(s).multiply(r).add(o),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r}),define("cobweb/Components/PointingDeviceSensor/CylinderSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/PointingDeviceSensor/X3DDragSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l,c,h,d){function p(e){r.call(this,e.getBrowser(),e),this.addType(o.CylinderSensor)}return p.prototype=e.extend(Object.create(r.prototype),{constructor:p,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.inputOutput,"description",new t.SFString),new n(o.inputOutput,"axisRotation",new t.SFRotation),new n(o.inputOutput,"diskAngle",new t.SFFloat(.261799)),new n(o.inputOutput,"minAngle",new t.SFFloat),new n(o.inputOutput,"maxAngle",new t.SFFloat(-1)),new n(o.inputOutput,"offset",new t.SFFloat),new n(o.inputOutput,"autoOffset",new t.SFBool(!0)),new n(o.outputOnly,"trackPoint_changed",new t.SFVec3f),new n(o.outputOnly,"rotation_changed",new t.SFRotation),new n(o.outputOnly,"isOver",new t.SFBool),new n(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.cylinder=new h(new l(new s(0,0,0),new s(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startOffset=new a(0,0,1,0)},isBehind:function(e,t){var n=new s(0,0,0),i=new s(0,0,0);return this.cylinder.intersectsLine(e,n,i),s.subtract(t,n).abs()>s.subtract(t,i).abs()},getTrackPoint:function(e,t){var n=new s(0,0,0);this.zPlane.intersectsLine(e,n);var i=s.add(n,this.cylinder.axis.getPerpendicularVector(n)),r=this.sxPlane.getDistanceToPoint(n)/this.cylinder.radius,o=Math.floor((r+1)/2),u=d.interval(r,-1,1),l=0===o?Math.asin(u):u*Math.PI/2,c=l+o*Math.PI,h=new a(this.cylinder.axis.direction,c);h.multVecRot(t.assign(this.szNormal).multiply(this.cylinder.radius)),t.add(i)},getAngle:function(e){return s.dot(e.getAxis(),this.cylinder.axis.direction)>0?e.angle:-e.angle},set_active__:function(e,t){r.prototype.set_active__.call(this,e,t);try{if(this.isActive_.getValue()){var n=this.getMatrices()[e.layer.getId()];this.modelViewMatrix.assign(n.modelViewMatrix),this.invModelViewMatrix.assign(this.modelViewMatrix).inverse();var i=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),o=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),u=this.axisRotation_.getValue().multVecRot(new s(0,1,0)),d=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize(),p=new l(new s(0,0,0),u),f=p.getPerpendicularVector(o).abs();this.cylinder=new h(p,f),this.disk=Math.abs(s.dot(d,u))>Math.cos(this.diskAngle_.getValue()),this.behind=this.isBehind(i,o),this.yPlane=new c(o,u),this.zPlane=new c(o,d);var g=this.invModelViewMatrix.origin,m=s.cross(u,g).normalize();this.sxPlane=new c(new s(0,0,0),m),this.szNormal=s.cross(m,u).normalize();var y=new s(0,0,0);this.disk?this.yPlane.intersectsLine(i,y):this.getTrackPoint(i,y),this.fromVector=this.cylinder.axis.getPerpendicularVector(y).negate(),this.startOffset=new a(u,this.offset_.getValue())}else this.autoOffset_.getValue()&&(this.offset_=this.getAngle(this.rotation_changed_.getValue()))}catch(b){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new s(0,0,0);this.disk?this.yPlane.intersectsLine(t,n):this.getTrackPoint(t,n),this.trackPoint_changed_=n;var i=this.cylinder.axis.getPerpendicularVector(n).negate(),r=new a(this.fromVector,i);if(this.disk){var o=this.modelViewMatrix.multVecMatrix(n.copy());o.z>0&&r.multRight(new a(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this.minAngle_.getValue()>this.maxAngle_.getValue())this.rotation_changed_=r;else{var u=d.interval(this.getAngle(r),-Math.PI,Math.PI),l=d.interval(this.minAngle_.getValue(),-Math.PI,Math.PI),c=d.interval(this.maxAngle_.getValue(),-Math.PI,Math.PI);l>u?r.setAxisAngle(this.cylinder.axis.direction,l):u>c&&r.setAxisAngle(this.cylinder.axis.direction,c),this.rotation_changed_.getValue().equals(r)||(this.rotation_changed_=r)}}catch(h){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),p}),define("cobweb/Components/Geometry2D/Disk2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a){function u(e){o.call(this,e.getBrowser(),e),this.addType(s.Disk2D),this.lineGeometry=!1}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"innerRadius",new t.SFFloat),new n(s.inputOutput,"outerRadius",new t.SFFloat(1)),new n(s.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Disk2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getDisk2DOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getDisk2DOptions().removeInterest(this,"eventsProcessed")},isLineGeometry:function(){return this.lineGeometry},build:function(){var e=this.getBrowser().getDisk2DOptions(),t=this.innerRadius_.getValue(),n=this.outerRadius_.getValue();if(t===n){var i=Math.abs(n),r=e.getCircleVertices(),o=this.getVertices();if(1===i)this.setVertices(r);else for(var s=0,a=r.length;a>s;s+=4)o.push(r[s]*i,r[s+1]*i,0,1);return this.getMin().set(-i,-i,0),this.getMax().set(i,i,0),void(this.lineGeometry=!0)}if(0===t||0===n){var i=Math.abs(Math.max(t,n)),u=this.getNormals(),r=e.getDiskVertices(),o=this.getVertices();if(this.getTexCoords().push(e.getDiskTexCoords()),this.setNormals(e.getDiskNormals()),1===i)this.setVertices(r);else for(var s=0,a=r.length;a>s;s+=4)o.push(r[s]*i,r[s+1]*i,0,1);return this.getMin().set(-i,-i,0),this.getMax().set(i,i,0),this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null),void(this.lineGeometry=!1)}var l=Math.abs(Math.max(t,n)),c=Math.abs(Math.min(t,n)),h=c/l,d=(1-h)/2,p=e.getDiskTexCoords(),f=[],u=this.getNormals(),g=e.getDiskVertices(),m=this.getVertices();this.getTexCoords().push(f);for(var s=0,a=g.length;a>s;s+=12)f.push(p[s+4]*h+d,p[s+5]*h+d,0,1,p[s+4],p[s+5],0,1,p[s+8],p[s+9],0,1,p[s+4]*h+d,p[s+5]*h+d,0,1,p[s+8],p[s+9],0,1,p[s+8]*h+d,p[s+9]*h+d,0,1),u.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1),m.push(g[s+4]*c,g[s+5]*c,0,1,g[s+4]*l,g[s+5]*l,0,1,g[s+8]*l,g[s+9]*l,0,1,g[s+4]*c,g[s+5]*c,0,1,g[s+8]*l,g[s+9]*l,0,1,g[s+8]*c,g[s+9]*c,0,1);this.getMin().set(-l,-l,0),this.getMax().set(l,l,0),this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null),this.lineGeometry=!1},traverse:function(e){if(this.isLineGeometry())o.prototype.traverse.call(this,e);else{var t=this.getBrowser(),n=t.getContext(),i=t.getShader();i.use(),n.uniform1i(i.geometryType,2),r.prototype.traverse.call(this,e),n.uniform1i(i.geometryType,3)}}}),u}),define("cobweb/Components/Geometry3D/ElevationGrid",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(s.ElevationGrid),this.attribNodes=[],this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.initializeOnly,"xDimension",new t.SFInt32),new n(s.initializeOnly,"zDimension",new t.SFInt32),new n(s.initializeOnly,"xSpacing",new t.SFFloat(1)),new n(s.initializeOnly,"zSpacing",new t.SFFloat(1)),new n(s.initializeOnly,"solid",new t.SFBool(!0)),new n(s.initializeOnly,"ccw",new t.SFBool(!0)),new n(s.initializeOnly,"creaseAngle",new t.SFFloat),new n(s.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(s.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(s.inputOutput,"attrib",new t.MFNode),new n(s.inputOutput,"fogCoord",new t.SFNode),new n(s.inputOutput,"color",new t.SFNode),new n(s.inputOutput,"texCoord",new t.SFNode),new n(s.inputOutput,"normal",new t.SFNode),new n(s.inputOutput,"height",new t.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest(this,"set_attrib__"),this.color_.addInterest(this,"set_color__"),this.texCoord_.addInterest(this,"set_texCoord__"),this.normal_.addInterest(this,"set_normal__"),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].removeInterest(this,"addNodeEvent");this.attribNodes.length=0;for(var e=0,t=this.attrib_.length;t>e;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&this.attribNodes.push(n)}for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].addInterest(this,"addNodeEvent")},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest(this,"addNodeEvent"),this.colorNode.removeInterest(this,"set_transparent__")),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest(this,"addNodeEvent"),this.colorNode.addInterest(this,"set_transparent__"),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest(this,"addNodeEvent"),this.texCoordNode=o(s.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest(this,"addNodeEvent")},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest(this,"addNodeEvent"),this.normalNode=o(s.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest(this,"addNodeEvent")},getAttrib:function(){return this.attribNodes},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(e){return e<this.height_.length?this.height_[e]:0},createTexCoords:function(){for(var e=[],t=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=t-1,r=n-1,o=0;n>o;++o)for(var s=0;t>s;++s)e.push(new u(s/i,o/r));return e},createNormals:function(e,t,n){for(var i=!this.ccw_.getValue(),r=[],o=[],s=0;s<e.length;++s)r[s]=[];for(var u=0;u<t.length;u+=3){var c=t[u],h=t[u+1],d=t[u+2];r[c].push(o.length),r[h].push(o.length+1),r[d].push(o.length+2);var p=a.normal(e[c],e[h],e[d],new l(0,0,0));i&&p.negate(),o.push(p),o.push(p),o.push(p)}return this.refineNormals(r,o,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var e=[],t=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=t-1,r=n-1,o=0;r>o;++o)for(var s=0;i>s;++s){var a=o*t+s,u=(o+1)*t+s,l=(o+1)*t+(s+1),c=o*t+(s+1);e.push(a),e.push(u),e.push(l),e.push(a),e.push(l),e.push(c)}return e},createPoints:function(){for(var e=[],t=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=this.xSpacing_.getValue(),r=this.zSpacing_.getValue(),o=0;n>o;++o)for(var s=0;t>s;++s)e.push(new l(i*s,this.getHeight(s+o*t),r*o));return e},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var e=this.colorPerVertex_.getValue(),t=this.normalPerVertex_.getValue(),n=this.createCoordIndex(),i=this.getColor(),r=this.getTexCoord(),o=this.getNormal(),s=this.createPoints(),a=0;if(r)r.init(this.getTexCoords());else{var u=this.createTexCoords();this.getTexCoords().push([])}for(var l=0;l<n.length;++a)for(var c=0;6>c;++c,++l){var h=n[l];if(i&&(e?this.addColor(i.getColor(h)):this.addColor(i.getColor(a))),r)r.addTexCoord(this.getTexCoords(),h);else{var d=u[h];this.getTexCoords()[0].push(d.x,d.y,0,1)}o&&(t?this.addNormal(o.getVector(h)):this.addNormal(o.getVector(a))),this.addVertex(s[h])}if(!o)for(var p=this.createNormals(s,n),f=0;f<p.length;++f)this.addNormal(p[f]);this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue()),this.setCurrentTexCoord(this.getTexCoord())}}}),c}),define("cobweb/Components/Geometry3D/Extrusion",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l,c){function h(e){r.call(this,e.getBrowser(),e),this.addType(o.Extrusion)}return h.prototype=e.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"beginCap",new t.SFBool(!0)),new n(o.initializeOnly,"endCap",new t.SFBool(!0)),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"convex",new t.SFBool(!0)),new n(o.initializeOnly,"creaseAngle",new t.SFFloat),new n(o.inputOutput,"crossSection",new t.MFVec2f(new a(1,1),new a(1,-1),new a(-1,-1),new a(-1,1),new a(1,1))),new n(o.inputOutput,"orientation",new t.MFRotation(new l)),new n(o.inputOutput,"scale",new t.MFVec2f(new a(1,1))),new n(o.inputOutput,"spine",new t.MFVec3f(new u(0,0,0),new u(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},createPoints:function(){for(var e=this.crossSection_.getValue(),t=this.orientation_.getValue(),n=this.scale_.getValue(),i=this.spine_.getValue(),r=[],o=this.createRotations(),s=new c,a=0,l=i.length;l>a;++a){if(s.identity(),s.translate(i[a].getValue()),t.length&&s.rotate(t[Math.min(a,t.length-1)].getValue()),s.multLeft(o[a]),n.length){var h=n[Math.min(a,n.length-1)].getValue();s.scale(new u(h.x,1,h.y))}for(var d=0,p=e.length;p>d;++d){var f=e[d].getValue();r.push(s.multVecMatrix(new u(f.x,0,f.y)))}}return r},createRotations:function(){var e,t,n=[],i=this.spine_.getValue(),r=i[0].getValue(),o=i[i.length-1].getValue(),s=r.equals(o),a=new u(0,0,0);if(s)t=u.subtract(i[1].getValue(),i[i.length-2].getValue()).normalize(),a=u.subtract(i[1].getValue(),i[0].getValue()).cross(u.subtract(i[i.length-2].getValue(),i[0].getValue())).normalize();else{t=u.subtract(i[1].getValue(),i[0].getValue()).normalize();for(var h=1,d=i.length-1;d>h&&(a=u.subtract(i[h+1].getValue(),i[h].getValue()).cross(u.subtract(i[h-1].getValue(),i[h].getValue())).normalize(),a.equals(u.Zero));++h);}a.equals(u.Zero)&&(a=new l(new u(0,1,0),t).multVecRot(new u(0,0,1))),e=u.cross(t,a),n.push(new c(e.x,e.y,e.z,0,t.x,t.y,t.z,0,a.x,a.y,a.z,0,0,0,0,1));for(var p=a,h=1,d=i.length-1;d>h;++h)t=u.subtract(i[h+1].getValue(),i[h-1].getValue()).normalize(),a=u.subtract(i[h+1].getValue(),i[h].getValue()).cross(u.subtract(i[h-1].getValue(),i[h].getValue())).normalize(),p.dot(a)<0&&a.negate(),a.equals(u.Zero)?a=p:p=a,e=u.cross(t,a),n.push(new c(e.x,e.y,e.z,0,t.x,t.y,t.z,0,a.x,a.y,a.z,0,0,0,0,1));return s?n.push(n[0].copy()):(t=u.subtract(i[i.length-1].getValue(),i[i.length-2].getValue()).normalize(),i.length>2&&(a=u.subtract(i[i.length-1].getValue(),i[i.length-2].getValue()).cross(u.subtract(i[i.length-3].getValue(),i[i.length-2].getValue())).normalize()),p.dot(a)<0&&a.negate(),a.equals(u.Zero)&&(a=p),e=u.cross(t,a),n.push(new c(e.x,e.y,e.z,0,t.x,t.y,t.z,0,a.x,a.y,a.z,0,0,0,0,1))),n},build:function(){function e(e,t){return e*o+t}var t=!this.ccw_.getValue(),n=this.crossSection_.getValue(),i=this.spine_.getValue(),r=[];if(!(i.length<2||n.length<2)){this.getTexCoords().push(r);for(var o=n.length,l=i[0].getValue(),c=i[i.length-1].getValue(),h=l.equals(c),d=n[0].getValue(),p=n[n.length-1].getValue(),f=d.equals(p),g=n[0].getValue().copy(),m=n[0].getValue().copy(),y=1,b=n.length;b>y;++y)g.min(n[y].getValue()),m.max(n[y].getValue());for(var w=a.subtract(m,g),v=Math.max(w.x,w.y),x=f?n.length-1:n.length,_=[],C=[],S=this.createPoints(),T=0,b=S.length;b>T;++T)_[T]=[];for(var F=n.length-1,O=i.length-1,N=0;O>N;++N)for(var y=0;F>y;++y){var V=h&&N===i.length-2?0:N+1,D=f&&y===n.length-2?0:y+1,M=e(N,y),B=e(N,D),E=e(V,D),I=e(V,y),A=S[M],P=S[B],L=S[E],R=S[I];if(t)var k=s.normal(L,P,A,new u(0,0,0)),j=s.normal(R,L,A,new u(0,0,0));else var k=s.normal(A,P,L,new u(0,0,0)),j=s.normal(A,L,R,new u(0,0,0));r.push(y/F,N/O,0,1),_[M].push(C.length),C.push(k),this.addVertex(A),r.push((y+1)/F,N/O,0,1),_[B].push(C.length),C.push(k),this.addVertex(P),r.push((y+1)/F,(N+1)/O,0,1),_[E].push(C.length),C.push(k),this.addVertex(L),r.push(y/F,N/O,0,1),_[M].push(C.length),C.push(j),this.addVertex(A),r.push((y+1)/F,(N+1)/O,0,1),_[E].push(C.length),C.push(j),this.addVertex(L),r.push(y/F,(N+1)/O,0,1),_[I].push(C.length),C.push(j),this.addVertex(R)}C=this.refineNormals(_,C,this.creaseAngle_.getValue());for(var z=0;z<C.length;++z)this.addNormal(C[z]);if(v&&n.length>2){if(this.beginCap_.getValue()){for(var X=0,U=[],q=[],y=0;x>y;++y){var G=e(X,x-1-y),H=S[G].copy();H.index=G,H.texCoord=a.subtract(n[x-1-y].getValue(),g).divide(v),U.push(H)}this.convex_.getValue()?s.triangulateConvexPolygon(U,q):s.triangulatePolygon(U,q);var W=s.normal(S[q[0].index],S[q[1].index],S[q[2].index],new u(0,0,0));t&&W.negate(),this.addCap(r,W,S,q)}if(this.endCap_.getValue()){for(var X=i.length-1,U=[],q=[],y=0;x>y;++y){var G=e(X,y),H=S[G].copy();H.index=G,H.texCoord=a.subtract(n[y].getValue(),g).divide(v),U.push(H)}this.convex_.getValue()?s.triangulateConvexPolygon(U,q):s.triangulatePolygon(U,q);var W=s.normal(S[q[0].index],S[q[1].index],S[q[2].index],new u(0,0,0));t&&W.negate(),this.addCap(r,W,S,q)}}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue()),this.setCurrentTexCoord(null)}},addCap:function(e,t,n,i){for(var r=0;r<i.length;r+=3){var o=n[i[r].index],s=n[i[r+1].index],a=n[i[r+2].index],u=i[r].texCoord,l=i[r+1].texCoord,c=i[r+2].texCoord;e.push(u.x,u.y,0,1),e.push(l.x,l.y,0,1),e.push(c.x,c.y,0,1),this.addNormal(t),this.addNormal(t),this.addNormal(t),this.addVertex(o),this.addVertex(s),this.addVertex(a)}}}),h}),define("cobweb/Components/Rendering/IndexedLineSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.IndexedLineSet),this.attribNodes=[],this.colorNode=null,this.coordNode=null}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(s.inputOutput,"colorIndex",new t.MFInt32),new n(s.inputOutput,"coordIndex",new t.MFInt32),new n(s.inputOutput,"attrib",new t.MFNode),new n(s.inputOutput,"fogCoord",new t.SFNode),new n(s.inputOutput,"color",new t.SFNode),new n(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest(this,"set_attrib__"),this.color_.addInterest(this,"set_color__"),this.coord_.addInterest(this,"set_coord__"),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].removeInterest(this,"addNodeEvent");this.attribNodes.length=0;for(var e=0,t=this.attrib_.length;t>e;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&this.attribNodes.push(n)}for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].addInterest(this,"addNodeEvent")},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest(this,"addNodeEvent"),this.colorNode.removeInterest(this,"set_transparent__")),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest(this,"addNodeEvent"),this.colorNode.addInterest(this,"set_transparent__"),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest(this,"addNodeEvent"),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest(this,"addNodeEvent")},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getPolylineIndices:function(){var e=this.coordIndex_.getValue(),t=[],n=[];if(this.coordIndex_.length){for(var i=0,i=0;i<e.length;++i){var r=e[i].getValue();r>=0?n.push(i):(n.length>1&&t.push(n),n=[])}e[e.length-1].getValue()>=0&&n.length>1&&t.push(n)}return t},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var e=this.coordIndex_.getValue(),t=this.getPolylineIndices(),n=this.colorPerVertex_.getValue(),i=this.colorNode,r=this.coordNode,o=0,s=0;s<t.length;++s){for(var a=t[s],u=0,l=a.length-1;l>u;++u)for(var c=u,h=u+2;h>c;++c){var d=a[c];i&&(n?this.addColor(i.getColor(this.getColorPerVertexIndex(d))):this.addColor(i.getColor(this.getColorIndex(o)))),this.addVertex(r.getPoint(e[d].getValue()))}++o}}}),a}),define("cobweb/Components/CADGeometry/IndexedQuadSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IndexedQuadSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{
constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"index",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedQuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest(this,"set_index__"),this.set_index__()},set_index__:function(){var e=this.index_.getValue(),t=e.length,n=this.triangleIndex;t-=t%4,n.length=0;for(var i=0;t>i;i+=4){var r=i,o=i+1,s=i+2,a=i+3;n.push(r,o,s,r,s,a)}},getTriangleIndex:function(e){return this.triangleIndex[e]},getPolygonIndex:function(e){return this.index_[e]},build:function(){r.prototype.build.call(this,4,this.index_.length,6,this.triangleIndex.length)}}),s}),define("cobweb/Components/Rendering/IndexedTriangleFanSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IndexedTriangleFanSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"index",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest(this,"set_index__"),this.set_index__()},set_index__:function(){var e=this.index_.getValue(),t=this.triangleIndex;t.length=0;for(var n=0,i=e.length;i>n;++n){var r=e[n].getValue();if(++n<i){var o=e[n].getValue();if(0>o)continue;for(++n;i>n;++n){var s=e[n].getValue();if(0>s)break;t.push(r,o,s),o=s}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("cobweb/Components/Rendering/IndexedTriangleSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IndexedTriangleSet)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"index",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(e){return this.index_[e]},build:function(){r.prototype.build.call(this,3,this.index_.length,3,this.index_.length)}}),s}),define("cobweb/Components/Rendering/IndexedTriangleStripSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IndexedTriangleStripSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"index",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.index_.addInterest(this,"set_index__"),this.set_index__()},set_index__:function(){var e=this.index_.getValue(),t=this.triangleIndex;t.length=0;for(var n=0,i=e.length;i>n;++n){var r=e[n].getValue();if(!(0>r)&&++n<i){var o=e[n].getValue();if(0>o)continue;++n;for(var s=0;i>n;++n,++s){var a=e[n].getValue();if(0>a)break;t.push(r,o,a),1&s?o=a:r=a}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("cobweb/Components/Networking/Inline",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Components/Grouping/X3DBoundedObject","cobweb/Components/Grouping/Group","cobweb/Bits/X3DConstants","cobweb/InputOutput/Loader"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),s.call(this,e.getBrowser(),e),this.addType(u.Inline),this.addChildren("buffer",new t.SFTime),this.scene=this.getBrowser().getDefaultScene(),this.group=new a(e),this.getBBox=this.group.getBBox.bind(this.group),this.traverse=this.group.traverse.bind(this.group)}return c.prototype=e.extend(Object.create(r.prototype),o.prototype,s.prototype,{constructor:c,fieldDefinitions:new i([new n(u.inputOutput,"metadata",new t.SFNode),new n(u.inputOutput,"load",new t.SFBool(!0)),new n(u.inputOutput,"url",new t.MFString),new n(u.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(u.initializeOnly,"bboxCenter",new t.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.load_.addInterest(this,"set_load__"),this.url_.addInterest(this,"set_url__"),this.buffer_.addInterest(this,"set_buffer__"),this.requestAsyncLoad()},set_live__:function(){if(this.checkLoadState()==u.COMPLETE_STATE){var e=this.getExecutionContext().isLive().getValue()&&this.isLive().getValue();e?this.scene.beginUpdate():this.scene.endUpdate()}},set_load__:function(){this.load_.getValue()?this.buffer_.addEvent():this.requestUnload()},set_url__:function(){this.buffer_.addEvent()},set_buffer__:function(){this.load_.getValue()&&(this.setLoadState(u.NOT_STARTED_STATE),this.requestAsyncLoad())},requestImmediateLoad:function(){try{this.setScene(new l(this).createX3DFromURL(this.url_))}catch(e){console.log(e),this.setScene(this.getBrowser().getDefaultScene())}},requestAsyncLoad:function(){this.checkLoadState()!==u.COMPLETE_STATE&&this.checkLoadState()!==u.IN_PROGRESS_STATE&&(this.setLoadState(u.IN_PROGRESS_STATE),new l(this).createX3DFromURL(this.url_,this.setSceneAsync.bind(this)))},requestUnload:function(){this.checkLoadState()!==u.NOT_STARTED_STATE&&this.checkLoadState()!==u.FAILED_STATE&&(this.setLoadState(u.NOT_STARTED_STATE),this.setScene(this.getBrowser().getDefaultScene()))},setSceneAsync:function(e){e?(this.setLoadState(u.COMPLETE_STATE),this.setScene(e)):(this.setLoadState(u.FAILED_STATE),this.setScene(this.getBrowser().getDefaultScene()))},setScene:function(e){this.scene.endUpdate(),this.scene.rootNodes.removeInterest(this.group.children_,"setValue"),this.scene=e,this.scene.setup(),this.scene.rootNodes.addInterest(this.group.children_,"setValue"),this.group.children_=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getScene:function(){return this.scene}}),c}),define("cobweb/Components/EventUtilities/IntegerSequencer",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EventUtilities/X3DSequencerNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IntegerSequencer)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOnly,"previous",new t.SFBool),new n(o.inputOnly,"next",new t.SFBool),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFInt32),new n(o.outputOnly,"value_changed",new t.SFInt32)]),getTypeName:function(){return"IntegerSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_index__")},getSize:function(){return this.keyValue_.length},sequence:function(e){this.value_changed_=this.keyValue_[e]}}),s}),define("cobweb/Components/EventUtilities/IntegerTrigger",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EventUtilities/X3DTriggerNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.IntegerTrigger)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_boolean",new t.SFBool),new n(o.inputOutput,"integerKey",new t.SFInt32),new n(o.outputOnly,"triggerValue",new t.SFInt32)]),getTypeName:function(){return"IntegerTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest(this,"set_boolean__")},set_boolean__:function(){this.triggerValue_=this.integerKey_}}),s}),define("cobweb/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode",["jquery","cobweb/Components/Core/X3DSensorNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DKeyDeviceSensorNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.set_live__()},set_live__:function(){this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?(this.enabled_.addInterest(this,"set_enabled__"),this.enabled_.getValue()&&this.enable()):(this.enabled_.removeInterest(this,"set_enabled__"),this.enabled_.getValue()&&this.disable())},set_enabled__:function(){this.enabled_.getValue()?this.enable():this.disable()},enable:function(){if(!this.isActive_.getValue()){var e=this.getBrowser().getKeyDeviceSensorNode();e&&(e.enabled_=!1,e.isActive_=!1),this.getBrowser().setKeyDeviceSensorNode(this),this.isActive_=!0}},disable:function(){this.isActive_.getValue()&&(this.getBrowser().setKeyDeviceSensorNode(null),this.release(),this.isActive_=!1)},keydown:function(){},keyup:function(){},release:function(){}}),i}),define("cobweb/Components/KeyDeviceSensor/KeySensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.KeySensor)}var a=1,u=2,l=3,c=4,h=5,d=6,p=7,f=8,g=9,m=10,y=11,b=12,w=13,v=14,x=15,_=16,C=17,S=18,T=19,F=20;return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.outputOnly,"controlKey",new t.SFBool),new n(o.outputOnly,"shiftKey",new t.SFBool),new n(o.outputOnly,"altKey",new t.SFBool),new n(o.outputOnly,"actionKeyPress",new t.SFInt32),new n(o.outputOnly,"actionKeyRelease",new t.SFInt32),new n(o.outputOnly,"keyPress",new t.SFString),new n(o.outputOnly,"keyRelease",new t.SFString),new n(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"KeySensor"},getComponentName:function(){return"KeyDeviceSensor"},getContainerField:function(){return"children"},keydown:function(e){switch(e.which){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 112:this.actionKeyPress_=a;break;case 113:this.actionKeyPress_=u;break;case 114:this.actionKeyPress_=l;break;case 115:this.actionKeyPress_=c;break;case 116:this.actionKeyPress_=h;break;case 117:this.actionKeyPress_=d;break;case 118:this.actionKeyPress_=p;break;case 119:this.actionKeyPress_=f;break;case 120:this.actionKeyPress_=g;break;case 121:this.actionKeyPress_=m;break;case 122:this.actionKeyPress_=y;break;case 123:this.actionKeyPress_=b;break;case 36:this.actionKeyPress_=w;break;case 35:this.actionKeyPress_=v;break;case 33:this.actionKeyPress_=x;break;case 34:this.actionKeyPress_=_;break;case 38:this.actionKeyPress_=C;break;case 40:this.actionKeyPress_=S;break;case 37:this.actionKeyPress_=T;break;case 39:this.actionKeyPress_=F;break;default:e.charCode&&(this.keyPress_=e.key)}},keyup:function(e){switch(e.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 112:this.actionKeyRelease_=a;break;case 113:this.actionKeyRelease_=u;break;case 114:this.actionKeyRelease_=l;break;case 115:this.actionKeyRelease_=c;break;case 116:this.actionKeyRelease_=h;break;case 117:this.actionKeyRelease_=d;break;case 118:this.actionKeyRelease_=p;break;case 119:this.actionKeyRelease_=f;break;case 120:this.actionKeyRelease_=g;break;case 121:this.actionKeyRelease_=m;break;case 122:this.actionKeyRelease_=y;break;case 123:this.actionKeyRelease_=b;break;case 36:this.actionKeyRelease_=w;break;case 35:this.actionKeyRelease_=v;break;case 33:this.actionKeyRelease_=x;break;case 34:this.actionKeyRelease_=_;break;case 38:this.actionKeyRelease_=C;break;case 40:this.actionKeyRelease_=S;break;case 37:this.actionKeyRelease_=T;break;case 39:this.actionKeyRelease_=F;break;default:e.charCode&&(this.keyRelease_=e.key)}},release:function(){this.shiftKey_.getValue()&&(this.shiftKey_=!1),this.controlKey_.getValue()&&(this.controlKey_=!1),this.altKey_.getValue()&&(this.altKey_=!1)}}),s}),define("cobweb/Components/Navigation/LOD",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(s.LOD),this.addAlias("level",this.children_),this.frameRate=60,this.keepCurrentLevel=!1}var c=180,h=20,d=55;return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.initializeOnly,"forceTransitions",new t.SFBool),new n(s.initializeOnly,"center",new t.SFVec3f),new n(s.initializeOnly,"range",new t.MFFloat),new n(s.outputOnly,"level_changed",new t.SFInt32(-1)),new n(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(s.initializeOnly,"bboxCenter",new t.SFVec3f),new n(s.inputOnly,"addChildren",new t.MFNode),new n(s.inputOnly,"removeChildren",new t.MFNode),new n(s.inputOutput,"children",new t.MFNode)]),modelViewMatrix:new a,getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.child=this.getChild(this.level_changed_.getValue()),this.set_cameraObjects__()},set_cameraObjects__:function(){this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},getBBox:function(){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=X3DCast(s.X3DBoundedObject,this.child);return e?e.getBBox():new Box3}return new Box3(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getLevel:function(e){if(0===this.range_.length){var t=this.children_.length;if(2>t)return 0;if(this.frameRate=((c-1)*this.frameRate+this.getBrowser().currentFrameRate)/c,2===t)return Number(this.frameRate>d);var n=t-1,i=Math.max((this.frameRate-h)/(d-h),0);return Math.min(Math.ceil(i*(n-1)),n)}var r=this.getDistance(e);return u.upperBound(this.range_,0,this.range_.length,r,u.less)},getDistance:function(e){var t=this.getModelViewMatrix(e,this.modelViewMatrix);return t.translate(this.center_.getValue()),t.origin.abs()},traverse:function(e){if(!this.keepCurrentLevel){var t=this.getLevel(e),n=this.level_changed_.getValue();t!==n&&(this.forceTransitions_.getValue()?e===o.DISPLAY&&(t>n?this.level_changed_=n+1:this.level_changed_=n-1):this.level_changed_=t,this.child=this.getChild(Math.min(t,this.children_.length-1)),this.set_cameraObjects__())}this.child&&this.child.traverse(e)}}),l}),define("cobweb/Components/Layout/X3DLayoutNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DLayoutNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Layout/Layout",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Layout/X3DLayoutNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l,c){function h(e){r.call(this,e.getBrowser(),e),this.addType(s.Layout),this.alignX=f,this.alignY=f,this.offsetUnitX=b,this.offsetUnitY=b,this.offsetX=0,this.offsetY=0,this.sizeUnitX=b,this.sizeUnitY=b,this.sizeX=1,this.sizeY=1,this.scaleModeX=x,this.scaleModeY=x,this.parent=null,this.rectangleCenter=new a(0,0),this.rectangleSize=new a(0,0),this.matrix=new c}var d=0,p=d++,f=d++,g=d++,m=d++,y=d++,b=d++,w=d++,v=d++,x=d++,_=d++;return h.prototype=e.extend(Object.create(r.prototype),{constructor:h,viewportPixel:new a(0,0),pixelSize:new a(0,0),translation:new u(0,0,0),offset:new u(0,0,0),scale:new u(1,1,1),currentTranslation:new u(0,0,0),currentRotation:new l(0,0,1,0),currentScale:new u(0,0,0),modelViewMatrix:new c,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"align",new t.MFString(["CENTER","CENTER"])),new n(s.inputOutput,"offsetUnits",new t.MFString(["WORLD","WORLD"])),new n(s.inputOutput,"offset",new t.MFFloat([0,0])),new n(s.inputOutput,"sizeUnits",new t.MFString(["WORLD","WORLD"])),new n(s.inputOutput,"size",new t.MFFloat([1,1])),new n(s.inputOutput,"scaleMode",new t.MFString(["NONE","NONE"]))]),getTypeName:function(){return"Layout"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layout"},initialize:function(){r.prototype.initialize.call(this),this.align_.addInterest(this,"set_align__"),this.offsetUnits_.addInterest(this,"set_offsetUnits__"),this.offset_.addInterest(this,"set_offset__"),this.sizeUnits_.addInterest(this,"set_sizeUnits__"),this.size_.addInterest(this,"set_size__"),this.scaleMode_.addInterest(this,"set_scaleMode__"),this.set_align__(),this.set_offsetUnits__(),this.set_offset__(),this.set_sizeUnits__(),this.set_size__(),this.set_scaleMode__()},set_align__:function(){this.align_.length>0?"LEFT"===this.align_[0]?this.alignX=p:"RIGHT"===this.align_[0]?this.alignX=g:this.alignX=f:this.alignX=f,this.align_.length>1?"BOTTOM"===this.align_[1]?this.alignY=m:"TOP"===this.align_[1]?this.alignY=y:this.alignY=f:this.alignY=f},set_offsetUnits__:function(){this.offsetUnits_.length>0?("FRACTION"===this.offsetUnits_[0]?this.offsetUnitX=w:"PIXEL"===this.offsetUnits_[0]?this.offsetUnitX=v:this.offsetUnitX=b,this.offsetUnits_.length>1?"FRACTION"===this.offsetUnits_[1]?this.offsetUnitY=w:"PIXEL"===this.offsetUnits_[1]?this.offsetUnitY=v:this.offsetUnitY=b:this.offsetUnitY=this.offsetUnitX):(this.offsetUnitX=b,this.offsetUnitY=b)},set_offset__:function(){this.offset_.length>0?(this.offsetX=this.offset_[0],this.offset_.length>1?this.offsetY=this.offset_[1]:this.offsetY=offsetX):(this.offsetX=0,this.offsetY=0)},set_sizeUnits__:function(){this.sizeUnits_.length>0?("FRACTION"===this.sizeUnits_[0]?this.sizeUnitX=w:"PIXEL"===this.sizeUnits_[0]?this.sizeUnitX=v:this.sizeUnitX=b,this.sizeUnits_.length>1?"FRACTION"===this.sizeUnits_[1]?this.sizeUnitY=w:"PIXEL"===this.sizeUnits_[1]?this.sizeUnitY=v:this.sizeUnitY=b:this.sizeUnitY=this.sizeUnitX):(this.sizeUnitX=b,this.sizeUnitY=b)},set_size__:function(){this.size_.length>0?(this.sizeX=this.size_[0],this.size_.length>1?this.sizeY=this.size_[1]:this.sizeY=this.sizeX):(this.sizeX=0,this.sizeY=0)},set_scaleMode__:function(){this.scaleMode_.length>0?("FRACTION"===this.scaleMode_[0]?this.scaleModeX=w:"PIXEL"===this.scaleMode_[0]?this.scaleModeX=v:"STRETCH"===this.scaleMode_[0]?this.scaleModeX=_:this.scaleModeX=x,this.scaleMode_.length>1?"FRACTION"===this.scaleMode_[1]?this.scaleModeY=w:"PIXEL"===this.scaleMode_[1]?this.scaleModeY=v:"STRETCH"===this.scaleMode_[1]?this.scaleModeY=_:this.scaleModeY=x:this.scaleModeY=this.scaleModeX):(this.scaleModeX=x,this.scaleModeY=x)},getRectangleCenter:function(){return this.rectangleCenter},getRectangleSize:function(){return this.rectangleSize},getAlignX:function(){return this.alignX},getAlignY:function(){return this.alignY},getOffsetUnitX:function(){return this.offsetUnitX===b?this.parent?this.parent.getOffsetUnitX():w:this.offsetUnitX},getOffsetUnitY:function(){return this.offsetUnitY===b?this.parent?this.parent.getOffsetUnitY():w:this.offsetUnitY},getSizeUnitX:function(){return this.sizeUnitX===b?this.parent?this.parent.getSizeUnitX():w:this.sizeUnitX},getOffsetX:function(){return this.offsetX},getOffsetY:function(){return this.offsetY},getSizeUnitY:function(){return this.sizeUnitX===b?this.parent?this.parent.getSizeUnitX():w:this.sizeUnitX},getSizeUnitY:function(){return this.sizeUnitY===b?this.parent?this.parent.getSizeUnitY():w:this.sizeUnitY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getScaleModeX:function(){return this.parent?this.scaleModeX:this.scaleModeX===x?w:this.scaleModeX},getScaleModeY:function(){return this.parent?this.scaleModeY:this.scaleModeY===x?w:this.scaleModeY},transform:function(e){var t=this.matrix,n=o(s.OrthoViewpoint,this.getCurrentViewpoint());if(n){var i=this.parent=this.getBrowser().getParentLayout(),r=this.getCurrentLayer().getViewVolume().getScissor(),a=n.getViewportSize(r),u=this.viewportPixel,l=this.pixelSize,c=i?i.getRectangleSize():a,h=this.rectangleSize,d=this.rectangleCenter;switch(u.set(r[2],r[3]),l.assign(a).divVec(u),this.getSizeUnitX()){case w:h.x=this.sizeX*c.x;break;case v:h.x=this.sizeX*l.x}switch(this.getSizeUnitY()){case w:h.y=this.sizeY*c.y;break;case v:h.y=this.sizeY*l.y}var b=this.translation.set(0,0,0);switch(this.getAlignX()){case p:b.x=-(c.x-h.x)/2;break;case f:this.getSizeUnitX()===v&&1&u.x&&(b.x=-l.x/2);break;case g:b.x=(c.x-h.x)/2}switch(this.getAlignY()){case m:b.y=-(c.y-h.y)/2;break;case f:this.getSizeUnitX===v&&1&u.y&&(b.y=-l.y/2);break;case y:b.y=(c.y-h.y)/2}var C=this.offset.set(0,0,0);switch(this.getOffsetUnitX()){case w:C.x=this.offsetX*c.x;break;case v:C.x=this.offsetX*a.x/u.x}switch(this.getOffsetUnitY()){case w:C.y=this.offsetY*c.y;break;case v:C.y=this.offsetY*a.y/u.y}var S=this.scale.set(1,1,1),T=this.currentTranslation,F=this.currentRotation,O=this.currentScale,N=this.getModelViewMatrix(e,this.modelViewMatrix);switch(N.get(T,F,O),this.getScaleModeX()){case x:S.x=O.x;break;case w:S.x=h.x;break;case _:break;case v:S.x=a.x/u.x}switch(this.getScaleModeY()){case x:S.y=O.y;break;case w:S.y=h.y;break;case _:break;case v:S.y=a.y/u.y}this.getScaleModeX()===_?this.getScaleModeY()===_?h.x>h.y?(S.x=h.x,S.y=S.x):(S.y=h.y,S.x=S.y):S.x=S.y:this.getScaleModeY()===_&&(S.y=S.x),d.assign(b).add(C),t.set(T,F),t.translate(b.add(C)),t.scale(S)}else t.identity();return t}}),h}),define("cobweb/Components/Layout/LayoutGroup",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DCast","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(a.LayoutGroup),this.viewportNode=null,this.layoutNode=null}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"layout",new t.SFNode),new n(a.inputOutput,"viewport",new t.SFNode),new n(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(a.initializeOnly,"bboxCenter",new t.SFVec3f),new n(a.inputOnly,"addChildren",new t.MFNode),new n(a.inputOnly,"removeChildren",new t.MFNode),new n(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"LayoutGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.viewport_.addInterest(this,"set_viewport__"),this.layout_.addInterest(this,"set_layout__"),this.set_viewport__(),this.set_layout__()},set_viewport__:function(){this.viewportNode=o(a.X3DViewportNode,this.viewport_)},set_layout__:function(){this.layoutNode=o(a.X3DLayoutNode,this.layout_)},traverse:function(e){switch(e){case s.POINTER:case s.CAMERA:case s.DISPLAY:if(this.viewportNode&&this.viewportNode.push(),this.layoutNode){var t=this.getBrowser(),n=t.getModelViewMatrix();n.push(),n.set(this.layoutNode.transform(e)),t.getLayouts().push(this.layoutNode),r.prototype.traverse.call(this,e),t.getLayouts().pop(),n.pop()}else r.prototype.traverse.call(this,e);this.viewportNode&&this.viewportNode.pop()}}}),u}),define("cobweb/Components/Layout/LayoutLayer",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Layering/X3DLayerNode","cobweb/Components/Layout/LayoutGroup","cobweb/Components/Navigation/OrthoViewpoint","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e,new s(e),new o(e)),this.addType(a.LayoutLayer)}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"isPickable",new t.SFBool(!0)),new n(a.inputOutput,"layout",new t.SFNode),new n(a.inputOutput,"viewport",new t.SFNode),new n(a.inputOnly,"addChildren",new t.MFNode),new n(a.inputOnly,"removeChildren",new t.MFNode),new n(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"LayoutLayer"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layers"},initialize:function(){this.layout_.addFieldInterest(this.getGroup().layout_),this.getGroup().layout_=this.layout_,r.prototype.initialize.call(this)}}),u}),define("cobweb/Components/Shape/LineProperties",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shape/X3DAppearanceChildNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.LineProperties)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"applied",new t.SFBool(!0)),new n(o.inputOutput,"linetype",new t.SFInt32(1)),new n(o.inputOutput,"linewidthScaleFactor",new t.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){r.prototype.initialize.call(this),this.linewidthScaleFactor_.addInterest(this,"set_linewidthScaleFactor__"),this.set_linewidthScaleFactor__()},getLinewidthScaleFactor:function(){return this.linewidthScaleFactor},set_linewidthScaleFactor__:function(){this.linewidthScaleFactor=Math.max(1,this.linewidthScaleFactor_.getValue())}}),s}),define("cobweb/Components/Rendering/LineSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.LineSet),this.attribNodes=[],this.colorNode=null,this.coordNode=null}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"vertexCount",new t.MFInt32),new n(s.inputOutput,"attrib",new t.MFNode),new n(s.inputOutput,"fogCoord",new t.SFNode),new n(s.inputOutput,"color",new t.SFNode),new n(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest(this,"set_attrib__"),this.color_.addInterest(this,"set_color__"),this.coord_.addInterest(this,"set_coord__"),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].removeInterest(this,"addNodeEvent");this.attribNodes.length=0;for(var e=0,t=this.attrib_.length;t>e;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&this.attribNodes.push(n)}for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].addInterest(this,"addNodeEvent")},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest(this,"addNodeEvent"),this.colorNode.removeInterest(this,"set_transparent__")),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest(this,"addNodeEvent"),this.colorNode.addInterest(this,"set_transparent__"),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest(this,"addNodeEvent"),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest(this,"addNodeEvent")},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var e=this.vertexCount_.getValue(),t=this.colorNode,n=this.coordNode,i=n.getSize(),r=0,o=0,s=e.length;s>o;++o){var a=e[o].getValue();if(r+a>i)break;if(a>1){a=2*a-2;for(var u=0;a>u;++u,r+=1&u)t&&this.addColor(t.getColor(r)),
this.addVertex(n.getPoint(r));++r}else r+=a}}}),a}),define("cobweb/Components/EnvironmentalEffects/LocalFog",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Components/EnvironmentalEffects/X3DFogObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.LocalFog)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"fogType",new t.SFString("LINEAR")),new n(s.inputOutput,"color",new t.SFColor(1,1,1)),new n(s.inputOutput,"visibilityRange",new t.SFFloat)]),getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this)},push:function(){this.enabled_.getValue()&&this.getCurrentLayer().pushLocalFog(this)},pop:function(){this.enabled_.getValue()&&this.getCurrentLayer().popLocalFog()}}),a}),define("cobweb/Components/Shape/X3DMaterialNode",["jquery","cobweb/Components/Shape/X3DAppearanceChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DMaterialNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Shape/Material",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shape/X3DMaterialNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Material),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new n(o.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new n(o.inputOutput,"specularColor",new t.SFColor),new n(o.inputOutput,"emissiveColor",new t.SFColor),new n(o.inputOutput,"shininess",new t.SFFloat(.2)),new n(o.inputOutput,"transparency",new t.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){r.prototype.initialize.call(this),this.addChildren("transparent",new t.SFBool),this.ambientIntensity_.addInterest(this,"set_ambientIntensity__"),this.diffuseColor_.addInterest(this,"set_diffuseColor__"),this.specularColor_.addInterest(this,"set_specularColor__"),this.emissiveColor_.addInterest(this,"set_emissiveColor__"),this.shininess_.addInterest(this,"set_shininess__"),this.transparency_.addInterest(this,"set_transparency__"),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__()},getSeparateBackColor:function(){return!1},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){this.diffuseColor.set(this.diffuseColor_.getValue())},set_specularColor__:function(){this.specularColor.set(this.specularColor_.getValue())},set_emissiveColor__:function(){this.emissiveColor.set(this.emissiveColor_.getValue())},set_shininess__:function(){this.shininess=128*s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){var e=s.clamp(this.transparency_.getValue(),0,1);this.transparency=e,e!=this.transparent_.getValue()&&(this.transparent_=e)}}),a}),define("cobweb/Components/Core/X3DMetadataObject",["jquery","cobweb/Bits/X3DConstants"],function(e,t){function n(e,n){this.addType(t.X3DMetadataObject)}return n.prototype={constructor:n,initialize:function(){}},n}),define("cobweb/Components/Core/MetadataBoolean",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataBoolean)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Core/MetadataDouble",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataDouble)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Core/MetadataFloat",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataFloat)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Core/MetadataInteger",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataInteger)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Core/MetadataSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataSet)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Core/MetadataString",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DNode","cobweb/Components/Core/X3DMetadataObject","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(s.MetadataString)}return a.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"name",new t.SFString),new n(s.inputOutput,"reference",new t.SFString),new n(s.inputOutput,"value",new t.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),a}),define("cobweb/Components/Texturing/MovieTexture",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTexture2DNode","cobweb/Components/Sound/X3DSoundSourceNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Bits/X3DConstants","cobweb/Browser/Networking/urls","standard/Networking/URI"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),s.call(this,e.getBrowser(),e),this.addType(a.MovieTexture),this.urlStack=new t.MFString}return c.prototype=e.extend(Object.create(r.prototype),o.prototype,s.prototype,{constructor:c,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"enabled",new t.SFBool(!0)),new n(a.inputOutput,"description",new t.SFString),new n(a.inputOutput,"url",new t.MFString),new n(a.inputOutput,"speed",new t.SFFloat(1)),new n(a.inputOutput,"pitch",new t.SFFloat(1)),new n(a.inputOutput,"loop",new t.SFBool),new n(a.inputOutput,"startTime",new t.SFTime),new n(a.inputOutput,"resumeTime",new t.SFTime),new n(a.inputOutput,"pauseTime",new t.SFTime),new n(a.inputOutput,"stopTime",new t.SFTime),new n(a.outputOnly,"isPaused",new t.SFBool),new n(a.outputOnly,"isActive",new t.SFBool),new n(a.outputOnly,"cycleTime",new t.SFTime),new n(a.outputOnly,"elapsedTime",new t.SFTime),new n(a.outputOnly,"duration_changed",new t.SFTime(-1)),new n(a.initializeOnly,"repeatS",new t.SFBool(!0)),new n(a.initializeOnly,"repeatT",new t.SFBool(!0)),new n(a.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.url_.addInterest(this,"set_url__"),this.canvas=e("<canvas>"),this.video=e("<video>"),this.video.error(this.setError.bind(this)),this.video.bind("abort",this.setError.bind(this)),this.video.attr("preload","auto"),this.video.attr("volume",0),this.video.attr("crossOrigin","anonymous"),this.requestAsyncLoad()},set_url__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==a.COMPLETE_STATE&&this.checkLoadState()!==a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.setMedia(null),this.urlStack.setValue(this.url_),this.video.bind("canplaythrough",this.setVideo.bind(this)),this.loadNext())},loadNext:function(){return 0===this.urlStack.length?(this.duration_changed_=-1,this.clear(),void this.setLoadState(a.FAILED_STATE)):(this.URL=new l(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),void this.video.attr("src",this.URL))},setError:function(){var e=this.URL.toString();this.URL.isLocal()||e.match(u.fallbackRx)||this.urlStack.unshift(u.fallback+e),"data"!==this.URL.scheme&&console.warn("Error loading movie:",this.URL.toString()),this.loadNext()},setVideo:function(){"data"!==this.URL.scheme&&console.info("Done loading movie:",this.URL.toString());var e=this.video[0];try{var t=e.videoWidth,n=e.videoHeight,i=this.canvas[0],r=i.getContext("2d");i.width=t,i.height=n,r.drawImage(e,0,0);var o=r.getImageData(0,0,t,n).data;setTimeout(function(){this.video.unbind("canplaythrough"),this.setMedia(this.video),this.setTexture(t,n,!1,new Uint8Array(o),!0),this.setLoadState(a.COMPLETE_STATE)}.bind(this),16)}catch(s){console.log(s.message),this.setError()}},prepareEvents:function(){o.prototype.prepareEvents.call(this);var e=this.getMedia();e&&this.updateTexture(e[0])},traverse:r.prototype.traverse}),c}),define("cobweb/Components/Rendering/X3DNormalNode",["jquery","cobweb/Components/Rendering/X3DGeometricPropertyNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DNormalNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Rendering/Normal",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DNormalNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Normal),this.vector=this.vector_.getValue()}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"vector",new t.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},getVector:function(e){return e>=0&&e<this.vector.length?this.vector[e].getValue():new s(0,0,0)}}),a}),define("cobweb/Components/Interpolation/NormalInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(o.NormalInterpolator)}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFVec3f),new n(o.outputOnly,"value_changed",new t.MFVec3f)]),keyValue:new s(0,0,0),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){},interpolate:function(e,t,n){var i=this.keyValue_.getValue(),r=this.value_changed_.getValue(),o=this.key_.length>1?Math.floor(i.length/this.key_.length):0;e*=o,t=e+o,this.value_changed_.length=o;for(var s=0;o>s;++s)r[s].set(this.keyValue.assign(i[e+s].getValue()).slerp(i[t+s].getValue(),n));this.value_changed_.addEvent()}}),u}),define("cobweb/Components/Followers/OrientationChaser",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.OrientationChaser)}var u=new s(0,0,1,0),l=new s(0,0,1,0);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFRotation),new n(o.inputOnly,"set_destination",new t.SFRotation),new n(o.initializeOnly,"initialValue",new t.SFRotation),new n(o.initializeOnly,"initialDestination",new t.SFRotation),new n(o.initializeOnly,"duration",new t.SFTime(1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(e,t,n){return u.assign(e).inverse().multRight(t),Math.abs(u.angle)<n},interpolate:function(e,t,n){return l.assign(e).slerp(t,n)},step:function(e,t,n){this.deltaOut.assign(t).inverse().multRight(e).multLeft(this.output),this.output.slerp(this.deltaOut,n)}}),a}),define("cobweb/Components/Followers/OrientationDamper",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.OrientationDamper)}var u=new s(0,0,1,0),l=new s(0,0,1,0);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFRotation),new n(o.inputOnly,"set_destination",new t.SFRotation),new n(o.initializeOnly,"initialValue",new t.SFRotation),new n(o.initializeOnly,"initialDestination",new t.SFRotation),new n(o.initializeOnly,"order",new t.SFInt32(3)),new n(o.inputOutput,"tau",new t.SFTime(.3)),new n(o.inputOutput,"tolerance",new t.SFFloat(-1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(e,t,n){return u.assign(e).inverse().multRight(t),Math.abs(u.angle)<n},interpolate:function(e,t,n){return l.assign(e).slerp(t,n)}}),a}),define("cobweb/Components/Texturing/PixelTexture",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTexture2DNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PixelTexture),this.addChildren("loadState",new t.SFInt32(o.NOT_STARTED_STATE))}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"image",new t.SFImage(0,0,0,[])),new n(o.initializeOnly,"repeatS",new t.SFBool(!0)),new n(o.initializeOnly,"repeatT",new t.SFBool(!0)),new n(o.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.image_.addInterest(this,"set_image__"),this.set_image__()},checkLoadState:function(){return this.loadState_.getValue()},convert:function(e,t,n){switch(t){case 1:for(var i=0,r=0,o=n.length;o>i;++i,r+=4){var s=n[i].getValue();e[r]=e[r+1]=e[r+2]=255&s,e[r+3]=255}break;case 2:for(var i=0,r=0,o=n.length;o>i;++i,r+=4){var s=n[i].getValue();e[r]=e[r+1]=e[r+2]=s>>>8&255,e[r+3]=255&s}break;case 3:for(var i=0,r=0,o=n.length;o>i;++i,r+=4){var s=n[i].getValue();e[r]=s>>>16&255,e[r+1]=s>>>8&255,e[r+2]=255&s,e[r+3]=255}break;case 4:for(var i=0,r=0,o=n.length;o>i;++i,r+=4){var s=n[i].getValue();e[r]=s>>>24,e[r+1]=s>>>16&255,e[r+2]=s>>>8&255,e[r+3]=255&s}}},set_image__:function(){var t=this.image_.width,n=this.image_.height,i=this.image_.comp,r=this.image_.array.getValue(),a=!(i%2),u=null;if(t>0&&n>0&&i>0&&5>i){if(s.isPowerOfTwo(t)&&s.isPowerOfTwo(n))u=new Uint8Array(t*n*4),this.convert(u,i,r);else if(Math.max(t,n)<this.getBrowser().getMinTextureSize()&&!this.textureProperties_.getValue()){u=new Uint8Array(t*n*4),this.convert(u,i,r);var l=t,c=n;t=4*s.nextPowerOfTwo(l),n=4*s.nextPowerOfTwo(c),u=this.resize(u,l,c,t,n)}else{var h=e("<canvas/>")[0],d=e("<canvas/>")[0],p=h.getContext("2d"),f=d.getContext("2d"),g=p.createImageData(t,n);h.width=t,h.height=n,this.convert(g.data,i,r),p.putImageData(g,0,0),t=s.nextPowerOfTwo(t),n=s.nextPowerOfTwo(n),d.width=t,d.height=n,f.drawImage(h,0,0,h.width,h.height,0,0,t,n),u=f.getImageData(0,0,t,n).data}this.setTexture(t,n,a,new Uint8Array(u),!1),this.loadState_=o.COMPLETE_STATE}else this.clear(),this.loadState_=o.FAILED_STATE}}),a}),define("cobweb/Components/PointingDeviceSensor/PlaneSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/PointingDeviceSensor/X3DDragSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p){function f(e){r.call(this,e.getBrowser(),e),this.addType(o.PlaneSensor)}return f.prototype=e.extend(Object.create(r.prototype),{constructor:f,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.inputOutput,"description",new t.SFString),new n(o.inputOutput,"axisRotation",new t.SFRotation),new n(o.inputOutput,"autoOffset",new t.SFBool(!0)),new n(o.inputOutput,"offset",new t.SFVec3f),new n(o.inputOutput,"minPosition",new t.SFVec2f),new n(o.inputOutput,"maxPosition",new t.SFVec2f(-1,-1)),new n(o.outputOnly,"trackPoint_changed",new t.SFVec3f),new n(o.outputOnly,"translation_changed",new t.SFVec3f),new n(o.outputOnly,"isOver",new t.SFBool),new n(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new l,this.invModelViewMatrix=new l,this.projectionMatrix=new l,this.viewport=new u,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new a(0,0,0),this.startPoint=new a(0,0,0)},getLineTrackPoint:function(e,t,n){var i=d.projectLine(t,this.modelViewMatrix,this.projectionMatrix,this.viewport),r=i.getClosestPointToPoint(new a(e.pointer.x,e.pointer.y,0)),o=d.unProjectLine(r.x,r.y,this.modelViewMatrix,this.projectionMatrix,this.viewport);return t.getClosestPointToLine(o,n)},set_active__:function(e,t){r.prototype.set_active__.call(this,e,t);try{if(this.isActive_.getValue()){var n=this.getMatrices()[e.layer.getId()];this.modelViewMatrix.assign(n.modelViewMatrix),this.projectionMatrix.assign(n.projectionMatrix),this.viewport.assign(n.viewport),this.invModelViewMatrix.assign(this.modelViewMatrix).inverse();var i=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),o=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),s=this.axisRotation_.getValue();if(this.minPosition_.x===this.maxPosition_.x){this.planeSensor=!1;var u=s.multVecRot(new a(0,Math.abs(this.maxPosition_.y-this.minPosition_.y),0));this.line=new c(o,u.normalize())}else if(this.minPosition_.y===this.maxPosition_.y){this.planeSensor=!1;var u=s.multVecRot(new a(Math.abs(this.maxPosition_.x-this.minPosition_.x),0,0));this.line=new c(o,u.normalize())}else this.planeSensor=!0,this.plane=new h(o,s.multVecRot(new a(0,0,1)));this.planeSensor?this.plane.intersectsLine(i,this.startPoint):this.getLineTrackPoint(e,this.line,this.startPoint),this.startOffset.assign(this.offset_.getValue())}else this.autoOffset_.getValue()&&(this.offset_=this.translation_changed_)}catch(l){}},set_motion__:function(e){try{if(this.planeSensor){var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new a(0,0,0),i=new a(0,0,0);if(!this.plane.intersectsLine(t,n))throw new Error("Plane and line are parallel.");new h(new a(0,0,0),this.plane.normal).intersectsLine(t,i),this.track(n,i)}else{var n=new a(0,0,0),i=new a(0,0,0);if(!this.getLineTrackPoint(e,this.line,n))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(e,new c(a.Zero,this.line.direction),i)}catch(r){i=n}this.track(n,i)}}catch(r){this.trackPoint_changed_.addEvent(),this.translation_changed_.addEvent()}},track:function(e,t){var n=this.axisRotation_.getValue(),i=s.inverse(n).multVecRot(e.add(this.startOffset).subtract(this.startPoint));this.minPosition_.x>this.maxPosition_.x||(i.x=p.clamp(i.x,this.minPosition_.x,this.maxPosition_.x)),this.minPosition_.y>this.maxPosition_.y||(i.y=p.clamp(i.y,this.minPosition_.y,this.maxPosition_.y)),n.multVecRot(i),this.trackPoint_changed_.getValue().equals(t)||(this.trackPoint_changed_=t),this.translation_changed_.getValue().equals(i)||(this.translation_changed_=i)}}),f}),define("cobweb/Components/Lighting/PointLight",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Lighting/X3DLightNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Utility/ObjectCache"],function(e,t,n,i,r,o,s,a){function u(e){this.location=new s(0,0,0),this.set(e)}function l(e){r.call(this,e.getBrowser(),e),this.addType(o.PointLight)}var c=a(u);return u.prototype={constructor:u,set:function(e){this.color=e.color_.getValue(),this.intensity=e.intensity_.getValue(),this.ambientIntensity=e.ambientIntensity_.getValue(),this.attenuation=e.attenuation_.getValue(),this.radius=e.radius_.getValue(),e.getBrowser().getModelViewMatrix().get().multVecMatrix(this.location.assign(e.location_.getValue()))},use:function(e,t,n){e.uniform1i(t.lightType[n],2),e.uniform3f(t.lightColor[n],this.color.r,this.color.g,this.color.b),e.uniform1f(t.lightIntensity[n],this.intensity),e.uniform1f(t.lightAmbientIntensity[n],this.ambientIntensity),e.uniform3f(t.lightAttenuation[n],this.attenuation.x,this.attenuation.y,this.attenuation.z),e.uniform3f(t.lightLocation[n],this.location.x,this.location.y,this.location.z),e.uniform1f(t.lightRadius[n],this.radius)},recycle:function(){c.push(this)}},l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"global",new t.SFBool(!0)),new n(o.inputOutput,"on",new t.SFBool(!0)),new n(o.inputOutput,"color",new t.SFColor(1,1,1)),new n(o.inputOutput,"intensity",new t.SFFloat(1)),new n(o.inputOutput,"ambientIntensity",new t.SFFloat),new n(o.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new n(o.inputOutput,"location",new t.SFVec3f),new n(o.inputOutput,"radius",new t.SFFloat(100))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return c}}),l}),define("cobweb/Components/Rendering/PointSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Numbers/Color4"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(s.PointSet),this.attribNodes=[],this.colorNode=null,this.coordNode=null}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"attrib",new t.MFNode),new n(s.inputOutput,"fogCoord",new t.SFNode),new n(s.inputOutput,"color",new t.SFNode),new n(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.attrib_.addInterest(this,"set_attrib__"),this.color_.addInterest(this,"set_color__"),this.coord_.addInterest(this,"set_coord__");var e=this.getBrowser();this.setShader(e.getPointShader()),this.setPrimitiveMode(e.getContext().POINTS),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].removeInterest(this,"addNodeEvent");this.attribNodes.length=0;for(var e=0,t=this.attrib_.length;t>e;++e){var n=o(s.X3DVertexAttributeNode,this.attrib_[e]);n&&this.attribNodes.push(n)}for(var e=0;e<this.attribNodes.length;++e)this.attribNodes[e].addInterest(this,"addNodeEvent")},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest(this,"addNodeEvent"),this.colorNode.removeInterest(this,"set_transparent__")),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest(this,"addNodeEvent"),this.colorNode.addInterest(this,"set_transparent__"),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest(this,"addNodeEvent"),this.coordNode=o(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest(this,"addNodeEvent")},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){var e=this.colorNode,t=this.coordNode;if(this.colorNode){for(var n=0,i=e.color_.length;i>n;++n)this.addColor(e.getColor(n));for(var i=t.point_.length;i>n;++n)this.addColor(new a(1,1,1,1))}for(var n=0,i=t.point_.length;i>n;++n)this.addVertex(t.getPoint(n))}}}),u}),define("cobweb/Components/Geometry2D/Polyline2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Polyline2D)}var u=new s(0,0,0);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"lineSegments",new t.MFVec2f)]),getTypeName:function(){return"Polyline2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_STRIP)},build:function(){for(var e=this.lineSegments_.getValue(),t=0,n=e.length;n>t;++t){var i=e[t];this.addVertex(u.set(i.x,i.y,0))}this.setSolid(!1)}}),a}),define("cobweb/Components/Geometry2D/Polypoint2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DLineGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Polypoint2D)}var u=new s(0,0,0);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec2f)]),getTypeName:function(){return"Polypoint2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this);var e=this.getBrowser();this.setShader(e.getPointShader()),this.setPrimitiveMode(e.getContext().POINTS),this.setSolid(!1)},build:function(){for(var e=this.point_.getValue(),t=0,n=e.length;n>t;++t){var i=e[t];this.addVertex(u.set(i.x,i.y,0))}}}),a}),define("cobweb/Components/Followers/PositionChaser",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionChaser)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFVec3f),new n(o.inputOnly,"set_destination",new t.SFVec3f),new n(o.initializeOnly,"initialValue",new t.SFVec3f),new n(o.initializeOnly,"initialDestination",new t.SFVec3f),new n(o.initializeOnly,"duration",new t.SFTime(1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"PositionChaser";
},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("cobweb/Components/Followers/PositionChaser2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionChaser2D)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFVec2f),new n(o.inputOnly,"set_destination",new t.SFVec2f),new n(o.initializeOnly,"initialValue",new t.SFVec2f),new n(o.initializeOnly,"initialDestination",new t.SFVec2f),new n(o.initializeOnly,"duration",new t.SFTime(1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),a}),define("cobweb/Components/Followers/PositionDamper",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionDamper)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFVec3f),new n(o.inputOnly,"set_destination",new t.SFVec3f),new n(o.initializeOnly,"initialValue",new t.SFVec3f),new n(o.initializeOnly,"initialDestination",new t.SFVec3f),new n(o.initializeOnly,"order",new t.SFInt32(3)),new n(o.inputOutput,"tolerance",new t.SFFloat(-1)),new n(o.inputOutput,"tau",new t.SFTime(.3)),new n(o.outputOnly,"value_changed",new t.SFVec3f),new n(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("cobweb/Components/Followers/PositionDamper2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionDamper2D)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFVec2f),new n(o.inputOnly,"set_destination",new t.SFVec2f),new n(o.initializeOnly,"initialValue",new t.SFVec2f),new n(o.initializeOnly,"initialDestination",new t.SFVec2f),new n(o.initializeOnly,"order",new t.SFInt32(3)),new n(o.inputOutput,"tau",new t.SFTime(.3)),new n(o.inputOutput,"tolerance",new t.SFFloat(-1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),a}),define("cobweb/Components/Interpolation/PositionInterpolator2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.PositionInterpolator2D)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_fraction",new t.SFFloat),new n(o.inputOutput,"key",new t.MFFloat),new n(o.inputOutput,"keyValue",new t.MFVec2f),new n(o.outputOnly,"value_changed",new t.SFVec2f)]),keyValue:new s(0,0),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec2f)},interpolate:function(e,t,n){this.value_changed_=this.keyValue.assign(this.keyValue_[e].getValue()).lerp(this.keyValue_[t].getValue(),n)}}),a}),define("cobweb/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["jquery","cobweb/Fields","cobweb/Components/Core/X3DSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r){function o(e,r){n.call(this,e,r),this.addType(i.X3DEnvironmentalSensorNode),this.addChildren("traversed",new t.SFBool(!0)),this.currentTraversed=!0}return o.prototype=e.extend(Object.create(n.prototype),{constructor:o,initialize:function(){n.prototype.initialize.call(this),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.enabled_.addInterest(this,"set_live__"),this.size_.addInterest(this,"set_live__"),this.traversed_.addInterest(this,"set_live__"),this.set_live__()},setTraversed:function(e){e?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=e},getTraversed:function(){return this.currentTraversed},set_live__:function(){this.traversed_.getValue()&&this.enabled_.getValue()&&this.isLive().getValue()&&this.getExecutionContext().isLive().getValue()&&!this.size_.getValue().equals(r.Zero)?this.getBrowser().sensors().addInterest(this,"update"):(this.getBrowser().sensors().removeInterest(this,"update"),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},update:function(){}}),o}),define("cobweb/Components/EnvironmentalSensor/ProximitySensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o,s,a,u,l,c){function h(e){r.call(this,e.getBrowser(),e),this.addType(s.ProximitySensor),this.setCameraObject(!0),this.viewpoint=null,this.modelViewMatrix=new l,this.invModelViewMatrix=new l,this.centerOfRotationMatrix=new l,this.position=new a,this.orientation=new u,this.centerOfRotation=new a,this.viewer=new a,this.inside=!1}function d(e){try{switch(e){case o.CAMERA:return this.viewpoint=this.getCurrentViewpoint(),void this.modelViewMatrix.assign(this.getBrowser().getModelViewMatrix().get());case o.DISPLAY:if(this.setTraversed(!0),this.inside)return;if(this.size_.getValue().equals(p))this.inside=!0;else{var t=this.invModelViewMatrix.assign(this.getBrowser().getModelViewMatrix().get()).inverse();this.viewer.set(t[12],t[13],t[14]),this.inside=this.intersectsPoint(this.viewer)}return}}catch(n){}}var p=new a(-1,-1,-1);return h.prototype=e.extend(Object.create(r.prototype),{constructor:h,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"size",new t.SFVec3f),new n(s.inputOutput,"center",new t.SFVec3f),new n(s.outputOnly,"enterTime",new t.SFTime),new n(s.outputOnly,"exitTime",new t.SFTime),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"position_changed",new t.SFVec3f),new n(s.outputOnly,"orientation_changed",new t.SFRotation),new n(s.outputOnly,"centerOfRotation_changed",new t.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.size_.addInterest(this,"set_extents__"),this.center_.addInterest(this,"set_extents__"),this.traversed_.addFieldInterest(this.isCameraObject_),this.min=new a(0,0,0),this.max=new a(0,0,0),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this.enabled_.getValue()),this.enabled_.getValue()?this.traverse=d:delete this.traverse},set_extents__:function(){var e=this.size_.getValue(),t=this.center_.getValue(),n=e.x/2,i=e.y/2,r=e.z/2,o=t.x,s=t.y,a=t.z;this.min.set(o-n,s-i,a-r),this.max.set(o+n,s+i,a+r)},update:function(){try{if(this.inside&&this.getTraversed()){var e=this.modelViewMatrix,t=this.centerOfRotationMatrix;t.assign(this.viewpoint.getTransformationMatrix()),t.translate(this.viewpoint.getUserCenterOfRotation()),t.multRight(this.invModelViewMatrix.assign(e).inverse()),e.multRight(this.viewpoint.getInverseCameraSpaceMatrix()),e.get(null,this.orientation),e.inverse(),this.position.set(e[12],e[13],e[14]),this.orientation.inverse(),this.centerOfRotation.set(t[12],t[13],t[14]),this.isActive_.getValue()?(this.position_changed_.getValue().equals(this.position)||(this.position_changed_=this.position),this.orientation_changed_.getValue().equals(this.orientation)||(this.orientation_changed_=this.orientation),this.centerOfRotation_changed_.getValue().equals(this.centerOfRotation)||(this.centerOfRotation_changed_=this.centerOfRotation)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=this.position,this.orientation_changed_=this.orientation,this.centerOfRotation_changed_=this.centerOfRotation),this.inside=!1}else this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}catch(n){}this.setTraversed(!1)},traverse:function(){},intersectsPoint:function(e){var t=this.min,n=this.max;return t.x<=e.x&&n.x>=e.x&&t.y<=e.y&&n.y>=e.y&&t.z<=e.z&&n.z>=e.z}}),h}),define("cobweb/Components/CADGeometry/QuadSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.QuadSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"QuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(e){return this.triangleIndex[e]},build:function(){if(this.getCoord()){var e=this.getCoord().getSize(),t=this.triangleIndex;e-=e%4,t.length=0;for(var n=0;e>n;n+=4){var i=n,o=n+1,s=n+2,a=n+3;t.push(i,o,s,i,s,a)}r.prototype.build.call(this,4,e,6,t.length)}},createNormals:function(e,t){return this.createFaceNormals(e,t)}}),s}),define("cobweb/Components/Geometry2D/Rectangle2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(o.Rectangle2D)}var l=new s(2,2);return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"size",new t.SFVec2f(2,2)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Rectangle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){var e=this.getBrowser().getRectangle2DOptions(),t=e.getGeometry(),n=this.size_.getValue();if(this.setTexCoords(t.getTexCoords()),this.setNormals(t.getNormals()),n.equals(l))this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var i=a.divide(n,2),r=i.x,o=i.y,s=t.getVertices(),u=this.getVertices(),c=0;c<s.length;c+=4)u.push(r*s[c],o*s[c+1],s[c+2],1);this.getMin().set(-r,-o,0),this.getMax().set(r,o,0)}this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null)},traverse:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getShader();i.use(),n.uniform1i(i.geometryType,2),r.prototype.traverse.call(this,e),n.uniform1i(i.geometryType,3)}}),u}),define("cobweb/Components/Followers/ScalarChaser",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.ScalarChaser)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFFloat),new n(o.inputOnly,"set_destination",new t.SFFloat),new n(o.initializeOnly,"initialValue",new t.SFFloat),new n(o.initializeOnly,"initialDestination",new t.SFFloat),new n(o.initializeOnly,"duration",new t.SFTime(1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(e){this.previousValue=e},copy:function(e){return e},assign:function(e,t,n){e[t]=n},equals:function(e,t,n){return Math.abs(e-t)<n},interpolate:function(e,t,n){return s.lerp(e,t,n)},step:function(e,t,n){this.output+=(e-t)*n}}),a}),define("cobweb/Components/Followers/ScalarDamper",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.ScalarDamper)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_value",new t.SFFloat),new n(o.inputOnly,"set_destination",new t.SFFloat),new n(o.initializeOnly,"initialValue",new t.SFFloat),new n(o.initializeOnly,"initialDestination",new t.SFFloat),new n(o.initializeOnly,"order",new t.SFInt32(3)),new n(o.inputOutput,"tau",new t.SFTime(.3)),new n(o.inputOutput,"tolerance",new t.SFFloat(-1)),new n(o.outputOnly,"isActive",new t.SFBool),new n(o.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},copy:function(e){return e},assign:function(e,t,n){e[t]=n},equals:function(e,t,n){return Math.abs(e-t)<n},interpolate:function(e,t,n){return s.lerp(e,t,n)}}),a}),define("cobweb/Components/Layout/ScreenGroup",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(o.ScreenGroup),this.screenMatrix=new u,this.modelViewMatrix=new u,this.invModelViewMatrix=new u}var h=new s(0,0,0),d=new a(0,0,1,0),p=new s(1,1,1);return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"ScreenGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},getBBox:function(){return r.prototype.getBBox.call(this).multRight(this.getMatrix())},getMatrix:function(){try{this.invModelViewMatrix.assign(this.modelViewMatrix).inverse(),this.matrix.assign(this.screenMatrix).multRight(this.invModelViewMatrix)}catch(e){}return this.matrix},scale:function(e){this.getModelViewMatrix(e,this.modelViewMatrix),this.modelViewMatrix.get(h,d,p);var t=this.getCurrentLayer().getViewVolume().getViewport(),n=this.getCurrentViewpoint().getScreenScale(this.modelViewMatrix.origin,t);this.screenMatrix.set(h,d,p.set(n.x*(l.signum(p.x)<0?-1:1),n.y*(l.signum(p.y)<0?-1:1),n.z*(l.signum(p.z)<0?-1:1))),this.getBrowser().getModelViewMatrix().set(this.screenMatrix)},traverse:function(e){var t=this.getBrowser().getModelViewMatrix();t.push(),this.scale(e),r.prototype.traverse.call(this,e),t.pop()}}),c}),define("cobweb/Configuration/UnitInfo",["jquery"],function(e){function t(e,t,n){this.category=e,this.name=t,this.conversionFactor=n}return e.extend(t.prototype,{constructor:t}),t}),define("cobweb/Configuration/UnitInfoArray",["jquery","cobweb/Configuration/X3DInfoArray"],function(e,t){function n(){return t.call(this)}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n}),n}),define("cobweb/Execution/X3DScene",["jquery","cobweb/Fields","cobweb/Execution/X3DExecutionContext","cobweb/Configuration/UnitInfo","cobweb/Configuration/UnitInfoArray","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e,t){n.call(this,e,t),this.getRootNodes().setAccessType(o.inputOutput),this.units=new r,this.units.add("angle",new i("angle","radian",1)),this.units.add("force",new i("force","newton",1)),this.units.add("length",new i("length","metre",1)),this.units.add("mass",new i("mass","kilogram",1)),this.metaData={}}return s.prototype=e.extend(Object.create(n.prototype),{constructor:s,isRootContext:function(){return!0},updateUnit:function(e,t,n){var i=this.units.get(e);i&&(i.name=t,i.conversionFactor=n)},setMetaData:function(e,t){e.length&&(this.metaData[e]=String(t))},getMetaData:function(e){return this.metaData[e]},setRootNodes:function(e){this.getRootNodes().setValue(e)}}),s}),define("cobweb/Browser/Scripting/evaluate",[],function(){return function(){with(arguments[0])return eval(arguments[1])}}),define("cobweb/Components/Scripting/X3DScriptNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Components/Networking/X3DUrlObject","cobweb/Bits/X3DConstants"],function(e,t,n,i){function r(e,r){t.call(this,e,r),n.call(this,e,r),this.addType(i.X3DScriptNode)}return r.prototype=e.extend(Object.create(t.prototype),n.prototype,{constructor:r}),r}),define("cobweb/Components/Scripting/Script",["jquery","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Basic/X3DField","cobweb/Basic/X3DArrayField","cobweb/Fields","cobweb/Browser/X3DBrowser","cobweb/Configuration/ComponentInfo","cobweb/Configuration/ComponentInfoArray","cobweb/Configuration/ProfileInfo","cobweb/Configuration/ProfileInfoArray","cobweb/Configuration/UnitInfo","cobweb/Configuration/UnitInfoArray","cobweb/Execution/X3DExecutionContext","cobweb/Execution/X3DScene","cobweb/Prototype/ExternProtoDeclarationArray","cobweb/Prototype/ProtoDeclarationArray","cobweb/Prototype/X3DExternProtoDeclaration","cobweb/Prototype/X3DProtoDeclaration","cobweb/Routing/RouteArray","cobweb/Routing/X3DRoute","cobweb/Browser/Scripting/evaluate","cobweb/Components/Scripting/X3DScriptNode","cobweb/InputOutput/Loader","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y,b,w,v,x,_,C,S){function T(e){this.fieldDefinitions=new n(F.slice(0)),_.call(this,e.getBrowser(),e),this.addType(S.Script)}var F=[new t(S.inputOutput,"metadata",new o.SFNode),new t(S.inputOutput,"url",new o.MFString),new t(S.initializeOnly,"directOutput",new o.SFBool),new t(S.initializeOnly,"mustEvaluate",new o.SFBool)];return T.prototype=e.extend(Object.create(_.prototype),{constructor:T,getTypeName:function(){return"Script"},getComponentName:function(){return"Scripting"},getContainerField:function(){return"children"},initialize:function(){_.prototype.initialize.call(this),this.url_.addInterest(this,"set_url__"),this.requestAsyncLoad()},getExtendedEventHandling:function(){return!1},hasUserDefinedFields:function(){return!0},getCDATA:function(){return this.url_},requestAsyncLoad:function(){this.checkLoadState()!==S.COMPLETE_STATE&&this.checkLoadState()!==S.IN_PROGRESS_STATE&&(this.setLoadState(S.IN_PROGRESS_STATE),this.getScene().addLoadCount(this),new C(this).loadScript(this.url_,function(e){this.getScene().removeLoadCount(this),null===e?this.setLoadState(S.FAILED_STATE):(this.setLoadState(S.COMPLETE_STATE),this.initialize__(e))}.bind(this)))},set_url__:function(){this.setLoadState(S.NOT_STATED_STATE),this.requestAsyncLoad()},getContext:function(e){var t=["initialize","prepareEvents","eventsProcessed","shutdown"],n=this.getUserDefinedFields();for(var i in n){var r=n[i];switch(r.getAccessType()){case S.inputOnly:t.push(r.getName());break;case S.inputOutput:t.push("set_"+r.getName())}}e+="\n;var "+t.join(",")+";",e+="\n["+t.join(",")+"];";for(var o=this.getGlobal(),s=x(o,e),a={},u=0;u<t.length;++u)"function"==typeof s[u]?a[t[u]]=s[u]:a[t[u]]=null;return a},getGlobal:function(){function e(e){var t=x.createX3DFromString(String(e));if(t.getRootNodes().length&&t.getRootNodes()[0])return o.SFNode.call(this,t.getRootNodes()[0].getValue());throw new Error("SFNode.new: invalid argument, must be 'string' is 'undefined'.")}var x=this.getBrowser();e.prototype=Object.create(o.SFNode.prototype),e.prototype.constructor=e;var _={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:function(){this.print.apply(this,arguments)}.bind(x)},trace:{value:function(){this.print.apply(this,arguments)}.bind(x)},Browser:{value:x},X3DConstants:{value:S},X3DBrowser:{value:s},X3DExecutionContext:{value:p},X3DScene:{value:f},ComponentInfo:{value:a},ComponentInfoArray:{value:u},ProfileInfo:{value:l},ProfileInfoArray:{value:c},UnitInfo:{value:h},UnitInfoArray:{value:d},ExternProtoDeclarationArray:{value:g},ProtoDeclarationArray:{value:m},X3DExternProtoDeclaration:{value:y},X3DProtoDeclaration:{value:b},RouteArray:{value:w},X3DRoute:{value:v},X3DFieldDefinition:{value:t},FieldDefinitionArray:{value:n},X3DField:{value:i},X3DArrayField:{value:r},SFColor:{value:o.SFColor},SFColorRGBA:{value:o.SFColorRGBA},SFImage:{value:o.SFImage},SFMatrix3d:{value:o.SFMatrix3d},SFMatrix3f:{value:o.SFMatrix3f},SFMatrix4d:{value:o.SFMatrix4d},SFMatrix4f:{value:o.SFMatrix4f},SFNode:{value:e},SFRotation:{value:o.SFRotation},SFVec3d:{value:o.SFVec2d},SFVec2f:{value:o.SFVec2f},SFVec2d:{value:o.SFVec3d},SFVec3f:{value:o.SFVec3f},SFVec4d:{value:o.SFVec4d},SFVec4f:{value:o.SFVec4f},VrmlMatrix:{value:o.VrmlMatrix},MFBool:{value:o.MFBool},MFColor:{value:o.MFColor},MFColorRGBA:{value:o.MFColorRGBA},MFDouble:{value:o.MFDouble},MFFloat:{value:o.MFFloat},MFImage:{value:o.MFImage},MFInt32:{value:o.MFInt32},MFMatrix3d:{value:o.MFMatrix3d},MFMatrix3f:{value:o.MFMatrix3f},MFMatrix4d:{value:o.MFMatrix4d},MFMatrix4f:{value:o.MFMatrix4f},MFNode:{value:o.MFNode},MFRotation:{value:o.MFRotation},MFString:{value:o.MFString},MFTime:{value:o.MFTime},MFVec2d:{value:o.MFVec2d},MFVec2f:{value:o.MFVec2f},MFVec3d:{value:o.MFVec3d},MFVec3f:{value:o.MFVec3f},MFVec4d:{value:o.MFVec4d},MFVec4f:{value:o.MFVec4f}},C=this.getUserDefinedFields();for(var T in C){var F=C[T];F.getAccessType()!==S.inputOnly&&(T in _||(_[T]={get:F.valueOf.bind(F),set:F.setValue.bind(F)}),F.getAccessType()===S.inputOutput&&(_[T+"_changed"]={get:F.valueOf.bind(F),set:F.setValue.bind(F)}))}return Object.create(Object.prototype,_)},set_live__:function(){var t=this.getUserDefinedFields();if(this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()){e.isFunction(this.context.prepareEvents)&&this.getBrowser().prepareEvents().addInterest(this,"prepareEvents__"),e.isFunction(this.context.eventsProcessed)&&this.addInterest(this,"eventsProcessed__");for(var n in t){var i=t[n];switch(i.getAccessType()){case S.inputOnly:var r=this.context[i.getName()];e.isFunction(r)&&i.addInterest(this,"set_field__",r);break;case S.inputOutput:var r=this.context["set_"+i.getName()];e.isFunction(r)&&i.addInterest(this,"set_field__",r)}}}else{this.context.prepareEvents&&this.getBrowser().prepareEvents().removeInterest(this,"prepareEvents__"),this.context.eventsProcessed&&this.removeInterest(this,"eventsProcessed__");for(var n in t){var i=t[n];switch(i.getAccessType()){case S.inputOnly:case S.inputOutput:i.removeInterest(this,"set_field__")}}}},initialize__:function(e){if(this.context=this.getContext(e),this.getExecutionContext().isLive().addInterest(this,"set_live__"),this.isLive().addInterest(this,"set_live__"),this.set_live__(),this.context.initialize){var t=this.getBrowser();t.getScriptStack().push(this);try{this.context.initialize()}catch(n){this.setError("initialize",n)}t.getScriptStack().pop()}},prepareEvents__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.prepareEvents()}catch(t){this.setError("prepareEvents",t)}e.getScriptStack().pop()},set_field__:function(e,t){var n=this.getBrowser();e.setTainted(!0),n.getScriptStack().push(this);try{t(e.valueOf(),n.getCurrentTime())}catch(i){this.setError(e.getName(),i)}n.getScriptStack().pop(),e.setTainted(!1)},eventsProcessed__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.eventsProcessed()}catch(t){this.setError("eventsProcessed",t)}e.getScriptStack().pop()},shutdown__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.shutdown()}catch(t){this.setError("shutdown",t)}e.getScriptStack().pop()},setError:function(e,t){console.error("JavaScript Error in Script '"+this.getName()+"', function '"+e+"'\nworld url is '"+this.getExecutionContext().getURL()+"':"),console.error(t)}}),T}),define("cobweb/Components/Shape/X3DShapeNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Components/Grouping/X3DBoundedObject","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o){function s(e,i){t.call(this,e,i),n.call(this,e,i),this.addType(r.X3DShapeNode)}return s.prototype=e.extend(Object.create(t.prototype),n.prototype,{constructor:s,initialize:function(){t.prototype.initialize.call(this),n.prototype.initialize.call(this),this.bboxSize_.addInterest(this,"set_bbox__"),this.bboxCenter_.addInterest(this,"set_bbox__"),this.appearance_.addInterest(this,"set_apparance__"),this.geometry_.addInterest(this,"set_geometry__"),this.set_apparance__(),this.set_geometry__(),this.set_bbox__(),this.static_=!0},getBBox:function(){return this.bbox},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},isTransparent:function(){return this.transparent},set_bbox__:function(){this.bboxSize_.getValue().equals(this.defaultBBoxSize)?this.getGeometry()?this.bbox=this.getGeometry().getBBox():this.bbox=new o:this.bbox=new o(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize=this.bbox.size,this.bboxCenter=this.bbox.center},set_apparance__:function(){this.apparanceNode&&this.apparanceNode.removeInterest(this,"set_transparent__"),this.apparanceNode=i(r.X3DAppearanceNode,this.appearance_),this.apparanceNode?this.apparanceNode.addInterest(this,"set_transparent__"):this.apparanceNode=this.getBrowser().getDefaultAppearance(),this.set_transparent__()},set_geometry__:function(){this.geometryNode&&(this.geometryNode.removeInterest(this,"set_transparent__"),this.geometryNode.removeInterest(this,"set_bbox__")),this.geometryNode=i(r.X3DGeometryNode,this.geometry_),this.geometryNode&&(this.geometryNode.addInterest(this,"set_transparent__"),this.geometryNode.addInterest(this,"set_bbox__")),this.set_transparent__(),this.set_bbox__()},set_transparent__:function(){this.transparent=this.apparanceNode&&this.apparanceNode.transparent_.getValue()||this.geometryNode&&this.geometryNode.transparent_.getValue()}}),s}),define("cobweb/Components/Shape/Shape",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shape/X3DShapeNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Geometry/Line3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/QuickSort","standard/Math/Geometry/ViewVolume"],function(e,t,n,i,r,o,s,a,u,l,c,h,d){function p(e){r.call(this,e.getBrowser(),e),this.addType(s.Shape)}var f=[];return p.prototype=e.extend(Object.create(r.prototype),{constructor:p,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(s.initializeOnly,"bboxCenter",new t.SFVec3f),new n(s.inputOutput,"appearance",new t.SFNode),new n(s.inputOutput,"geometry",new t.SFNode)]),modelViewMatrix:new c,invModelViewMatrix:new c,hitRay:new u(new l(0,0,0),new l(0,0,0)),intersections:f,intersectionSorter:new h(f,function(e,t){return e.point.z>t.point.z}),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},traverse:function(e){if(this.getGeometry())switch(e){case o.POINTER:this.pointer();break;case o.COLLISION:this.getCurrentLayer().addCollision(this);break;case o.DISPLAY:this.getCurrentLayer().addShape(this)}},pointer:function(){try{var e=this.getGeometry();if(e.isLineGeometry())return;var t=this.getBrowser(),n=e.transformMatrix(this.modelViewMatrix.assign(t.getModelViewMatrix().get())),i=this.invModelViewMatrix.assign(n).inverse(),r=this.intersections;if(this.hitRay.assign(t.getHitRay()).multLineMatrix(i),e.intersectsLine(this.hitRay,r,i)){for(var o=0;o<r.length;++o)n.multVecMatrix(r[o].point);this.intersectionSorter.sort(0,r.length);var s=a.lowerBound(r,0,r.length,-this.getCurrentNavigationInfo().getNearPlane(),function(e,t){return e.point.z>t});s!==r.length&&(i.multMatrixDir(r[s].normal).normalize(),t.addHit(r[s],this.getCurrentLayer())),r.length=0}}catch(u){}},draw:function(e){this.getAppearance().traverse(),this.getGeometry().traverse(e)},collision:function(e){this.getGeometry().collision(e)},intersectsSphere:function(e){return this.getGeometry().intersectsSphere(e)}}),p}),define("cobweb/Components/Sound/X3DSoundNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DSoundNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Sound/Sound",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Sound/X3DSoundNode","cobweb/Bits/X3DCast","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u,l,c,h){function d(e){r.call(this,e.getBrowser(),e),this.addType(a.Sound),this.min={radius:0,distance:0},this.max={radius:0,distance:0}}return d.prototype=e.extend(Object.create(r.prototype),{constructor:d,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"intensity",new t.SFFloat(1)),new n(a.initializeOnly,"spatialize",new t.SFBool(!0)),new n(a.inputOutput,"location",new t.SFVec3f),new n(a.inputOutput,"direction",new t.SFVec3f(0,0,1)),new n(a.inputOutput,"minBack",new t.SFFloat(1)),new n(a.inputOutput,"minFront",new t.SFFloat(1)),new n(a.inputOutput,"maxBack",new t.SFFloat(10)),new n(a.inputOutput,"maxFront",new t.SFFloat(10)),new n(a.inputOutput,"priority",new t.SFFloat),new n(a.inputOutput,"source",new t.SFNode)]),
transformationMatrix:new h,translation:new l(0,0,0),rotation:new c,scale:new l(1,1,1),viewer:new l(0,0,0),zAxis:new l(0,0,1),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.source_.addInterest(this,"set_source__"),this.set_source__()},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=o(a.X3DSoundSourceNode,this.source_)},traverse:function(e){if(e===s.DISPLAY&&this.sourceNode&&this.sourceNode.isActive_.getValue()&&!this.sourceNode.isPaused_.getValue())try{if(this.getEllipsoidParameter(this.maxBack_.getValue(),this.maxFront_.getValue(),this.max),this.getEllipsoidParameter(this.minBack_.getValue(),this.minFront_.getValue(),this.min),this.max.distance<this.max.radius)if(this.min.distance<this.min.radius)this.sourceNode.setVolume(this.intensity_.getValue());else{var t=this.max.radius-this.max.distance,n=this.max.radius-this.min.radius;this.sourceNode.setVolume(this.intensity_.getValue()*(t/n))}else this.sourceNode.setVolume(0)}catch(i){console.log(i)}},getEllipsoidParameter:function(e,t,n){var i=(e+t)/2,r=i-e,o=Math.sqrt(i*i-r*r);this.translation.z=r,this.rotation.setFromToVec(this.zAxis,this.direction_.getValue()),this.scale.z=o/i;var s=this.transformationMatrix;s.assign(this.getBrowser().getModelViewMatrix().get()),s.translate(this.location_.getValue()),s.rotate(this.rotation),s.translate(this.translation),s.scale(this.scale),s.inverse(),this.viewer.set(s[12],s[13],s[14]),n.radius=o,n.distance=this.viewer.abs()}}),d}),define("cobweb/Components/Geometry3D/Sphere",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.Sphere)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"radius",new t.SFFloat(1)),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest(this,"eventsProcessed"):this.getBrowser().getSphereOptions().removeInterest(this,"eventsProcessed")},build:function(){var e=this.getBrowser().getSphereOptions(),t=e.getGeometry(),n=this.radius_.getValue();if(this.setNormals(t.getNormals()),this.setTexCoords(t.getTexCoords()),1===n)this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var i=t.getVertices(),r=this.getVertices(),o=0;o<i.length;o+=4)r.push(n*i[o],n*i[o+1],n*i[o+2],1);this.getMin().set(-n,-n,-n),this.getMax().set(n,n,n)}this.setSolid(this.solid_.getValue()),this.setCurrentTexCoord(null)}}),a}),define("cobweb/Components/PointingDeviceSensor/SphereSensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/PointingDeviceSensor/X3DDragSensorNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],function(e,t,n,i,r,o,s,a,u,l,c,h,d){function p(e){r.call(this,e.getBrowser(),e),this.addType(o.SphereSensor)}return p.prototype=e.extend(Object.create(r.prototype),{constructor:p,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"enabled",new t.SFBool(!0)),new n(o.inputOutput,"description",new t.SFString),new n(o.inputOutput,"autoOffset",new t.SFBool(!0)),new n(o.inputOutput,"offset",new t.SFRotation),new n(o.outputOnly,"trackPoint_changed",new t.SFVec3f),new n(o.outputOnly,"rotation_changed",new t.SFRotation),new n(o.outputOnly,"isOver",new t.SFBool),new n(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startPoint=new s(0,0,0),this.startOffset=new a(0,0,1,0)},getTrackPoint:function(e,t,n){var i=new s(0,0,0);return this.sphere.intersectsLine(e,t,i)?((s.subtract(e.point,i).abs()<s.subtract(e.point,t).abs())-n&&t.assign(i),!0):!1},set_active__:function(e,t){r.prototype.set_active__.call(this,e,t);try{if(this.isActive_.getValue()){var n=this.getMatrices()[e.layer.getId()];this.modelViewMatrix.assign(n.modelViewMatrix),this.invModelViewMatrix.assign(this.modelViewMatrix).inverse();var i=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),o=new s(0,0,0);this.zPlane=new h(o,this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize()),this.sphere=new d(i.abs(),o),this.behind=this.zPlane.getDistanceToPoint(i)<0,this.fromVector.assign(i),this.startPoint.assign(i),this.startOffset.assign(this.offset_.getValue())}else this.autoOffset_.getValue()&&(this.offset_=this.rotation_changed_)}catch(a){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new s(0,0,0);if(this.getTrackPoint(t,n,this.behind)){var i=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize();this.zPlane=new h(n,i)}else{var r=new s(0,0,0);this.zPlane.intersectsLine(t,r),t=new c(r,s.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(t,n,!1);var o=l.normal(this.sphere.center,n,this.startPoint,new s(0,0,0)),u=s.subtract(n,this.sphere.center).normalize(),d=s.cross(o,u).normalize(),p=s.subtract(n,d.multiply(s.subtract(r,n).abs()));t=new c(p,s.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(t,n,!1)}this.trackPoint_changed_=n;var f=s.subtract(n,this.sphere.center),g=new a(this.fromVector,f);this.behind&&g.inverse(),this.rotation_changed_=a.multRight(this.startOffset,g)}catch(m){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),p}),define("cobweb/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t){function n(){this.T0=[],this.T1=[]}var i=[],r=[],o=[],s=new e(0,0,0,0),a=new t(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);return n.prototype={constructor:n,generate:function(e,t,n,s,a){var u=this.T0,l=this.T1;if(u.length=0,l.length=0,i.length=0,r.length=0,o.length=0,t.length>1){if(0===s.length){e?i.push(this.divide(this.subtract(n[1].getValue(),n[n.size()-2].getValue()),2)):i.push(this.create());for(var c=1,h=n.length-1;h>c;++c)i.push(this.divide(this.subtract(n[c+1].getValue(),n[c-1].getValue()),2));i.push(this.copy(i[0]))}else{for(var c=0,h=s.length;h>c;++c)i.push(this.copy(s[c].getValue()));if(a){for(var d=0,c=0,h=n.length-1;h>c;++c)d+=this.abs(this.subtract(n[c].getValue(),n[c+1].getValue()));for(var c=0,h=i.length-1;h>c;++c)i[c]=this.multiply(i[c],d/this.abs(i[c]))}}if(e){var p=t.length-1,f=t.length-2,g=t[1].getValue()-t[0].getValue()+t[p].getValue()-t[f].getValue();o.push(2*(t[1].getValue()-t[0].getValue())/g),r.push(2*(t[p].getValue()-t[f].getValue())/g)}else o.push(1),r.push(1);for(var c=1,h=t.length-1;h>c;++c){var g=t[c+1].getValue()-t[c-1].getValue();o.push(2*(t[c+1].getValue()-t[c].getValue())/g),r.push(2*(t[c].getValue()-t[c-1].getValue())/g)}o.push(o[0]),r.push(r[0]);for(var c=0,h=i.length;h>c;++c)u.push(this.multiply(i[c],r[c])),l.push(this.multiply(i[c],o[c]))}else u.push(this.create()),l.push(this.create())},interpolate:function(e,t,n,i){return s.set(Math.pow(n,3),Math.pow(n,2),n,1),this.dot(a.multVecMatrix(s),i[e].getValue(),i[t].getValue(),this.T0[e],this.T1[t])}},n}),define("cobweb/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["jquery","cobweb/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e,t){return function(n){function i(){this.T0=[],this.T1=[]}var r=new n(0,0,0,0),o=new n(0,0,0,0),s=new n(0,0,0,0),a=new n(0,0,0,0);return i.prototype=e.extend(Object.create(t.prototype),{constructor:i,create:function(){return new n(0,0,0,0)},copy:function(e){return e.copy()},subtract:function(e,t){return n.subtract(e,t)},multiply:function(e,t){return n.multiply(e,t)},divide:function(e,t){return n.divide(e,t)},abs:function(e){return e.abs()},dot:function(e,t,n,i,u){return r.assign(t).multiply(e[0]),o.assign(n).multiply(e[1]),s.assign(i).multiply(e[2]),a.assign(u).multiply(e[3]),r.add(o).add(s).add(a)}}),i}}),define("cobweb/Browser/Interpolation/CatmullRomSplineInterpolator3",["cobweb/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],function(e,t){return e(t)}),define("cobweb/Components/Interpolation/SplinePositionInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Browser/Interpolation/CatmullRomSplineInterpolator3","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.SplinePositionInterpolator),this.spline=new o}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_fraction",new t.SFFloat),new n(s.inputOutput,"closed",new t.SFBool),new n(s.inputOutput,"key",new t.MFFloat),new n(s.inputOutput,"keyValue",new t.MFVec3f),new n(s.inputOutput,"keyVelocity",new t.MFVec3f),new n(s.inputOutput,"normalizeVelocity",new t.SFBool),new n(s.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__"),this.keyVelocity_.addInterest(this,"set_keyVelocity__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFVec3f),this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(e,t,n){this.value_changed_=this.spline.interpolate(e,t,n,this.keyValue_.getValue())}}),a}),define("cobweb/Browser/Interpolation/CatmullRomSplineInterpolator2",["cobweb/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],function(e,t){return e(t)}),define("cobweb/Components/Interpolation/SplinePositionInterpolator2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Browser/Interpolation/CatmullRomSplineInterpolator2","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.SplinePositionInterpolator2D),this.spline=new o}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_fraction",new t.SFFloat),new n(s.inputOutput,"closed",new t.SFBool),new n(s.inputOutput,"key",new t.MFFloat),new n(s.inputOutput,"keyValue",new t.MFVec2f),new n(s.inputOutput,"keyVelocity",new t.MFVec2f),new n(s.inputOutput,"normalizeVelocity",new t.SFBool),new n(s.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__"),this.keyVelocity_.addInterest(this,"set_keyVelocity__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFVec2f),this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(e,t,n){this.value_changed_=this.spline.interpolate(e,t,n,this.keyValue_.getValue())}}),a}),define("cobweb/Browser/Interpolation/CatmullRomSplineInterpolator1",["jquery","cobweb/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e,t){function n(){this.T0=[],this.T1=[]}return n.prototype=e.extend(Object.create(t.prototype),{constructor:n,create:function(){return 0},copy:function(e){return e},subtract:function(e,t){return e-t},multiply:function(e,t){return e*t},divide:function(e,t){return e/t},abs:function(e){return Math.abs(e)},dot:function(e,t,n,i,r){return t*e[0]+n*e[1]+i*e[2]+r*e[3]}}),n}),define("cobweb/Components/Interpolation/SplineScalarInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Browser/Interpolation/CatmullRomSplineInterpolator1","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.SplineScalarInterpolator),this.spline=new o}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_fraction",new t.SFFloat),new n(s.inputOutput,"closed",new t.SFBool),new n(s.inputOutput,"key",new t.MFFloat),new n(s.inputOutput,"keyValue",new t.MFFloat),new n(s.inputOutput,"keyVelocity",new t.MFFloat),new n(s.inputOutput,"normalizeVelocity",new t.SFBool),new n(s.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__"),this.keyVelocity_.addInterest(this,"set_keyVelocity__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFFloat),this.spline.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue(),this.keyVelocity_.getValue(),this.normalizeVelocity_.getValue())},interpolate:function(e,t,n){this.value_changed_=this.spline.interpolate(e,t,n,this.keyValue_.getValue())}}),a}),define("cobweb/Components/Lighting/SpotLight",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Lighting/X3DLightNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Utility/ObjectCache"],function(e,t,n,i,r,o,s,a){function u(e){this.location=new s(0,0,0),this.direction=new s(0,0,0),this.set(e)}function l(e){r.call(this,e.getBrowser(),e),this.addType(o.SpotLight)}var c=a(u);return u.prototype={constructor:u,set:function(e){var t=e.getBrowser().getModelViewMatrix().get();this.color=e.color_.getValue(),this.intensity=e.intensity_.getValue(),this.ambientIntensity=e.ambientIntensity_.getValue(),this.attenuation=e.attenuation_.getValue(),this.beamWidth=e.beamWidth_.getValue(),this.cutOffAngle=e.cutOffAngle_.getValue(),this.radius=e.radius_.getValue(),t.multVecMatrix(this.location.assign(e.location_.getValue())),t.multDirMatrix(this.direction.assign(e.direction_.getValue())).normalize()},use:function(e,t,n){e.uniform1i(t.lightType[n],3),e.uniform3f(t.lightColor[n],this.color.r,this.color.g,this.color.b),e.uniform1f(t.lightIntensity[n],this.intensity),e.uniform1f(t.lightAmbientIntensity[n],this.ambientIntensity),e.uniform3f(t.lightAttenuation[n],this.attenuation.x,this.attenuation.y,this.attenuation.z),e.uniform3f(t.lightLocation[n],this.location.x,this.location.y,this.location.z),e.uniform3f(t.lightDirection[n],this.direction.x,this.direction.y,this.direction.z),e.uniform1f(t.lightBeamWidth[n],this.beamWidth),e.uniform1f(t.lightCutOffAngle[n],this.cutOffAngle),e.uniform1f(t.lightRadius[n],this.radius)},recycle:function(){c.push(this)}},l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"global",new t.SFBool(!0)),new n(o.inputOutput,"on",new t.SFBool(!0)),new n(o.inputOutput,"color",new t.SFColor(1,1,1)),new n(o.inputOutput,"intensity",new t.SFFloat(1)),new n(o.inputOutput,"ambientIntensity",new t.SFFloat),new n(o.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new n(o.inputOutput,"location",new t.SFVec3f),new n(o.inputOutput,"direction",new t.SFVec3f(0,0,-1)),new n(o.inputOutput,"radius",new t.SFFloat(100)),new n(o.inputOutput,"beamWidth",new t.SFFloat(.785398)),new n(o.inputOutput,"cutOffAngle",new t.SFFloat(1.5708))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return c}}),l}),define("cobweb/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],function(e){function t(){this.s=[]}var n=new e(0,0,1,0);return t.prototype={constructor:t,generate:function(t,n,i){var r=this.s;if(r.length=0,n.length>1){t?r.push(e.spline(i[n.length-2].getValue(),i[0].getValue(),i[1].getValue())):r.push(i[0].getValue());for(var o=1,s=n.length-1;s>o;++o)r.push(e.spline(i[o-1].getValue(),i[o].getValue(),i[o+1].getValue()));t?r.push(e.spline(i[n.length-2].getValue(),i[n.length-1].getValue(),i[1].getValue())):r.push(i[n.length-1].getValue())}else n.length>0&&r.push(i[0].getValue().copy())},interpolate:function(e,t,i,r){return n.assign(r[e].getValue()).squad(this.s[e],this.s[t],r[t].getValue(),i)}},t}),define("cobweb/Components/Interpolation/SquadOrientationInterpolator",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Interpolation/X3DInterpolatorNode","cobweb/Browser/Interpolation/SquatInterpolator","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.SquadOrientationInterpolator),this.squad=new o}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_fraction",new t.SFFloat),new n(s.inputOutput,"closed",new t.SFBool),new n(s.inputOutput,"key",new t.MFFloat),new n(s.inputOutput,"keyValue",new t.MFRotation),new n(s.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.keyValue_.addInterest(this,"set_keyValue__")},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFRotation),this.squad.generate(this.closed_.getValue(),this.key_.getValue(),this.keyValue_.getValue())},interpolate:function(e,t,n){try{this.value_changed_=this.squad.interpolate(e,t,n,this.keyValue_.getValue())}catch(i){console.log(i)}}}),a}),define("cobweb/Components/Grouping/StaticGroup",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Components/Grouping/X3DBoundedObject","cobweb/Components/Grouping/Group","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),o.call(this,e.getBrowser(),e),this.addType(a.StaticGroup)}return u.prototype=e.extend(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(a.initializeOnly,"bboxCenter",new t.SFVec3f),new n(a.initializeOnly,"children",new t.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.group=new s(this.getExecutionContext()),this.children_.addFieldInterest(this.group.children_),this.group.children_=this.children_,this.group.setup(),this.traverse=this.group.traverse.bind(this.group)}}),u}),define("cobweb/Components/Grouping/Switch",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DGroupingNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),this.addType(s.Switch),this.addAlias("choice",this.children_)}return u.prototype=e.extend(Object.create(r.prototype),{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"whichChoice",new t.SFInt32(-1)),new n(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(s.initializeOnly,"bboxCenter",new t.SFVec3f),new n(s.inputOnly,"addChildren",new t.MFNode),new n(s.inputOnly,"removeChildren",new t.MFNode),new n(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.whichChoice_.addInterest(this,"set_whichChoice__"),this.set_whichChoice__()},getBBox:function(){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=o(s.X3DBoundedObject,this.child);return e?e.getBBox():new a}return new a(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_whichChoice__:function(){this.set_cameraObjects__()},set_cameraObjects__:function(){this.child=this.getChild(this.whichChoice_.getValue()),this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},traverse:function(e){this.child&&this.child.traverse(e)}}),u}),define("cobweb/Components/Followers/TexCoordChaser2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DChaserNode","cobweb/Browser/Followers/X3DArrayChaserTemplate","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),l.call(this,e.getBrowser(),e),this.addType(s.TexCoordChaser2D)}var l=o(r);return u.prototype=e.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_value",new t.MFVec2f),new n(s.inputOnly,"set_destination",new t.MFVec2f),new n(s.initializeOnly,"initialValue",new t.MFVec2f),new n(s.initializeOnly,"initialDestination",new t.MFVec2f),new n(s.initializeOnly,"duration",new t.SFTime(1)),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0)},getArray:function(){return new t.MFVec2f}}),u}),define("cobweb/Components/Followers/TexCoordDamper2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Followers/X3DDamperNode","cobweb/Browser/Followers/X3DArrayFollowerTemplate","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,n,i,r,o,s,a){function u(e){r.call(this,e.getBrowser(),e),l.call(this,e.getBrowser(),e),this.addType(s.TexCoordDamper2D)}var l=o(r);return u.prototype=e.extend(Object.create(r.prototype),l.prototype,{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_value",new t.MFVec2f),new n(s.inputOnly,"set_destination",new t.MFVec2f),new n(s.initializeOnly,"initialValue",new t.MFVec2f),new n(s.initializeOnly,"initialDestination",new t.MFVec2f),new n(s.initializeOnly,"order",new t.SFInt32(3)),new n(s.inputOutput,"tau",new t.SFTime(.3)),new n(s.inputOutput,"tolerance",new t.SFFloat(-1)),new n(s.outputOnly,"isActive",new t.SFBool),new n(s.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new a(0,0,0)},getArray:function(){return new t.MFVec2f}}),u}),define("cobweb/Components/Text/Text",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.Text)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"string",new t.MFString),new n(s.inputOutput,"length",new t.MFFloat),new n(s.inputOutput,"maxExtent",new t.SFFloat),new n(s.initializeOnly,"solid",new t.SFBool),new n(s.outputOnly,"origin",new t.SFVec3f),new n(s.outputOnly,"textBounds",new t.SFVec2f),new n(s.outputOnly,"lineBounds",new t.MFVec2f),new n(s.inputOutput,"fontStyle",new t.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.fontStyle_.addInterest(this,"set_fontStyle__"),this.set_fontStyle__(),this.eventsProcessed()},getLength:function(e){return e<this.length_.length?this.length_[e]:0},set_live__:function(){r.prototype.set_live__.call(this),this.getExecutionContext().isLive().getValue()&&this.isLive().getValue()?this.getBrowser().getBrowserOptions().PrimitiveQuality_.addInterest(this,"eventsProcessed"):this.getBrowser().getBrowserOptions().PrimitiveQuality_.removeInterest(this,"eventsProcessed")},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest(this,"addNodeEvent"),this.fontStyleNode=o(s.X3DFontStyleNode,this.fontStyle_),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest(this,"addNodeEvent"),this.textGeometry=this.fontStyleNode.getTextGeometry(this)},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this.solid_.getValue())}}),a}),define("cobweb/Components/EnvironmentalEffects/TextureBackground",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EnvironmentalEffects/X3DBackgroundNode","cobweb/Bits/X3DCast","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(s.TextureBackground)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOnly,"set_bind",new t.SFBool),new n(s.inputOutput,"skyAngle",new t.MFFloat),new n(s.inputOutput,"skyColor",new t.MFColor(0,0,0)),new n(s.inputOutput,"groundAngle",new t.MFFloat),new n(s.inputOutput,"groundColor",new t.MFColor),new n(s.inputOutput,"transparency",new t.SFFloat),new n(s.outputOnly,"isBound",new t.SFBool),new n(s.outputOnly,"bindTime",new t.SFTime),new n(s.inputOutput,"frontTexture",new t.SFNode),new n(s.inputOutput,"backTexture",new t.SFNode),new n(s.inputOutput,"leftTexture",new t.SFNode),new n(s.inputOutput,"rightTexture",new t.SFNode),new n(s.inputOutput,"topTexture",new t.SFNode),new n(s.inputOutput,"bottomTexture",new t.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.frontTexture_.addInterest(this,"set_frontTexture__"),this.backTexture_.addInterest(this,"set_backTexture__"),this.leftTexture_.addInterest(this,"set_leftTexture__"),this.rightTexture_.addInterest(this,"set_rightTexture__"),this.topTexture_.addInterest(this,"set_topTexture__"),this.bottomTexture_.addInterest(this,"set_bottomTexture__"),this.set_frontTexture__(this.frontTexture_),this.set_backTexture__(this.backTexture_),this.set_leftTexture__(this.leftTexture_),this.set_rightTexture__(this.rightTexture_),this.set_topTexture__(this.topTexture_),this.set_bottomTexture__(this.bottomTexture_)},set_frontTexture__:function(){r.prototype.set_frontTexture__.call(this,o(s.X3DTextureNode,this.frontTexture_))},set_backTexture__:function(){r.prototype.set_backTexture__.call(this,o(s.X3DTextureNode,this.backTexture_))},set_leftTexture__:function(){r.prototype.set_leftTexture__.call(this,o(s.X3DTextureNode,this.leftTexture_))},set_rightTexture__:function(){r.prototype.set_rightTexture__.call(this,o(s.X3DTextureNode,this.rightTexture_))},set_topTexture__:function(){r.prototype.set_topTexture__.call(this,o(s.X3DTextureNode,this.topTexture_))},set_bottomTexture__:function(){r.prototype.set_bottomTexture__.call(this,o(s.X3DTextureNode,this.bottomTexture_))}}),a}),define("cobweb/Components/Texturing3D/TextureCoordinate3D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureCoordinateNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureCoordinate3D)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec3f)]),getTypeName:function(){return"TextureCoordinate3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(e,t){if(t>=0&&t<this.point_.length){var n=this.point_[t];e.push(n.x,n.y,n.z,1)}else e.push(0,0,0,1)}}),s}),define("cobweb/Components/Texturing3D/TextureCoordinate4D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureCoordinateNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureCoordinate4D)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"point",new t.MFVec4f)]),getTypeName:function(){return"TextureCoordinate4D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},addTexCoordToChannel:function(e,t){if(t>=0&&t<this.point_.length){var n=this.point_[t];e.push(n.x,n.y,n.z,n.w)}else e.push(0,0,0,1)}}),s}),define("cobweb/Components/Texturing3D/TextureTransform3D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureTransformNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureTransform3D)}var c=new s(0,0,0);return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"translation",new t.SFVec3f),new n(o.inputOutput,"rotation",new t.SFRotation),new n(o.inputOutput,"scale",new t.SFVec3f(1,1,1)),new n(o.inputOutput,"center",new t.SFVec3f)]),
getTypeName:function(){return"TextureTransform3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},initialize:function(){r.prototype.initialize.call(this),this.addInterest(this,"eventsProcessed"),this.eventsProcessed()},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var e=this.translation_.getValue(),t=this.rotation_.getValue(),n=this.scale_.getValue(),i=this.center_.getValue(),o=this.getMatrix();o.identity(),i.equals(s.Zero)||o.translate(c.assign(i).negate()),n.equals(s.One)||o.scale(n),t.equals(a.Identity)||o.rotate(t),i.equals(s.Zero)||o.translate(i),e.equals(s.Zero)||o.translate(e),this.setMatrix(o)}}),l}),define("cobweb/Components/Texturing3D/TextureTransformMatrix3D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Texturing/X3DTextureTransformNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TextureTransformMatrix3D)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"matrix",new t.SFMatrix4f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1))]),getTypeName:function(){return"TextureTransformMatrix3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},eventsProcessed:function(){r.prototype.eventsProcessed.call(this);var e=this.getMatrix();e.assign(this.matrix_.getValue()),this.setMatrix(e)}}),s}),define("cobweb/Components/EventUtilities/TimeTrigger",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EventUtilities/X3DTriggerNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TimeTrigger)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOnly,"set_boolean",new t.SFBool),new n(o.outputOnly,"triggerTime",new t.SFTime)]),getTypeName:function(){return"TimeTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.set_boolean_.addInterest(this,"set_boolean__")},set_boolean__:function(){this.triggerTime_=this.getBrowser().getCurrentTime()}}),s}),define("cobweb/Components/Grouping/Transform",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Grouping/X3DTransformNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.Transform)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"translation",new t.SFVec3f),new n(o.inputOutput,"rotation",new t.SFRotation),new n(o.inputOutput,"scale",new t.SFVec3f(1,1,1)),new n(o.inputOutput,"scaleOrientation",new t.SFRotation),new n(o.inputOutput,"center",new t.SFVec3f),new n(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new n(o.initializeOnly,"bboxCenter",new t.SFVec3f),new n(o.inputOnly,"addChildren",new t.MFNode),new n(o.inputOnly,"removeChildren",new t.MFNode),new n(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("cobweb/Components/Rendering/TriangleFanSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TriangleFanSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"fanCount",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.fanCount_.addInterest(this,"set_fanCount__"),this.set_fanCount__()},set_fanCount__:function(){var e=this.fanCount_.getValue(),t=this.triangleIndex;t.length=0;for(var n=0,i=e.length,r=0;i>n;++n){for(var o=e[n].getValue(),s=1,a=o-1;a>s;++s)t.push(r,r+s,r+s+1);r+=o}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("cobweb/Components/Rendering/TriangleSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TriangleSet)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&r.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(e,t){return this.createFaceNormals(e,t)}}),s}),define("cobweb/Components/Geometry2D/TriangleSet2D",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DGeometryNode","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.TriangleSet2D)}var u=new s(0,0,1),l=new s(0,0,0);return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"vertices",new t.MFVec2f),new n(o.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"TriangleSet2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){for(var e=this.vertices_.getValue(),t=0,n=e.length;n>t;++t){var i=e[t];this.addNormal(u),this.addVertex(l.set(i.x,i.y,0))}this.setSolid(this.solid_.getValue())},buildTexCoords:function(){var e=this.getTexCoordParams(),t=e.min,n=e.Ssize,i=[],r=this.vertices;this.texCoords.push(i);for(var o=0,s=this.vertices.length;s>o;o+=4)i.push((r[o]-t[0])/n,(r[o+1]-t[1])/n,0,1)},traverse:function(e){var t=this.getBrowser(),n=t.getContext(),i=t.getShader();i.use(),n.uniform1i(i.geometryType,2),r.prototype.traverse.call(this,e),n.uniform1i(i.geometryType,3)}}),a}),define("cobweb/Components/Rendering/TriangleStripSet",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Rendering/X3DComposedGeometryNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.TriangleStripSet),this.triangleIndex=[]}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"solid",new t.SFBool(!0)),new n(o.initializeOnly,"ccw",new t.SFBool(!0)),new n(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new n(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new n(o.inputOutput,"stripCount",new t.MFInt32),new n(o.inputOutput,"attrib",new t.MFNode),new n(o.inputOutput,"fogCoord",new t.SFNode),new n(o.inputOutput,"color",new t.SFNode),new n(o.inputOutput,"texCoord",new t.SFNode),new n(o.inputOutput,"normal",new t.SFNode),new n(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.stripCount_.addInterest(this,"set_stripCount__"),this.set_stripCount__()},set_stripCount__:function(){var e=this.stripCount_.getValue(),t=this.triangleIndex;t.length=0;for(var n=0,i=e.length,r=0;i>n;++n){for(var o=e[n].getValue(),s=0,a=o-2;a>s;++s){var u=1&s;t.push(r+(u?s+1:s),r+(u?s:s+1),r+(s+2))}r+=o}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){r.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("cobweb/Components/Shape/TwoSidedMaterial",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Shape/X3DMaterialNode","cobweb/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,n,i,r,o,s){function a(e){r.call(this,e.getBrowser(),e),this.addType(o.TwoSidedMaterial),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return a.prototype=e.extend(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.inputOutput,"separateBackColor",new t.SFBool),new n(o.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new n(o.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new n(o.inputOutput,"specularColor",new t.SFColor),new n(o.inputOutput,"emissiveColor",new t.SFColor),new n(o.inputOutput,"shininess",new t.SFFloat(.2)),new n(o.inputOutput,"transparency",new t.SFFloat),new n(o.inputOutput,"backAmbientIntensity",new t.SFFloat(.2)),new n(o.inputOutput,"backDiffuseColor",new t.SFColor(.8,.8,.8)),new n(o.inputOutput,"backSpecularColor",new t.SFColor),new n(o.inputOutput,"backEmissiveColor",new t.SFColor),new n(o.inputOutput,"backShininess",new t.SFFloat(.2)),new n(o.inputOutput,"backTransparency",new t.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){r.prototype.initialize.call(this),this.addChildren("transparent",new t.SFBool),this.ambientIntensity_.addInterest(this,"set_ambientIntensity__"),this.diffuseColor_.addInterest(this,"set_diffuseColor__"),this.specularColor_.addInterest(this,"set_specularColor__"),this.emissiveColor_.addInterest(this,"set_emissiveColor__"),this.shininess_.addInterest(this,"set_shininess__"),this.transparency_.addInterest(this,"set_transparency__"),this.backAmbientIntensity_.addInterest(this,"set_backAmbientIntensity__"),this.backDiffuseColor_.addInterest(this,"set_backDiffuseColor__"),this.backSpecularColor_.addInterest(this,"set_backSpecularColor__"),this.backEmissiveColor_.addInterest(this,"set_backEmissiveColor__"),this.backShininess_.addInterest(this,"set_backShininess__"),this.backTransparency_.addInterest(this,"set_backTransparency__"),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__()},getSeparateBackColor:function(){return this.separateBackColor_.getValue()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){this.diffuseColor.set(this.diffuseColor_.getValue())},set_specularColor__:function(){this.specularColor.set(this.specularColor_.getValue())},set_emissiveColor__:function(){this.emissiveColor.set(this.emissiveColor_.getValue())},set_shininess__:function(){this.shininess=128*s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){this.transparency=s.clamp(this.transparency_.getValue(),0,1),this.set_transparent__()},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this.backAmbientIntensity_.getValue(),0)},set_backDiffuseColor__:function(){this.backDiffuseColor.set(this.backDiffuseColor_.getValue())},set_backSpecularColor__:function(){this.backSpecularColor.set(this.backSpecularColor_.getValue())},set_backEmissiveColor__:function(){this.backEmissiveColor.set(this.backEmissiveColor_.getValue())},set_backShininess__:function(){this.backShininess=128*s.clamp(this.backShininess_.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=s.clamp(this.backTransparency_.getValue(),0,1),this.set_transparent__()},set_transparent__:function(){var e=this.transparency_.getValue()||this.backTransparency_.getValue();e!=this.transparent_.getValue()&&(this.transparent_=e)}}),a}),define("cobweb/Components/Navigation/ViewpointGroup",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DChildNode","cobweb/Components/EnvironmentalSensor/ProximitySensor","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,n,i,r,o,s,a,u){function l(e){r.call(this,e.getBrowser(),e),this.addType(a.ViewpointGroup),this.proximitySensor=new o(e),this.cameraObjects=[],this.viewpointGroups=[]}function c(e){switch(e){case s.CAMERA:if(this.proximitySensor.traverse(e),this.proximitySensor.isActive_.getValue())for(var t=0,n=this.cameraObjects.length;n>t;++t)this.cameraObjects[t].traverse(e);return;case s.DISPLAY:if(this.proximitySensor.traverse(e),this.proximitySensor.isActive_.getValue())for(var t=0,n=this.viewpointGroups.length;n>t;++t)this.viewpointGroups[t].traverse(e);return}}function h(e){switch(e){case s.CAMERA:for(var t=0,n=this.cameraObjects.length;n>t;++t)this.cameraObjects[t].traverse(e);return;case s.DISPLAY:for(var t=0,n=this.viewpointGroups.length;n>t;++t)this.viewpointGroups[t].traverse(e);return}}return l.prototype=e.extend(Object.create(r.prototype),{constructor:l,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new t.SFNode),new n(a.inputOutput,"displayed",new t.SFBool(!0)),new n(a.inputOutput,"description",new t.SFString),new n(a.inputOutput,"retainUserOffsets",new t.SFBool),new n(a.inputOutput,"size",new t.SFVec3f),new n(a.inputOutput,"center",new t.SFVec3f),new n(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.proximitySensor.setup(),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.displayed_.addInterest(this,"set_displayed__"),this.size_.addInterest(this,"set_displayed__"),this.children_.addInterest(this,"set_children__"),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor.isActive_.getValue()},set_displayed__:function(){var e=!this.size_.getValue().equals(u.Zero),t=this.displayed_.getValue();this.proximitySensor.enabled_=t&&e,t&&e?(this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.setCameraObject(this.proximitySensor.getCameraObject()),this.traverse=c):(this.proximitySensor.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.setCameraObject(t),t?this.traverse=h:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var e=this.children_,t=0,n=e.length;n>t;++t)try{for(var i=e[t].getValue().getInnerNode(),r=i.getType(),o=r.length-1;o>=0;--o)switch(r[o]){case a.X3DViewpointNode:this.cameraObjects.push(i);break;case a.ViewpointGroup:this.cameraObjects.push(i),this.viewpointGroups.push(i)}}catch(s){}},traverse:function(){}}),l}),define("cobweb/Components/EnvironmentalSensor/VisibilitySensor",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","cobweb/Bits/TraverseType","cobweb/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(e,t,n,i,r,o,s,a,u,l){function c(e){r.call(this,e.getBrowser(),e),this.addType(s.VisibilitySensor),this.visible=!1}function h(e){if(e===o.DISPLAY&&(this.setTraversed(!0),!this.visible))if(this.size_.getValue().equals(d))this.visible=!0;else{var t=this.getCurrentLayer().getViewVolume(),n=this.getModelViewMatrix(e,this.modelViewMatrix),i=n.multDirMatrix(this.size.assign(this.size_.getValue())),r=n.multVecMatrix(this.center.assign(this.center_.getValue()));this.visible=t.intersectsSphere(i.abs()/2,r)}}var d=new a(-1,-1,-1);return c.prototype=e.extend(Object.create(r.prototype),{constructor:c,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"enabled",new t.SFBool(!0)),new n(s.inputOutput,"size",new t.SFVec3f),new n(s.inputOutput,"center",new t.SFVec3f),new n(s.outputOnly,"enterTime",new t.SFTime),new n(s.outputOnly,"exitTime",new t.SFTime),new n(s.outputOnly,"isActive",new t.SFBool)]),size:new a(0,0,0),center:new a(0,0,0),modelViewMatrix:new u,getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.enabled_.addInterest(this,"set_enabled__"),this.set_enabled__()},set_enabled__:function(){this.enabled_.getValue()?this.traverse=h:delete this.traverse},update:function(){this.visible&&this.getTraversed()?(this.isActive_.getValue()||(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime()),this.visible=!1):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(){}}),c}),define("cobweb/Components/Core/X3DInfoNode",["jquery","cobweb/Components/Core/X3DChildNode","cobweb/Bits/X3DConstants"],function(e,t,n){function i(e,i){t.call(this,e,i),this.addType(n.X3DInfoNode)}return i.prototype=e.extend(Object.create(t.prototype),{constructor:i}),i}),define("cobweb/Components/Core/WorldInfo",["jquery","cobweb/Fields","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Components/Core/X3DInfoNode","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o){function s(e){r.call(this,e.getBrowser(),e),this.addType(o.WorldInfo)}return s.prototype=e.extend(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new t.SFNode),new n(o.initializeOnly,"title",new t.SFString),new n(o.initializeOnly,"info",new t.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"}}),s}),define("cobweb/Configuration/SupportedNodes",["cobweb/Components/Networking/Anchor","cobweb/Components/Shape/Appearance","cobweb/Components/Geometry2D/Arc2D","cobweb/Components/Geometry2D/ArcClose2D","cobweb/Components/Sound/AudioClip","cobweb/Components/EnvironmentalEffects/Background","cobweb/Components/Navigation/Billboard","cobweb/Components/EventUtilities/BooleanFilter","cobweb/Components/EventUtilities/BooleanSequencer","cobweb/Components/EventUtilities/BooleanToggle","cobweb/Components/EventUtilities/BooleanTrigger","cobweb/Components/Geometry3D/Box","cobweb/Components/CADGeometry/CADAssembly","cobweb/Components/CADGeometry/CADFace","cobweb/Components/CADGeometry/CADLayer","cobweb/Components/CADGeometry/CADPart","cobweb/Components/Geometry2D/Circle2D","cobweb/Components/Rendering/ClipPlane","cobweb/Components/Navigation/Collision","cobweb/Components/Rendering/Color","cobweb/Components/Followers/ColorChaser","cobweb/Components/Followers/ColorDamper","cobweb/Components/Interpolation/ColorInterpolator","cobweb/Components/Rendering/ColorRGBA","cobweb/Components/CubeMapTexturing/ComposedCubeMapTexture","cobweb/Components/Shaders/ComposedShader","cobweb/Components/Geometry3D/Cone","cobweb/Components/Rendering/Coordinate","cobweb/Components/Followers/CoordinateChaser","cobweb/Components/Followers/CoordinateDamper","cobweb/Components/NURBS/CoordinateDouble","cobweb/Components/Interpolation/CoordinateInterpolator","cobweb/Components/Interpolation/CoordinateInterpolator2D","cobweb/Components/Geometry3D/Cylinder","cobweb/Components/PointingDeviceSensor/CylinderSensor","cobweb/Components/Lighting/DirectionalLight","cobweb/Components/Geometry2D/Disk2D","cobweb/Components/Interpolation/EaseInEaseOut","cobweb/Components/Geometry3D/ElevationGrid","cobweb/Components/Geometry3D/Extrusion","cobweb/Components/EnvironmentalEffects/Fog","cobweb/Components/Text/FontStyle","cobweb/Components/Grouping/Group","cobweb/Components/Texturing/ImageTexture","cobweb/Components/Geometry3D/IndexedFaceSet","cobweb/Components/Rendering/IndexedLineSet","cobweb/Components/CADGeometry/IndexedQuadSet","cobweb/Components/Rendering/IndexedTriangleFanSet","cobweb/Components/Rendering/IndexedTriangleSet","cobweb/Components/Rendering/IndexedTriangleStripSet","cobweb/Components/Networking/Inline","cobweb/Components/EventUtilities/IntegerSequencer","cobweb/Components/EventUtilities/IntegerTrigger","cobweb/Components/KeyDeviceSensor/KeySensor","cobweb/Components/Navigation/LOD","cobweb/Components/Layering/Layer","cobweb/Components/Layering/LayerSet","cobweb/Components/Layout/Layout","cobweb/Components/Layout/LayoutGroup","cobweb/Components/Layout/LayoutLayer","cobweb/Components/Shape/LineProperties","cobweb/Components/Rendering/LineSet","cobweb/Components/Networking/LoadSensor","cobweb/Components/EnvironmentalEffects/LocalFog","cobweb/Components/Shape/Material","cobweb/Components/Core/MetadataBoolean","cobweb/Components/Core/MetadataDouble","cobweb/Components/Core/MetadataFloat","cobweb/Components/Core/MetadataInteger","cobweb/Components/Core/MetadataSet","cobweb/Components/Core/MetadataString","cobweb/Components/Texturing/MovieTexture","cobweb/Components/Navigation/NavigationInfo","cobweb/Components/Rendering/Normal","cobweb/Components/Interpolation/NormalInterpolator","cobweb/Components/Followers/OrientationChaser","cobweb/Components/Followers/OrientationDamper","cobweb/Components/Interpolation/OrientationInterpolator","cobweb/Components/Navigation/OrthoViewpoint","cobweb/Components/Texturing/PixelTexture","cobweb/Components/PointingDeviceSensor/PlaneSensor","cobweb/Components/Lighting/PointLight","cobweb/Components/Rendering/PointSet","cobweb/Components/Geometry2D/Polyline2D","cobweb/Components/Geometry2D/Polypoint2D","cobweb/Components/Followers/PositionChaser","cobweb/Components/Followers/PositionChaser2D","cobweb/Components/Followers/PositionDamper","cobweb/Components/Followers/PositionDamper2D","cobweb/Components/Interpolation/PositionInterpolator","cobweb/Components/Interpolation/PositionInterpolator2D","cobweb/Components/EnvironmentalSensor/ProximitySensor","cobweb/Components/CADGeometry/QuadSet","cobweb/Components/Geometry2D/Rectangle2D","cobweb/Components/Followers/ScalarChaser","cobweb/Components/Followers/ScalarDamper","cobweb/Components/Interpolation/ScalarInterpolator","cobweb/Components/Layout/ScreenGroup","cobweb/Components/Scripting/Script","cobweb/Components/Shaders/ShaderPart","cobweb/Components/Shape/Shape","cobweb/Components/Sound/Sound","cobweb/Components/Geometry3D/Sphere","cobweb/Components/PointingDeviceSensor/SphereSensor","cobweb/Components/Interpolation/SplinePositionInterpolator","cobweb/Components/Interpolation/SplinePositionInterpolator2D","cobweb/Components/Interpolation/SplineScalarInterpolator","cobweb/Components/Lighting/SpotLight","cobweb/Components/Interpolation/SquadOrientationInterpolator","cobweb/Components/Grouping/StaticGroup","cobweb/Components/Grouping/Switch","cobweb/Components/Followers/TexCoordChaser2D","cobweb/Components/Followers/TexCoordDamper2D","cobweb/Components/Text/Text","cobweb/Components/EnvironmentalEffects/TextureBackground","cobweb/Components/Texturing/TextureCoordinate","cobweb/Components/Texturing3D/TextureCoordinate3D","cobweb/Components/Texturing3D/TextureCoordinate4D","cobweb/Components/Texturing/TextureProperties","cobweb/Components/Texturing/TextureTransform","cobweb/Components/Texturing3D/TextureTransform3D","cobweb/Components/Texturing3D/TextureTransformMatrix3D","cobweb/Components/Time/TimeSensor","cobweb/Components/EventUtilities/TimeTrigger","cobweb/Components/PointingDeviceSensor/TouchSensor","cobweb/Components/Grouping/Transform","cobweb/Components/Rendering/TriangleFanSet","cobweb/Components/Rendering/TriangleSet","cobweb/Components/Geometry2D/TriangleSet2D","cobweb/Components/Rendering/TriangleStripSet","cobweb/Components/Shape/TwoSidedMaterial","cobweb/Components/Navigation/Viewpoint","cobweb/Components/Navigation/ViewpointGroup","cobweb/Components/Layering/Viewport","cobweb/Components/EnvironmentalSensor/VisibilitySensor","cobweb/Components/Core/WorldInfo"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y,b,w,v,x,_,C,S,T,F,O,N,V,D,M,B,E,I,A,P,L,R,k,j,z,X,U,q,G,H,W,Y,$,K,Z,Q,J,ee,te,ne,ie,re,oe,se,ae,ue,le,ce,he,de,pe,fe,ge,me,ye,be,we,ve,xe,_e,Ce,Se,Te,Fe,Oe,Ne,Ve,De,Me,Be,Ee,Ie,Ae,Pe,Le,Re,ke,je,ze,Xe,Ue,qe,Ge,He,We,Ye,$e,Ke,Ze,Qe,Je,et,tt,nt,it,rt,ot,st,at,ut,lt,ct,ht,dt,pt,ft,gt,mt,yt,bt,wt,vt,xt,_t,Ct,St,Tt,Ft,Ot){return{MetadataBool:he,Anchor:e,Appearance:t,Arc2D:n,ArcClose2D:i,AudioClip:r,Background:o,Billboard:s,BooleanFilter:a,BooleanSequencer:u,BooleanToggle:l,BooleanTrigger:c,Box:h,CADAssembly:d,CADFace:p,CADLayer:f,CADPart:g,Circle2D:m,ClipPlane:y,Collision:b,Color:w,ColorChaser:v,ColorDamper:x,ColorInterpolator:_,ColorRGBA:C,ComposedCubeMapTexture:S,ComposedShader:T,Cone:F,Coordinate:O,CoordinateChaser:N,CoordinateDamper:V,CoordinateDouble:D,CoordinateInterpolator:M,CoordinateInterpolator2D:B,Cylinder:E,CylinderSensor:I,DirectionalLight:A,Disk2D:P,EaseInEaseOut:L,ElevationGrid:R,Extrusion:k,Fog:j,FontStyle:z,Group:X,ImageTexture:U,IndexedFaceSet:q,IndexedLineSet:G,IndexedQuadSet:H,IndexedTriangleFanSet:W,IndexedTriangleSet:Y,IndexedTriangleStripSet:$,Inline:K,IntegerSequencer:Z,IntegerTrigger:Q,KeySensor:J,LOD:ee,Layer:te,LayerSet:ne,Layout:ie,LayoutGroup:re,LayoutLayer:oe,LineProperties:se,LineSet:ae,LoadSensor:ue,LocalFog:le,Material:ce,MetadataBoolean:he,MetadataDouble:de,MetadataFloat:pe,MetadataInteger:fe,MetadataSet:ge,MetadataString:me,MovieTexture:ye,NavigationInfo:be,Normal:we,NormalInterpolator:ve,OrientationChaser:xe,OrientationDamper:_e,OrientationInterpolator:Ce,OrthoViewpoint:Se,PixelTexture:Te,PlaneSensor:Fe,PointLight:Oe,PointSet:Ne,Polyline2D:Ve,Polypoint2D:De,PositionChaser:Me,PositionChaser2D:Be,PositionDamper:Ee,PositionDamper2D:Ie,PositionInterpolator:Ae,PositionInterpolator2D:Pe,ProximitySensor:Le,QuadSet:Re,Rectangle2D:ke,ScalarChaser:je,ScalarDamper:ze,ScalarInterpolator:Xe,ScreenGroup:Ue,Script:qe,ShaderPart:Ge,Shape:He,Sound:We,Sphere:Ye,SphereSensor:$e,SplinePositionInterpolator:Ke,SplinePositionInterpolator2D:Ze,SplineScalarInterpolator:Qe,SpotLight:Je,SquadOrientationInterpolator:et,StaticGroup:tt,Switch:nt,TexCoordChaser2D:it,TexCoordDamper2D:rt,Text:ot,TextureBackground:st,TextureCoordinate:at,TextureCoordinate3D:ut,TextureCoordinate4D:lt,TextureProperties:ct,TextureTransform:ht,TextureTransform3D:dt,TextureTransformMatrix3D:pt,TimeSensor:ft,TimeTrigger:gt,TouchSensor:mt,Transform:yt,TriangleFanSet:bt,TriangleSet:wt,TriangleSet2D:vt,TriangleStripSet:xt,TwoSidedMaterial:_t,Viewpoint:Ct,ViewpointGroup:St,Viewport:Tt,VisibilitySensor:Ft,WorldInfo:Ot}}),define("cobweb/Execution/Scene",["cobweb/Execution/X3DScene"],function(e){function t(t){e.call(this,t,this)}return t.prototype=$.extend(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"Scene"}}),t}),define("cobweb/Browser/X3DBrowser",["jquery","cobweb/Fields","cobweb/Browser/X3DBrowserContext","cobweb/Browser/Version","cobweb/Configuration/ComponentInfo","cobweb/Configuration/SupportedProfiles","cobweb/Configuration/SupportedComponents","cobweb/Configuration/SupportedNodes","cobweb/Execution/Scene","cobweb/InputOutput/Loader","cobweb/Parser/XMLParser","cobweb/Parser/Parser","cobweb/Bits/X3DConstants","lib/gettext"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p){function f(e){n.call(this,e),this.currentSpeed=0,this.currentFrameRate=0,this.description_="",this.supportedNodes=a,this.supportedComponents=s,this.supportedProfiles=o}return f.prototype=e.extend(Object.create(n.prototype),{constructor:f,initialize:function(){this.replaceWorld(this.createScene()),n.prototype.initialize.call(this),this.getLoadSensor().loadTime_.addInterest(this,"realize"),this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n        Current Graphics Renderer\n                Name: "+this.getVendor()+" "+this.getWebGLVersion()+"\n                Shading language: "+this.getShadingLanguageVersion()+"\n        Rendering Properties\n                Texture units: "+this.getMaxTextureUnits()+" / "+this.getMaxCombinedTextureUnits()+"\n                Max texture size: "+this.getMaxTextureSize()+"  "+this.getMaxTextureSize()+" pixel\n                Max lights: 0\n                Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n                Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n                Max vertex attribs: "+this.getMaxVertexAttribs()+"\n                Antialiased: "+this.getAntialiased()+"\n                Color depth: "+this.getColorDepth()+" bits\n")},realize:function(){this.getLoadSensor().loadTime_.removeInterest(this,"realize");var e=this.getElement()[0].getAttribute("url");if(e){var n=new h(this.getExecutionContext(),"",!0),i=new t.MFString,r=new t.MFString;n.setInput(e),n.sfstringValues(i),i.length&&this.loadURL(i,r)}},getName:function(){return this.name},getVersion:function(){return this.version},getCurrentSpeed:function(){return this.currentSpeed},getCurrentFrameRate:function(){return this.currentFrameRate},setDescription:function(e){this.description=e},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(e){var t=this.supportedProfiles.get(e);if(t)return t;throw Error("Profile '"+e+"' is not supported.")},getComponent:function(e,t){var n=this.supportedComponents.get(e);if(n&&t<=n.level)return new r(e,t,n.title,this.browser.getProviderUrl());throw Error("Component '"+e+"' at level '"+t+"' is not supported.")},createScene:function(){var e=new u(this);return e.setup(),this.isExternal()?e:(e.beginUpdate(),e)},replaceWorld:function(e){this.getWorld()&&(this.getExecutionContext().endUpdate(),this.shutdown().processInterests()),e||(e=this.createScene()),this.loadCount_.removeFieldCallback("bindWorld"+this.loadId),this.loadId=performance.now(),this.description="",this.setBrowserLoading(!0),this.loadCount_.addFieldCallback("bindWorld"+this.loadId,this.bindWorld.bind(this)),this.isLive().getValue()?e.beginUpdate():e.endUpdate(),this.setExecutionContext(e),this.initialized().setValue(this.getCurrentTime())},bindWorld:function(e){e||(this.loadCount_.removeFieldCallback("bindWorld"+this.loadId),
this.getWorld().bind(),this.setBrowserLoading(!1))},createVrmlFromString:function(e){var n=new t.MFNode;return n.setValue(this.createX3DFromString(e).rootNodes),n},createX3DFromString:function(e){var t=this.currentScene,n=this.isExternal(),i=new l(this.getWorld()).createX3DFromString(this.currentScene.getURL(),e);return n||(t.isLive().addFieldInterest(i.isLive()),t.isLive().getValue()&&i.beginUpdate()),i.setup(),i},createVrmlFromURL:function(e,n,i){if(!(n instanceof t.SFNode))throw new Error("Browser.createVrmlFromURL: node must be of type SFNode.");if(!n.getValue())throw new Error("Browser.createVrmlFromURL: node IS NULL.");var r=n.getValue().getField(i);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be a input field.");if(r.getType()!==d.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be of type MFNode.");var o=this.currentScene,s=this.isExternal();new l(this.getWorld()).createX3DFromURL(e,function(e){e&&(s||(o.isLive().addFieldInterest(e.isLive()),o.isLive().getValue()&&e.beginUpdate()),e.setup(),r.setValue(e.rootNodes))})},createX3DFromURL:function(e,t,n){if(3===arguments.length)return this.createVrmlFromURL(e,t,n);var i=this.currentScene,r=this.isExternal(),o=new l(this.getWorld()).createX3DFromURL(e);return r||(i.isLive().addFieldInterest(o.isLive()),i.isLive().getValue()&&o.beginUpdate()),o.setup(),o},loadURL:function(e,t){for(var n,i=0,r=t.length;r>i;++i){var o=t[i].split("=");2===o.length&&"target"===o[0]&&(n=o[1])}this.setBrowserLoading(!0);var s=this.addLoadCount();new l(this.getWorld()).createX3DFromURL(e,function(e){e?this.replaceWorld(e):setTimeout(function(){this.getLoadingElement().find(".cobweb-spinner-text").text(p("Failed loading world."))}.bind(this),31),this.removeLoadCount(s)}.bind(this),function(e){this.currentScene.changeViewpoint(e),this.removeLoadCount(s),this.setBrowserLoading(!1)}.bind(this),function(e){n?window.open(e,n):location=e,this.removeLoadCount(s),this.setBrowserLoading(!1)}.bind(this))},getRenderingProperty:function(e){this.getRenderingProperties().getField(e).getValue()},addBrowserListener:function(e,t){},removeBrowserListener:function(e){},importDocument:function(e){e&&(new c(this.currentScene,e).parseIntoScene(),this.currentScene.setup())},setBrowserOption:function(e,t){this.getBrowserOptions().getField(e).setValue(t)},getBrowserOption:function(e){return this.getBrowserOptions().getField(e).getValue()},firstViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();t.length&&this.bindViewpoint(t[0])}},previousViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();if(0===t.length)return;for(var n=0,i=0;i<t.length&&!t[i].isBound_.getValue();++i)++n;n<t.length?0===n?this.bindViewpoint(t[t.length-1]):this.bindViewpoint(t[n-1]):this.bindViewpoint(t[t.length-1])}},nextViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();if(0===t.length)return;for(var n=0,i=0;i<t.length&&!t[i].isBound_.getValue();++i)++n;n<t.length?n===t.length-1?this.bindViewpoint(t[0]):this.bindViewpoint(t[n+1]):this.bindViewpoint(t[0])}},lastViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();t.length&&this.bindViewpoint(t[t.length-1])}},changeViewpoint:function(e){try{this.currentScene.changeViewpoint(e)}catch(t){console.log(t.message)}},bindViewpoint:function(e){e.isBound_.getValue()?e.transitionStart(null,e):e.set_bind_=!0},addRoute:function(e,t,n,i){this.currentScene.addRoute(e,t,n,i)},deleteRoute:function(e,t,n,i){try{this.currentScene.deleteRoute(this.currentScene.getRoute(e,t,n,i))}catch(r){console.log(r)}},beginUpdate:function(){n.prototype.beginUpdate.call(this),this.getExecutionContext().beginUpdate()},endUpdate:function(){n.prototype.endUpdate.call(this)},print:function(){for(var t="",n=0;n<arguments.length;++n)t+=arguments[n];console.log(t),e(".cobweb-console").append(t)},println:function(){for(var t="",n=0;n<arguments.length;++n)t+=arguments[n];console.log(t),t+="\n",e(".cobweb-console").append(t)}}),Object.defineProperty(f.prototype,"name",{get:function(){return"Cobweb"},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"version",{get:function(){return i},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"description",{get:function(){return this.description_},set:function(e){this.description_=e,this.getNotification().string_=e},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"currentScene",{get:function(){return this.getScriptStack()[this.getScriptStack().length-1].getExecutionContext()},enumerable:!0,configurable:!1}),f}),define("cobweb/X3D",["jquery","cobweb/Error","cobweb/Basic/X3DFieldDefinition","cobweb/Basic/FieldDefinitionArray","cobweb/Basic/X3DField","cobweb/Basic/X3DArrayField","cobweb/Fields","cobweb/Browser/X3DBrowser","cobweb/Configuration/ComponentInfo","cobweb/Configuration/ComponentInfoArray","cobweb/Configuration/ProfileInfo","cobweb/Configuration/ProfileInfoArray","cobweb/Configuration/UnitInfo","cobweb/Configuration/UnitInfoArray","cobweb/Execution/X3DExecutionContext","cobweb/Execution/X3DScene","cobweb/Prototype/ExternProtoDeclarationArray","cobweb/Prototype/ProtoDeclarationArray","cobweb/Prototype/X3DExternProtoDeclaration","cobweb/Prototype/X3DProtoDeclaration","cobweb/Routing/RouteArray","cobweb/Routing/X3DRoute","cobweb/Bits/X3DConstants"],function(e,t,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,y,b,w,v,x,_){function C(t){return e(t).data("browser")}function S(t){t=e(t);var n=new a(t);return t.data("browser",n),n.setup(),"false"!==t.attr("splashScreen")&&n.getCanvas().fadeOut(0),n}function T(n,i){"function"==typeof n&&O.done(n),"function"==typeof i&&N.done(i),F||(F=!0,e(function(){var n=e("X3D");try{e.map(n,S),n.length&&O.resolve(n)}catch(i){t.fallback(n),N.resolve(n,i)}}))}console||(console={}),console.log||(console.log=function(){}),console.info||(console.info=console.log),console.warn||(console.warn=console.log),console.error||(console.error=console.log);var F=!1,O=e.Deferred(),N=e.Deferred();return e.extend(T,s,{require:require,getBrowser:C,createBrowser:S,X3DConstants:_,X3DFieldDefinition:n,FieldDefinitionArray:i,X3DField:r,X3DArrayField:o,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:c,ProfileInfoArray:h,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:m,ProtoDeclarationArray:y,X3DExterProtonDeclaration:b,X3DProtoDeclaration:w,RouteArray:v,X3DRoute:x}),T}),function(){function e(t,n){e.callbacks.push(t),e.fallbacks.push(n)}function t(e){require(["cobweb/Error"],function(t){t(e,window.X3D.fallbacks),delete window.X3D})}if(e.callbacks=[],e.fallbacks=[],void 0===window.X3D){if(window.X3D=e,void 0===window.Proxy)return t("Proxy is not defined");require(["cobweb/X3D"],function(e){var t=window.X3D.callbacks,n=window.X3D.fallbacks;window.X3D=e,e();for(var i=0;i<t.length;++i)e(t[i],n[i])},t)}}(),define("cobweb.js",function(){})}();
